<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:5pt Arial, sans-serif; }
 .font1 { font:6pt Arial, sans-serif; }
 .font2 { font:7pt Arial, sans-serif; }
 .font3 { font:8pt Arial, sans-serif; }
 .font4 { font:9pt Arial, sans-serif; }
 .font5 { font:10pt Arial, sans-serif; }
 .font6 { font:11pt Arial, sans-serif; }
 .font7 { font:12pt Arial, sans-serif; }
 .font8 { font:13pt Arial, sans-serif; }
 .font9 { font:14pt Arial, sans-serif; }
 .font10 { font:19pt Arial, sans-serif; }
 .font11 { font:20pt Arial, sans-serif; }
 .font12 { font:22pt Arial, sans-serif; }
 .font13 { font:24pt Arial, sans-serif; }
 .font14 { font:8pt Arial Unicode MS, sans-serif; }
 .font15 { font:9pt Arial Unicode MS, sans-serif; }
 .font16 { font:10pt Cambria, serif; }
 .font17 { font:12pt Cambria, serif; }
 .font18 { font:16pt Cambria, serif; }
 .font19 { font:6pt Courier New, monospace; }
 .font20 { font:8pt Courier New, monospace; }
 .font21 { font:9pt Courier New, monospace; }
 .font22 { font:22pt Courier New, monospace; }
 .font23 { font:9pt Times New Roman, serif; }
 .font24 { font:10pt Times New Roman, serif; }
 .font25 { font:12pt Times New Roman, serif; }
 .font26 { font:13pt Times New Roman, serif; }
 .font27 { font:17pt Times New Roman, serif; }
 .font28 { font:20pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font18" style="font-style:italic;">Understanding Web Internals</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-1.jpg" alt="" style="width:468pt;height:468pt;">
</div><br clear="all">
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font10">O’REILLY®</span></p>
</div>
<p style="text-align:right;padding:0pt 0pt 0pt 46pt;"><span class="font17" style="font-weight:bold;font-style:italic;">David Gourley &amp;&nbsp;Brian Totty </span><span class="font17" style="font-style:italic;">with Marjorie Sayer, Sailιι Reddy &amp;&nbsp;Anshu Aggarwal</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font23">Web Programming</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font10">O’REILLY®</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font28">HTTP: The Definitive Guide</span></p>
<p style="text-indent:37pt;"><span class="font16"><sup>-</sup>1 Behind every successful web transaction lurks the Hypertext Transfer Protocol (HTTP), βs∣ij!!j&lt;∣∣y the language by which web clients and servers exchange documents and information.</span></p>
<p style="text-indent:54pt;"><span class="font16">HTTP is commonly known as the workhorse behind the browsers we use every day to </span><span class="font2">K∏<sup>fc</sup>--- </span><span class="font16">access our company intranets, locate out-of-print books, or research census information.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">But HTTP is used for far more than browsing the Web: the simplicity and ubiquity of HTTP also have made it the choice protocol for many other networked applications, most notably through web services such as SOAP and XML-RPC.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">As the title suggests, </span><span class="font16" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font16"> explains the HTTP protocol: how it works and how to use it to develop web-based applications. However, this book is not just about HTTP; it’s also about all the other core Internet technologies that HTTP depends on to work effectively. Although HTTP is at the center of the book, the essence of </span><span class="font16" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font16"> is in understanding how the Web works and how to apply that knowledge to web programming and administration. The book explains the technical workings, motivations, performance considerations, and objectives of H'ΓTP and the technologies around which it revolves.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font16"> is the bible for the HTTP protocol and related web technologies. Topics covered include:</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• HTTP methods, headers, and status codes</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• Optimizing proxies and caches</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• Strategies for designing web robots and crawlers</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• Cookies, authentication, and Secure HTTP</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• Internationalization and content negotiation</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">• Redirection and load-balancing strategies</span></p></li></ul>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font16">Written by experts with years of practical experience, this book uses clear, concise language and a plethora of detailed illustrations to help readers visualize what goes on behind the scenes, providing a complete understanding of the story behind each query on the Web.</span></p>
<p style="padding:0pt 0pt 54pt 0pt;"><span class="font16">All web programmers, administrators, and application developers need to be familiar with HTTP in order to work effectively. There are many books that explain how to use the Web, but this is the book that explains how the Web works.</span></p>
<p><a href="http://www.oreilly.com"><span class="font6" style="font-weight:bold;">www.oreilly.com</span></a></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font23">CAN $69.95</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font23">US $44.95</span></p>
</div><br clear="all">
<p><span class="font3">ISBN: 978-1-56592-509-0</span></p>
<p style="text-align:right;padding:0pt 35pt 0pt 0pt;"><span class="font11" style="font-weight:bold;">HTTP</span></p>
<p style="text-align:right;padding:0pt 35pt 0pt 0pt;"><span class="font26" style="font-weight:bold;font-style:italic;">The Definitive Guide</span></p>
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><span class="font13" style="font-weight:bold;">HTTP</span></p>
<p style="text-align:right;padding:0pt 0pt 214pt 0pt;"><span class="font27" style="font-weight:bold;font-style:italic;">The Definitive Guide</span></p>
<p style="text-align:right;"><span class="font17" style="font-weight:bold;font-style:italic;">David Gourley and Brian Totty</span></p>
<p style="text-align:right;padding:0pt 0pt 160pt 0pt;"><span class="font25" style="font-style:italic;">with Marjorie Sayer, Sailu Reddy, and Anshu Aggarwal</span></p>
<p style="text-align:right;"><span class="font3">Beijing </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Cambridge </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Farnham </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Köln </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Paris </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Sebastopol </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Taipei </span><span class="font2" style="font-weight:bold;">• </span><span class="font3">Tokyo</span></p>
<p><span class="font4" style="font-weight:bold;">HTTP: The Definitive Guide</span></p>
<p><span class="font23">by David Gourley and Brian Totty</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font23">with Marjorie Sayer, Sailu Reddy, and Anshu Aggarwal</span></p>
<p><span class="font20">Copyright © 2002 O’Reilly Media, Inc. All rights reserved.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font20">Printed in the United States of America.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font20">Published by O’Reilly Media, Inc., 1005 Gravenstein Highway North, Sebastopol, CA 95472.</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font20">O’Reilly Media, Inc. books may be purchased for educational, business, or sales promotional use. Online editions are also available for most titles (</span><span class="font20" style="font-style:italic;">safari.oreilly.com</span><span class="font20">). For more information, contact our cor-porate/institutional sales department: (800) 998-9938 or </span><a href="mailto:corporate@oreilly.com"><span class="font20" style="font-style:italic;">corporate@oreilly.com</span></a><span class="font20">.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font4" style="font-weight:bold;">Editor: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font20">Linda Mui</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font4" style="font-weight:bold;">Production Editor: &nbsp;&nbsp;&nbsp;</span><span class="font20">Rachel Wheeler</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font4" style="font-weight:bold;">Cover Designer: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font20">Ellie Volckhausen</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font4" style="font-weight:bold;">Interior Designers: &nbsp;&nbsp;&nbsp;</span><span class="font20">David Futato and Melanie Wang</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font4" style="font-weight:bold;">Printing History:</span></p>
<p style="text-indent:13pt;padding:0pt 0pt 39pt 0pt;"><span class="font20">September 2002: &nbsp;&nbsp;First Edition.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font20">Nutshell Handbook, the Nutshell Handbook logo, and the O’Reilly logo are registered trademarks of O’Reilly Media, Inc. </span><span class="font20" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font20">, the image of a thirteen-lined ground squirrel, and related trade dress are trademarks of O’Reilly Media, Inc. Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this book, and O’Reilly Media, Inc. was aware of a trademark claim, the designations have been printed in caps or initial caps.</span></p>
<p style="padding:0pt 0pt 132pt 0pt;"><span class="font20">While every precaution has been taken in the preparation of this book, the publisher and authors assume no responsibility for errors or omissions, or for damages resulting from the use of the information contained herein.</span></p>
<p style="text-indent:42pt;padding:0pt 0pt 14pt 0pt;"><span class="font20">This book uses RepKover</span><span class="font0"><sup>™</sup></span><span class="font20">, a durable and flexible lay-flat binding.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font20">ISBN-10: 1-56592-509-2 ISBN-13: 978-1-56592-509-0 [C]</span></p><a name="caption1"></a>
<h1 style="text-align:right;padding:0pt 0pt 112pt 0pt;"><a name="bookmark0"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1"></a>Table of Contents</span></h1>
<p style="padding:0pt 0pt 20pt 0pt;"><a href="#bookmark2"><span class="font6" style="font-weight:bold;">Preface </span></a></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3"><span class="font8" style="font-weight:bold;">Pa rt I.</span></a><a href="#bookmark4"><span class="font8" style="font-weight:bold;"> HTTP: The Web’s Foundation</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark5"><span class="font6" style="font-weight:bold;">1. Overview of HTTP </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark6"><span class="font23">HTTP: The Internet’s Multimedia Courier</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark7"><span class="font23">Web Clients and Servers</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark8"><span class="font23">Resources</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark9"><span class="font23">Transactions</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark10"><span class="font23">Messages</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark11"><span class="font23">Connections</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark12"><span class="font23">Protocol Versions</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark13"><span class="font23">Architectural Components of the Web</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark14"><span class="font23">The End of the Beginning</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark15"><span class="font23">For More Information</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark16"><span class="font6" style="font-weight:bold;">2. URLs and Resources </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark17"><span class="font23">Navigating the Internet’s Resources</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark18"><span class="font23">URL Syntax</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark19"><span class="font23">URL Shortcuts</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark20"><span class="font23">Shady Characters</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark21"><span class="font23">A Sea of Schemes</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark22"><span class="font23">The Future</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark23"><span class="font23">For More Information</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark24"><span class="font6" style="font-weight:bold;">3. HTTP Messages </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark25"><span class="font23">The Flow of Messages</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark26"><span class="font23">The Parts of a Message</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark27"><span class="font23">Methods</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark28"><span class="font23">Status Codes</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark29"><span class="font23">Headers</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark30"><span class="font23">For More Information</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark31"><span class="font6" style="font-weight:bold;">4. Connection Management </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark32"><span class="font23">TCP Connections</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark33"><span class="font23">TCP Performance Considerations</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark34"><span class="font23">HTTP Connection Handling</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark35"><span class="font23">Parallel Connections</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark36"><span class="font23">Persistent Connections</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark37"><span class="font23">Pipelined Connections</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark38"><span class="font23">The Mysteries of Connection Close</span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 22pt 0pt;"><a href="#bookmark39"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark40"><span class="font8" style="font-weight:bold;">Pa rt II.</span></a><a href="#bookmark41"><span class="font8" style="font-weight:bold;"> HTTP Architecture</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark42"><span class="font6" style="font-weight:bold;">5. Web Servers </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark43"><span class="font23">Web Servers Come in All Shapes and Sizes</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark44"><span class="font23">A Minimal Perl Web Server</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark45"><span class="font23">What Real Web Servers Do</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark46"><span class="font23">Step 1: Accepting Client Connections</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark47"><span class="font23">Step 2: Receiving Request Messages</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark48"><span class="font23">Step 3: Processing Requests</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark49"><span class="font23">Step 4: Mapping and Accessing Resources</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark50"><span class="font23">Step 5: Building Responses</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark51"><span class="font23">Step 6: Sending Responses</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark52"><span class="font23">Step 7: Logging</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark53"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark54"><span class="font6" style="font-weight:bold;">6. Proxies </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark55"><span class="font23">Web Intermediaries</span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark56"><span class="font23">Why Use Proxies?</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark57"><span class="font23">Where Do Proxies Go?</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark58"><span class="font23">Client Proxy Settings</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark59"><span class="font23">Tricky Things About Proxy Requests</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark60"><span class="font23">Tracing Messages</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark61"><span class="font23">Proxy Authentication</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark62"><span class="font23">Proxy Interoperation</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark63"><span class="font23">For More Information</span></a></p>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark64"><span class="font6" style="font-weight:bold;">7. Caching </span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark65"><span class="font23">Redundant Data Transfers</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark66"><span class="font23">Bandwidth Bottlenecks</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark67"><span class="font23">Flash Crowds</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark68"><span class="font23">Distance Delays</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark69"><span class="font23">Hits and Misses</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark70"><span class="font23">Cache Topologies</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark71"><span class="font23">Cache Processing Steps</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark72"><span class="font23">Keeping Copies Fresh</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark73"><span class="font23">Controlling Cachability</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark74"><span class="font23">Setting Cache Controls</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark75"><span class="font23">Detailed Algorithms</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark76"><span class="font23">Caches and Advertising</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark77"><span class="font23">For More Information</span></a></p>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark78"><span class="font6" style="font-weight:bold;">8. Integration Points: Gateways, Tunnels, and Relays </span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark79"><span class="font23">Gateways</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark80"><span class="font23">Protocol Gateways</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark81"><span class="font23">Resource Gateways</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark82"><span class="font23">Application Interfaces and Web Services</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark83"><span class="font23">Tunnels</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark84"><span class="font23">Relays</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark85"><span class="font23">For More Information</span></a></p>
<p style="text-align:justify;text-indent:10pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark86"><span class="font6" style="font-weight:bold;">9. Web Robots </span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark87"><span class="font23">Crawlers and Crawling</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark88"><span class="font23">Robotic HTTP</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark89"><span class="font23">Misbehaving Robots</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark90"><span class="font23">Excluding Robots</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark91"><span class="font23">Robot Etiquette</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark92"><span class="font23">Search Engines</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark93"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark94"><span class="font6" style="font-weight:bold;">10. HTTP-NG</span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark95"><span class="font23">HTTP’s Growing Pains</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark96"><span class="font23">HTTP-NG Activity</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark97"><span class="font23">Modularize and Enhance</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark98"><span class="font23">Distributed Objects</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark99"><span class="font23">Layer 1: Messaging</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark100"><span class="font23">Layer 2: Remote Invocation</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark101"><span class="font23">Layer 3: Web Application</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark102"><span class="font23">WebMUX</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark103"><span class="font23">Binary Wire Protocol</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark104"><span class="font23">Current Status</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 22pt 0pt;"><a href="#bookmark105"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark106"><span class="font8" style="font-weight:bold;">Part III.</span></a><a href="#bookmark107"><span class="font8" style="font-weight:bold;"> Identification, Authorization, and Security</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark108"><span class="font6" style="font-weight:bold;">11. Client Identification and Cookies </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark109"><span class="font23">The Personal Touch</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark110"><span class="font23">HTTP Headers</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark111"><span class="font23">Client IP Address</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark112"><span class="font23">User Login</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark113"><span class="font23">Fat URLs</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark114"><span class="font23">Cookies</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark115"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark116"><span class="font6" style="font-weight:bold;">12. Basic Authentication </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark117"><span class="font23">Authentication</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark118"><span class="font23">Basic Authentication</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark119"><span class="font23">The Security Flaws of Basic Authentication</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark120"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark121"><span class="font6" style="font-weight:bold;">13. Digest Authentication </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark122"><span class="font23">The Improvements of Digest Authentication</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark123"><span class="font23">Digest Calculations</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark124"><span class="font23">Quality of Protection Enhancements</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark125"><span class="font23">Practical Considerations</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark126"><span class="font23">Security Considerations</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark127"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark128"><span class="font6" style="font-weight:bold;">14. Secure HTTP </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark129"><span class="font23">Making HTTP Safe</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark130"><span class="font23">Digital Cryptography</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark131"><span class="font23">Symmetric-Key Cryptography</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark132"><span class="font23">Public-Key Cryptography</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark133"><span class="font23">Digital Signatures</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark134"><span class="font23">Digital Certificates</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark135"><span class="font23">HTTPS: The Details</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark136"><span class="font23">A Real HTTPS Client</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark137"><span class="font23">Tunneling Secure Traffic Through Proxies</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 22pt 0pt;"><a href="#bookmark138"><span class="font23">For More Information</span></a></p>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark139"><span class="font8" style="font-weight:bold;">Part IV.</span></a><a href="#bookmark140"><span class="font8" style="font-weight:bold;"> Entities, Encodings, and Internationalization</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark141"><span class="font6" style="font-weight:bold;">15. Entities and Encodings </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark142"><span class="font23">Messages Are Crates, Entities Are Cargo</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark143"><span class="font23">Content-Length: The Entity’s Size</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark144"><span class="font23">Entity Digests</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark145"><span class="font23">Media Type and Charset</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark146"><span class="font23">Content Encoding</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark147"><span class="font23">Transfer Encoding and Chunked Encoding</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark148"><span class="font23">Time-Varying Instances</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark149"><span class="font23">Validators and Freshness</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark150"><span class="font23">Range Requests</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark151"><span class="font23">Delta Encoding</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark152"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark153"><span class="font6" style="font-weight:bold;">16. Internationalization </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark154"><span class="font23">HTTP Support for International Content</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark155"><span class="font23">Character Sets and HTTP</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark156"><span class="font23">Multilingual Character Encoding Primer</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark157"><span class="font23">Language Tags and HTTP</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark158"><span class="font23">Internationalized URIs</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark159"><span class="font23">Other Considerations</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark160"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark161"><span class="font6" style="font-weight:bold;">17. Content Negotiation and Transcoding </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark162"><span class="font23">Content-Negotiation Techniques</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark163"><span class="font23">Client-Driven Negotiation</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark164"><span class="font23">Server-Driven Negotiation</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark165"><span class="font23">Transparent Negotiation</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark166"><span class="font23">Transcoding</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark167"><span class="font23">Next Steps</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 22pt 0pt;"><a href="#bookmark168"><span class="font23">For More Information</span></a></p>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark169"><span class="font8" style="font-weight:bold;">Part V.</span></a><a href="#bookmark170"><span class="font8" style="font-weight:bold;"> Content Publishing and Distribution</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark171"><span class="font6" style="font-weight:bold;">18. Web Hosting </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark172"><span class="font23">Hosting Services</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark173"><span class="font23">Virtual Hosting</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark174"><span class="font23">Making Web Sites Reliable</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark175"><span class="font23">Making Web Sites Fast</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark176"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark177"><span class="font6" style="font-weight:bold;">19. Publishing Systems </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark178"><span class="font23">FrontPage Server Extensions for Publishing Support</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark179"><span class="font23">WebDAV and Collaborative Authoring</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark180"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark181"><span class="font6" style="font-weight:bold;">20. Redirection and Load Balancing </span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark182"><span class="font23">Why Redirect?</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark183"><span class="font23">Where to Redirect</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark184"><span class="font23">Overview of Redirection Protocols</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark185"><span class="font23">General Redirection Methods</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark186"><span class="font23">Proxy Redirection Methods</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark187"><span class="font23">Cache Redirection Methods</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark188"><span class="font23">Internet Cache Protocol</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark189"><span class="font23">Cache Array Routing Protocol</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark190"><span class="font23">Hyper Text Caching Protocol</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 13pt 0pt;"><a href="#bookmark191"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark192"><span class="font6" style="font-weight:bold;">21. Logging and Usage Tracking </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark193"><span class="font23">What to Log?</span></a></p></li></ul>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark194"><span class="font23">Log Formats</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark195"><span class="font23">Hit Metering</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark196"><span class="font23">A Word on Privacy</span></a></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><a href="#bookmark197"><span class="font23">For More Information</span></a></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark198"><span class="font8" style="font-weight:bold;">Part VI. </span></a><a href="#bookmark199"><span class="font8" style="font-weight:bold;">Appendixes</span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark200"><span class="font6" style="font-weight:bold;">A. URI Schemes </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark201"><span class="font6" style="font-weight:bold;">B. HTTP Status Codes </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark202"><span class="font6" style="font-weight:bold;">C. HTTP Header Reference </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark203"><span class="font6" style="font-weight:bold;">D. MIME Types </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark204"><span class="font6" style="font-weight:bold;">E. Base-64 Encoding </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark205"><span class="font6" style="font-weight:bold;">F. Digest Authentication </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark206"><span class="font6" style="font-weight:bold;">G. Language Tags </span></a></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark207"><span class="font6" style="font-weight:bold;">H. MIME Charset Registry </span></a></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark208"><span class="font6" style="font-weight:bold;">Index </span></a></p>
<h1 style="text-align:right;padding:24pt 0pt 113pt 0pt;"><a name="bookmark2"></a><span class="font11" style="font-weight:bold;"><a name="bookmark209"></a>Preface</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark210"></a><span class="font24"><a name="bookmark211"></a>The Hypertext Transfer Protocol (HTTP) is the protocol programs use to communicate over the World Wide Web. There are many applications of HTTP, but HTTP is most famous for two-way conversation between web browsers and web servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP began as a simple protocol, so you might think there really isn’t that much to say about it. And yet here you stand, with a two-pound book in your hands. If you’re wondering how we could have written 650 pages on HTTP, take a look at the Table of Contents. This book isn’t just an HTTP header reference manual; it’s a veritable bible of web architecture.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In this book, we try to tease apart HTTP’s interrelated and often misunderstood rules, and we offer you a series of topic-based chapters that explain all the aspects of HTTP. Throughout the book, we are careful to explain the “why” of HTTP, not just the “how.” And to save you time chasing references, we explain many of the critical non-HTTP technologies that are required to make HTTP applications work. You can find the alphabetical header reference (which forms the basis of most conventional HTTP texts) in a conveniently organized appendix. We hope this conceptual design makes it easy for you to work with HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This book is written for anyone who wants to understand HTTP and the underlying architecture of the Web. Software and hardware engineers can use this book as a coherent reference for HTTP and related web technologies. Systems architects and network administrators can use this book to better understand how to design, deploy, and manage complicated web architectures. Performance engineers and analysts can benefit from the sections on caching and performance optimization. Marketing and consulting professionals will be able to use the conceptual orientation to better understand the landscape of web technologies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This book illustrates common misconceptions, advises on “tricks of the trade,” provides convenient reference material, and serves as a readable introduction to dry and confusing standards specifications. In a single book, we detail the essential and interrelated technologies that make the Web work.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark212"></a><span class="font24">This book is the result of a tremendous amount of work by many people who share an enthusiasm for Internet technologies. We hope you find it useful.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark213"></a><span class="font9" style="font-weight:bold;"><a name="bookmark214"></a>Running Example: Joe’s Hardware Store</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Many of our chapters include a running example of a hypothetical online hardware and home-improvement store called “Joe’s Hardware” to demonstrate technology concepts. We have set up a real web site for the store (</span><a href="http://www.joes-hardware"><span class="font24" style="font-style:italic;">http://www.joes-hardware</span></a><span class="font24" style="font-style:italic;">. com</span><span class="font24">) for you to test some of the examples in the book. We will maintain this web site while this book remains in print.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark215"></a><span class="font9" style="font-weight:bold;"><a name="bookmark216"></a>Chapter-by-Chapter Guide</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This book contains 21 chapters, divided into 5 logical parts (each with a technology theme), and 8 useful appendixes containing reference data and surveys of related technologies:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark217"><span class="font24">Part I,</span><span class="font24" style="font-style:italic;"> HTTP: The Web’s Foundation</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark218"><span class="font24">Part II,</span><span class="font24" style="font-style:italic;"> HTTP Architecture</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark219"><span class="font24">Part III,</span><span class="font24" style="font-style:italic;"> Identification, Authorization, and Security</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark220"><span class="font24">Part IV,</span><span class="font24" style="font-style:italic;"> Entities, Encodings, and Internationalization</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark221"><span class="font24">Part V,</span><span class="font24" style="font-style:italic;"> Content Publishing and Distribution</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark222"><span class="font24">Part VI,</span><span class="font24" style="font-style:italic;"> Appendixes</span></a></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark217"><span class="font24">Part I, </span><span class="font24" style="font-style:italic;">HTTP: The Web’s Foundation</span></a><span class="font24" style="font-weight:bold;">, </span><span class="font24">describes the core technology of HTTP, the foundation of the Web, in four chapters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark223"><span class="font24">Chapter 1, </span><span class="font24" style="font-style:italic;">Overview of HTTP</span></a><span class="font24">, is a rapid-paced overview of HTTP.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark224"><span class="font24">Chapter 2, </span><span class="font24" style="font-style:italic;">URLs and Resources</span></a><span class="font24">, details the formats of uniform resource locators (URLs) and the various types of resources that URLs name across the Internet. It also outlines the evolution to uniform resource names (URNs).</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark225"><span class="font24">Chapter 3, </span><span class="font24" style="font-style:italic;">HTTP Messages</span></a><span class="font24">, details how HTTP messages transport web content.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• </span><a href="#bookmark226"><span class="font24">Chapter 4, </span><span class="font24" style="font-style:italic;">Connection Management</span></a><span class="font24">, explains the commonly misunderstood and poorly documented rules and behavior for managing HTTP connections.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark218"><span class="font24">Part II, </span><span class="font24" style="font-style:italic;">HTTP Architecture</span></a><span class="font24">, highlights the HTTP server, proxy, cache, gateway, and robot applications that are the architectural building blocks of web systems. (Web browsers are another building block, of course, but browsers already were covered thoroughly in</span><a href="#bookmark227"><span class="font24"> Part I</span></a><span class="font24"> of the book.) </span><a href="#bookmark228"><span class="font24">Part II</span></a><span class="font24"> contains the following six chapters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark229"><span class="font24">Chapter 5, </span><span class="font24" style="font-style:italic;">Web Servers</span></a><span class="font24">, gives an overview of web server architectures.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark230"><span class="font24">Chapter 6, </span><span class="font24" style="font-style:italic;">Proxies</span></a><span class="font24">, explores HTTP proxy servers, which are intermediary servers that act as platforms for HTTP services and controls.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• </span><a href="#bookmark231"><span class="font24">Chapter 7, </span><span class="font24" style="font-style:italic;">Caching</span></a><span class="font24">, delves into the science of web caches—devices that improve performance and reduce traffic by making local copies of popular documents.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark232"><span class="font24">Chapter 8, </span><span class="font24" style="font-style:italic;">Integration Points: Gateways, Tunnels, and Relays</span></a><span class="font24">, explains gateways and application servers that allow HTTP to work with software that speaks different protocols, including Secure Sockets Layer (SSL) encrypted protocols.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark233"><span class="font24">Chapter 9, </span><span class="font24" style="font-style:italic;">Web Robots</span></a><span class="font24">, describes the various types of clients that pervade the Web, including the ubiquitous browsers, robots and spiders, and search engines.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• </span><a href="#bookmark234"><span class="font24">Chapter 10, </span><span class="font24" style="font-style:italic;">HTTP-NG</span></a><span class="font24">, talks about HTTP developments still in the works: the HTTP-NG protocol.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark219"><span class="font24">Part III, </span><span class="font24" style="font-style:italic;">Identification, Authorization, and Security</span></a><span class="font24">, presents a suite of techniques and technologies to track identity, enforce security, and control access to content. It contains the following four chapters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark235"><span class="font24">Chapter 11, </span><span class="font24" style="font-style:italic;">Client Identification and Cookies</span></a><span class="font24">, talks about techniques to identify users so that content can be personalized to the user audience.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark236"><span class="font24">Chapter 12, </span><span class="font24" style="font-style:italic;">Basic Authentication</span></a><span class="font24">, highlights the basic mechanisms to verify user identity. The chapter also examines how HTTP authentication interfaces with databases.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark237"><span class="font24">Chapter 13, </span><span class="font24" style="font-style:italic;">Digest Authentication</span></a><span class="font24">, explains digest authentication, a complex proposed enhancement to HTTP that provides significantly enhanced security.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• </span><a href="#bookmark238"><span class="font24">Chapter 14, </span><span class="font24" style="font-style:italic;">Secure HTTP</span></a><span class="font24">, is a detailed overview of Internet cryptography, digital certificates, and SSL.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark220"><span class="font24">Part IV, </span><span class="font24" style="font-style:italic;">Entities, Encodings, and Internationalization</span></a><span class="font24">, focuses on the bodies of HTTP messages (which contain the actual web content) and on the web standards that describe and manipulate content stored in the message bodies. Part IV contains three chapters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• </span><a href="#bookmark239"><span class="font24">Chapter 15, </span><span class="font24" style="font-style:italic;">Entities and Encodings</span></a><span class="font24">, describes the structure of HTTP content.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark240"><span class="font24">Chapter 16, </span><span class="font24" style="font-style:italic;">Internationalization</span></a><span class="font24">, surveys the web standards that allow users around the globe to exchange content in different languages and character sets.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• </span><a href="#bookmark241"><span class="font24">Chapter 17, </span><span class="font24" style="font-style:italic;">Content Negotiation and Transcoding</span></a><span class="font24">, explains mechanisms for negotiating acceptable content.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark221"><span class="font24">Part V, </span><span class="font24" style="font-style:italic;">Content Publishing and Distribution</span></a><span class="font24">, discusses the technology for publishing and disseminating web content. It contains four chapters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark242"><span class="font24">Chapter 18, </span><span class="font24" style="font-style:italic;">Web Hosting</span></a><span class="font24">, discusses the ways people deploy servers in modern web hosting environments and HTTP support for virtual web hosting.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark243"><span class="font24">Chapter 19, </span><span class="font24" style="font-style:italic;">Publishing Systems</span></a><span class="font24">, discusses the technologies for creating web content and installing it onto web servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark244"><span class="font24">Chapter 20, </span><span class="font24" style="font-style:italic;">Redirection and Load Balancing</span></a><span class="font24">, surveys the tools and techniques for distributing incoming web traffic among a collection of servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• </span><a href="#bookmark245"><span class="font24">Chapter 21, </span><span class="font24" style="font-style:italic;">Logging and Usage Tracking</span></a><span class="font24">, covers log formats and common questions.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark222"><span class="font24">Part VI, </span><span class="font24" style="font-style:italic;">Appendixes</span></a><span class="font24">, contains helpful reference appendixes and tutorials in related technologies:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark246"><span class="font24">Appendix A, </span><span class="font24" style="font-style:italic;">URI Schemes</span></a><span class="font24">, summarizes the protocols supported through uniform resource identifier (URI) schemes.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark247"><span class="font24">Appendix B, </span><span class="font24" style="font-style:italic;">HTTP Status Codes</span></a><span class="font24">, conveniently lists the HTTP response codes.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark248"><span class="font24">Appendix C, </span><span class="font24" style="font-style:italic;">HTTP Header Reference</span></a><span class="font24">, provides a reference list of HTTP header fields.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark249"><span class="font24">Appendix D, </span><span class="font24" style="font-style:italic;">MIME Types</span></a><span class="font24">, provides an extensive list of MIME types and explains how MIME types are registered.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark250"><span class="font24">Appendix E, </span><span class="font24" style="font-style:italic;">Base-64 Encoding</span></a><span class="font24">, explains base-64 encoding, used by HTTP authentication.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark251"><span class="font24">Appendix F, </span><span class="font24" style="font-style:italic;">Digest Authentication</span></a><span class="font24">, gives details on how to implement various authentication schemes in HTTP.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark252"><span class="font24">Appendix G, </span><span class="font24" style="font-style:italic;">Language Tags</span></a><span class="font24">, defines language tag values for HTTP language headers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark253"><span class="font24">Appendix H, </span><span class="font24" style="font-style:italic;">MIME Charset Registry</span></a><span class="font24">, provides a detailed list of character encodings, used for HTTP internationalization support.</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">Each chapter contains many examples and pointers to additional reference material.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark254"></a><span class="font9" style="font-weight:bold;"><a name="bookmark255"></a>Typographic Conventions</span></h2>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">In this book, we use the following typographic conventions:</span></p>
<p><span class="font24" style="font-style:italic;">Italic</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Used for URLs, C functions, command names, MIME types, new terms where they are defined, and emphasis</span></p>
<p><span class="font4">Constant width</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Used for computer output, code, and any literal text</span></p>
<p><span class="font4" style="font-weight:bold;">Constant width bold</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">Used for user input</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark256"></a><span class="font9" style="font-weight:bold;"><a name="bookmark257"></a>Comments and Questions</span></h2>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">Please address comments and questions concerning this book to the publisher:</span></p>
<p style="text-indent:19pt;"><span class="font24">O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p style="text-indent:19pt;"><span class="font24">1005 Gravenstein Highway North</span></p>
<p style="text-indent:19pt;"><span class="font24">Sebastopol, CA 95472</span></p>
<p style="text-indent:19pt;"><span class="font24">(800) 998-9938 (in the United States or Canada)</span></p>
<p style="text-indent:19pt;"><span class="font24">(707) 829-0515 (international/local)</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">(707) 829-0104 (fax)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There is a web page for this book, which lists errata, examples, or any additional information. You can access this page at:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.oreilly.com/catalog/httptdg/"><span class="font24" style="font-style:italic;">http://www.oreilly.com/catalog/httptdg/</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To comment or ask technical questions about this book, send email to:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="mailto:bookquestions@oreilly.com"><span class="font24" style="font-style:italic;">bookquestions@oreilly.com</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information about books, conferences, Resource Centers, and the O’Reilly Network, see the O’Reilly web site at:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><a href="http://www.oreilly.com"><span class="font24" style="font-style:italic;">http://www.oreilly.com</span></a></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark258"></a><span class="font9" style="font-weight:bold;"><a name="bookmark259"></a>Acknowledgments</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This book is the labor of many. The five authors would like to hold up a few people in thanks for their significant contributions to this project.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To start, we’d like to thank Linda Mui, our editor at O’Reilly. Linda first met with David and Brian way back in 1996, and she refined and steered several concepts into the book you hold today. Linda also helped keep our wandering gang of first-time book authors moving in a coherent direction and on a progressing (if not rapid) timeline. Most of all, Linda gave us the chance to create this book. We’re very grateful.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We’d also like to thank several tremendously bright, knowledgeable, and kind souls who devoted noteworthy energy to reviewing, commenting on, and correcting drafts of this book. These include Tony Bourke, Sean Burke, Mike Chowla, Shernaz Daver, Fred Douglis, Paula Ferguson, Vikas Jha, Yves Lafon, Peter Mattis, Chuck Neer-daels, Luis Tavera, Duane Wessels, Dave Wu, and Marco Zagha. Their viewpoints and suggestions have improved the book tremendously.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Rob Romano from O’Reilly created most of the amazing artwork you’ll find in this book. The book contains an unusually large number of detailed illustrations that make subtle concepts very clear. Many of these illustrations were painstakingly created and revised numerous times. If a picture is worth a thousand words, Rob added hundreds of pages of value to this book.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Brian would like to personally thank all of the authors for their dedication to this project. A tremendous amount of time was invested by the authors in a challenge to make the first detailed but accessible treatment of HTTP. Weddings, childbirths, killer work projects, startup companies, and graduate schools intervened, but the authors held together to bring this project to a successful completion. We believe the result is worthy of everyone’s hard work and, most importantly, that it provides a valuable service. Brian also would like to thank the employees of Inktomi for their enthusiasm and support and for their deep insights about the use of HTTP in real-world applications. Also, thanks to the fine folks at Cajun-shop.com for allowing us to use their site for some of the examples in this book.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">David would like to thank his family, particularly his mother and grandfather for their ongoing support. He’d like to thank those that have put up with his erratic schedule over the years writing the book. He’d also like to thank Slurp, Orctomi, and Norma for everything they’ve done, and his fellow authors for all their hard work. Finally, he would like to thank Brian for roping him into yet another adventure.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Marjorie would like to thank her husband, Alan Liu, for technical insight, familial support and understanding. Marjorie thanks her fellow authors for many insights and inspirations. She is grateful for the experience of working together on this book.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Sailu would like to thank David and Brian for the opportunity to work on this book, and Chuck Neerdaels for introducing him to HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Anshu would like to thank his wife, Rashi, and his parents for their patience, support, and encouragement during the long years spent writing this book.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Finally, the authors collectively thank the famous and nameless Internet pioneers, whose research, development, and evangelism over the past four decades contributed so much to our scientific, social, and economic community. Without these labors, there would be no subject for this book.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 3pt 0pt;"><a name="bookmark227"></a><span class="font9" style="font-weight:bold;"><a name="bookmark260"></a><a name="bookmark261"></a>PART I</span></h1>
<p style="text-align:right;padding:0pt 0pt 113pt 0pt;"><a name="bookmark3"></a><span class="font12" style="font-weight:bold;"><a name="bookmark4"></a><a name="bookmark217"></a>HTTP: The Web’s Foundation</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">This section is an introduction to the HTTP protocol. The next four chapters describe the core technology of HTTP, the foundation of the Web:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark223"><span class="font24">Chapter 1, </span><span class="font24" style="font-style:italic;">Overview of HTTP</span></a><span class="font24">, is a rapid-paced overview of HTTP.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark224"><span class="font24">Chapter 2, </span><span class="font24" style="font-style:italic;">URLs and Resources</span></a><span class="font24">, details the formats of URLs and the various types of resources that URLs name across the Internet. We also outline the evolution to URNs.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark225"><span class="font24">Chapter 3, </span><span class="font24" style="font-style:italic;">HTTP Messages</span></a><span class="font24">, details the HTTP messages that transport web content.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark226"><span class="font24">Chapter 4, </span><span class="font24" style="font-style:italic;">Connection Management</span></a><span class="font24">, discusses the commonly misunderstood and poorly documented rules and behavior for managing TCP connections by HTTP.</span></p></li></ul>
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 1</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark223"></a><span class="font11" style="font-weight:bold;"><a name="bookmark5"></a><a name="bookmark262"></a>Overview of HTTP</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark263"></a><span class="font24"><a name="bookmark264"></a><a name="bookmark265"></a>The world’s web browsers, servers, and related web applications all talk to each other through HTTP, the Hypertext Transfer Protocol. HTTP is the common language of the modern global Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">This chapter is a concise overview of HTTP. You’ll see how web applications use HTTP to communicate, and you’ll get a rough idea of how HTTP does its job. In particular, we talk about:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• How web clients and servers communicate</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Where resources (web content) come from</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• How web transactions work</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The format of the messages used for HTTP communication</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The underlying TCP network transport</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><a name="bookmark266"></a><span class="font24">• The different variations of the HTTP protocol</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 10pt 0pt;"><span class="font24">• Some of the many HTTP architectural components installed around the Internet We’ve got a lot of ground to cover, so let’s get started on our tour of HTTP.</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark267"></a><span class="font9" style="font-weight:bold;"><a name="bookmark6"></a><a name="bookmark268"></a>HTTP: The Internet’s Multimedia Courier</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Billions of JPEG images, HTML pages, text files, MPEG movies, WAV audio files, Java applets, and more cruise through the Internet each and every day. HTTP moves the bulk of this information quickly, conveniently, and reliably from web servers all around the world to web browsers on people’s desktops.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because HTTP uses reliable data-transmission protocols, it guarantees that your data will not be damaged or scrambled in transit, even when it comes from the other side of the globe. This is good for you as a user, because you can access information without worrying about its integrity. Reliable transmission is also good for you as an Internet application developer, because you don’t have to worry about HTTP communications <a name="bookmark269"></a>being destroyed, duplicated, or distorted in transit. You can focus on programming the distinguishing details of your application, without worrying about the flaws and foibles of the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Let’s look more closely at how HTTP transports the Web’s traffic.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark270"></a><span class="font9" style="font-weight:bold;"><a name="bookmark7"></a><a name="bookmark271"></a>Web Clients and Servers</span></h2>
<p style="text-align:justify;padding:0pt 0pt 36pt 0pt;"><span class="font24">Web content lives on web servers. Web servers speak the HTTP protocol, so they are often called HTTP servers. These HTTP servers store the Internet’s data and provide the data when it is requested by HTTP clients. The clients send HTTP requests to servers, and servers return the requested data in HTTP responses, as sketched in </span><a href="#bookmark272"><span class="font24">Figure 1-1</span></a><span class="font24">. Together, HTTP clients and HTTP servers make up the basic components of the World Wide Web.</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a href="http://www.oreilly.com"><span class="font1" style="font-style:italic;">www.oreilly.com</span></a></p></td></tr>
<tr><td><img src="book_files/book-2.jpg" alt="" style="width:37pt;height:51pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-3.jpg" alt="" style="width:44pt;height:39pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<p><span class="font1" style="font-weight:bold;">HTTP request</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font0">“Get me the document called </span><span class="font1" style="font-style:italic;">/index.html</span><span class="font0">.”</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">HTTP response</span></p>
<p style="padding:0pt 0pt 17pt 0pt;"><span class="font0">“Okay, here it is, it’s in HTML format and is 3,150 characters long.”</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark272"></a><span class="font23" style="font-style:italic;">Figure 1-1. Web clients and servers</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">You probably u<a name="bookmark273"></a>se HTTP clients every day. The most common client is a web browser, such as Microsoft Internet Explorer or Netscape Navigator. Web browsers request HTTP objects from servers and display the objects on your screen.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">When you browse to a page, such as “</span><a href="http://www.oreilly.com/index.html,%e2%80%9d"><span class="font24">http://www.oreilly.com/index.html,”</span></a><span class="font24"> your browser sends an HTTP request to the server </span><a href="http://www.oreilly.com"><span class="font24" style="font-style:italic;">www.oreilly.com</span></a><span class="font24"> (see </span><a href="#bookmark272"><span class="font24">Figure 1-1</span></a><span class="font24">). The server tries to find the desired object (in this case, “/index.html”) and, if successful, sends the object to the client in an HTTP response, along with the type of the object, the length of the object, and other information.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark274"></a><span class="font9" style="font-weight:bold;"><a name="bookmark8"></a><a name="bookmark275"></a>Resources</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web servers host </span><span class="font24" style="font-style:italic;">web resources</span><span class="font24">. A web resource is the source of web content. The simplest kind of web resource is a static file on the web server’s filesystem. These files can contain anything: they might be text files, HTML files, Microsoft Word files, Adobe Acrobat files, JPEG image files, AVI movie files, or any other format you can think of.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">However, resources don’t have to be static files. Resources can also be software programs that generate content on demand. These dynamic content resources can generate content based on your identity, on what information you’ve requested, or on</span></p>
<p><span class="font24">the time of day. They can show you a live image from a camera, or let you trade stocks, search real estate databases, or buy gifts from online stores (see</span><a href="#bookmark276"><span class="font24"> Figure 1-2</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Filesystem</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Resources</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-4.jpg" alt="" style="width:22pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Image file</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-5.jpg" alt="" style="width:39pt;height:23pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Text file</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-6.jpg" alt="" style="width:140pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-7.jpg" alt="" style="width:56pt;height:21pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Web cam gateway</span></p></td></tr>
</table>
</div><br clear="all">
<p><span class="font1" style="font-style:italic;">Stock trading gateway</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Real estate search gateway</span></p></td></tr>
<tr><td><img src="book_files/book-8.jpg" alt="" style="width:68pt;height:21pt;"></td><td>
<p style="text-align:right;"><span class="font0">11000101101</span></p></td></tr>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">E-commerce gateway</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark276"></a><span class="font23" style="font-style:italic;"><a name="bookmark277"></a>Figure 1-2. A web resource is anything that provides web content</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">In summary, a resource is any kind of content source. A file containing your company’s sales forecast spreadsheet is a resource. A web gateway to scan your local public library’s shelves is a resource. An Internet search engine is a resource.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark278"></a><span class="font7" style="font-weight:bold;"><a name="bookmark279"></a>Media Types</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because the Internet hosts many thousands of different data types, HTTP carefully tags each object being transported through the Web with a data format label called a </span><span class="font24" style="font-style:italic;">MIME type</span><span class="font24">. MIME (Multipurpose Internet Mail Extensions) was originally designed to solve problems encountered in moving messages between different electronic mail systems. MIME worked so well for email that HTTP adopted it to describe and label its own multimedia content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Web servers attach a MIME type to all HTTP object data (see </span><a href="#bookmark280"><span class="font24">Figure 1-3</span></a><span class="font24">). When a web browser gets an object back from a server, it looks at the associated MIME type to see if it knows how to handle the object. Most browsers can handle hundreds of popular object types: displaying image files, parsing and formatting HTML files, playing audio files through the computer’s speakers, or launching external plug-in software to handle special formats.</span></p>
<table>
<tr><td><img src="book_files/book-9.jpg" alt="" style="width:363pt;height:106pt;"></td></tr>
<tr><td>
<p><a name="bookmark280"></a><span class="font23" style="font-style:italic;">Figure 1-3. MIME types are sent back with the data content</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">A MIME type is a textual label, represented as a primary object type and a specific subtype, separated by a slash. For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• An HTML-formatted text document would be labeled with type </span><span class="font4">text/html</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><a name="bookmark281"></a><span class="font24">• A plain ASCII text document would be labeled with type </span><span class="font4">text/plain</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A JPEG version of an image would be </span><span class="font4">image/jpeg</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A GIF-format image would be </span><span class="font4">image/gif</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• An Apple QuickTime movie would be </span><span class="font4">video/quicktime</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A Microsoft PowerPoint presentation would be </span><span class="font4">application/vnd.ms-powerpoint</span><span class="font24">.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There are hundreds of popular MIME types, and many more experimental or limiteduse types. A very thorough MIME type list is provided in </span><a href="#bookmark249"><span class="font24">Appendix D</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark282"></a><span class="font7" style="font-weight:bold;"><a name="bookmark283"></a>URIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark284"></a><span class="font24">Each web server resource has a name, so clients can point out what resources they are interested in. The server resource name is called a </span><span class="font24" style="font-style:italic;">uniform resource identifier</span><span class="font24">, or URI. URIs are like the postal addresses of the Internet, uniquely identifying and locating information resources around the world.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Here’s a URI for an image resource on Joe’s Hardware store’s web server:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 6pt 0pt;"><a href="http://www.joes-hardware.com/specials/saw-blade.gif"><span class="font3">http://www.joes-hardware.com/specials/saw-blade.gif</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a href="#bookmark285"><span class="font24">Figure 1-4</span></a><span class="font24"> shows how the URI specifies the HTTP protocol to access the saw-blade GIF resource on Joe’s store’s server. Given the URI, HTTP can retrieve the object. URIs come in two flavors, called URLs and URNs. Let’s take a peek at each of these types of resource identifiers now.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark286"></a><span class="font7" style="font-weight:bold;"><a name="bookmark287"></a>URLs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The </span><span class="font24" style="font-style:italic;">uniform resource locator</span><span class="font24"> (URL) is the most common form of resource identifier. URLs describe the specific location of a resource on a particular server. They tell you exactly how to fetch a resource from a precise, fixed location. </span><a href="#bookmark285"><span class="font24">Figure 1-4</span></a><span class="font24"> shows how a URL tells precisely where a resource is located and how to access it. </span><a href="#bookmark288"><span class="font24">Table 1-1</span></a><span class="font24"> shows a few examples of URLs.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font3">Content-type: image/gif Content-length: 8572</span></p>
<p style="text-indent:20pt;"><span class="font1" style="font-weight:bold;">12 &nbsp;&nbsp;&nbsp;3</span></p>
<p><span class="font1" style="font-style:italic;">Use HTTP protocol &nbsp;&nbsp;&nbsp;Go to </span><a href="http://www.joes-hardware.com"><span class="font1" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font1" style="font-style:italic;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grab the resource called /specials/saw-blade.gif</span></p>
<p style="text-align:center;"><a href="http://www.joes-hardware.com/specials/saw-blade.gif"><span class="font5">http://www.joes-hardware.com/specials/saw-blade.gif</span></a></p></td></tr>
<tr><td><img src="book_files/book-10.jpg" alt="" style="width:318pt;height:89pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
<p><a name="bookmark285"></a><span class="font23" style="font-style:italic;"><a name="bookmark289"></a>Figure 1-4. URLs specify protocol, server, and local resource</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 9pt 0pt;"><a name="bookmark288"></a><span class="font23" style="font-style:italic;">Table 1-1. Example URLs</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">URL &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><a href="http://www.oreilly.com/index.html"><span class="font3" style="font-style:italic;">http://www.oreilly.com/index.html</span></a><span class="font2"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The home URL for O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><a href="http://www.yahoo.com/images/logo.gif"><span class="font3" style="font-style:italic;">http://www.yahoo.com/images/logo.gif</span></a></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The URL for the Yahoo! web site’s logo</span></p>
<p><span class="font2">The URL for a program that checks if inventory item</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">#12731 is in stock</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The URL for the </span><span class="font3" style="font-style:italic;">locking-pliers.gif</span><span class="font2"> image file, using password-protected FTP as the access protocol</span></p>
</div>
<p style="padding:0pt 0pt 4pt 7pt;"><a href="http://www.joes-hardware.com/inventory-check"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com/inventory-check</span></a><span class="font3" style="font-style:italic;">. cgi?item=12731</span></p>
<p style="padding:0pt 0pt 12pt 7pt;"><span class="font3" style="font-style:italic;">ftp://joe:tools4u@ftp.joes-hardware.com/locking-pliers.gif</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Most URLs follow a standardized format of three main parts:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The first part of the URL is called the </span><span class="font24" style="font-style:italic;">scheme</span><span class="font24">, and it describes the protocol used to access the resource. This is usually the HTTP protocol (</span><span class="font24" style="font-style:italic;">http://</span><span class="font24">).</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The second part gives the server Internet address (e.g., </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">).</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The rest names a resource on the web server (e.g., </span><span class="font24" style="font-style:italic;">/specials/saw-blade.gif</span><span class="font24">).</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Today, almost every URI is a URL.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark290"></a><span class="font7" style="font-weight:bold;"><a name="bookmark291"></a>URNs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The second flavor of URI is the </span><span class="font24" style="font-style:italic;">uniform resource name</span><span class="font24">, or URN. A URN serves as a unique name for a particular piece of content, independent of where the resource currently resides. These location-independent URNs allow resources to move from place to place. URNs also allow resources to be accessed by multiple network access protocols while maintaining the same name.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For example, the following URN might be used to name the Internet standards document “RFC 2141” regardless of where it resides (it may even be copied in several places):</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">urn:ietf:rfc:2141</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark292"></a><span class="font24">URNs are still<a name="bookmark293"></a> experimental and not yet widely adopted. To work effectively, URNs need a supporting infrastructure to resolve resource locations; the lack of such an infrastructure has also slowed their adoption. But URNs do hold some exciting promise for the future. We’ll discuss URNs in a bit more detail in </span><a href="#bookmark224"><span class="font24">Chapter 2</span></a><span class="font24">, but most of the remainder of this book focuses almost exclusively on URLs.</span></p>
<p style="text-align:justify;"><span class="font24">Unless stated otherwise, we adopt the conventional terminology and use URI and URL interchangeably for the remainder of this book.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h2><a name="bookmark294"></a><span class="font9" style="font-weight:bold;"><a name="bookmark9"></a><a name="bookmark295"></a>Transactions</span></h2>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font24">Let’s look in more detail how clients use HTTP to transact with web servers and their resources. An HTTP transaction consists of a request command (sent from client to server), and a response result (sent from the server back to the client). This communication happens with formatted blocks of data called </span><span class="font24" style="font-style:italic;">HTTP messages</span><span class="font24">, as illustrated in </span><a href="#bookmark296"><span class="font24">Figure 1-5</span></a><span class="font24">.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><a name="bookmark297"></a><span class="font1" style="font-style:italic;">HTTP request message contains the command and the URI</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-11.jpg" alt="" style="width:42pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font3">GET /specials/saw-blade.gif HTTP/1.0 Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-12.jpg" alt="" style="width:19pt;height:34pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.0 200 OK Content-type: image/gif Content-length: 8572</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-13.jpg" alt="" style="width:139pt;height:73pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP response message contains the result of the transaction</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-14.jpg" alt="" style="width:48pt;height:48pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark296"></a><span class="font23" style="font-style:italic;">Figure 1-5. HTTP transactions consist of request and response messages</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark298"></a><span class="font7" style="font-weight:bold;"><a name="bookmark299"></a>Methods</span></h3>
<p><span class="font24">HTTP supports several different request commands, called </span><span class="font24" style="font-style:italic;">HTTP methods</span><span class="font24">. Every HTTP request message has a method. The method tells the server what action to perform (fetch a web page, run a gateway program, delete a file, etc.). </span><a href="#bookmark300"><span class="font24">Table 1-2</span></a><span class="font24"> lists five common HTTP methods.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark300"></a><span class="font23" style="font-style:italic;">Table 1-2. Some common HTTP methods</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">HTTP method</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">Description</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font2">Send named resource from the server to the client.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">PUT</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">Store data from client into a named server resource.</span></p>
</div><br clear="all">
<table>
<tr><td>
<p><a name="bookmark301"></a><span class="font23" style="font-style:italic;">Table 1-2. Some common HTTP methods (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">HTTP method</span></p></td><td style="vertical-align:top;">
<p style="text-indent:32pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">DELETE</span></p></td><td style="vertical-align:top;">
<p style="text-indent:32pt;"><span class="font2">Delete the named resource from a server.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">POST</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:32pt;"><span class="font2">Send client data into a server gateway application.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">HEAD</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:32pt;"><span class="font2">Send just the HTTP headers from the response for the named resource.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font24">We’ll discuss HTTP methods in detail in</span><a href="#bookmark225"><span class="font24"> Chapter 3</span></a><span class="font24">.</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark302"></a><span class="font7" style="font-weight:bold;"><a name="bookmark303"></a>Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark304"></a><span class="font24">Every HTTP response message comes back with a status code. The status code is a three-digit numeric code that tells the client if the request succeeded, or if other actions are required. A few common status codes are shown in</span><a href="#bookmark305"><span class="font24"> Table 1-3</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark305"></a><span class="font23" style="font-style:italic;">Table 1-3. Some common HTTP status codes</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">HTTP status code &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">200 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OK. Document returned correctly.</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">302 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Redirect. Go someplace else to get the resource.</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 10pt 0pt;"><span class="font2">404 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not Found. Can’t find this resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP also sends an explanatory textual “reason phrase” with each numeric status code (see the response message in</span><a href="#bookmark296"><span class="font24"> Figure 1-5</span></a><span class="font24">). The textual phrase is included only for descriptive purposes; the numeric code is used for all processing.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The followi<a name="bookmark306"></a>ng status codes and reason phrases are treated identically by HTTP software:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">200 OK</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">200 Document attached</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">200 Success</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">200 All’s cool, dude</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font24">HTTP status codes are explained in detail in</span><a href="#bookmark307"><span class="font24"> Chapter 3</span></a><span class="font24">.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark308"></a><span class="font7" style="font-weight:bold;"><a name="bookmark309"></a>Web Pages Can Consist of Multiple Objects</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">An application often issues multiple HTTP transactions to accomplish a task. For example, a web browser issues a cascade of HTTP transactions to fetch and display a graphics-rich web page. The browser performs one transaction to fetch the HTML “skeleton” that describes the page layout, then issues additional HTTP transactions for each embedded image, graphics pane, Java applet, etc. These embedded resources might even reside on different servers, as shown in</span><a href="#bookmark310"><span class="font24"> Figure 1-6</span></a><span class="font24">. Thus, a “web page” often is a collection of resources, not a single resource.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:37pt;padding:0pt 0pt 5pt 0pt;"><span class="font1" style="font-weight:bold;">Internet</span></p>
<p style="text-align:right;padding:0pt 0pt 36pt 0pt;"><span class="font1" style="font-weight:bold;">Server 1</span></p>
<p style="padding:0pt 0pt 0pt 107pt;"><span class="font1" style="font-weight:bold;">Server 2</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark311"></a><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-15.jpg" alt="" style="width:72pt;height:49pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-16.jpg" alt="" style="width:90pt;height:43pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark310"></a><span class="font23" style="font-style:italic;"><a name="bookmark312"></a>Figure 1-6. Composite web pages require separate HTTP transactions for each embedded resource</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark313"></a><span class="font9" style="font-weight:bold;"><a name="bookmark10"></a><a name="bookmark314"></a>Messages</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Now let’s take a quick look at the structure of HTTP request and response messages. We’ll study HTTP messages in exquisite detail in</span><a href="#bookmark225"><span class="font24"> Chapter 3</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a name="bookmark315"></a><span class="font24"><a name="bookmark316"></a>HTTP messages are simple, line-oriented sequences of characters. Because they are plain text, not binary, they are easy for humans to read and write.<a name="footnote1"></a><sup><a href="#bookmark317">1</a></sup><sup> <a name="footnote2"></a><a href="#bookmark318">2</a></sup>&nbsp;</span><a href="#bookmark319"><span class="font24">Figure 1-7 </span></a><span class="font24">shows the HTTP messages for a simple transaction.</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Response message</span></p>
</div>
<table>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Request message</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p><span class="font3">GET /test/hi-there.txt HTTP/1.0</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2" style="font-weight:bold;font-style:italic;">Start line</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font3">Accept: text/<sup><a href="#bookmark318">2</a></sup> Accept-Language: en,fr</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;padding:7pt 0pt 0pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">Headers</span></p></td></tr>
</table></td><td>
<p><span class="font3">HTTP/1.0 200 OK</span></p>
<p><span class="font3">Content-type: text/plain Content-length: 19</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 9pt 201pt;"><span class="font3">Hi! I’m a message!</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP messages consist of three parts:</span></p>
<p><span class="font24" style="font-style:italic;">Start line</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The first line of the message is the start line, indicating what to do for a request or what happened for a response.</span></p>
<p><a name="bookmark320"></a><span class="font24" style="font-style:italic;">Header fields</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Zero or more header fields follow the start line. Each header field consists of a name and a value, separated by a colon (:) for easy parsing. The headers end with a blank line. Adding a header field is as easy as adding another line.</span></p>
<p><span class="font24" style="font-style:italic;">Body</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">After the blank line is an optional message body containing any kind of data. Request bodies carry data to the web server; response bodies carry data back to the client. Unlike the start lines and headers, which are textual and structured, the body can contain arbitrary binary data (e.g., images, videos, audio tracks, software applications). Of course, the body can also contain text.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark321"></a><span class="font7" style="font-weight:bold;"><a name="bookmark322"></a>Simple Message Example</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a href="#bookmark323"><span class="font24">Figure 1-8</span></a><a name="bookmark324"></a><span class="font24"> shows the HTTP messages that might be sent as part of a simple transaction. The browser requests the resource </span><a href="http://www.joes-hardware.com/tools.html"><span class="font4">http://www.joes-hardware.com/tools.html</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In</span><a href="#bookmark323"><span class="font24"> Figure 1-8</span></a><span class="font24">, the browser sends an HTTP request message. The request has a GET method in the start line, and the local resource is </span><span class="font24" style="font-style:italic;">/tools.html</span><span class="font24">. The request indicates it is speaking Version 1.0 of the HTTP protocol. The request message has no body, because no request data is needed to GET a simple document from a server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark325"></a><span class="font24">The server sends back an HTTP response message. The response contains the HTTP version number (HTTP/1.0), a success status code (200), a descriptive reason phrase (OK), and a block of response header fields, all followed by the response body containing the requested document. The response body length is noted in the ContentLength header, and the document’s MIME type is noted in the Content-Type header.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark326"></a><span class="font9" style="font-weight:bold;"><a name="bookmark11"></a><a name="bookmark327"></a>Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Now that we’ve sketched what HTTP’s messages look like, let’s talk for a moment about how messages move from place to place, across Transmission Control Protocol (TCP) connections.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark328"></a><span class="font7" style="font-weight:bold;"><a name="bookmark329"></a>TCP/IP</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP is an application layer protocol. HTTP doesn’t worry about the nitty-gritty details of network communication; instead, it leaves the details of networking to TCP/IP, the popular reliable Internet transport protocol.</span></p>
<p style="padding:0pt 0pt 0pt 100pt;"><span class="font1" style="font-weight:bold;">(a) Request message</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Request start line (command)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET /tools.html HTTP/1.0</span></p>
<p style="text-align:justify;"><span class="font2">User-agent: Mozilla/4.75 [en] (Win98; U)</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: text/html, image/gif, image/jpeg</span></p>
<p><span class="font2">Accept-language: en</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Request headers</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-17.jpg" alt="" style="width:33pt;height:46pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">No request body</span></p>
</div><br clear="all">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) Response message</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td rowspan="2" style="vertical-align:middle;">
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font1" style="font-style:italic;">Response start line (status)</span></p>
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Response headers</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HTTP/1.0 200 OK</span></p></td></tr>
<tr><td rowspan="2" style="vertical-align:top;">
<p><span class="font2">Date: Sun, o1 Oct 2000 23:25:17 GMT</span></p>
<p><span class="font2">Server: Apache/1.3.11 BSafe-SSL/1.38 (Unix)</span></p>
<p><span class="font2">Last-modified: Tue, 04 Jul 2000 09:46:21 GMT</span></p>
<p><span class="font2">Content-length: 403</span></p>
<p><span class="font2">Content-type: text/html</span></p></td></tr>
<tr><td rowspan="2" style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font1" style="font-style:italic;">Response body</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;HTML&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;HEAD&gt;&lt;TITLE&gt;Joe’s Tools&lt;/TITLE&gt;&lt;/HEAD&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;BODY&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;H1&gt;Tools Page&lt;/H1&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;H2&gt;Hammers&lt;/H2&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;P&gt;Joe’s Hardware Online has the largest selection of hammers on the earth.&lt;/P&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;H2&gt;&lt;A NAME=drills&gt;&lt;/A&gt;Drills&lt;/H2&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;P&gt;Joe’s Hardware has a complete line of cordless and corded drills, as well as the latest in plutonium-powered atomic drills, for those big around the house jobs./&lt;P&gt;...</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;/BODY&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">&lt;/HTML&gt;</span></p></td></tr>
</table></td></tr>
</table>
<div style="float:right;writing-mode:horizontal-tb;">
<p style="text-align:right;"><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
</div>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark323"></a><span class="font23" style="font-style:italic;">Figure 1-8. Example GET transaction for </span><a href="http://www.joes-hardware.com/tools.html"><span class="font23" style="font-style:italic;">http://www.joes-hardware.com/tools.html</span></a></p>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark330"></a><span class="font24">TCP provides:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Error-free data transportation</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• In-order delivery (data will always arrive in the order in which it was sent)</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Unsegmented data stream (can dribble out data in any size at any time)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The Internet itself is based on TCP/IP, a popular layered set of packet-switched network protocols spoken by computers and network devices around the world. TCP/IP hides the peculiarities and foibles of individual networks and hardware, letting computers and networks of any type talk together reliably.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Once a TCP connection is established, messages exchanged between the client and server computers will never be lost, damaged, or received out of order.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In networking terms, the HTTP protocol is </span><span class="font24" style="font-style:italic;">layered</span><span class="font24"> over TCP. HTTP uses TCP to transport its message data. Likewise, TCP is layered over IP (see </span><a href="#bookmark331"><span class="font24">Figure 1-9</span></a><span class="font24">).</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">HTTP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Network-specific link interface</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Physical network hardware</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Physical layer</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark331"></a><span class="font23" style="font-style:italic;"><a name="bookmark332"></a><a name="bookmark333"></a>Figure 1-9. HTTP network protocol stack</span></p></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark334"></a><span class="font7" style="font-weight:bold;"><a name="bookmark335"></a>Connections, IP Addresses, and Port Numbers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark336"></a><span class="font24">Before an HTTP client can send a message to a server, it needs to establish a TCP/IP connection between the client and server using Internet protocol (IP) addresses and port numbers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Setting up a TCP connection is sort of like calling someone at a corporate office. First, you dial the company’s phone number. This gets you to the right organization. Then, you dial the specific extension of the person you’re trying to reach.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark337"></a><span class="font24">In TCP, you need the IP address of the server computer and the TCP port number associated with the specific software program running on the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark338"></a><span class="font24">This is all well and good, but how do you get the IP address and port number of the HTTP server in the first place? Why, the URL, of course! We mentioned before that URLs are the addresses for resources, so naturally enough they can provide us with the IP address for the machine that has the r<a name="bookmark339"></a>esource. Let’s take a look at a few URLs:</span></p>
<p style="text-align:justify;text-indent:19pt;"><a href="http://207.200.83.29:80/index.html"><span class="font3">http://207.200.83.29:80/index.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><a href="http://www.netscape.com:80/index.html"><span class="font3">http://www.netscape.com:80/index.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.netscape.com/index.html"><span class="font3">http://www.netscape.com/index.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark340"></a><span class="font24"><a name="bookmark341"></a>The first URL has the machine’s IP address, “207.200.83.29”, and port number, “80”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The second URL doesn’t have a numeric IP address; it has a textual domain name, or </span><span class="font24" style="font-style:italic;">hostname</span><span class="font24"> (“www.netscape.com”). The hostname is just a human-friendly alias for an IP address. Hostnames can easily be converted into IP addresses through a facility called the Domain Name Service (DNS), so we’re all set here, too. We will talk much more about DNS and URLs in</span><a href="#bookmark224"><span class="font24"> Chapter 2</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The final URL has no port number. When the port number is missing from an HTTP URL, you can assume the default value of port 80.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With the IP address and port number, a client can easily communicate via TCP/IP. </span><a href="#bookmark342"><span class="font24">Figure 1-10</span></a><span class="font24"> shows how a browser uses HTTP to display a simple HTML resource that resides on a distant server.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are the steps:</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(a)</span><span class="font24"> The browser extracts the server’s hostname from the URL.</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(b)</span><span class="font24"> The browser converts the server’s hostname into the server’s IP address.</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(c)</span><span class="font24"> The browser extracts the port number (if any) from the URL.</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(d)</span><span class="font24"> The browser establishes a TCP connection with the web server.</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(e)</span><span class="font24"> The browser sends an HTTP request message to the server.</span></p></li>
<li>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">(f)</span><span class="font24"> The server sends an HTTP response back to the browser.</span></p></li>
<li>
<p><span class="font24" style="font-style:italic;">(g)</span><span class="font24"> The connection is closed, and the browser displays the document.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-18.jpg" alt="" style="width:112pt;height:113pt;"></td><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Get the port number (80)</span></p>
<p><span class="font3">:80/tools.html</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(d)</span><span class="font0"> Connect to 161.58.228.45 port 80</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-19.jpg" alt="" style="width:36pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-20.jpg" alt="" style="width:42pt;height:29pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(e)</span><span class="font0"> Send an HTTP GET request</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td><td><img src="book_files/book-21.jpg" alt="" style="width:38pt;height:38pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-22.jpg" alt="" style="width:32pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(f)</span><span class="font0"> Read HTTP response from server</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td><td><img src="book_files/book-23.jpg" alt="" style="width:43pt;height:40pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-24.jpg" alt="" style="width:46pt;height:32pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-25.jpg" alt="" style="width:131pt;height:99pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Browser showing page</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(g) </span><span class="font0">Close the connection</span></p></td></tr>
<tr><td><img src="book_files/book-26.jpg" alt="" style="width:116pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all"></li></ul>
<p><a name="bookmark342"></a><span class="font23" style="font-style:italic;">Figure 1-10. Basic browser connection process</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark343"></a><span class="font7" style="font-weight:bold;"><a name="bookmark344"></a><a name="bookmark345"></a>A Real Example Using Telnet</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because HTTP uses TCP/IP, and is text-based, as opposed to using some obscure binary format, it is simple to talk directly to a web server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Telnet utility connects your keyboard to a destination TCP port and connects the TCP port output back to your display screen. Telnet is commonly used for remote terminal sessions, but it can generally connect to any TCP server, including HTTP servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You can use the Telnet utility to talk directly to web servers. Telnet lets you open a TCP connection to a port on a machine and type characters directly into the port. The web server treats you as a web client, and any data sent back on the TCP connection is displayed onscreen.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s use Telnet to interact with a real web server. We will use Telnet to fetch the document pointed to by the URL </span><a href="http://www.joes-hardware.com:80/tools.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com:80/tools.html</span></a><span class="font24"> (you can try this example yourself).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s review what should happen:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• First, we need to look up the IP address of </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> and open a TCP connection to port 80 on that machine. Telnet does this legwork for us.</span></p></li>
<li>
<p style="text-indent:8pt;"><span class="font24">• Once the TCP connection is open, we need to type in the HTTP request.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• When the request is complete (indicated by a blank line), the server should send back the content in an HTTP response and close the connection.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Our example HTTP request for </span><a href="http://www.joes-hardware.com:80/tools.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com:80/tools.html</span></a><span class="font24"> is shown in </span><a href="#bookmark346"><span class="font24">Example 1-1</span></a><span class="font24">. What we typed is shown in boldface.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark346"></a><span class="font23" style="font-style:italic;">Example 1-1. An HTTP transaction using telnet</span></p>
<p style="text-align:justify;"><span class="font3">% </span><span class="font3" style="font-weight:bold;">telnet </span><a href="http://www.joes-hardware.com"><span class="font3" style="font-weight:bold;">www.joes-hardware.com</span></a><span class="font3" style="font-weight:bold;"> 80</span></p>
<p style="text-align:justify;"><span class="font3">Trying 161.58.228.45...</span></p>
<p style="text-align:justify;"><span class="font3">Connected to joes-hardware.com.</span></p>
<p style="text-align:justify;"><span class="font3">Escape character is '^]'.</span></p>
<p style="text-align:justify;"><span class="font3" style="font-weight:bold;">GET /tools.html HTTP/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font3" style="font-weight:bold;">Host: </span><a href="http://www.joes-hardware.com"><span class="font3" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;"><span class="font3">Date: Sun, 01 Oct 2000 23:25:17 GMT</span></p>
<p style="text-align:justify;"><span class="font3">Server: Apache/1.3.11 BSafe-SSL/1.38 (Unix) FrontPage/4.0.4.3</span></p>
<p><span class="font3">Last-Modified: Tue, 04 Jul 2000 09:46:21 GMT</span></p>
<p><span class="font3">ETag: &quot;373979-193-3961b26d&quot;</span></p>
<p><span class="font3">Accept-Ranges: bytes</span></p>
<p><span class="font3">Content-Length: 403</span></p>
<p><span class="font3">Connection: close</span></p>
<p><span class="font3">Content-Type: text/html</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font23" style="font-style:italic;">Example 1-1. An HTTP transaction using telnet (continued)</span></p>
<p style="text-align:justify;"><span class="font3">&lt;HTML&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;HEAD&gt;&lt;TITLE&gt;Joe's Tools&lt;/TITLE&gt;&lt;/HEAD&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;BODY&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;H1&gt;Tools Page&lt;/H1&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;H2&gt;Hammers&lt;/H2&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;P&gt;Joe's Hardware Online has the largest selection of hammers on the earth.&lt;/P&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;H2&gt;&lt;A NAME=drills&gt;&lt;/A&gt;Drills&lt;/H2&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;P&gt;Joe's Hardware has a complete line of cordless and corded drills, as well as the latest in plutonium-powered atomic drills, for those big around the house jobs.&lt;/P&gt; ...</span></p>
<p style="text-align:justify;"><span class="font3">&lt;/BODY&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;/HTML&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font3">Connection closed by foreign host.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Telnet looks up the hostname and opens a connection to the </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24" style="font-style:italic;"> </span><span class="font24">web server, which is liste<a name="bookmark347"></a>ning on port 80. The three lines after the command are output from Telnet, telling us it has established a connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">We then type in our basic request command, “GET /tools.html HTTP/1.1”, and send a Host header providing the original hostname, followed by a blank line, asking the server to GET us the resource “/tools.html” from the server </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">. After that, the server responds with a response line, several response headers, a blank line, and finally the body of the HTML document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Beware that Telnet mimics HTTP clients well but doesn’t work well as a server. And automated Telnet scripting is no fun at all. <a name="bookmark348"></a>For a more flexible tool, you might want to check out </span><span class="font4">nc </span><span class="font24">(netcat). The </span><span class="font4">nc </span><span class="font24">tool lets you easily manipulate and script UDP- and TCP-based traffic, including HTTP. See </span><a href="http://netcat"><span class="font24" style="font-style:italic;">http://netcat</span></a><span class="font24" style="font-style:italic;">. sourceforge.net</span><span class="font24"> for details.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark349"></a><span class="font9" style="font-weight:bold;"><a name="bookmark12"></a><a name="bookmark350"></a>Protocol Versions</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">There are several versions of the HTTP protocol in use today. <a name="bookmark351"></a>HTTP applications need to work hard to robustly handle different variations of the HTTP protocol. The versions in use are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP/0.9</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The 1991 prototype version of HTTP is known as HTTP/0.9. This protocol contains many serious design flaws and should be used only to interoperate with legacy clients. HTTP/0.9 supports only the GET method, and it does not support MIME typing of multimedia content, HTTP headers, or version numbers. HTTP/0.9 was originally defined to fetch simple HTML objects. It was soon replaced with HTTP/1.0.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP/1.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">1.0 was the first version of HTTP that was widely deployed. HTTP/1.0 added version numbers, HTTP headers, additional methods, and multimedia object handling. HTTP/1.0 made it practical to support graphically appealing web <a name="bookmark352"></a><a name="bookmark353"></a>pages and interactive forms, which helped promote the wide-scale adoption of the World Wide Web. This specification was never well specified. It represented a collection of best practices in a time of rapid commercial and academic evolution of the protocol.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP/1.0+</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark354"></a><span class="font24">Many popular web clients and servers rapidly added features to HTTP in the mid-1990s to meet the demands of a rapidly expanding, commercially successful World Wide Web. Many of these features, including long-lasting “keepalive” connections, virtual hosting support, and proxy connection support, were added to HTTP and became unofficial, de facto standards. This informal, extended version of HTTP is often referred to as HTTP/1.0+.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark355"></a><span class="font24">HTTP/1.1 focused on correcting architectural flaws in the design of HTTP, specifying semantics, introducing significant performance optimizations, and removing mis-features. HTTP/1.1 also included support for the more sophisticated web applications and deployments that were under way in the late 1990s. HTTP/1.1 is the current version of HTTP.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP-NG (a.k.a. HTTP/2.0)</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">HTTP-NG is a prototype proposal for an architectural successor to HTTP/1.1 that focuses on significant performance optimizations and a more powerful framework for remote execution of server logic. The HTTP-NG research effort concluded in 1998, and at the time of this writing, there are no plans to advance this proposal as a replacement for HTTP/1.1. See</span><a href="#bookmark234"><span class="font24"> Chapter 10 </span></a><span class="font24">for more information.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark356"></a><span class="font9" style="font-weight:bold;"><a name="bookmark13"></a><a name="bookmark357"></a>Architectural Components of the Web</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">In this overview chapter, we’ve focused on how two web applications (web browsers and web servers) send messages back and forth to implement basic transactions. There are many other web applications that you interact with on the Internet. In this section, we’ll outline several other important applications, including:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Proxies</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">HTTP intermediaries that sit between clients and servers</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Caches</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">HTTP storehouses that keep copies of popular web pages close to clients</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Gateways</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Special web servers that connect to other applications</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Tunnels</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Special proxies that blindly forward HTTP communications</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Agents</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Semi-intelligent web clients that make automated HTTP requests</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark358"></a><span class="font7" style="font-weight:bold;"><a name="bookmark359"></a>Proxies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark360"></a><span class="font24">Let’s start by looking at HTTP </span><span class="font24" style="font-style:italic;">proxy servers</span><span class="font24">, important building blocks for web security, application integration, and performance optimization.</span></p>
<p style="text-align:justify;"><span class="font24">As shown in</span><a href="#bookmark361"><span class="font24"> Figure 1-11</span></a><span class="font24">, a proxy sits between a client and a server, receiving all of the client’s HTTP requests and relaying the requests to the server (perhaps after modifying the requests). These applications act as a proxy for the user, accessing the server on the user’s behalf.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-27.jpg" alt="" style="width:362pt;height:100pt;"></td></tr>
<tr><td>
<p><a name="bookmark361"></a><span class="font23" style="font-style:italic;"><a name="bookmark362"></a>Figure 1-11. Proxies relay traffic between client and server</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Proxies are often used for security, acting as trusted intermediaries through which all web traffic flows. Proxies can also filter requests and responses; for example, to detect application viruses in corporate downloads or to filter adult content away from elementary-school students. We’ll talk about proxies in detail in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark363"></a><span class="font7" style="font-weight:bold;"><a name="bookmark364"></a>Caches</span></h3>
<p style="text-align:justify;"><span class="font24">A </span><span class="font24" style="font-style:italic;">web cache</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">caching proxy</span><span class="font24"> is a special type of HTTP proxy server that keeps copies of popular documents that pass through the proxy. The next client requesting the same document can be served from the cache’s personal copy (see </span><a href="#bookmark365"><span class="font24">Figure 1-12</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-28.jpg" alt="" style="width:34pt;height:47pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-29.jpg" alt="" style="width:161pt;height:92pt;">
</div><br clear="all">
<p><a name="bookmark365"></a><span class="font23" style="font-style:italic;">Figure 1-12. Caching proxies keep local copies of popular documents to improve performance</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark366"></a><span class="font24">A client may be able to download a document much more quickly from a nearby cache than from a distant web server. HTTP defines many facilities to make caching more effective and to regulate the freshness and privacy of cached content. We cover caching technology in</span><a href="#bookmark231"><span class="font24"> Chapter 7</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark367"></a><span class="font7" style="font-weight:bold;"><a name="bookmark368"></a>Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24" style="font-style:italic;">Gateways</span><span class="font24"> are special servers that act as intermediaries for other servers. They are often used to convert HTTP traffic to another protocol. A gateway always receives requests as if it was the origin server for the resource. The client may not be aware it is communicating with a gateway.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a name="bookmark369"></a><span class="font24">For example, an HTTP/FTP gateway receives requests for FTP URIs via HTTP requests but fetches the documents using the FTP protocol (see </span><a href="#bookmark370"><span class="font24">Figure 1-13</span></a><span class="font24">). The resulting document is packed into an HTTP message and sent to the client. We discuss gateways in</span><a href="#bookmark232"><span class="font24"> Chapter 8</span></a><span class="font24">.</span></p>
<table>
<tr><td><img src="book_files/book-30.jpg" alt="" style="width:200pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p>
<p><span class="font1" style="font-weight:bold;">HTTP/FTP gateway</span></p>
<p><span class="font1" style="font-weight:bold;">FTP server</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark370"></a><span class="font23" style="font-style:italic;">Figure 1-13. HTTP/FTP gateway</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark371"></a><span class="font7" style="font-weight:bold;"><a name="bookmark372"></a>Tunnels</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark373"></a><span class="font24" style="font-style:italic;">Tunnels</span><span class="font24"> are HTTP applications that, after setup, blindly relay raw data between two connections. HTTP tunnels are often used to transport non-HTTP data over one or more HTTP connections, without looking at the data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One popular use of HTTP tunnels is to carry encrypted Secure Sockets Layer (SSL) traffic through an HTTP connection, allowing SSL traffic through corporate firewalls that permit only web traffic. As sketched in </span><a href="#bookmark374"><span class="font24">Figure 1-14</span></a><span class="font24">, an HTTP/SSL tunnel receives an HTTP request to establish an outgoing connection to a destination address and port, then proceeds to tunnel the encrypted SSL traffic over the HTTP channel so that it can be blindly relayed to the destination server.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark375"></a><span class="font7" style="font-weight:bold;"><a name="bookmark376"></a>Agents</span></h3>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">User agents (or just </span><span class="font24" style="font-style:italic;">agents</span><span class="font24">) are client programs that make HTTP requests on the user’s behalf. Any application that issues web requests is an HTTP agent. So far, we’ve talked about only one kind of HTTP agent: web browsers. But there are many other kinds of user agents.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-31.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-32.jpg" alt="" style="width:48pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-33.jpg" alt="" style="width:140pt;height:85pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">SSL</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Tunnel start</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td><td><img src="book_files/book-34.jpg" alt="" style="width:20pt;height:20pt;"></td><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP connection</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">HTTP</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark374"></a><span class="font23" style="font-style:italic;">Figure 1-14. Tunnels forward data across non-HTTP networks (HTTP/SSL tunnel shown)</span></p>
<p style="text-align:justify;"><a name="bookmark377"></a><span class="font24">For example, there are machine-automated user agents that autonomously wander the Web, issuing HTTP transactions and fetching content, without human supervision. These automated agents often have colorful names, such as “spiders” or “web robots” (see </span><a href="#bookmark378"><span class="font24">Figure 1-15</span></a><span class="font24">). Spiders wander the Web to build useful archives of web content, such as a search engine’s database or a product catalog for a comparisonshopping robot. See </span><a href="#bookmark233"><span class="font24">Chapter 9 </span></a><span class="font24">for more information.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-35.jpg" alt="" style="width:130pt;height:110pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Search engine “spider”</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-36.jpg" alt="" style="width:75pt;height:68pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Search engine database</span></p></td></tr>
</table>
</div><br clear="all">
<p><a name="bookmark378"></a><span class="font23" style="font-style:italic;">Figure 1-15. Automated search engine “spiders” are agents, fetching web pages around the world</span></p>
<h2 style="padding:12pt 0pt 6pt 0pt;"><a name="bookmark379"></a><span class="font9" style="font-weight:bold;"><a name="bookmark14"></a><a name="bookmark380"></a>The End of the Beginning</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">That’s it for our quick introduction to HTTP. In this chapter, we highlighted HTTP’s role as a multimedia transport protocol. We outlined how HTTP uses URIs to name multimedia resources on remote servers, we sketched how HTTP request and response messages are used to manipulate multimedia resources on remote servers, and we finished by surveying a few of the web applications that use HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark381"></a><span class="font24">The remaining chapters explain the technical machinery of the HTTP protocol, applications, and resources in much more detail.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark382"></a><span class="font9" style="font-weight:bold;"><a name="bookmark15"></a><a name="bookmark383"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Later chapters of this book will explore HTTP in much more detail, but you might find that some of the following sources contain useful background about particular topics we covered in this chapter.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark384"></a><span class="font7" style="font-weight:bold;"><a name="bookmark385"></a>HTTP Protocol Information</span></h3>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP Pocket Reference</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Clinton Wong, O’Reilly &amp;&nbsp;Associates, Inc. This little book provides a concise introduction to HTTP and a quick reference to each of the headers and status codes that compose HTTP transactions.</span></p>
<p><a href="http://www.w3.org/Protocols/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">This W3C web page contains many great links about the HTTP protocol.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol—HTTP/1.1,” is the official specification for HTTP/1.1, the current version of the HTTP protocol. The specification is a well-written, well-organized, detailed reference for HTTP, but it isn’t ideal for readers who want to learn the underlying concepts and motivations of HTTP or the differences between theory and practice. We hope that this book fills in the underlying concepts, so you can make better use of the specification.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc1945.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1945.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">RFC 1945, “Hypertext Transfer Protocol—HTTP/1.0,” is an informational RFC that describes the modern foundation for HTTP. It details the officially sanctioned and “best-practice” behavior of web applications at the time the specification was written. It also contains some useful descriptions about behavior that is deprecated in HTTP/1.1 but still widely implemented by legacy applications.</span></p>
<p><a href="http://www.w3.org/Protocols/HTTP/AsImplemented.html"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP/AsImplemented.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">This web page contains a description of the 1991 HTTP/0.9 protocol, which implements only GET requests and has no content typing.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark386"></a><span class="font7" style="font-weight:bold;"><a name="bookmark387"></a>Historical Perspective</span></h3>
<p><a href="http://www.w3.org/Protocols/WhyHTTP.html"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/WhyHTTP.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">This brief web page from 1991, from the author of HTTP, highlights some of the original, minimalist goals of HTTP.</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/History.html"><span class="font24" style="font-style:italic;">http://www.w3.org/History.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">“A Little History of the World Wide Web” gives a short but interesting perspective on some of the early goals and foundations of the World Wide Web and HTTP.</span></p>
<p><a href="http://www.w3.org/DesignIssues/Architecture.html"><span class="font24" style="font-style:italic;">http://www.w3.org/DesignIssues/Architecture.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 18pt;"><span class="font24">“Web Architecture from 50,000 Feet” paints a broad, ambitious view of the World Wide Web and the design principles that affect HTTP and related web technologies.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark388"></a><span class="font7" style="font-weight:bold;"><a name="bookmark389"></a>Other World Wide Web Information</span></h3>
<p><a href="http://www.w3.org"><span class="font24" style="font-style:italic;">http://www.w3.org</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">The World Wide Web Consortium (W3C) is the technology steering team for the Web. The W3C develops interoperable technologies (specifications, guidelines, software, and tools) for the evolving Web. The W3C site is a treasure trove of introductory and detailed documentation about web technologies.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2396.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2396.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">RFC 2396, “Uniform Resource Identifiers (URI): Generic Syntax,” is the detailed reference for URIs and URLs.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2141.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2141.txt</span></a></p>
<p style="text-align:justify;text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 2141, “URN Syntax,” is a 1997 specification describing URN syntax.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2046.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2046.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">RFC 2046, “MIME Part 2: Media Types,” is the second in a suite of five Internet specifications defining the Multipurpose Internet Mail Extensions standard for multimedia content management.</span></p>
<p><a href="http://www.wrec.org/Drafts/draft-ietf-wrec-taxonomy-06.txt"><span class="font24" style="font-style:italic;">http://www.wrec.org/Drafts/draft-ietf-wrec-taxonomy-06.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">This Internet draft, “Internet Web Replication and Caching Taxonomy,” specifies standard terminology for web architectural components.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 2</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark224"></a><span class="font11" style="font-weight:bold;"><a name="bookmark16"></a><a name="bookmark390"></a>URLs and Resources</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark391"></a><span class="font24"><a name="bookmark392"></a><a name="bookmark393"></a>Think of the Internet as a giant, expanding city, full of places to see and things to do. You and the other residents and tourists of this booming community would use standard naming conventions for the city’s vast attractions and services. You’d use street addresses for museums, restaurants, and people’s homes. You’d use phone numbers for the fire department, the boss’s secretary, and your mother, who says you don’t call enough.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Everything has a standardized name, to help sort out the city’s resources. Books have ISBN numbers, buses have route numbers, bank accounts have account numbers, and people have social security numbers. Tomorrow you will meet your business partners at gate 31 of the airport. Every morning you take a Red-line train and exit at Kendall Square station.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">And because everyone agreed on standards for these different names, we can easily share the city’s treasures with each other. You can tell the cab driver to take you to 246 McAllister Street, and he’ll know what you mean (even if he takes the long way).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Uniform resource locators (URLs) are the standardized names for the Internet’s resources. URLs point to pieces of electronic information, telling you where they are located and how to interact with them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In this chapter, we’ll cover:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• URL syntax and what the various URL components mean and do</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• URL shortcuts that many web clients support, including relative URLs and expandomatic URLs</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• URL encoding and character rules</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Common URL schemes that support a variety of Internet information systems</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The future of URLs, including uniform resource names (URNs)—a framework to support objects that move from place to place while retaining stable names</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark394"></a><span class="font9" style="font-weight:bold;"><a name="bookmark395"></a><a name="bookmark17"></a><a name="bookmark396"></a>Navigating the Internet’s Resources</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark397"></a><span class="font24"><a name="bookmark398"></a>URLs are the resource locations that your browser needs to find information. They let people and applications find, use, and share the billions of data resources on the Internet. URLs are the usual human access point to HTTP and other protocols: a person points a browser at a URL and, behind the scenes, the browser sends the appropriate protocol messages to get the resource that the person wants.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark399"></a><span class="font24"><a name="bookmark400"></a>URLs actually are a subset of a more general class of resource identifier called a uniform resource identifier, or URI. URIs are a general concept comprised of two main subsets, URLs and URNs. URLs identify resources by describing where resources are located, whereas URNs (which we’ll cover later in this chapter) identify resources by name, regardless of where they currently reside.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP specification uses the more general concept of URIs as its resource identifiers; in practice, however, HTTP applications deal only with the URL subset of URIs. Throughout this book, we’ll sometimes refer to URIs and URLs interchangeably, but we’re almost always talking about URLs.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Say you want to fetch the URL </span><a href="http://www.joes-hardware.com/seasonal/index-fall.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/seasonal/index-fall.html</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The first part of the URL (</span><span class="font24" style="font-style:italic;">http</span><span class="font24">) is the </span><span class="font24" style="font-style:italic;">URL scheme</span><span class="font24">. The scheme tells a web client </span><span class="font24" style="font-style:italic;">how</span><span class="font24"> to access the resource. In this case, the URL says to use the HTTP protocol.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The second part of the URL (</span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">) is the server location. This tells the web client </span><span class="font24" style="font-style:italic;">where</span><span class="font24"> the resource is hosted.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The third part of the URL (</span><span class="font24" style="font-style:italic;">/seasonal/index-fall.html</span><span class="font24">) is the resource path. The path tells </span><span class="font24" style="font-style:italic;">what</span><span class="font24"> particular local resource on the server is being requested.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 27pt 0pt;"><span class="font24">See</span><a href="#bookmark401"><span class="font24"> Figure 2-1 </span></a><span class="font24">for an illustration.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-37.jpg" alt="" style="width:77pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Web page</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/seasonal/index-fall.html"><span class="font5" style="text-decoration:underline;">http://www.joes-hardware.com/seasonal/index-fall.html</span></a></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Scheme (how)</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Host (where)</span></p></td></tr>
<tr><td><img src="book_files/book-38.jpg" alt="" style="width:142pt;height:49pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 59pt 0pt;"><span class="font1" style="font-style:italic;">Path (what)</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Disk</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:5pt 0pt 10pt 0pt;"><a name="bookmark401"></a><span class="font23" style="font-style:italic;">Figure 2-1. How URLs relate to browser, machine, server, and location on the server’s filesystem</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URLs can direct you to resources available through protocols other than HTTP. They can point you to any resource on the Internet, from a person’s email account:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="mailto:president@whitehouse.gov"><span class="font3">mailto:president@whitehouse.gov</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark402"></a><span class="font24">to files that are available through other protocols, such as the File Transfer Protocol (FTP):</span></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 5pt 0pt;"><a href="ftp://ftp.lots-o-books.com/pub/complete-price-list.xls"><span class="font3">ftp://ftp.lots-o-books.com/pub/complete-price-list.xls</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">to movies hosted off of streaming video servers:</span></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">rtsp://</span><a href="http://www.joes-hardware.com:554/interview/cto_video"><span class="font3">www.joes-hardware.com:554/interview/cto_video</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">URLs provide a way to uniformly name resources. Most URLs have the same “scheme://server location/path” structure. So, for every resource out there and every way to get those resources, you have a single way to name each resource so that anyone can use that name to find it. However, this wasn’t always the case.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark403"></a><span class="font7" style="font-weight:bold;"><a name="bookmark404"></a>The Dark Days Before URLs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before the Web and URLs, people relied on a rag-tag assortment of applications to access data distributed throughout the Net. Most people were not lucky enough to have all the right applications or were not savvy and patient enough to use them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before URLs came along, if you wanted to share the </span><span class="font24" style="font-style:italic;">complete-catalog.xls</span><span class="font24"> file with a friend, you would have had to say something like this: “Use FTP to connect to </span><span class="font24" style="font-style:italic;">ftp. joes-hardware.com</span><span class="font24">. Log in as </span><span class="font24" style="font-style:italic;">anonymous</span><span class="font24">. Then type your username as the password. Change to the </span><span class="font24" style="font-style:italic;">pub</span><span class="font24"> directory. Switch to binary mode. Now download the file named </span><span class="font24" style="font-style:italic;">complete-catalog.xls</span><span class="font24"> to your local filesystem and view it there.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Today, browsers such as Netscape Navigator and Microsoft Internet Explorer bundle much of this functionality into one convenient package. Using URLs, these applications are able to access many resources in a uniform way, through one interface. Instead of the complicated instructions above, you could just say “Point your browser at </span><a href="ftp://ftp.lots-o-books.com/pub/complete-catalog.xls.%e2%80%9d"><span class="font24" style="font-style:italic;">ftp://ftp.lots-o-books.com/pub/complete-catalog.xls</span><span class="font24">.”</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URLs have provided a means for applications to be aware of how to access a resource. In fact, many users are probably unaware of the protocols and access methods their browsers use to get the resources they are requesting.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With web browsers, you no longer need a news reader to read Internet news or an FTP client to access files on FTP servers. You don’t need an electronic mail program to send and receive email messages. URLs have helped to simplify the online world, by allowing the browser to be smart about how to access and handle resources.<a name="footnote3"></a><sup><a href="#bookmark405">3</a></sup><sup> </sup>Applications can use URLs to simplify access to information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URLs give you and your browser all you need to find a piece of information. They define the particular resource you want, where it is located, and how to get it.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark406"></a><span class="font9" style="font-weight:bold;"><a name="bookmark407"></a><a name="bookmark18"></a><a name="bookmark408"></a>URL Syntax</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark409"></a><span class="font24">URLs provide a means of locating any resource on the Internet, but these resources can be accessed by different schemes (e.g., HTTP, FTP, SMTP), and URL syntax varies from scheme to scheme.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Does this mean that each different URL scheme has a radically different syntax? In practice, no. Most URLs adhere to a general URL syntax, and there is significant overlap in the style and syntax between different URL schemes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Most URL schemes base their URL syntax on this nine-part general format:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;scheme&gt;://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;;&lt;params&gt;?&lt;query&gt;#&lt;frag&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Almost no URLs contain all these components. The three most important parts of a URL are the </span><span class="font24" style="font-style:italic;">scheme</span><span class="font24">, the </span><span class="font24" style="font-style:italic;">host</span><span class="font24">, and the </span><span class="font24" style="font-style:italic;">path</span><span class="font24">. </span><a href="#bookmark410"><span class="font24">Table 2-1 </span></a><span class="font24">summarizes the various components.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark410"></a><span class="font23" style="font-style:italic;">Table 2-1.</span></p></td><td colspan="2" style="vertical-align:top;">
<p><span class="font23" style="font-style:italic;">General URL components</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Component</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Default value</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">scheme</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">Which protocol to use when accessing a server to get a resource.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">user</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">The username some schemes require to access a resource.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">anonymous</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">password</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">The password that may be included after the username, separated by a colon (:).</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">&lt;Email address&gt;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">host</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">The hostname or dotted IP address of the server hosting the resource.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">port</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 14pt;"><span class="font2">The port number on which the server hosting the resource is listening. Many schemes have default port numbers (the default port number for HTTP is 80).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Scheme-specific</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">path</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 14pt;"><span class="font2">The local name for the resource on the server, separated from the previous URL components by a slash (/). The syntax of the path component is server- and scheme-specific. (We will see later in this chapter that a URL’s path can be divided into segments, and each segment can have its own components specific to that segment.)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">params</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 14pt;"><span class="font2">Used by some schemes to specify input parameters. Params are name/value pairs. A URL can contain multiple params fields, separated from themselves and the rest of the path by semicolons (;).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">query</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 14pt;"><span class="font2">Used by some schemes to pass parameters to active applications (such as databases, bulletin boards, search engines, and other Internet gateways). There is no common format for the contents of the query component. It is separated from the rest of the URL by the “?” character.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">frag</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 14pt;"><span class="font2">A name for a piece or part of the resource. The frag field is not passed to the server when referencing the object; it is used internally by the client. It is separated from the rest of the URL by the “#” character.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, consider the URL </span><a href="http://www.joes-hardware.com:80/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com:80/index.html</span></a><span class="font24">. The scheme is “http”, the host is “www.joes-hardware.com”, the port is “80”, and the path is “/index.html”.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark411"></a><span class="font7" style="font-weight:bold;"><a name="bookmark412"></a><a name="bookmark413"></a>Schemes: What Protocol to Use</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark414"></a><span class="font24"><a name="bookmark415"></a>The </span><span class="font24" style="font-style:italic;">scheme</span><span class="font24"> is really the main identifier of how to access a given resource; it tells the application interpreting the URL what protocol it needs to speak. In our simple HTTP URL, the scheme is simply “http”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The scheme component must start with an alphabetic character, and it is separated from the rest of the URL by the first “:” character. Scheme names are caseinsensitive, so the URLs “http://www.joes-hardware.com” and “HTTP://www.joes-hardware.com” are equivalent.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark416"></a><span class="font7" style="font-weight:bold;"><a name="bookmark417"></a>Hosts and Ports</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To find a resource on the Internet, an application needs to know what machine is hosting the resource and where on that machine it can find the server that has access to the desired resource. The </span><span class="font24" style="font-style:italic;">host</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">port</span><span class="font24"> components of the URL provide these two pieces of information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark418"></a><span class="font24">The host component identifies the host machine on the Internet that has access to the resource. The name can be provided as a hostname, as above (“</span><a href="http://www.joes-hardware"><span class="font24">www.joes-hardware</span></a><span class="font24">. com”) or as an IP address. For example, the following two URLs point to the same resource—the first refers to the server by its hostname and the second by its IP address:</span></p>
<p style="text-align:justify;text-indent:19pt;"><a href="http://www.joes-hardware.com:80/index.html"><span class="font3">http://www.joes-hardware.com:80/index.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://161.58.228.45:80/index.html"><span class="font3">http://161.58.228.45:80/index.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The port component identifies the network port on which the server is listening. For HTTP, which uses the underlying TCP protocol, the default port is 80.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark419"></a><span class="font7" style="font-weight:bold;"><a name="bookmark420"></a>Usernames and Passwords</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">More interesting components are the </span><span class="font24" style="font-style:italic;">user</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">password</span><span class="font24"> components. Many servers require a username and password before you can access data through them. FTP servers are a common example of this. Here are a few examples:</span></p>
<p style="text-align:justify;text-indent:19pt;"><a href="ftp://ftp.prep.ai.mit.edu/pub/gnu"><span class="font3">ftp://ftp.prep.ai.mit.edu/pub/gnu</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">http://joe:joespasswd@www.joes-hardware.com/sales_info.txt</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The first example has no user or password component, just our standard scheme, host, and path. If an application is using a URL scheme that requires a username and password, such as FTP, it generally will insert a default username and password if they aren’t supplied. For example, if you hand your browser an FTP URL without specifying a username and password, it will insert “anonymous” for your username and send a default password (Internet Explorer sends “IEUser”, while Netscape Navigator sends “mozilla”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark421"></a><span class="font24">The second example shows a username being specified as “anonymous”. This username, combined with the host component, looks just like an email address. The “@” character separates the user and password components from the rest of the URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In the third example, both a username (“anonymous”) and password (“my_passwd”) are specified, separated by the “:” character.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark422"></a><span class="font7" style="font-weight:bold;"><a name="bookmark423"></a>Paths</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark424"></a><span class="font24">The </span><span class="font24" style="font-style:italic;">path</span><span class="font24"> component of the URL specifies where on the server machine the resource lives. The path often resembles a hierarchical filesystem path. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com:80/seasonal/index-fall.html"><span class="font3">http://www.joes-hardware.com:80/seasonal/index-fall.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The path in this URL is “/seasonal/index-fall.html”, which resembles a filesystem path on a Unix filesystem. The path is the information that the server needs to locate the resource.<a name="footnote4"></a><sup><a href="#bookmark425">4</a></sup><sup></sup> The path component for HTTP URLs can be divided into </span><span class="font24" style="font-style:italic;">path segments</span><span class="font24"> separated by “/” characters (again, as in a file path on a Unix filesystem). Each path segment can have its own </span><span class="font24" style="font-style:italic;">params</span><span class="font24"> component.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark426"></a><span class="font7" style="font-weight:bold;"><a name="bookmark427"></a>Parameters</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For many schemes, a simple host and path to the object just aren’t enough. Aside from what port the server is listening to and even whether or not you have access to the resource with a username and password, many protocols require more information to work.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Applications interpreting URLs need these protocol parameters to access the resource. Otherwise, the server on the other side might not service the request or, worse yet, might service it wrong. For example, take a protocol like FTP, which has two modes of transfer, binary and text. You wouldn’t want your binary image transferred in text mode, because the binary image could be scrambled.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To give applications the input parameters they need in order to talk to the server correctly, URLs have a </span><span class="font24" style="font-style:italic;">params</span><span class="font24"> component. This component is just a list of name/value pairs in the URL, separated from the rest of the URL (and from each other) by “;” characters. They provide applications with any additional information that they need to access the resource. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="ftp://prep.ai.mit.edu/pub/gnu;type=d"><span class="font3">ftp://prep.ai.mit.edu/pub/gnu;type=d</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In this example, there is one param, </span><span class="font4">type=d</span><span class="font24">, where the name of the param is “type” and its value is “d”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark428"></a><span class="font24">As we mentioned earlier, the path component for HTTP URLs can be broken into path segments. Each segment can have its own params. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark429"></a><span class="font24">In this example there are two path segments, </span><span class="font4">hammers </span><span class="font24">and </span><span class="font4">index.html</span><span class="font24">. The </span><span class="font4">hammers </span><span class="font24">path segment has the param </span><span class="font4">sale</span><span class="font24">, and its value is </span><span class="font4">false</span><span class="font24">. The </span><span class="font4">index.html </span><span class="font24">segment has the param </span><span class="font4">graphics</span><span class="font24">, and its value is </span><span class="font4">true</span><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark430"></a><span class="font7" style="font-weight:bold;"><a name="bookmark431"></a>Query Strings</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some resources, such as database services, can be asked questions or queries to narrow down the type of resource being requested.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s say Joe’s Hardware store maintains a list of unsold inventory in a database and allows the inventory to be queried, to see whether products are in stock. The following URL might be used to query a web database gateway to see if item number 12731 is available:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/inventory-check.cgi?item=12731"><span class="font3">http://www.joes-hardware.com/inventory-check.cgi?item=12731</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For the most part, this resembles the other URLs we have looked at. What is new is everything to the right of the question mark (</span><span class="font4">?</span><span class="font24">). This is called the </span><span class="font24" style="font-style:italic;">query</span><span class="font24"> component. The query component of the URL is passed along to a gateway resource, with the path component of the URL identifying the gateway resource. Basically, gateways can be thought of as access points to other applications (we discuss gateways in detail in</span><a href="#bookmark232"><span class="font24"> Chapter 8</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><a href="#bookmark432"><span class="font24">Figure 2-2</span></a><span class="font24"> shows an example of a query component being passed to a server that is acting as a gateway to Joe’s Hardware’s inventory-checking application. The query is checking whether a particular item, </span><span class="font4">12731</span><span class="font24">, is in inventory in size </span><span class="font4">large </span><span class="font24">and color </span><span class="font4">blue</span><span class="font24">.</span></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 25pt 0pt;"><a href="http://www.joes-hardware.com/inventory-check.cgi?item=12731&amp;color=blue&amp;size=large"><span class="font2">http://www.joes-hardware.com/inventory-check.cgi?item=12731&amp;color=blue&amp;size=large</span></a></p>
<p style="text-align:right;padding:0pt 31pt 5pt 0pt;"><span class="font2">item=12731&amp;color=blue&amp;size=large</span></p>
<p style="padding:0pt 0pt 18pt 132pt;"><span class="font1" style="font-weight:bold;">Internet</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
</div>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font0">Inventory-check” gateway</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark432"></a><span class="font23" style="font-style:italic;">Figure 2-2. The URL query component is sent along to the gateway application</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There is no requirement for the format of the query component, except that some characters are illegal, as we’ll see later in this chapter. By convention, many gateways <a name="bookmark433"></a><a name="bookmark434"></a>expect the query string to be formatted as a series of “name=value” pairs, separated by “&amp;” characters:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/inventory-check.cgi?item=12731&amp;color=blue"><span class="font3">http://www.joes-hardware.com/inventory-check.cgi?item=12731&amp;color=blue</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In this example, there are two name/value pairs in the query component: </span><span class="font4">item=12731 </span><span class="font24">and </span><span class="font4">color=blue</span><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark435"></a><span class="font7" style="font-weight:bold;"><a name="bookmark436"></a>Fragments</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some resource types, such as HTML, can be divided further than just the resource level. For example, for a single, large text document with sections in it, the URL for the resource would point to the entire text document, but ideally you could specify the sections within the resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark437"></a><span class="font24">To allow referencing of parts or fragments of a resource, URLs support a </span><span class="font24" style="font-style:italic;">frag</span><span class="font24"> component to identify pieces within a resource. For example, a URL could point to a particular image or section within an HTML document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark438"></a><span class="font24"><a name="bookmark439"></a>A fragment dangles off the right-hand side of a URL, preceded by a </span><span class="font4"># </span><span class="font24">character. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/tools.html%23drills"><span class="font3">http://www.joes-hardware.com/tools.html#drills</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark440"></a><span class="font24">In this example, the fragment </span><span class="font4">drills </span><span class="font24">references a portion of the </span><span class="font24" style="font-style:italic;">/tools.html</span><span class="font24"> web page located on the Joe’s Hardware web server. The portion is named “drills”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark441"></a><span class="font24"><a name="bookmark442"></a><a name="bookmark443"></a>Because HTTP servers generally deal only with entire objects,<a name="footnote5"></a><sup><a href="#bookmark444">5</a></sup><sup></sup> not with fragments of objects, clients don’t pass fragments along to servers (see </span><a href="#bookmark445"><span class="font24">Figure 2-3</span></a><span class="font24">). After your browser gets the </span><span class="font24" style="font-style:italic;">entire</span><span class="font24"> resource from the server, it then uses the fragment to display the part of the resource in which you are interested.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark446"></a><span class="font9" style="font-weight:bold;"><a name="bookmark19"></a><a name="bookmark447"></a>URL Shortcuts</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web clients understand and use a few URL shortcuts. Relative URLs are a convenient shorthand for specifying a resource within a resource. Many browsers also support “automatic expansion” of URLs, where the user can type in a key (memorable) part of a URL, and the browser fills in the rest. This is explained in</span><a href="#bookmark448"><span class="font24"> “Expandomatic URLs</span></a><span class="font24">.”</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark449"></a><span class="font7" style="font-weight:bold;"><a name="bookmark450"></a>Relative URLs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URLs come in two flavors: </span><span class="font24" style="font-style:italic;">absolute</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">relative</span><span class="font24">. So far, we have looked only at absolute URLs. With an absolute URL, you have all the information you need to access a resource.</span></p>
<table>
<tr><td>
<p><a href="http://www.joes-hardware.com/tools.html%23drills"><span class="font4">http://www.joes-hardware.com/tools.html#drills</span></a></p></td></tr>
<tr><td><img src="book_files/book-39.jpg" alt="" style="width:300pt;height:178pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><a name="bookmark451"></a><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Browser displays HTML page starting with named “drills” fragment</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark445"></a><span class="font23" style="font-style:italic;"><a name="bookmark452"></a>Figure 2-3. The URL fragment is used only by the client, because the server deals with entire objects</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">On the other hand, relative URLs are incomplete. To get all the information needed to access a resource from a relative URL, you must interpret it relative to another URL, called its </span><span class="font24" style="font-style:italic;">base</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Relative URLs are a convenient shorthand notation for URLs. If you have ever written HTML by hand, you have probably found them to be a great shortcut. </span><a href="#bookmark453"><span class="font24">Example 2-1 </span></a><span class="font24">contains an example HTML document with an embedded relative URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark453"></a><span class="font23" style="font-style:italic;">Example 2-1. HTML snippet with relative URLs</span></p>
<p style="text-align:justify;"><span class="font3">&lt;HTML&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;HEAD&gt;&lt;TITLE&gt;Joe's Tools&lt;/TITLE&gt;&lt;/HEAD&gt;</span></p>
<p style="text-align:justify;"><span class="font3">&lt;BODY&gt;</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;"><span class="font3">&lt; H1&gt; Tools Page &lt;/H1&gt;</span></p></li>
<li>
<p style="text-align:justify;"><span class="font3">&lt; H2&gt; Hammers &lt;H2&gt;</span></p></li>
<li>
<p style="text-align:justify;"><span class="font3">&lt; P&gt; Joe's Hardware Online has the largest selection of &lt;A HREF=&quot;./hammers.html&quot;&gt;hammers</span></p></li>
<li>
<p style="text-align:justify;"><span class="font3">&lt; /A&gt; on earth.</span></p></li></ul>
<p style="text-align:justify;"><span class="font3">&lt;/BODY&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font3">&lt;/HTML&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In</span><a href="#bookmark453"><span class="font24"> Example 2-1</span></a><span class="font24">, we have an HTML document for the resource:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/tools.html"><span class="font3">http://www.joes-hardware.com/tools.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In the HTML document, there is a hyperlink containing the URL </span><span class="font24" style="font-style:italic;">./hammers.html</span><span class="font24">. This URL seems incomplete, but it is a legal relative URL. It can be interpreted relative to the URL of the document in which it is found; in this case, relative to the resource </span><span class="font24" style="font-style:italic;">/tools.html</span><span class="font24"> on the Joe’s Hardware web server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The abbreviated relative URL syntax lets HTML authors omit from URLs the scheme, host, and other components. These components can be inferred by the </span><span class="font24" style="font-style:italic;">base </span><span class="font24">URL of the resource they are in. URLs for other resources also can be specified in this shorthand.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In</span><a href="#bookmark453"><span class="font24"> Example 2-1</span></a><span class="font24">, our base URL is:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/tools.html"><span class="font3">http://www.joes-hardware.com/tools.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><span class="font24">Using this URL as a base, we can infer the missing information. We know the resource is </span><span class="font24" style="font-style:italic;">./hammers.html</span><span class="font24">, but we don’t know the scheme or host. Using the base URL, we can infer that the scheme is </span><span class="font24" style="font-style:italic;">http</span><span class="font24"> and the host is </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">. </span><a href="#bookmark454"><span class="font24">Figure 2-4</span></a><span class="font24"> illustrates this.</span></p>
<p style="text-align:justify;text-indent:48pt;padding:0pt 0pt 2pt 0pt;"><span class="font1" style="font-style:italic;text-decoration:underline;">Base URL:</span><span class="font1" style="font-style:italic;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Re</span><span class="font1" style="font-style:italic;text-decoration:underline;">lative URL:</span></p>
<p style="padding:0pt 0pt 17pt 0pt;"><a href="http://www.joes-hardware.com/"><span class="font4" style="text-decoration:underline;">http://www.joes-hardware.com/</span></a><span class="font4">tools.html &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font4" style="text-decoration:underline;">./hammers.html</span></p>
<p><a href="http://www.joes-hardware.com/hammers.html"><span class="font5">http://www.joes-hardware.com/hammers.html</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font1" style="font-style:italic;">New absolute URL</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a name="bookmark454"></a><span class="font23" style="font-style:italic;">Figure 2-4. Using a base URL</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark455"></a><span class="font24">Relative URLs are only fragments or pieces of URLs. Applications that process URLs (such as your browser) need to be able to convert between relative and absolute URLs.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">It is also worth noting that relative URLs provide a convenient way to keep a set of resources (such as HTML pages) portable. If you use relative URLs, you can move a set of documents around and still have their links work, because they will be interpreted relative to the new base. This allows for things like mirroring content on other servers.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark456"></a><span class="font5" style="font-weight:bold;"><a name="bookmark457"></a>Base URLs</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The first step in the conversion process is to find a base URL. The base URL serves as a point of reference for the relative URL. It can come from a few places:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Explicitly provided in the resource</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Some resources explicitly specify the base URL. An HTML document, for example, may include a </span><span class="font4">&lt;BASE&gt; </span><span class="font24">HTML tag defining the base URL by which to convert all relative URLs in that HTML document.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Base URL of the encapsulating resource</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">If a relative URL is found in a resource that does not explicitly specify a base URL, as in </span><a href="#bookmark453"><span class="font24">Example 2-1</span></a><span class="font24">, it can use the URL of the resource in which it is embedded as a base (as we did in our example).</span></p>
<p style="text-align:justify;"><a name="bookmark458"></a><span class="font24" style="font-style:italic;">No base URL</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><a name="bookmark459"></a><span class="font24">In some instances, there is no base URL. This often means that you have an absolute URL; however, sometimes you may just have an incomplete or broken URL.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark460"></a><span class="font5" style="font-weight:bold;"><a name="bookmark461"></a>Resolving relative references</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Previously, we showed the basic components and syntax of URLs. The next step in converting a relative URL into an absolute one is to break up both the relative and base URLs into their component pieces.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">In effect, you are just parsing the URL, but this is often called </span><span class="font24" style="font-style:italic;">decomposing</span><span class="font24"> the URL, because you are breaking it up into its components. Once you have broken the base and relative URLs into their components, you can then apply the algorithm pictured in </span><a href="#bookmark462"><span class="font24">Figure 2-5 </span></a><span class="font24">to finish the conversion.</span></p>
<table>
<tr><td><img src="book_files/book-40.jpg" alt="" style="width:306pt;height:288pt;"></td></tr>
<tr><td>
<p><a name="bookmark462"></a><span class="font23" style="font-style:italic;">Figure 2-5. Converting relative to absolute URLs</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark463"></a><span class="font24">This algorithm converts a relative URL to its absolute form, which can then be used to reference the resource. This algorithm was originally specified in RFC 1808 and later incorporated into RFC 2396.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark464"></a><span class="font24">With our </span><span class="font24" style="font-style:italic;">./hammers.html</span><span class="font24"> example from </span><a href="#bookmark453"><span class="font24">Example 2-1</span></a><span class="font24">, we can apply the algorithm depicted in </span><a href="#bookmark462"><span class="font24">Figure 2-5</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">1. <a name="bookmark465"></a>Path is </span><span class="font24" style="font-style:italic;">./hammers.html</span><span class="font24">; <a name="bookmark466"></a>base URL is </span><a href="http://www.joes-hardware.com/tools.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/tools.html</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">2. Scheme is empty; proceed down left half of chart and inherit the base URL scheme (HTTP).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">3. At least one component is non-empty; proceed to bottom, inheriting host and port components.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">4. <a name="bookmark467"></a>Combining the components we have from the relative URL (path: </span><span class="font24" style="font-style:italic;">./hammers.html</span><span class="font24">) with what we have inherited (scheme: </span><span class="font24" style="font-style:italic;">http,</span><span class="font24"> host: </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, port: </span><span class="font24" style="font-style:italic;">80</span><span class="font24">), we get our new absolute URL: </span><a href="http://www.joes-hardware.com/hammers.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/hammers.html</span></a><span class="font24">.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark448"></a><span class="font7" style="font-weight:bold;"><a name="bookmark468"></a><a name="bookmark469"></a>Expandomatic URLs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Some browsers try to expand URLs automatically, either after you submit the URL or while you’re typing. This provides users with a shortcut: they don’t have to type in the complete URL, because it automatically expands itself.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">These “expandomatic” features come in two flavors:</span></p>
<p style="text-align:justify;"><a name="bookmark470"></a><span class="font24" style="font-style:italic;">Hostname expansion</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">In hostname expansion, the browser can often expand the hostname you type in into the full hostname without your help, just by using some simple heuristics.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">For example if you type “yahoo” in the address box, your browser can automatically insert “www.” and “.com” onto the hostname, creating “www.yahoo.com”. Some browsers will try this if they are unable to find a site that matches “yahoo”, trying a few expansions before giving up. Browsers apply these simple tricks to save you some time and frustration.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">However, these expansion tricks on hostnames can cause problems for other HTTP applications, such as proxies. In</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">, we will discuss these problems in more detail.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">History expansion</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Another technique that browsers use to save you time typing URLs is to store a history of the URLs that you have visited in the past. As you type in the URL, they can offer you completed choices to select from by matching what you type to the prefixes of the URLs in your history. So, if you were typing in the start of a URL that you had visited previously, such as </span><span class="font24" style="font-style:italic;">http://www.joes-</span><span class="font24">, your browser could suggest </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com</span></a><span class="font24">. You could then select that instead of typing out the complete URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark471"></a><span class="font24">Be aware that URL auto-expansion may behave differently when used with proxies. We discuss this further in</span><a href="#bookmark472"><span class="font24"> “URI Client Auto-Expansion and Hostname Resolution”</span></a><span class="font24"> </span><a href="#bookmark472"><span class="font24">in Chapter 6</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark473"></a><span class="font9" style="font-weight:bold;"><a name="bookmark474"></a><a name="bookmark20"></a><a name="bookmark475"></a>Shady Characters</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URLs were designed to be </span><span class="font24" style="font-style:italic;">portable</span><span class="font24">. They were also designed to uniformly name all the resources on the Internet, which means that they will be transmitted through various protocols. Because all of these protocols have different mechanisms for transmitting their data, it was important for URLs to be designed so that they could be transmitted safely through any Internet protocol.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Safe transmission means that URLs can be transmitted without the risk of losing information. Some protocols, such as the Simple Mail Transfer Protocol (SMTP) for electronic mail, use transmission methods that can strip off certain characters.<a name="footnote6"></a><sup><a href="#bookmark476">6</a></sup><sup></sup> To get around this, URLs are permitted to contain only characters from a relatively small, universally safe alphabet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark477"></a><span class="font24">In addition to wanting URLs to be transportable by all Internet protocols, designers wante<a name="bookmark478"></a>d them to be </span><span class="font24" style="font-style:italic;">readable</span><span class="font24"> by people. So invisible, nonprinting characters also are prohibited in URLs, even though these characters may pass through mailers and otherwise be portable.<a name="footnote7"></a><sup><a href="#bookmark479">7</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To complicate matters further, URLs also need to be </span><span class="font24" style="font-style:italic;">complete</span><span class="font24">. URL designers realized there would be times when people would want URLs to contain binary data or characters outside of the universally safe alphabet. So, an escape mechanism was added, allowing unsafe characters to be encoded into safe characters for transport.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This section summarizes the universal alphabet and encoding rules for URLs.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark480"></a><span class="font7" style="font-weight:bold;"><a name="bookmark481"></a>The URL Character Set</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Default computer system character sets often have an Anglocentric bias. Historically, many computer applications have used the US-ASCII character set. US-ASCII uses 7 bits to represent most keys available on an English typewriter and a few nonprinting control characters for text formatting and hardware signalling.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">US-ASCII is very portable, due to its long legacy. But while it’s convenient to citizens of the U.S., it doesn’t support the inflected characters common in European languages or the hundreds of non-Romanic languages read by billions of people around the world.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark482"></a><span class="font24"><a name="bookmark483"></a>Furthermore, some URLs may need to contain arbitrary binary data. Recognizing the need for completeness, the URL designers have incorporated </span><span class="font24" style="font-style:italic;">escape sequences</span><span class="font24">. Escape sequences allow the encoding of arbitrary character values or data using a restricted subset of the US-ASCII character set, yielding portability and completeness.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark484"></a><span class="font7" style="font-weight:bold;"><a name="bookmark485"></a>Encoding Mechanisms</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark486"></a><span class="font24">To get around the limitations of a safe character set representation, an encoding scheme was devised to represent characters in a URL that are not safe. The encoding simply represents the unsafe character by an “escape” notation, consisting of a percent sign (%) followed by two hexadecimal digits that represent the ASCII code of the character.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark487"><span class="font24">Table 2-2</span></a><span class="font24"> shows a few examples.</span></p>
<table>
<tr><td>
<p><a name="bookmark487"></a><span class="font23" style="font-style:italic;">Table 2-2. Some encoded character examples</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Character</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">ASCII code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:31pt;"><span class="font2" style="font-weight:bold;">Example URL</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">~</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:16pt;"><span class="font2">126 (0x7E)</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:31pt;"><a href="http://www.joes-hardware.com/%7Ejoe"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com/%7Ejoe</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SPACE</span></p></td><td style="vertical-align:top;">
<p style="text-indent:16pt;"><span class="font2">32 (0x20)</span></p></td><td style="vertical-align:top;">
<p style="text-indent:31pt;"><a href="http://www.joes-hardware.com/more%20tools.html"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com/more%20tools.html</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">%</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">37 (0x25)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:31pt;"><a href="http://www.joes-hardware.com/100%25satisfaction"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com/100%25satisfaction</span></a><span class="font3" style="font-style:italic;"> html</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark488"></a><span class="font7" style="font-weight:bold;"><a name="bookmark489"></a>Character Restrictions</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Several characters have been reserved to have special meaning inside of a URL. Others are not in the defined US-ASCII printable set. And still others are known to confuse some Internet gateways and protocols, so their use is discouraged.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark490"><span class="font24">Table 2-3 </span></a><span class="font24">lists characters that should be encoded in a URL before you use them for anything other than their reserved purposes.</span></p>
<table>
<tr><td>
<p><a name="bookmark490"></a><span class="font23" style="font-style:italic;">Table 2-3. Reserved and restricted characters</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Character</span></p></td><td style="vertical-align:top;">
<p style="text-indent:15pt;"><span class="font2" style="font-weight:bold;">Reservation/Restriction</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">%</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:15pt;"><span class="font2">Reserved as escape token for encoded characters</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">/</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">..</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved for delimiting splitting up path segments in the path component</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved in the path component</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved in the path component</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">#</span></p></td><td style="vertical-align:top;">
<p style="text-indent:15pt;"><span class="font2">Reserved as the fragment delimiter</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">?</span></p>
<p style="text-indent:7pt;"><span class="font2">;</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved as the query-string delimiter</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved as the params delimiter</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reserved to delimit the scheme, user/password, and host/port components</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">$ , +</span></p>
<p style="text-indent:7pt;"><span class="font2">@ &amp;&nbsp;=</span></p></td><td style="vertical-align:top;">
<p style="text-indent:15pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Reserved</span></p>
<p style="text-indent:15pt;"><span class="font2">Reserved because they have special meaning in the context of some schemes</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 2-3. Reserved and restricted characters (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Character</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Reservation/Restriction</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">{ } | \ ^ ~ [ ] ‘</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Restricted because of unsafe handling by various transport agents, such as gateways</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">&lt; &gt;&nbsp;&quot;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Unsafe; should be encoded because these characters often have meaning outside the scope of the URL, such as delimiting the URL itself in a document (e.g., “http://www.joes-hardware.com”)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">0x00–0x1F, 0x7F</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Restricted; characters within these hex ranges fall within the nonprintable section of the US-ASCII character set</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">&gt; 0x7F</span></p></td><td style="vertical-align:top;">
<p><a name="bookmark491"></a><span class="font2">Restricted; characters whose hex values fall within this range do not fall within the 7-bit range of the US-ASCII character set</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark492"></a><span class="font7" style="font-weight:bold;"><a name="bookmark493"></a>A Bit More</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You might be wondering why nothing bad has happened when you have used characters that are unsafe. For instance, you can visit Joe’s home page at:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.joes-hardware.com/~joe"><span class="font3">http://www.joes-hardware.com/~joe</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">and not encode the “~” character. For some transport protocols this is not an issue, but it is still unwise for application developers not to encode unsafe characters.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Applications need to walk a fine line. It is best for client applications to convert any unsafe or restricted characters before sending any URL to any other application.<a name="footnote8"></a><sup><a href="#bookmark494">8</a></sup><sup> </sup>Once all the unsafe characters have been encoded, the URL is in a </span><span class="font24" style="font-style:italic;">canonical form </span><span class="font24">that can be shared between applications; there is no need to worry about the other application getting confused by any of the characters’ special meanings.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The original application that gets the URL from the user is best fit to determine which characters need to be encoded. Because each component of the URL may have its own safe/unsafe characters, and which characters are safe/unsafe is schemedependent, only the application receiving the URL from the user really is in a position to determine what needs to be encoded.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Of course, the other extreme is for the application to encode all characters. While this is not recommended, there is no hard and fast rule against encoding characters that are considered safe already; however, in practice this can lead to odd and broken behavior, because some applications may assume that safe characters will not be encoded.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Sometimes, malicious folks encode extra characters in an attempt to get around applications that are doing pattern matching on URLs—for example, web filtering applications. Encoding safe URL components can cause pattern-matching applications to fail to recognize the patterns for which they are searching. In general, applications interpreting URLs must decode the URLs before processing them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark495"></a><span class="font24"><a name="bookmark496"></a><a name="bookmark497"></a>Some URL components, such as the scheme, need to be recognized readily and are required to start with an alphabetic character. Refer back to</span><a href="#bookmark406"><span class="font24"> “URL Syntax</span></a><span class="font24">” for more guidelines on the use of reserved and unsafe characters within different URL components.<a name="footnote9"></a><sup><a href="#bookmark498">9</a></sup><sup></sup></span></p>
<h2 style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark499"></a><span class="font9" style="font-weight:bold;"><a name="bookmark500"></a><a name="bookmark21"></a><a name="bookmark501"></a>A Sea of Schemes</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In this section, we’ll take a look at the more common scheme formats on the Web. </span><a href="#bookmark246"><span class="font24">Appendix A</span></a><span class="font24"> gives a fairly exhaustive list of schemes and references to their individual documentation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark502"><span class="font24">Table 2-4</span></a><a name="bookmark503"></a><span class="font24"> summarizes some of the most popular schemes. Reviewing</span><a href="#bookmark406"><span class="font24"> “URL Syntax</span></a><span class="font24">” will make the syntax portion of the table a little more familiar.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark502"></a><span class="font23" style="font-style:italic;">Table 2-4. Common scheme formats</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme Description</span></p>
<p style="text-indent:7pt;"><a name="bookmark504"></a><span class="font2">http &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Hypertext Transfer Protocol scheme conforms to the general URL format, except that there is no username</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">or password. The port defaults to 80 if omitted.</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Basic form:</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 58pt;"><span class="font3" style="font-style:italic;">http://&lt;host&gt;:&lt;port&gt;/&lt;path&gt;?&lt;query&gt;#&lt;frag&gt;</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Examples:</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><a href="http://www.joes-hardware.com/index.html"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com/index.html</span></a></p>
<p style="padding:0pt 0pt 0pt 58pt;"><a href="http://www.joes-hardware.com:80/index"><span class="font3" style="font-style:italic;">http://www.joes-hardware.com:80/index</span></a><span class="font3" style="font-style:italic;"> html</span></p>
<p style="text-indent:7pt;"><span class="font2">https &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The https scheme is a twin to the http scheme. The only difference is that the https scheme uses Netscape’s</span></p>
<p style="padding:0pt 0pt 0pt 49pt;"><span class="font2">Secure Sockets Layer (SSL), which provides end-to-end encryption of HTTP connections. Its syntax is identical to that of HTTP, with a default port of 443.</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Basic form:</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><span class="font3" style="font-style:italic;">https://&lt;host&gt;:&lt;port&gt;/&lt;path&gt;?&lt;query&gt;#&lt;frag&gt;</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Example:</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><a href="https://www.joes-hardware.com/secure.html"><span class="font3" style="font-style:italic;">https://www.joes-hardware.com/secure.html</span></a></p>
<p style="text-indent:7pt;"><span class="font2">mailto &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mailto URLs refer to email addresses. Because email behaves differently from other schemes (it does not refer to</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 49pt;"><span class="font2">objects that can be accessed directly), the format of a mailto URL differs from that of the standard URL. The syntax for Internet email addresses is documented in Internet RFC 822.</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Basic form:</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><span class="font3" style="font-style:italic;">mailto:&lt;RFC-822-addr-spec&gt;</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font2">Example:</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><a href="mailto:joe@joes-hardware.com"><span class="font3" style="font-style:italic;">mailto:joe@joes-hardware.com</span></a></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ftp</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">File Transfer Protocol URLs can be used to download and upload files on an FTP server and to obtain listings of the contents of a directory structure on an FTP server.</span></p>
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">FTP has been around since before the advent of the Web and URLs. Web applications have assimilated FTP as a data-access scheme. The URL syntax follows the general form.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Basic form:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">ftp //&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;;&lt;params&gt;</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Example:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">ftp //anonymous:joe%40joes-hardware.com@prep.ai.mit.edu:21/pub/gnu/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark505"></a><span class="font2"><a name="bookmark506"></a>rtsp, rtspu</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">RTSP URLs are identifiers for audio and video media resources that can be retrieved through the Real Time Streaming Protocol.</span></p>
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">The “u” in the rtspu scheme denotes that the UDP protocol is used to retrieve the resource.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Basic forms:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">rtsp://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">rtspu://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Example:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">rtsp://</span><a href="http://www.joes-hardware.com:554/interview/cto_video"><span class="font3" style="font-style:italic;">www.joes-hardware.com:554/interview/cto_video</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">file</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">The file scheme denotes files directly accessible on a given host machine (by local disk, a network filesystem, or some other file-sharing system). The fields follow the general form. If the host is omitted, it defaults to the local host from which the URL is being used.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Basic form:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">file://&lt;host&gt;/&lt;path&gt;</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Example:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><a href="file://OFFICE-FS/policies/casual-fridays.doc"><span class="font3" style="font-style:italic;">file://OFFICE-FS/policies/casual-fridays.doc</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">news</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">The news scheme is used to access specific articles or newsgroups, as defined by RFC 1036. It has the unusual property that a news URL in itself does not contain sufficient information to locate the resource.</span></p>
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">The news URL is missing information about where to acquire the resource—no hostname or machine name is supplied. It is the interpreting application’s job to acquire this information from the user. For example, in your Netscape browser, under the Options menu, you can specify your NNTP (news) server. This tells your browser what server to use when it has a news URL.</span></p>
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">News resources can be accessed from multiple servers. They are said to be location-independent, as they are not dependent on any one source for access.</span></p>
<p style="padding:0pt 0pt 2pt 7pt;"><span class="font2">The “@” character is reserved within a news URL and is used to distinguish between news URLs that refer to newsgroups and news URLs that refer to specific news articles.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Basic forms:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">news:&lt;newsgroup&gt;</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">news:&lt;news-article-id&gt;</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Example:</span></p>
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">news:rec.arts startrek</span></p></td></tr>
</table>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2" style="font-weight:bold;">Scheme Description</span></p>
<p style="padding:0pt 0pt 2pt 49pt;"><span class="font2">telnet The telnet scheme is used to access interactive services. It does not represent an object per se, but an interactive application (resource) accessible via the telnet protocol.</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Basic form:</span></p>
<p style="padding:0pt 0pt 2pt 58pt;"><span class="font3" style="font-style:italic;">telnet //&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Example:</span></p>
<p style="padding:0pt 0pt 14pt 58pt;"><span class="font3" style="font-style:italic;">telnet //slurp:webhound@joes-hardware.com:23/</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark507"></a><span class="font9" style="font-weight:bold;"><a name="bookmark22"></a><a name="bookmark508"></a>The Future</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark509"></a><span class="font24">URLs are a powerful tool. Their design allows them to name all existing objects and easily encompass new formats. They provide a uniform naming mechanism that can be shared between Internet protocols.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark510"></a><span class="font24"><a name="bookmark511"></a>However, they are not perfect. URLs are really addresses, not true names. This means that a URL tells you where something is located, for the moment. It provides you with the name of a specific server on a specific port, where you can find the resource. The downfall of this scheme is that if the resource is moved, the URL is no longer valid. And at that point, it provides no way to locate the object.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">What would be ideal is if you had the real name of an object, which you could use to look up that object regardless of its location. As with a person, given the name of the resource and a few other facts, you could track down that resource, regardless of where it moved.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Internet Engineering Task Force (IETF) has been working on a new standard, uniform resource names (URNs), for some time now, to address just this issue. URNs provide a stable name for an object, regardless of where that object moves (either inside a web server or across web servers).</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24" style="font-style:italic;">Persistent uniform resource locators</span><span class="font24"> (PURLs) are an example of how URN functionality can be achieved using URLs. The concept is to introduce another level of indirection in looking up a resource, using an intermediary </span><span class="font24" style="font-style:italic;">resource locator</span><span class="font24"> server that catalogues and tracks the actual URL of a resource. A client can request a persistent URL from the locator, which can then respond with a resource that redirects the client to the actual and current URL for the resource (see </span><a href="#bookmark512"><span class="font24">Figure 2-6</span></a><span class="font24">). For more information on PURLs, visit </span><a href="http://purl.oclc.org"><span class="font24" style="font-style:italic;">http://purl.oclc.org</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark513"></a><span class="font7" style="font-weight:bold;"><a name="bookmark514"></a>If Not Now, When?</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The ideas behind URNs have been around for some time. Indeed, if you look at the publication dates for some of their specifications, you might ask yourself why they have yet to be adopted.</span></p>
<p style="text-align:justify;padding:0pt 0pt 46pt 38pt;"><a name="bookmark515"></a><span class="font1" style="font-weight:bold;">STEP 1: </span><span class="font0">Ask the resource resolver what the Joe’s Hardware URL is. Receive from the resolver the current location of the resource.</span></p>
<p style="text-align:justify;text-indent:38pt;padding:0pt 0pt 70pt 0pt;"><span class="font1" style="font-weight:bold;">STEP 2: </span><span class="font0">Get the actual URL for the resource</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Get </span><a href="http://purl.oclc.org/jhardware/"><span class="font1" style="font-style:italic;">http://purl.oclc.org/jhardware/</span></a></p></td></tr>
<tr><td><img src="book_files/book-41.jpg" alt="" style="width:136pt;height:38pt;"></td></tr>
<tr><td>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purl.oclc.org</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Actual: </span><a href="http://www.joes-hardware.com/"><span class="font1" style="font-style:italic;">http://www.joes-hardware.com/</span></a></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Get </span><a href="http://www.joes-hardware.com/"><span class="font1" style="font-style:italic;">http://www.joes-hardware.com/</span></a></p></td></tr>
<tr><td><img src="book_files/book-42.jpg" alt="" style="width:136pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark512"></a><span class="font23" style="font-style:italic;">Figure 2-6. PURLs use a resource locator server to name the current location of a resource</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The change from URLs to URNs is an enormous task. Standardization is a slow process, often for good reason. Support for URNs will require many changes—consensus from the standards bodies, modifications to various HTTP applications, etc. A tremendous amount of critical mass is required to make such changes, and unfortunately (or perhaps fortunately), there is so much momentum behind URLs that it will be some time before all the stars align to make such a conversion possible.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark516"></a><span class="font24">Throughout the explosive growth of the Web, Internet users—everyone from computer scientists to the average Internet user—have been taught to use URLs. While they suffer from clumsy syntax (for the novice) and persistence problems, people have learned how to use them and how to deal with their drawbacks. URLs have some limitations, but they’re not the web development community’s most pressing problem.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Currently, and for the foreseeable future, URLs are the way to name resources on the Internet. They are everywhere, and they have proven to be a very important part of the Web’s success. It will be a while before any other naming scheme unseats URLs. However, URLs do have their limitations, and it is likely that new standards (possibly URNs) will emerge and be deployed to address some of these limitations.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark517"></a><span class="font9" style="font-weight:bold;"><a name="bookmark23"></a><a name="bookmark518"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For more information on URLs, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Addressing/"><span class="font24" style="font-style:italic;">http://www.w3.org/Addressing/</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">The W3C web page about naming and addressing URIs and URLs.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc1738"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1738</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 19pt;"><span class="font24">RFC 1738, “Uniform Resource Locators (URL),” by T. Berners-Lee, L. Masinter, and M. McCahill.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2396.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2396.txt</span></a></p>
<p style="text-indent:18pt;"><a name="bookmark519"></a><span class="font24">RFC 2396, “Uniform Resource Identifiers (URI): Generic Syntax,” by T. Berners-</span></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Lee, R. Fielding, and L. Masinter.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2141.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2141.txt</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 2141, “URN Syntax,” by R. Moats.</span></p>
<p><a href="http://purl.oclc.org"><span class="font24" style="font-style:italic;">http://purl.oclc.org</span></a></p>
<p style="text-align:justify;text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The persistent uniform resource locator web site.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc1808.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1808.txt</span></a></p>
<p style="text-indent:18pt;"><span class="font24">RFC 1808, “Relative Uniform Resource Locators,” by R. Fielding.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 3</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark225"></a><span class="font11" style="font-weight:bold;"><a name="bookmark520"></a><a name="bookmark24"></a><a name="bookmark521"></a>HTTP Messages</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark522"></a><span class="font24"><a name="bookmark523"></a><a name="bookmark524"></a><a name="bookmark525"></a>If HTTP is the Internet’s courier, HTTP messages are the packages it uses to move things around. In</span><a href="#bookmark223"><span class="font24"> Chapter 1</span></a><span class="font24">, we showed how HTTP programs send each other messages to get work done. This chapter tells you all about HTTP messages—how to create them and how to understand them. After reading this chapter, you’ll know most of what you need to know to write your own HTTP applications. In particular, you’ll understand:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• How messages flow</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><a name="bookmark526"></a><span class="font24">• The three parts of HTTP messages (start line, headers, and entity body)</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The differences between request and response messages</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The various functions (methods) that request messages support</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The various status codes that are returned with response messages</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><a name="bookmark527"></a><span class="font24">• What the various HTTP headers do</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark528"></a><span class="font9" style="font-weight:bold;"><a name="bookmark25"></a><a name="bookmark529"></a>The Flow of Messages</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTP messages are the blocks of data sent between HTTP applications. These blocks of data begin with some text </span><span class="font24" style="font-style:italic;">meta-information</span><span class="font24"> describing the message contents and meaning, followed by optional data. These messages flow between clients, servers, and proxies. The terms “inbound,” “outbound,” “upstream,” and “downstream” describe message direction.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark530"></a><span class="font7" style="font-weight:bold;"><a name="bookmark531"></a>Messages Commute Inbound to the Origin Server</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP uses the terms </span><span class="font24" style="font-style:italic;">inbound</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">outbound</span><span class="font24"> to describe </span><span class="font24" style="font-style:italic;">transactional</span><span class="font24"> direction. Messages travel inbound to the origin server, and when their work is done, they travel outbound back to the user agent (see </span><a href="#bookmark532"><span class="font24">Figure 3-1</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-43.jpg" alt="" style="width:252pt;height:64pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Outbound (to user agent)</span></p>
<p><span class="font3">HTTP/1.0 200 OK</span></p>
<p><a name="bookmark533"></a><span class="font3">Content-type: text/html</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
<tr><td><img src="book_files/book-44.jpg" alt="" style="width:32pt;height:29pt;"></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark532"></a><span class="font23" style="font-style:italic;"><a name="bookmark534"></a>Figure 3-1. Messages travel inbound to the origin server and outbound back to the client</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark535"></a><span class="font7" style="font-weight:bold;"><a name="bookmark536"></a>Messages Flow Downstream</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark537"></a><span class="font24">HTTP messages flow like rivers. All messages flow </span><span class="font24" style="font-style:italic;">downstream</span><span class="font24">, regardless of whether they are request messages or response messages (see</span><a href="#bookmark538"><span class="font24"> Figure 3-2</span></a><span class="font24">). The sender of any message is </span><span class="font24" style="font-style:italic;">upstream</span><span class="font24"> of the receiver. In</span><a href="#bookmark538"><span class="font24"> Figure 3-2</span></a><span class="font24">, proxy 1 is upstream of proxy 3 for the request but downstream of proxy 3 for the response.<a name="footnote10"></a><sup><a href="#bookmark539">10</a></sup><sup></sup></span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark540"></a><span class="font9" style="font-weight:bold;"><a name="bookmark541"></a><a name="bookmark26"></a><a name="bookmark542"></a>The Parts of a Message</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP messages are simple, formatted blocks of data. Take a peek at</span><a href="#bookmark543"><span class="font24"> Figure 3-3 </span></a><span class="font24">for an example. Each message contains either a request from a client or a response from a server. They consist of three parts: a </span><span class="font24" style="font-style:italic;">start line</span><span class="font24"> describing the message, a block of </span><span class="font24" style="font-style:italic;">headers</span><span class="font24"> containing attributes, and an optional </span><span class="font24" style="font-style:italic;">body</span><span class="font24"> containing data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The start line and headers are just ASCII text, broken up by lines. Each line ends with a two-character end-of-line sequence, consisting of a carriage return (ASCII 13) and a line-feed character (ASCII 10). This end-of-line sequence is written “CRLF.” It is worth pointing out that while the HTTP specification for terminating lines is CRLF, robust applications also should accept just a line-feed character. Some older or broken HTTP applications do not always send both the carriage return and line feed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The entity body or message body (or just plain “body”) is simply an optional chunk of data. Unlike the start line and headers, the body can contain text or binary data or can be empty.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In the example in</span><a href="#bookmark543"><span class="font24"> Figure 3-3</span></a><span class="font24">, the headers give you a bit of information about the body. The Content-Type line tells you what the body is—in this example, it is a plain-text document. The Content-Length line tells you how big the body is; here it is a meager 19 bytes.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-45.jpg" alt="" style="width:40pt;height:53pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-46.jpg" alt="" style="width:102pt;height:91pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-47.jpg" alt="" style="width:52pt;height:58pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy 3</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">No messages ever go upstream</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-48.jpg" alt="" style="width:151pt;height:92pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-49.jpg" alt="" style="width:41pt;height:25pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy 3</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-50.jpg" alt="" style="width:33pt;height:53pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-51.jpg" alt="" style="width:90pt;height:65pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark538"></a><span class="font23" style="font-style:italic;"><a name="bookmark544"></a>Figure 3-2. All messages flow downstream</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-52.jpg" alt="" style="width:64pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">Start line</span></p>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Headers</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark545"></a><span class="font3">HTTP/1.0 200 OK</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark546"></a><span class="font3">Content-type: text/plain Content-length: 19</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">Body</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font3">Hi! I’m a message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-53.jpg" alt="" style="width:69pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark543"></a><span class="font23" style="font-style:italic;">Figure 3-3. Three parts of an HTTP message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark547"></a><span class="font7" style="font-weight:bold;"><a name="bookmark548"></a>Message Syntax</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">All HTTP messages fall into two types: </span><span class="font24" style="font-style:italic;">request messages</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">response messages. </span><span class="font24">Request messages request an action from a web server. Response messages carry results of a request back to a client. Both request and response messages have the same basic message structure. </span><a href="#bookmark549"><span class="font24">Figure 3-4 </span></a><span class="font24">shows request and response messages to get a GIF image.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s the format for a request message:</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;method&gt; &lt;request-URL&gt; &lt;version&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">&lt;headers&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;entity-body&gt;</span></p>
</div><br clear="all">
<div style="float:left;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP request message contains the command and the URL</span></p>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-54.jpg" alt="" style="width:139pt;height:73pt;"></td></tr>
<tr><td>
<p style="text-align:right;"><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP response message contains the result of the transaction</span></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-55.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font3">GET /specials/saw-blade.gif HTTP/1.0 Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-56.jpg" alt="" style="width:19pt;height:34pt;">
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="padding:12pt 0pt 2pt 0pt;"><span class="font3">HTTP/1.0 200 OK Content-Type: image/gif Content-Length: 8572</span></p><img src="book_files/book-57.jpg" alt="" style="width:48pt;height:48pt;">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark549"></a><span class="font23" style="font-style:italic;"><a name="bookmark550"></a>Figure 3-4. An HTTP transaction has request and response messages</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark551"></a><span class="font24">Here’s the format for a response message (note that the syntax differs only in the start line):</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;version&gt; &lt;status&gt; &lt;reason-phrase&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 12pt 0pt;"><span class="font3">&lt;headers&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;entity-body&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">H<a name="bookmark552"></a>ere’s a quick description of the various parts:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">method</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">The action that the client wants the server to perform on the resource. It is a single word, like “GET,” “HEAD,” or “POST”. We cover the method in detail later in this chapter.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">request-URL</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">A complete URL naming the requested resource, or the </span><span class="font24" style="font-style:italic;">path</span><span class="font24"> component of the URL. If you are talking directly to the server, the path component of the URL is usually okay as long as it is the absolute path to the resource—the server can assume itself as the host/port of the URL. </span><a href="#bookmark224"><span class="font24">Chapter 2 </span></a><span class="font24">covers URL syntax in detail.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">version</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">The version of HTTP that the message is using. Its format looks like:</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">HTTP/&lt;major&gt;.&lt;minor&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">where </span><span class="font24" style="font-style:italic;">major</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">minor</span><span class="font24"> both are integers. We discuss HTTP versioning a bit more later in this chapter.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">status-code</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">A three-digit number describing what happened during the request. The first digit of each code describes the general class of status (“success,” “error,” etc.). An exhaustive list of status codes defined in the HTTP specification and their meanings is provided later in this chapter.</span></p>
<p style="text-align:justify;"><a name="bookmark553"></a><span class="font24" style="font-style:italic;"><a name="bookmark554"></a>reason-phrase</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark555"></a><span class="font24"><a name="bookmark556"></a>A human-readable version of the numeric status code, consisting of all the text until the end-of-line sequence. Example reason phrases for all the status codes defined in the HTTP specification are provided later in this chapter. The reason phrase is meant solely for human consumption, so, for example, response lines containing “HTTP/1.0 200 NOT OK” and “HTTP/1.0 200 OK” should be treated as equivalent success indications, despite the reason phrases suggesting otherwise.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Zero or more headers, each of which is a name, followed by a colon (</span><span class="font4">:</span><span class="font24">), followed by optional whitespace, followed by a value, followed by a CRLF. The headers are terminated by a blank line (CRLF), marking the end of the list of headers and the beginning of the entity body. Some versions of HTTP, such as HTTP/1.1, require certain headers to be present for the request or response message to be valid. The various HTTP headers are covered later in this chapter.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">entity-body</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">The entity body contains a block of arbitrary data. Not all messages contain entity bodies, so sometimes a message terminates with a bare CRLF. We discuss entities in detail in </span><a href="#bookmark239"><span class="font24">Chapter 15</span></a><span class="font24">.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><a href="#bookmark557"><span class="font24">Figure 3-5 </span></a><span class="font24">demonstrates hypothetical request and response messages.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Request message</span></p></td><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 75pt;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Response message</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:27pt;"><span class="font3">GET /test/hi-there.txt HTTP/1.1</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">Start line</span><span class="font3"> HTTP/1.0 200 OK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font3">Accept: text/*</span></p></td><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;font-style:italic;"><sub>Headers</sub></span><span class="font3"> Content-type: text/plain</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:27pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:39pt;"><span class="font3">Content-length: 19</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font5" style="font-weight:bold;font-style:italic;"><sup>Body</sup></span><span class="font3"> Hi! I’m a message!</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark557"></a><span class="font23" style="font-style:italic;"><a name="bookmark558"></a>Figure 3-5. Example request and response messages</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Note that a set of HTTP headers should always end in a blank line (bare CRLF), even if there are no headers and even if there is no entity body. Historically, however, many clients and servers (mistakenly) omitted the final CRLF if there was no entity body. To interoperate with these popular but noncompliant implementations, clients and servers should accept messages that end without the final CRLF.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark559"></a><span class="font7" style="font-weight:bold;"><a name="bookmark560"></a>Start Lines</span></h3>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">All HTTP messages begin with a start line. The start line for a request message says </span><span class="font24" style="font-style:italic;">what to do</span><span class="font24">. The start line for a response message says </span><span class="font24" style="font-style:italic;">what happened</span><span class="font24">.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark561"></a><span class="font5" style="font-weight:bold;"><a name="bookmark562"></a>Request line</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark563"></a><span class="font24">Request messages ask servers to do something to a resour<a name="bookmark564"></a>ce. The start line for a request message, or </span><span class="font24" style="font-style:italic;">request line</span><span class="font24">, contains a method describing what operation the server should perform and a request URL describing the resource on which to perform the method. The request line also includes an HTTP </span><span class="font24" style="font-style:italic;">version</span><span class="font24"> which tells the server what dialect of HTTP the client is speaking.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">All of these fields are separated by whitespace. In </span><a href="#bookmark557"><span class="font24">Figure 3-5</span></a><span class="font24">a, the request method is GET, the request URL is </span><span class="font24" style="font-style:italic;">/test/hi-there.txt</span><span class="font24">, and the version is HTTP/1.1. Prior to HTTP/1.0, request lines were not required to contain an HTTP version.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark565"></a><span class="font5" style="font-weight:bold;"><a name="bookmark566"></a><a name="bookmark567"></a>Response line</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Response messages carry status information and any resulting data from an operation back to a client. The start line for a response message, or </span><span class="font24" style="font-style:italic;">response line</span><span class="font24">, contains the HTTP version that the response message is using, a numeric status code, and a textual reason phrase describing the status of the operation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">All these fields are separated by whitespace. In </span><a href="#bookmark557"><span class="font24">Figure 3-5</span></a><span class="font24">b, the HTTP version is HTTP/1.0, the status code is 200 (indicating success), and the reason phrase is OK, meaning the document was returned successfully. Prior to HTTP/1.0, responses were not required to contain a response line.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark568"></a><span class="font5" style="font-weight:bold;"><a name="bookmark569"></a>Methods</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The method begins the start line of requests, telling the server what to do. For example, in the line “GET /specials/saw-blade.gif HTTP/1.0,” the method is GET.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The HTTP specifications have defined a set of common request methods. For example, the GET method gets a document from a server, the POST method sends data to a server for processing, and the OPTIONS method determines the general capabilities of a web server or the capabilities of a web server for a specific resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark570"><span class="font24">Table 3-1 </span></a><span class="font24">describes seven of these methods. Note that some methods have a body in the request message, and other methods have bodyless requests.</span></p>
<table>
<tr><td>
<p><a name="bookmark570"></a><span class="font23" style="font-style:italic;">Table 3-1. Common HTTP methods</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Method</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font2" style="font-weight:bold;">Message body?</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">GET</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Get a document from the server.</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">No</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">HEAD</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Get just the headers for a document from the server.</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">No</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">POST</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Send data to the server for processing.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font2">Yes</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">PUT</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Store the body of the request on the server.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font2">Yes</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">TRACE</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Trace the message through proxy servers to the server.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font2">No</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">OPTIONS</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Determine what methods can operate on a server.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font2">No</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">DELETE</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:24pt;"><span class="font2">Remove a document from the server.</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">No</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark571"></a><span class="font24">Not all servers implement all seven of the methods in </span><a href="#bookmark570"><span class="font24">Table 3-1</span></a><span class="font24">. Furthermore, because HTTP was designed to be easily extensible, other servers may implement their own request methods in addition to these. These additional methods are called </span><span class="font24" style="font-style:italic;">extension methods</span><span class="font24">, because they extend the HTTP specification.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark572"></a><span class="font5" style="font-weight:bold;"><a name="bookmark573"></a>Status codes</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As methods tell the server what to do, status codes tell the client what happened. Status codes live in the start lines of responses. For example, in the line “HTTP/1.0 200 OK,” the status code is 200.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark574"></a><span class="font24">When clients send request messages to an HTTP server, many things can happen. If you are fortunate, the request will complete successfully. You might not always be so lucky. The server may tell you that the resource you requested could not be found, that you don’t have permission to access the resource, or perhaps that the resource has mo<a name="bookmark575"></a>ved someplace else.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Status codes are returned in the start line of each response message. Both a numeric and a human-readable status are returned. The numeric code makes error processing easy for programs, while the reason phrase is easily understood by humans.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The different status codes are grouped into classes by their three-digit numeric codes. Status codes between 200 and 299 represent success. Codes between 300 and 399 indicate that the resource has been moved. Codes between 400 and 499 mean that the client did something wrong in the request. Codes between 500 and 599 mean something went awry on the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The status code classes are shown in</span><a href="#bookmark576"><span class="font24"> Table 3-2</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark576"></a><span class="font23" style="font-style:italic;">Table 3-2. Status code classes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Overall range</span></p></td><td style="vertical-align:top;">
<p style="text-indent:19pt;"><span class="font2" style="font-weight:bold;">Defined range</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2" style="font-weight:bold;">Category</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">100-199</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">100-101</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">Informational</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">200-299</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">200-206</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">Successful</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">300-399</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">300-305</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">Redirection</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">400-499</span></p></td><td style="vertical-align:top;">
<p style="text-indent:19pt;"><span class="font2">400-415</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">Client error</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">500-599</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">500-505</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">Server error</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Current versions of HTTP define only a few codes for each status category. As the protocol evolves, more status codes will be defined officially in the HTTP specification. If you receive a status code that you don’t recognize, chances are someone has defined it as an extension to the current protocol. You should treat it as a general member of the class whose range it falls into.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, if you receive status code 515 (which is outside of the defined range for 5XX codes listed in</span><a href="#bookmark576"><span class="font24"> Table 3-2)</span></a><span class="font24">, you should treat the response as indicating a server error, which is the general class of 5XX messages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark577"><span class="font24">Table 3-3 </span></a><a name="bookmark578"></a><span class="font24">lists some of the most common status codes that you will see. We will explain all the current HTTP status codes in detail later in this chapter.</span></p>
<table>
<tr><td>
<p><a name="bookmark577"></a><span class="font23" style="font-style:italic;">Table 3-3. Common status codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><a name="bookmark579"></a><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:18pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">200</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">OK</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:18pt;"><span class="font2">Success! Any requested data is in the response body.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">401</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">Unauthorized</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:18pt;"><span class="font2">You need to enter a username and password.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">404</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">Not Found</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:18pt;"><span class="font2">The server cannot find a resource for the requested URL.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font5" style="font-weight:bold;">Reason phrases</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark580"></a><span class="font24">The reason phrase is the last component of the start line of the response. It provides a textual explanation of the status code. For example, in the line “HTTP/1.0 200 OK,” the reason phrase is OK.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Reason phrases are paired one-to-one with status codes. The reason phrase provides a human-readable version of the status code that application developers can pass along to their users to indicate what happened during the request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">The HTTP specification does not provide any hard and fast rules for what reason phrases should look like. Later in this chapter, we list the status codes and some suggested reason phrases.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark581"></a><span class="font5" style="font-weight:bold;"><a name="bookmark582"></a>Version numbers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Version numbers appear in both request and response message start lines in the format HTTP/x.y. They provide a means for HTTP applications to tell each other what version of the protocol they conform to.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Version numbers are intended to provide applications speaking HTTP with a clue about each other’s capabilities and the format of the message. An HTTP Version 1.2 application communicating with an HTTP Version 1.1 application should know that it should not use any new 1.2 features, as they likely are not implemented by the application speaking the older version of the protocol.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The version number indicates the highest version of HTTP that an application supports. In some cases this leads to confusion between applications,<a name="footnote11"></a><sup><a href="#bookmark583">11</a></sup><sup></sup> because HTTP/1.0 applications interpret a response with HTTP/1.1 in it to indicate that the response is a 1.1 response, when in fact that’s just the level of protocol used by the responding application.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Note that version numbers are not treated as fractional numbers. Each number in the version (for example, the “1” and “0” in HTTP/1.0) is treated as a separate number. So, when comparing HTTP versions, each number must be compared separately in <a name="bookmark584"></a><a name="bookmark585"></a>order to determine which is the higher version. For example, HTTP/2.22 is a higher version than HTTP/2.3, because 22 is a larger number than 3.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark586"></a><span class="font7" style="font-weight:bold;"><a name="bookmark587"></a><a name="bookmark588"></a>Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark589"></a><span class="font24">The previous section focused on the first line of request and response messages (methods, status codes, reason phrases, and version numbers). Following the start line comes a list of zero, one, or many HTTP header fields (see </span><a href="#bookmark557"><span class="font24">Figure 3-5</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark590"></a><span class="font24"><a name="bookmark591"></a>HTTP header fields add additional information to request and response messages. They are basically just lists of name/value pairs. For example, the following header line assigns the value 19 to the Content-Length header field:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">Content-length: 19</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark592"></a><span class="font5" style="font-weight:bold;"><a name="bookmark593"></a><a name="bookmark594"></a>Header classifications</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark595"></a><span class="font24">The HTTP specification defines several header fields. Applications also are free to invent their own home-brewed headers. HTTP headers are classified into:</span></p>
<p style="text-align:justify;"><a name="bookmark596"></a><span class="font24" style="font-style:italic;">General headers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Can appear in both request and response messages</span></p>
<p><span class="font24" style="font-style:italic;">Request headers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Provide more informatio<a name="bookmark597"></a>n about the request</span></p>
<p><span class="font24" style="font-style:italic;">Response headers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Provide more information about the response</span></p>
<p><span class="font24" style="font-style:italic;">Entity headers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Describe body size and contents, or the resource itself</span></p>
<p><span class="font24" style="font-style:italic;">Extension headers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">New headers that are not defined in the specification</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark598"></a><span class="font24">Each HTTP header has a simple syntax: a name, followed by a colon (</span><span class="font4">:</span><span class="font24">), followed by optional whitespace, followed by the field value, followed by a CRLF.</span><a href="#bookmark599"><span class="font24"> Table 3-4 </span></a><span class="font24">lists some common header examples.</span></p>
<table>
<tr><td>
<p><a name="bookmark599"></a><span class="font23" style="font-style:italic;">Table 3-4. Common header examples</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header example</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Date: Tue, 3 Oct 1997 02:16:03 GMT</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font2">The date the server generated the response</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Content-length: 15040</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font2">The entity body contains 15,040 bytes of data</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Content-type: image/gif</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font2">The entity body is a GIF image</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept: image/gif, image/jpeg, text/html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:27pt;"><span class="font2">The client accepts GIF and JPEG images and HTML</span></p></td></tr>
</table></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark600"></a><span class="font5" style="font-weight:bold;"><a name="bookmark601"></a>Header continuation lines</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Long header lines can be made more readable by breaking them into multiple lines, preceding each extra line with at least one space or tab character.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">For example:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.0 200 OK</span></p>
<p style="text-align:justify;text-indent:19pt;"><a name="bookmark602"></a><span class="font3">Content-Type: image/gif</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Length: 8572</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Test Server</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Version 1.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In this example, the response message contains a Server header whose value is broken into continuation lines. The complete value of the header is “Test Server Version 1.0”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark603"></a><span class="font24">We’ll briefly describe all the HTTP headers later in this chapter. We also provide a more detailed reference summary of all the headers in </span><a href="#bookmark248"><span class="font24">Appendix C</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark604"></a><span class="font7" style="font-weight:bold;"><a name="bookmark605"></a>Entity Bodies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The third part of an HTTP message is the optional entity body. Entity bodies are the payload of HTTP messages. They are the things that HTTP was designed to transport.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTP messages can carry many kinds of digital data: images, video, HTML documents, software applications, credit card transactions, electronic mail, and so on.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark606"></a><span class="font7" style="font-weight:bold;"><a name="bookmark607"></a>Version 0.9 Messages</span></h3>
<p style="text-align:justify;"><span class="font24">HTTP Version 0.9 was an early version of the HTTP protocol. It was the starting point for the request and response messages that HTTP has today, but with a far simpler protocol (see</span><a href="#bookmark608"><span class="font24"> Figure 3-6</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-58.jpg" alt="" style="width:106pt;height:47pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-59.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-60.jpg" alt="" style="width:31pt;height:28pt;"></td><td>
<p><span class="font3">GET /specials/saw-blade.gif</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-61.jpg" alt="" style="width:28pt;height:14pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">No version number</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-62.jpg" alt="" style="width:318pt;height:50pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<p><a name="bookmark608"></a><span class="font23" style="font-style:italic;">Figure 3-6. HTTP/0.9 transaction</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;"><span class="font24">HTTP/0.9 messages also consisted of requests and responses, but the request contained merely the </span><span class="font24" style="font-style:italic;">method</span><span class="font24"> and the </span><span class="font24" style="font-style:italic;">request URL</span><span class="font24">, and the response contained only the </span><span class="font24" style="font-style:italic;">entity</span><span class="font24">. No version information (it was the first and only version at the time), no status code or reason phrase, and no headers were included.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark609"></a><span class="font24"><a name="bookmark610"></a>However, this simplicity did not allow for much flexibility or the implementation of most of the HTTP features and applications described in this book. We briefly describe it here because there are still clients, servers, and other applications that use it, and application writers should be aware of its limitations.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark611"></a><span class="font9" style="font-weight:bold;"><a name="bookmark27"></a><a name="bookmark612"></a>Methods</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s talk in more detail about some of the basic HTTP methods, listed earlier in </span><a href="#bookmark570"><span class="font24">Table 3-1</span></a><span class="font24">. Note that not all methods are implemented by every server. To be compliant with HTTP Version 1.1, a server need implement only the GET and HEAD methods for its resources.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Even when servers do implement all of these methods, the methods most likely have restricted uses. For example, servers that support DELETE or PUT (described later in this section) would not want just anyone to be able to delete or store resources. These restrictions generally are set up in the server’s configuration, so they vary from site to site and from server to server.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark613"></a><span class="font7" style="font-weight:bold;"><a name="bookmark614"></a>Safe Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP defines a set of methods that are called </span><span class="font24" style="font-style:italic;">safe</span><span class="font24"> methods. The GET and HEAD methods are said to be safe, meaning that no action should occur as a result of an HTTP request that uses either the GET or HEAD method.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark615"></a><span class="font24">By no action, we mean that nothing will happen on the server as a result of the HTTP request. For example, consider when you are shopping online at Joe’s Hardware and you click on the “submit purchase” button. Clicking on the button submits a POST request (discussed later) with your credit card information, and an action is performed on the server on your behalf. In this case, the action is your credit card being charged for your purchase.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There is no guarantee that a safe method won’t cause an action to be performed (in practice, that is up to the web developers). Safe methods are meant to allow HTTP application developers to let users know when an unsafe method that may cause some action to be performed is being used. In our Joe’s Hardware example, your web browser may pop up a warning message letting you know that you are making a request with an unsafe method and that, as a result, something might happen on the server (e.g., your credit card being charged).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark616"></a><span class="font7" style="font-weight:bold;"><a name="bookmark617"></a>GET</span></h3>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">GET is the most common method. It usually is used to ask a server to send a resource. HTTP/1.1 requires servers to implement this method.</span><a href="#bookmark618"><span class="font24"> Figure 3-7</span></a><span class="font24"> shows an example of a client making an HTTP request with the GET method.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Request message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET /seasonal/index-fall.html HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><a name="bookmark619"></a><span class="font2">Accept: *</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-63.jpg" alt="" style="width:39pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-Type: text/html</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">Context-Length: 617</span></p>
<p><span class="font2">&lt;HTML&gt;</span></p>
<p><span class="font2">&lt;HEAD&gt;&lt;TITLE&gt;Joe’s Special Offers &lt;/TITLE&gt;</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-64.jpg" alt="" style="width:34pt;height:46pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark618"></a><span class="font23" style="font-style:italic;">Figure 3-7. GET example</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark620"></a><span class="font7" style="font-weight:bold;"><a name="bookmark621"></a>HEAD</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HEAD method behaves exactly like the GET method, but the server returns only the headers in the response. No entity body is ever returned. This allows a client to inspect the headers for a resource without having to actually get the resource. Using HEAD, you can:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Find out about a resource (e.g., determine its type) without getting it.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• See if an object exists, by looking at the status code of the response.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Test if the resource has been modified, by looking at the headers.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark622"></a><span class="font24">Server developers must ensure that the headers returned are exactly those that a GET request would return. The HEAD method also is required for HTTP/1.1 compliance. </span><a href="#bookmark623"><span class="font24">Figure 3-8 </span></a><span class="font24">shows the HEAD method in action.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Request message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HEAD /seasonal/index-fall.html HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-65.jpg" alt="" style="width:39pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Response message</span></p>
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-Type: text/html</span></p>
<p><span class="font2">Context-Length: 617</span></p></td><td><img src="book_files/book-66.jpg" alt="" style="width:43pt;height:50pt;"></td></tr>
<tr><td colspan="2">
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<p><span class="font1" style="font-style:italic;">no entity body</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-67.jpg" alt="" style="width:27pt;height:15pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark623"></a><span class="font23" style="font-style:italic;">Figure 3-8. HEAD example</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark624"></a><span class="font7" style="font-weight:bold;"><a name="bookmark625"></a>PUT</span></h3>
<p><span class="font24">The PUT method writes documents to a server, in the inverse of the way that GET reads documents from a server. Some publishing systems let you create web pages and install them directly on a web server using PUT (see</span><a href="#bookmark626"><span class="font24"> Figure 3-9</span></a><span class="font24">).</span></p>
</div><br clear="all">
<p style="text-indent:48pt;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p style="padding:0pt 0pt 4pt 51pt;"><span class="font2">PUT /product-list.txt HTTP/1.1 Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a><span class="font2"> Content-type: text/plain Content-length: 34</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-68.jpg" alt="" style="width:133pt;height:51pt;"></td></tr>
<tr><td>
<p style="padding:0pt 0pt 0pt 70pt;"><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a><span class="font2" style="font-weight:bold;font-style:italic;"> </span><span class="font1" style="font-style:italic;">Server updates/creates resource “/product-list.txt” and writes it to its disk.</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 38pt 51pt;"><span class="font2">Updated product list coming soon</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Joe</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<p style="padding:4pt 0pt 0pt 62pt;"><span class="font2">HTTP/1.1 201 Created</span></p>
<p style="padding:0pt 0pt 0pt 62pt;"><span class="font2">Location: </span><a href="http://www.joes-hardware.com/product-list.txt"><span class="font2">http://www.joes-hardware.com/product-list.txt</span></a></p>
<p style="padding:0pt 0pt 0pt 62pt;"><span class="font2">Content-Type: text/plain</span></p>
<p style="padding:0pt 0pt 4pt 62pt;"><span class="font2">Context-Length: 47</span></p>
<p style="padding:0pt 0pt 15pt 62pt;"><a href="http://www.joes-hardware.com/product-list.txt"><span class="font2">http://www.joes-hardware.com/product-list.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark626"></a><span class="font23" style="font-style:italic;"><a name="bookmark627"></a>Figure 3-9. PUT example</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The semantics of the PUT method are for the server to take the body of the request and either use it to create a new document named by the requested URL or, if that URL already exists, use the body to replace it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark628"></a><span class="font24">Because PUT allows you to change content, many web servers require you to log in with a password before you can perform a PUT. You can read more about password authentication in </span><a href="#bookmark236"><span class="font24">Chapter 12</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark629"></a><span class="font7" style="font-weight:bold;"><a name="bookmark630"></a>POST</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The POST method was designed to send input data to the server.<sup>*</sup> In practice, it is often used to support HTML forms. The data from a filled-in form typically is sent to the server, which then marshals it off to where it needs to go (e.g., to a server gateway program, which then processes it). </span><a href="#bookmark631"><span class="font24">Figure 3-10 </span></a><span class="font24">shows a client making an HTTP request—sending form data to a server—with the POST method.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark632"></a><span class="font7" style="font-weight:bold;"><a name="bookmark633"></a>TRACE</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When a client makes a request, that request may have to travel through firewalls, proxies, gateways, or other applications. Each of these has the opportunity to modify the original HTTP request. The TRACE method allows clients to see how its request looks when it finally makes it to the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 34pt 0pt;"><span class="font24">A TRACE request initiates a “loopback” diagnostic at the destination server. The server at the final leg of the trip bounces back a TRACE response, with the virgin</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font20">* POST is used to send data to a server. PUT is used to deposit data into a resource on the server (e.g., a file).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-69.jpg" alt="" style="width:123pt;height:69pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Browser sticks data in entity body of message</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-style:italic;">Request message</span></p>
<p><span class="font2">POST /inventory-check.cgi HTTP/1.1 Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a><span class="font2"> Content-type: text/plain</span></p>
<p><span class="font2">Content-length: 18 item=bandsaw 2647</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-70.jpg" alt="" style="width:103pt;height:62pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-71.jpg" alt="" style="width:31pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-72.jpg" alt="" style="width:119pt;height:120pt;"></td></tr>
<tr><td>
<p><span class="font3" style="font-weight:bold;">CG</span><span class="font3" style="font-weight:bold;text-decoration:underline;">I pr</span><span class="font3" style="font-weight:bold;">o</span><span class="font3" style="font-weight:bold;text-decoration:underline;">gra</span><span class="font3" style="font-weight:bold;">m</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-73.jpg" alt="" style="width:67pt;height:44pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.1 20o OK</span></p>
<p><span class="font2">Content-type: text/plain</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">Context-length: 37</span></p>
<p><span class="font2">The bandsaw model 2647 is in stock!</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">“item= bandsaw 2647</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-74.jpg" alt="" style="width:18pt;height:17pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Inventory check</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-75.jpg" alt="" style="width:18pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Inventory list</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark631"></a><span class="font23" style="font-style:italic;">Figure 3-10. POST example</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">request message it received in the body of its response. A client can then see how, or if, its original message was munged or modified along the request/response chain of any intervening HTTP applications (see </span><a href="#bookmark634"><span class="font24">Figure 3-11</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The TRACE method is used primarily for diagnostics; i.e., verifying that requests are going through the request/response chain as intended. It’s also a good tool for seeing the effects of proxies and other applications on your requests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">As good as TRACE is for diagnostics, it does have the drawback of assuming that intervening applications will treat different types of requests (different methods— GET, HEAD, POST, etc.) the same. Many HTTP applications do different things depending on the method—for example, a proxy might pass a POST request directly to the server but attempt to send a GET request to another HTTP application (such as a web cache). TRACE does not provide a mechanism to distinguish methods. Generally, intervening applications make the call as to how they process a TRACE request.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p><span class="font2">TRACE /product-list.txt HTTP/1.1</span></p>
<p><span class="font2">Accept: *</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">TRACE /product-list.txt HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
<p><span class="font2">Via: 1.1 proxy3.company.com</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-76.jpg" alt="" style="width:46pt;height:48pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-77.jpg" alt="" style="width:60pt;height:55pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-78.jpg" alt="" style="width:72pt;height:46pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-type: text/plain</span></p>
<p><span class="font2">Content-length: 96</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">Via: 1.1 proxy3.company.com</span></p>
<p><a name="bookmark635"></a><span class="font2">TRACE /product-list.txt HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
<p><span class="font2">Via: 1.1 proxy3.company.com</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-type: text/plain</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">Content-length: 96</span></p>
<p><span class="font2">TRACE /product-list.txt HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
<p><span class="font2">Via: 1.1 proxy3.company.com</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font1" style="font-style:italic;">Examining the entity, the client can see that its request was upgraded to protocol Version 1.1. Along with the upgrade came a few additional request headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark634"></a><span class="font23" style="font-style:italic;">Figure 3-11. TRACE example</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">No entity body can be sent with a TRACE request. The entity body of the TRACE response contains, verbatim, the request that the responding server received.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark636"></a><span class="font7" style="font-weight:bold;"><a name="bookmark637"></a>OPTIONS</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The OPTIONS method asks the server to tell us about the various supported capabilities of the web server. You can ask a server about what methods it supports in general or for particular resources. (Some servers may support particular operations only on particular kinds of objects).</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><span class="font24">This provides a means for client applications to determine how best to access various resources without actually having to access them.</span><a href="#bookmark638"><span class="font24"> Figure 3-12 </span></a><span class="font24">shows a request scenario using the OPTIONS method.</span></p>
<p style="padding:0pt 0pt 4pt 60pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<div style="border-right:solid;display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">OPTIONS * HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
</div><br clear="all">
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-79.jpg" alt="" style="width:49pt;height:54pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Since the request is for options on all resources, the server just returns the methods it supports for its resources.</span></p></td></tr>
<tr><td colspan="2">
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-80.jpg" alt="" style="width:59pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<p style="text-indent:22pt;padding:4pt 0pt 0pt 0pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="padding:0pt 0pt 15pt 105pt;"><span class="font2">Allow: GET, POST, PUT, OPTIONS Context-length: 0</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark638"></a><span class="font23" style="font-style:italic;">Figure 3-12. OPTIONS example</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark639"></a><span class="font7" style="font-weight:bold;"><a name="bookmark640"></a><a name="bookmark641"></a>DELETE</span></h3>
<p style="text-align:justify;padding:0pt 0pt 16pt 0pt;"><a name="bookmark642"></a><span class="font24">The DELETE method does just what you would think—it asks the server to delete the resources specified by the request URL. However, the client application is not guaranteed that the delete is carried out. This is because the HTTP specification allows the server to override the request without telling the client.</span><a href="#bookmark643"><span class="font24"> Figure 3-13 </span></a><span class="font24">shows an example of the DELETE method.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 54pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<div style="border-bottom:solid;display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">DELETE /product-list.txt HTTP/1.1 Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Response message</span></p></td><td><img src="book_files/book-81.jpg" alt="" style="width:171pt;height:51pt;"></td></tr>
<tr><td colspan="2">
<p style="text-align:right;"><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a><span class="font2" style="font-weight:bold;font-style:italic;"> </span><span class="font1" style="font-style:italic;">File “product-list.txt removed from server’s disk</span></p></td></tr>
</table>
</div><br clear="all">
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-82.jpg" alt="" style="width:58pt;height:71pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Client thinks resource was deleted</span></p></td></tr>
</table>
</div>
<p style="text-indent:38pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;text-indent:38pt;"><span class="font2">Content-Type: text/plain</span></p>
<p style="text-indent:38pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Content-Length: 54</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 38pt;"><span class="font2">I have your delete request, will take time to process.</span></p>
<p style="padding:0pt 0pt 16pt 0pt;"><a name="bookmark643"></a><span class="font23" style="font-style:italic;">Figure 3-13. DELETE example</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark644"></a><span class="font7" style="font-weight:bold;"><a name="bookmark645"></a>Extension Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">HTTP was designed to be field-extensible, so new features wouldn’t cause older software to fail. Extension methods are methods that are not defined in the HTTP/1.1 specification. They provide developers with a means of extending the capabilities of the HTTP services their servers implement on the resources that the servers manage. Some common examples of extension methods are listed in </span><a href="#bookmark646"><span class="font24">Table 3-5</span></a><span class="font24">. These methods are all part of the WebDAV HTTP extension (see</span><a href="#bookmark243"><span class="font24"> Chapter 19</span></a><span class="font24">) that helps support publishing of web content to web servers over HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark646"></a><span class="font23" style="font-style:italic;">Table 3-5. Example web publishing extension methods</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Method Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">LOCK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allows a user to “lock” a resource—for example, you could lock a resource while you are editing itto prevent</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 54pt;"><span class="font2">others from editing it at the same time</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">MKCOL &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allows a user to create a resource</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">COPY Facilitates copying resources on a server</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 9pt 0pt;"><span class="font2">MOVE &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Moves a resource on a server</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">It’s important to note that not all extension methods are defined in a formal specification. If you define an extension method, it’s likely not to be understood by most HTTP applications. Likewise, it’s possible that your HTTP applications could run into extension methods being used by other applications that it does not understand.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark307"></a><span class="font24"><a name="bookmark647"></a><a name="bookmark648"></a><a name="bookmark649"></a><a name="bookmark650"></a>In these cases, it is best to be tolerant of extension methods. Proxies should try to relay messages with unknown methods through to downstream servers if they are capable of doing that without breaking end-to-end behavior. Otherwise, they should respond with a 501 Not Implemented status code. Dealing with extension methods (and HTTP extensions in general) is best done with the old rule, “be conservative in what you send, be liberal in what you accept.”</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark651"></a><span class="font9" style="font-weight:bold;"><a name="bookmark652"></a><a name="bookmark28"></a><a name="bookmark653"></a>Status Codes</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP status codes are classified into five broad categories, as shown earlier in </span><a href="#bookmark576"><span class="font24">Table 3-2</span></a><span class="font24">. This section summarizes the HTTP status codes for each of the five classes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The status codes provide an easy way for clients to understand the results of their transactions. In this section, we also list example reason phrases, though there is no real guidance on the exact text for reason phrases. We include the recommended reason phrases from the HTTP/1.1 specification.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark654"></a><span class="font7" style="font-weight:bold;"><a name="bookmark655"></a>100–199: Informational Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark656"></a><span class="font24">HTTP/1.1 introduced the informational status codes to the protocol. They are relatively new and subject to a bit of controversy about their complexity and perceived value. </span><a href="#bookmark657"><span class="font24">Table 3-6 </span></a><span class="font24">lists the defined informational status codes.</span></p>
<table>
<tr><td>
<p><a name="bookmark657"></a><span class="font23" style="font-style:italic;">Table 3-6. Informational status codes and reason phrases</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark658"></a><span class="font2">100</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Continue</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Indicates that an initial part of the request was received and the client should continue. After sending this, the server must respond after receiving the request. See the Expect header in </span><a href="#bookmark248"><span class="font2">Appendix C </span></a><span class="font2">for more information.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">101</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Switching Protocols</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Indicates that the server is changing protocols, as specified by the client, to one listed in the Upgrade header.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The 100 Continue status code, in particular, is a bit confusing. It’s intended to optimize the case where an HTTP client application has an entity body to send to a server but wants to check that the server will accept the entity before it sends it. We discuss it here in a bit more detail (how it interacts with clients, servers, and proxies) because it tends to confuse HTTP programmers.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark659"></a><span class="font5" style="font-weight:bold;"><a name="bookmark660"></a>Clients and 100 Continue</span></h4>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">If a client is sending an entity to a server and is willing to wait for a 100 Continue response before it sends the entity, the client needs to send an Expect request header (see </span><a href="#bookmark248"><span class="font24">Appendix C</span></a><span class="font24">) with the value 100-continue. If the client is not sending an entity, it shouldn’t send a 100-continue Expect header, because this will only confuse the server into thinking that the client might be sending an entity.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark661"></a><span class="font24">100-continue, in many ways, is an optimization. A client application should really use 100-continue only to avoid sending a server a large entity that the server will not be able to handle or use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because of the initial confusion around the 100 Continue status (and given some of the older implementations out there), clients that send an Expect header for 100-continue should not wait forever for the server to send a 100 Continue response. After some timeout, the client should just send the entity.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">In practice, client implementors also should be prepared to deal with unexpected 100 Continue responses (annoying, but true). Some errant HTTP applications send this code inappropriately.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark662"></a><span class="font5" style="font-weight:bold;"><a name="bookmark663"></a>Servers and 100 Continue</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">If a server receives a request with the Expect header and 100-continue value, it should respond with either the 100 Continue response or an error code (see</span><a href="#bookmark664"><span class="font24"> Table 3-9</span></a><span class="font24">). Servers should never send a 100 Continue status code to clients that do not send the 100-continue expectation. However, as we noted above, some errant servers do this.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark665"></a><span class="font24">If for some reason the server receives some (or all) of the entity before it has had a chance to send a 100 Continue response, it does not need to send this status code, because the client already has decided to continue. When the server is done reading the request, however, it still needs to send a final status code for the request (it can just skip the 100 Continue status).</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Finally, if a server receives a request with a 100-continue expectation and it decides to end the request before it has read the entity body (e.g., because an error has occurred), it should not just send a response and close the connection, as this can prevent the client from receiving the response (see</span><a href="#bookmark666"><span class="font24"> “TCP close and reset errors” in Chapter 4</span></a><span class="font24">).</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark667"></a><span class="font5" style="font-weight:bold;"><a name="bookmark668"></a>Proxies and 100 Continue</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark669"></a><span class="font24">A proxy that receives from a client a request that contains the 100-continue expectation needs to do a few things. If the proxy either knows that the next-hop server (discussed in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">) is HTTP/1.1-compliant or does not know what version the next-hop server is compliant with, it should forward the request with the Expect header in it. If it knows that the next-hop server is compliant with a version of HTTP earlier than 1.1, it should respond with the 417 Expectation Failed error.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">If a proxy decides to include an Expect header and 100-continue value in its request on behalf of a client that is compliant with HTTP/1.0 or earlier, it should not forward the 100 Continue response (if it receives one from the server) to the client, because the client won’t know what to make of it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">It can pay for proxies to maintain some state about next-hop servers and the versions of HTTP they support (at least for servers that have received recent requests), so they can better handle requests received with a 100-continue expectation.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark670"></a><span class="font7" style="font-weight:bold;"><a name="bookmark671"></a><a name="bookmark672"></a>200–299: Success Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">When clients make requests, the requests usually are successful. Servers have an array of status codes to indicate success, matched up with different types of requests. </span><a href="#bookmark673"><span class="font24">Table 3-7</span></a><span class="font24"> lists the defined success status codes.</span></p>
<table>
<tr><td>
<p><a name="bookmark673"></a><span class="font23" style="font-style:italic;">Table 3-7. Success status codes and reason phrases</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">200</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">OK</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font2">Request is okay, entity body contains requested resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">201</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Created</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 8pt;"><span class="font2">For requests that create server objects (e.g., PUT). The entity body of the response should contain the various URLs for referencing the created resource, with the Location header containing the most specific reference. See </span><a href="#bookmark674"><span class="font2">Table 3-21 </span></a><span class="font2">for more on the Location header.</span></p>
<p style="text-indent:8pt;"><span class="font2">The server must have created the object prior to sending this status code.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">202</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Accepted</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 8pt;"><span class="font2">The request was accepted, but the server has not yet performed any action with it. There are no guarantees that the server will complete the request; this just means that the request looked valid when accepted.</span></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">The server should include an entity body with a description indicating the status of the request and possibly an estimate for when it will be completed (or a pointer to where this information can be obtained).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">203</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Non-Authoritative Information</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 8pt;"><span class="font2">The information contained in the entity headers (see </span><a href="#bookmark675"><span class="font2">“Entity Headers”</span></a><span class="font2"> for more information on entity headers) came not from the origin server but from a copy of the resource. This could happen if an intermediary had a copy of a resource but could not or did not validate the meta-information (headers) it sent about the resource.</span></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">This response code is not required to be used; itisan option for applications that have a response that would be a 200 status if the entity headers had come from the origin server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark676"></a><span class="font2">204</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">No Content</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">The response message contains headers and a status line, but no entity body. Primarily used to update browsers without having them move to a new document (e.g., refreshing a form page).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">205</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Reset Content</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Another code primarily for browsers. Tells the browser to clear any HTML form elements on the current page.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">206</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Partial Content</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 8pt;"><span class="font2">A partial or </span><span class="font3" style="font-style:italic;">range</span><span class="font2"> request was successful. Later, we will see that clients can request part or a range of a document by using special headers—this status code indicates that the range request was successful. See</span><a href="#bookmark677"><span class="font2"> “Range Requests” in Chapter 15 </span></a><span class="font2">for more on the Range header.</span></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">A 206 response must include a Content-Range, Date, and either ETag or ContentLocation header.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark678"></a><span class="font7" style="font-weight:bold;"><a name="bookmark679"></a>300–399: Redirection Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The redirection status codes either tell clients to use alternate locations for the resources they’re interested in or provide an alternate response instead of the content. If a resource has moved, a redirection status code and an optional Location header can be sent to tell the client that the resource has moved and where it can now be found (see</span><a href="#bookmark680"><span class="font24"> Figure 3-14</span></a><span class="font24">). This allows browsers to go to the new location transparently, without bothering their human users.</span></p>
<div style="border-bottom:solid;display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p><span class="font2">GET /pet-products.txt HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a><span class="font2"> Accept: *</span></p>
</div><br clear="all">
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-83.jpg" alt="" style="width:50pt;height:44pt;">
</div>
<p style="text-indent:14pt;padding:34pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Response message</span></p>
<p style="text-indent:14pt;"><span class="font2">HTTP/1.1 301 OK</span></p>
<p style="padding:0pt 0pt 0pt 126pt;"><span class="font2">Location: </span><a href="http://www.gentle-grooming.com/"><span class="font2">http://www.gentle-grooming.com/</span></a></p>
<p style="padding:0pt 0pt 0pt 126pt;"><span class="font2">Content-length: 56</span></p>
<p style="padding:0pt 0pt 4pt 126pt;"><span class="font2">Content-type: text/plain</span></p>
<p style="padding:0pt 0pt 15pt 126pt;"><span class="font2">Please go to our partner site, </span><a href="http://www.gentle-grooming.com"><span class="font2">www.gentle-grooming.com</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 93pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 96pt;"><span class="font2">GET / HTTP/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 96pt;"><span class="font2">Host: </span><a href="http://www.gentle-grooming.com"><span class="font2">www.gentle-grooming.com</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 41pt 96pt;"><span class="font2">Accept: *</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-84.jpg" alt="" style="width:45pt;height:47pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-85.jpg" alt="" style="width:45pt;height:48pt;"></td></tr>
<tr><td>
<p><a href="http://www.gentle-grooming.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.gentle-grooming.com</span></a></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-86.jpg" alt="" style="width:112pt;height:173pt;">
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<p style="padding:4pt 0pt 0pt 51pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="padding:0pt 0pt 0pt 51pt;"><span class="font2">Content-type: text/html</span></p>
<p style="padding:0pt 0pt 122pt 51pt;"><span class="font2">Content-length: 3307</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark680"></a><span class="font23" style="font-style:italic;">Figure 3-14. Redirected request to new location</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Some of the redirection status codes can be used to validate an application’s local copy of a resource with the origin server. For example, an HTTP application can check if the local copy of its resource is still up-to-date or if the resource has been modified on the origin server. </span><a href="#bookmark681"><span class="font24">Figure 3-15</span></a><span class="font24"> shows an example of this. The client sends a special If-Modified-Since header saying to get the document only if it has been modified since October 1997. The document has not changed since this date, so the server replies with a 304 status code instead of the contents.</span></p>
<p style="text-indent:12pt;"><span class="font1" style="font-style:italic;">Client has previously requested copy of:</span></p>
<p style="text-indent:12pt;"><a href="http://www.joes-hardware.com/seasonal/index-fall.html"><span class="font1" style="font-style:italic;">http://www.joes-hardware.com/seasonal/index-fall.html</span></a></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-87.jpg" alt="" style="width:35pt;height:168pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-88.jpg" alt="" style="width:47pt;height:35pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request message</span></p></td></tr>
<tr><td><img src="book_files/book-89.jpg" alt="" style="width:255pt;height:97pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-90.jpg" alt="" style="width:47pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-91.jpg" alt="" style="width:150pt;height:78pt;"></td></tr>
<tr><td>
<p><a name="bookmark682"></a><span class="font1" style="font-style:italic;">Browser displays local copy, since the original has not changed since we last requested it.</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark681"></a><span class="font23" style="font-style:italic;">Figure 3-15. Request redirected to use local copy</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">In general, it’s good practice for responses to non-HEAD requests that include a redirection status code to include an entity with a description and links to the redirected URL(s)—see the first response message in</span><a href="#bookmark680"><span class="font24"> Figure 3-14</span></a><span class="font24">. </span><a href="#bookmark683"><span class="font24">Table 3-8 </span></a><span class="font24">lists the defined redirection status codes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark683"></a><span class="font23" style="font-style:italic;">Table 3-8. Redirection status codes and reason phrases</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">Status code Reason phrase Meaning</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">300</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">301</span></p>
</div>
<p style="padding:0pt 0pt 4pt 96pt;"><span class="font2">Multiple Choices Returned when a client has requested a URL that actually refers to multiple resources, such as a server hosting an English and French version of an HTML document. This code is returned along with a list of options; the user can then select which one he wants. See </span><a href="#bookmark241"><span class="font2">Chapter 17 </span></a><span class="font2">for more on clients negotiating when there are multiple versions. The server can include the preferred URL in the Location header.</span></p>
<p style="text-indent:27pt;"><span class="font2">Moved Permanently Used when the requested URL has been moved. The response should contain in the</span></p>
<p style="padding:0pt 0pt 4pt 124pt;"><span class="font2">Location header the URL where the resource now resides.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">302 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Found</span></p>
</div>
<p style="padding:0pt 0pt 7pt 41pt;"><span class="font2">Like the 301 status code; however, the client should use the URL given in the Location header to locate the resource temporarily. Future requests should use the old URL.</span></p>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 3-8. Redirection status codes and reason phrases (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">303</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">See Other</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Used to tell the client that the resource should be fetched using a different URL. This new URL is in the Location header of the response message. Its main purpose is to allow responses to POST requests to direct a client to a resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">304</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Not Modified</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Clients can make their requests conditional by the request headers they include. See </span><a href="#bookmark684"><span class="font2">Table 3-15</span></a><span class="font2"> for more on conditional headers. If a client makes a conditional request, such as a GET if the resource has not been changed recently, this code is used to indicate that the resource has not changed. Responses with this status code should not contain an entity body.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark685"></a><span class="font2">305</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Use Proxy</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Used to indicate that the resource must be accessed through a proxy; the location of the proxy is given in the Location header. It’s important that clients interpret this response relative to a specific resource and do not assume that this proxy should be used for all requests or even all requests to the server holding the requested resource. This could lead to broken behavior if the proxy mistakenly interfered with a request, and it poses a security hole.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">306</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">(Unused)</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Not currently used.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">307</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Temporary Redirect</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Like the 301 status code; however, the client should use the URL given in the Location header to locate the resource temporarily. Future requests should use the old URL.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">From </span><a href="#bookmark683"><span class="font24">Table 3-8</span></a><span class="font24">, you may have noticed a bit of overlap between the 302, 303, and 307 status codes. There is some nuance to how these status codes are used, most of which stems from differences in the ways that HTTP/1.0 and HTTP/1.1 applications treat these status codes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When an HTTP/1.0 client makes a POST request and receives a 302 redirect status code in response, it will follow the redirect URL in the Location header with a GET request to that URL (instead of making a POST request, as it did in the original request).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark686"></a><span class="font24">HTTP/1.0 servers expect HTTP/1.0 clients to do this—when an HTTP/1.0 server sends a 302 status code after receiving a POST request from an HTTP/1.0 client, the server expects that client to follow the redirect with a GET request to the redirected URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The confusion comes in with HTTP/1.1. The HTTP/1.1 specification uses the 303 status code to get this same behavior (servers send the 303 status code to redirect a client’s POST request to be followed with a GET request).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To get around the confusion, the HTTP/1.1 specification says to use the 307 status code in place of the 302 status code for temporary redirects to HTTP/1.1 clients. Servers can then save the 302 status code for use with HTTP/1.0 clients.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">What this all boils down to is that servers need to check a client’s HTTP version to properly select which redirect status code to send in a redirect response.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark687"></a><span class="font7" style="font-weight:bold;"><a name="bookmark688"></a><a name="bookmark689"></a><a name="bookmark690"></a>400–499: Client Error Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Sometimes a client sends something that a server just can’t handle, such as a badly formed request message or, most often, a request for a URL that does not exist.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We’ve all seen the infamous 404 Not Found error code while browsing—this is just the server telling us that we have requested a resource about which it knows nothing.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">Many of the client errors are dealt with by your browser, without it ever bothering you. A few, like 404, might still pass through.</span><a href="#bookmark664"><span class="font24"> Table 3-9 </span></a><span class="font24">shows the various client error status codes.</span></p>
<table>
<tr><td>
<p><a name="bookmark664"></a><span class="font23" style="font-style:italic;">Table 3-9. Client error status codes and reason phrases</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:12pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">400</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Bad Request</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Used to tell the client that it has sent a malformed request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">401</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Unauthorized</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Returned along with appropriate headers that ask the client to authenticate itself before it can gain access to the resource. See</span><a href="#bookmark691"><span class="font2"> Chapter 12</span></a><span class="font2"> for more on authentication.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">402</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Payment Required</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Currently this status code is not used, but it has been set aside for future use.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">403</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Forbidden</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Used to indicate that the request was refused by the server. If the server wants to indicate why the request was denied, it can include an entity body describing the reason. However, this code usually is used when the server does not want to reveal the reason for the refusal.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">404</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Not Found</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Used to indicate that the server cannot find the requested URL. Often, an entity is included for the client application to display to the user.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">405</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Method Not Allowed</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Used when a request is made with a method that is not supported for the requested URL. The Allow header should be included in the response to tell the client what methods are allowed on the requested resource. See </span><a href="#bookmark675"><span class="font2">“Entity Head</span></a><span class="font2"></span><a href="#bookmark675"><span class="font2">ers</span></a><span class="font2">” for more on the Allow header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">406</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Not Acceptable</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Clients can specify parameters about what types of entities they are willing to accept. This code is used when the server has no resource matching the URL that is acceptable for the client. Often, servers include headers that allow the client to figure out why the request could not be satisfied. See </span><a href="#bookmark241"><span class="font2">“Content Negotiation</span></a><span class="font2"> </span><a href="#bookmark241"><span class="font2">and Transcoding” in Chapter 17</span></a><span class="font2"> for more information.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">407</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Proxy Authentication Required</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Like the 401 status code, but used for proxy servers that require authentication for a resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">408</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Request Timeout</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">If a client takes too long to complete its request, a server can send back this status code and close down the connection. The length of this timeout varies from server to server but generally is long enough to accommodate any legitimate request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">409</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Conflict</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Used to indicate some conflict that the request may be causing on a resource. Servers might send this code when they fear that a request could cause a conflict. The response should contain a body describing the conflict.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">410</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Gone</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Similar to 404, except that the server once held the resource. Used mostly for web site maintenance, so a server’s administrator can notify clients when a resource has been removed.</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 3-9. Client error status codes and reason phrases (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">411</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Length Required</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when the server requires a Content-Length header in the request message. See </span><a href="#bookmark692"><span class="font2">“Content headers</span></a><span class="font2">” for more on the Content-Length header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">412</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Precondition Failed</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark693"></a><span class="font2">Used if a client makes a conditional request and one of the conditions fails. Conditional requests occur when a client includes an Expect header. See </span><a href="#bookmark694"><span class="font2">Appendix C</span></a><span class="font2"> for more on the Expect header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">413</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Request Entity Too Large</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when a client sends an entity body that is larger than the server can or wants to process.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">414</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Request URI Too Long</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when a client sends a request with a request URL that is larger than the server can or wants to process.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark695"></a><span class="font2">415</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Unsupported Media Type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when a client sends an entity of a content type that the server does not understand or support.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">416</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Requested Range Not</span></p>
<p style="text-indent:7pt;"><span class="font2">Satisfiable</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when the request message requested a range of a given resource and that range either was invalid or could not be met.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">417</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Expectation Failed</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used when the request contained an expectation in the Expect request header</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font2">that the server could not satisfy. See </span><a href="#bookmark694"><span class="font2">Appendix C</span></a><span class="font2"> for more on the Expect header. A proxy or other intermediary application can send this response code if it has unambiguous evidence that the origin server will generate a failed expectation for the request.</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark696"></a><span class="font7" style="font-weight:bold;"><a name="bookmark697"></a>500–599: Server Error Status Codes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Sometimes a client sends a valid request, but the server itself has an error. This could be a client running into a limitation of the server or an error in one of the server’s subcomponents, such as a gateway resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Proxies often run into problems when trying to talk to servers on a client’s behalf. Proxies issue 5XX server error status codes to describe the problem (</span><a href="#bookmark230"><span class="font24">Chapter 6 </span></a><span class="font24">covers this in detail). </span><a href="#bookmark698"><span class="font24">Table 3-10</span></a><span class="font24"> lists the defined server error status codes.</span></p>
<table>
<tr><td>
<p><a name="bookmark698"></a><span class="font23" style="font-style:italic;">Table 3-10. Server error status codes and reason phrases</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">500</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Internal Server Error</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">Used when the server encounters an error that prevents it from servicing the request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">501</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Not Implemented</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">Used when a client makes a request that is beyond the server’s capabilities (e.g., using a request method that the server does not support).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">502</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bad Gateway</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">Used when a server acting as a proxy or gateway encounters a bogus response from the next link in the request response chain (e.g., if it is unable to connect to its parent gateway).</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">503</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Service Unavailable</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">Used to indicate that the server currently cannot service the request but will be</span></p></td></tr>
</table></td></tr>
<tr><td>
<p style="text-align:justify;"><span class="font2">able to in the future. If the server knows when the resource will become available, it can include a Retry-After header in the response. See </span><a href="#bookmark699"><span class="font2">“Response Head</span></a><span class="font2"></span><a href="#bookmark699"><span class="font2">ers</span></a><span class="font2">” for more on the Retry-After header.</span></p></td></tr>
</table>
<table>
<tr><td>
<p><a name="bookmark700"></a><span class="font23" style="font-style:italic;"><a name="bookmark701"></a><a name="bookmark702"></a>Table 3-10. Server error status codes and reason phrases (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">504</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Gateway Timeout</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">Similar to status code 408, except that the response is coming from a gateway or proxy that has timed out waiting for a response to its request from another server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">505</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">HTTP Version Not Supported</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">Used when a server receives a request in a version of the protocol that it can’t or won’t support. Some server applications elect not to support older versions of the protocol.</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark703"></a><span class="font9" style="font-weight:bold;"><a name="bookmark704"></a><a name="bookmark29"></a><a name="bookmark705"></a>Headers</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark706"></a><span class="font24">Headers and methods work together to determine what clients and servers do. This section quickly sketches the purposes of the standard HTTP headers and some headers that are not explicitly defined in the HTTP/1.1 specification (RFC 2616). </span><a href="#bookmark248"><span class="font24">Appendix C</span></a><span class="font24"> summarizes all these headers in more detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">There are headers that are specific for each type of message and headers that are more general in purpose, providing information in both request and response messages. Headers fall into five main classes:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">General headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark707"></a><span class="font24">These are generic headers used by both clients and servers. They serve general purposes that are useful for clients, servers, and other applications to supply to one another. For example, the Date header is a general-purpose header that allows both sides to indicate the time and date at which the message was constructed:</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">Date: Tue, 3 Oct 1974 02:16:00 GMT</span></p>
<p><a name="bookmark708"></a><span class="font24" style="font-style:italic;">Request headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">As the name implies, request headers are specific to request messages. They provide extra information to servers, such as what type of data the client is willing to receive. For example, the following Accept header tells the server that the client will accept any media type that matches its request:</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">Accept: */*</span></p>
<p><span class="font24" style="font-style:italic;">Response headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Response messages have their own set of headers that provide information to the client (e.g., what type of server the client is talking to). For example, the following Server header tells the client that it is talking to a Version 1.0 Tiki-Hut server:</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">Server: Tiki-Hut/1.0</span></p>
<p><span class="font24" style="font-style:italic;">Entity headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Entity headers refer to headers that deal with the entity body. For instance, entity headers can tell the type of the data in the entity body. For example, the following Content-Type header lets the application know that the data is an HTML document in the iso-latin-1 character set:</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">Content-Type: text/html; charset=iso-latin-1</span></p>
<p style="text-align:justify;"><a name="bookmark709"></a><span class="font24" style="font-style:italic;"><a name="bookmark710"></a>Extension headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">Extension headers are nonstandard headers that have been created by application developers but not yet added to the sanctioned HTTP specification. HTTP programs need to tolerate and forward extension headers, even if they don’t know what the headers mean.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark711"></a><span class="font7" style="font-weight:bold;"><a name="bookmark712"></a>General Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some headers provide very basic information about a message. These headers are called general headers. They are the fence straddlers, supplying useful information about a message regardless of its type.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">For example, whether you are constructing a request message or a response message, the date and time the message is created means the same thing, so the header that provides this kind of information is general to both types of messages. </span><a href="#bookmark713"><span class="font24">Table 3-11 </span></a><span class="font24">lists the general informational headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark713"></a><span class="font23" style="font-style:italic;">Table 3-11. General informational headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark714"></a><span class="font2">Connection</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Allows clients and servers to specify options about the request/response connection</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Date<sup>a</sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Provides a date and time stamp telling when the message was created</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">MIME-Version</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Gives the version of MIME that the sender is using</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Trailer</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Lists the set of headers that are in the trailer of a message encoded with the chunked transfer encoding<sup>b</sup></span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Transfer-Encoding</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Tells the receiver what encoding was performed on the message in order for it to be transported safely</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Upgrade</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Gives a new version or protocol that the sender would like to “upgrade” to using</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Via</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Shows what intermediaries (proxies, gateways) the message has gone through</span></p></td></tr>
<tr><td colspan="2" style="vertical-align:bottom;">
<p><span class="font3"><sup>a</sup> </span><a href="#bookmark715"><span class="font3">Appendix C</span></a><span class="font3"> lists the acceptable date formats for the Date header.</span></p>
<p><a name="bookmark716"></a><span class="font3"><sup>b</sup> Chunked transfer codings are discussed further in </span><a href="#bookmark717"><span class="font3">“Chunking and persistent connections” in Chapter 15</span></a><span class="font3">.</span></p></td></tr>
</table></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark718"></a><span class="font5" style="font-weight:bold;"><a name="bookmark719"></a>General caching headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">HTTP/1.0 introduced the first headers that allowed HTTP applications to cache local copies of objects instead of always fetching them directly from the origin server. The latest version of HTTP has a very rich set of cache parameters. In</span><a href="#bookmark231"><span class="font24"> Chapter 7</span></a><span class="font24">, we cover caching in depth. </span><a href="#bookmark720"><span class="font24">Table 3-12</span></a><span class="font24"> lists the basic caching headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark720"></a><span class="font23" style="font-style:italic;">Table 3-12. General caching headers</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">Cache-Control Used to pass caching directions along with the message</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Pragma<sup>a</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Another way to pass directions along with the message, though not specific to caching</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 7pt;"><span class="font3"><sup>a</sup> Pragma technically is a request header. It was never specified for use in responses. Because of its common misuse as a response header, many clients and proxies will interpret Pragma as a response header, but the precise semantics are not well defined. In any case, Pragma is deprecated in favor of Cache-Control.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark721"></a><span class="font7" style="font-weight:bold;"><a name="bookmark722"></a><a name="bookmark723"></a><a name="bookmark724"></a>Request Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">Request headers are headers that make sense only in a request message. They give information about who or what is sending the request, where the request originated, or what the preferences and capabilities of the client are. Servers can use the information the request headers give them about the client to try to give the client a better response.</span><a href="#bookmark725"><span class="font24"> Table 3-13 </span></a><span class="font24">lists the request informational headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark725"></a><span class="font23" style="font-style:italic;">Table 3-13. Request informational headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Client-IP<sup>a</sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides the IP address of the machine on which the client is running</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">From</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides the email address of the client’s user<sup>b</sup></span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Host</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Gives the hostname and port of the server to which the request is being sent</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark726"></a><span class="font2">Referer</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides the URL of the document that contains the current request URI</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">UA-Color</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides information about the color capabilities of the client machine’s display</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark727"></a><span class="font2">UA-CPU<sup>c</sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Gives the type or manufacturer of the client’s CPU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">UA-Disp</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides information about the client’s display (screen) capabilities</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">UA-OS</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Gives the name and version of operating system running on the client machine</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">UA-Pixels</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Provides pixel information about the client machine’s display</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">User-Agent</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Tells the server the name of the application making the request</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;"><span class="font3"><sup>a</sup> Client-IP and the UA-* headers are not defined in RFC 2616 but are implemented by many HTTP client applications.</span></p>
<p style="text-align:justify;"><span class="font3"><sup>b</sup> An RFC 822 email address format.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 7pt;"><span class="font3"><sup>c</sup> While implemented by some clients, the UA-* headers can be considered harmful. Content, specifically HTML, should not be targeted at specific client configurations.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark728"></a><span class="font5" style="font-weight:bold;"><a name="bookmark729"></a>Accept headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">Accept headers give the client a way to tell servers their preferences and capabilities: what they want, what they can use, and, most importantly, what they don’t want. Servers can then use this extra information to make more intelligent decisions about what to send. Accept headers benefit both sides of the connection. Clients get what they want, and servers don’t waste their time and bandwidth sending something the client can’t use.</span><a href="#bookmark730"><span class="font24"> Table 3-14</span></a><span class="font24"> lists the various accept headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark730"></a><span class="font23" style="font-style:italic;">Table 3-14. Accept headers</span></p>
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">Tells the server what media types are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Charset</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">Tells the server what charsets are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Encoding</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">Tells the server what encodings are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Language</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">Tells the server what languages are okay to send</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TE<sup>a</sup></span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">Tells the server what extension transfer codings are okay to use</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> See </span><a href="#bookmark731"><span class="font3">“Transfer-Encoding Headers” in Chapter 15 </span></a><span class="font3">for more on the TE header.</span></p></td></tr>
</table>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark732"></a><span class="font5" style="font-weight:bold;"><a name="bookmark733"></a><a name="bookmark734"></a><a name="bookmark735"></a>Conditional request headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Sometimes, clients want to put some restrictions on a request. For instance, if the client already has a copy of a document, it might want to ask a server to send the document only if it is different from the copy the client already has. Using conditional request headers, clients can put such restrictions on requests, requiring the server to make sure that the conditions are true before satisfying the request. </span><a href="#bookmark684"><span class="font24">Table 3-15 </span></a><span class="font24">lists the various conditional request headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark684"></a><span class="font23" style="font-style:italic;">Table 3-15. Conditional request headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark736"></a><span class="font2">Expect</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows a client to list server behaviors that it requires for a request</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">If-Match</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gets the document if the entity tag matches the current entity tag for the document<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">If-Modified-Since</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Restricts the request unless the resource has been modified since the specified date</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">If-None-Match</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gets the document if the entity tags supplied do not match those of the current document</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">If-Range</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows a conditional request for a range of a document</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">If-Unmodified-Since</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Restricts the request unless the resource has </span><span class="font3" style="font-style:italic;">not</span><span class="font2"> been modified since the specified date</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Range</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Requests a specific range of a resource, if the server supports range requests<sup>b</sup></span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> See </span><a href="#bookmark231"><span class="font3">Chapter 7 </span></a><span class="font3">for more on entity tags. The tag is basically an identifier for a version of the resource. <sup>b</sup> See </span><a href="#bookmark677"><span class="font3">“Range Requests” in Chapter 15 </span></a><span class="font3">for more on the Range header.</span></p></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark737"></a><span class="font5" style="font-weight:bold;"><a name="bookmark738"></a>Request security headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">HTTP natively supports a simple challenge/response authentication scheme for requests. It attempts to make transactions slightly more secure by requiring clients to authenticate themselves before getting access to certain resources. We discuss this challenge/response scheme in</span><a href="#bookmark238"><span class="font24"> Chapter 14</span></a><span class="font24">, along with other security schemes that have been implemented on top of HTTP.</span><a href="#bookmark739"><span class="font24"> Table 3-16 </span></a><span class="font24">lists the request security headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark739"></a><span class="font23" style="font-style:italic;"><a name="bookmark740"></a>Table 3-16. Request security headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Authorization</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Contains the data the client is supplying to the server to authenticate itself</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cookie</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">Used by clients to pass a token to the server—not a true security header, but it does have security implications<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cookie2</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">Used to note the version of cookies a requestor supports; see </span><a href="#bookmark741"><span class="font2">“Version 1 (RFC 2965) Cookies” in</span></a><span class="font2"> </span><a href="#bookmark741"><span class="font2">Chapter11</span></a></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> The Cookie header is not defined in RFC 2616; it is discussed in detail in </span><a href="#bookmark235"><span class="font3">Chapter 11</span></a><span class="font3">.</span></p></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark742"></a><span class="font5" style="font-weight:bold;"><a name="bookmark743"></a>Proxy request headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">As proxies become increasingly common on the Internet, a few headers have been defined to help them function better. In</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">, we discuss these headers in detail. </span><a href="#bookmark744"><span class="font24">Table 3-17</span></a><span class="font24"> lists the proxy request headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark744"></a><span class="font23" style="font-style:italic;"><a name="bookmark745"></a><a name="bookmark746"></a>Table 3-17. Proxy request headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Max-Forwards</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The maximum number of times a request should be forwarded to another proxy or gateway on its way to the origin server—used with the TRACE method<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Proxy-Authorization</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Same as Authorization, but used when authenticating with a proxy</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Proxy-Connection</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Same as Connection, but used when establishing connections with a proxy</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> See </span><a href="#bookmark747"><span class="font3">“Max-Forwards” in Chapter 6</span></a><span class="font3">.</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark699"></a><span class="font7" style="font-weight:bold;"><a name="bookmark748"></a><a name="bookmark749"></a>Response Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Response messages have their own set of response headers. Response headers provide clients with extra information, such as who is sending the response, the capabilities of the responder, or even special instructions regarding the response. These headers help the client deal with the response and make better requests in the future. </span><a href="#bookmark750"><span class="font24">Table 3-18</span></a><span class="font24"> lists the response informational headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark750"></a><span class="font23" style="font-style:italic;">Table 3-18. Response informational headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark751"></a><span class="font2">Age</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">How old the response is<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Public<sup>b</sup></span></p></td><td style="vertical-align:top;">
<p style="text-indent:19pt;"><span class="font2">A list of request methods the server supports for its resources</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Retry-After</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">A date or time to try back, if a resource is unavailable</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Server</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The name and version of the server’s application software</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Title<sup>c</sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">For HTML documents, the title as given by the HTML document source</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Warning</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">A more detailed warning message than what is in the reason phrase</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;"><span class="font3"><sup>a</sup> Implies that the response has traveled through an intermediary, possibly from a proxy cache.</span></p>
<p style="text-align:justify;"><span class="font3"><sup>b</sup> The Public header is defined in RFC 2068 but does not appear in the latest HTTP definition (RFC 2616).</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font3"><sup>c</sup> The Title header is not defined in RFC 2616; see the original HTTP/1.0 draft definition (</span><a href="http://www.w3.org/Protocols/HTTP/HTTP2.html"><span class="font3" style="font-style:italic;">http://www.w3.org/Protocols/HTTP/HTTP2.html</span></a><span class="font3">).</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark752"></a><span class="font5" style="font-weight:bold;"><a name="bookmark753"></a>Negotiation headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">HTTP/1.1 provides servers and clients with the ability to negotiate for a resource if multiple representations are available—for instance, when there are both French and German translations of an HTML document on a server.</span><a href="#bookmark241"><span class="font24"> Chapter 17</span></a><span class="font24"> walks through negotiation in detail. Here are a few headers servers use to convey information about resources that are negotiable. </span><a href="#bookmark754"><span class="font24">Table 3-19</span></a><span class="font24"> lists the negotiation headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark754"></a><span class="font23" style="font-style:italic;">Table 3-19. Negotiation headers</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Accept-Ranges &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The type of ranges that a server will accept for this resource</span></p>
<p style="text-indent:7pt;"><span class="font2">Vary &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A list of other headers that the server looks at and that may cause the response to vary; i.e., a list of</span></p>
<p style="padding:0pt 0pt 4pt 76pt;"><span class="font2">headers the server looks at to pick which is the best version of a resource to send the client</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark755"></a><span class="font5" style="font-weight:bold;"><a name="bookmark756"></a><a name="bookmark757"></a>Response security headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark758"></a><span class="font24"><a name="bookmark759"></a>You’ve already seen the request security headers, which are basically the </span><span class="font24" style="font-style:italic;">response </span><span class="font24">side of HTTP’s challenge/response authentication scheme. We talk about security in detail in </span><a href="#bookmark238"><span class="font24">Chapter 14</span></a><span class="font24">. For now, here are the basic </span><span class="font24" style="font-style:italic;">challenge</span><span class="font24"> headers. </span><a href="#bookmark760"><span class="font24">Table 3-20</span></a><span class="font24"> lists the response security headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark760"></a><span class="font23" style="font-style:italic;"><a name="bookmark761"></a>Table 3-20. Response security headers</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-indent:7pt;"><span class="font2">Proxy-Authenticate &nbsp;&nbsp;&nbsp;&nbsp;A list of challenges for the client from the proxy</span></p>
<p style="text-indent:7pt;"><span class="font2">Set-Cookie &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not a true security header, but it has security implications; used to set a token on the client side that</span></p>
<p style="padding:0pt 0pt 4pt 76pt;"><span class="font2">the server can use to identify the client<sup>a</sup></span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">Set-Cookie2</span></p>
<p><span class="font2">WWW-Authenticate</span></p>
</div>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">Similar to Set-Cookie, RFC 2965 Cookie definition; see </span><a href="#bookmark741"><span class="font2">“Version 1 (RFC 2965) Cookies” in Chapter 11</span></a></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">A list of challenges for the client from the server</span></p>
<p style="padding:0pt 0pt 16pt 0pt;"><span class="font3"><sup>a</sup> Set-Cookie and Set-Cookie2 are extension headers that are also covered in</span><a href="#bookmark235"><span class="font3"> Chapter 11</span></a><span class="font3">.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark675"></a><span class="font7" style="font-weight:bold;"><a name="bookmark762"></a><a name="bookmark763"></a>Entity Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">There are many headers to describe the payload of HTTP messages. Because both request and response messages can contain entities, these headers can appear in either type of message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark764"></a><span class="font24">Entity headers provide a broad range of information about the entity and its content, from information about the type of the object to valid request methods that can be made on the resource. In general, entity headers tell the receiver of the message what it’s dealing with. </span><a href="#bookmark674"><span class="font24">Table 3-21 </span></a><span class="font24">lists the entity informational headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark674"></a><span class="font23" style="font-style:italic;">Table 3-21. Entity informational headers</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-indent:7pt;"><span class="font2">Allow &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists the request methods that can be performed on this entity</span></p>
<p style="text-indent:7pt;"><span class="font2">Location &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tells the client where the entity really is located; used in directing the receiver to a (possibly new)</span></p>
<p style="padding:0pt 0pt 16pt 73pt;"><span class="font2">location (URL) for the resource</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark765"></a><span class="font5" style="font-weight:bold;"><a name="bookmark766"></a>Content headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The content headers provide specific information about the content of the entity, revealing its type, size, and other information useful for processing it. For instance, a web browser can look at the content type returned and know how to display the object.</span><a href="#bookmark692"><span class="font24"> Table 3-22 </span></a><span class="font24">lists the various content headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark692"></a><span class="font23" style="font-style:italic;">Table 3-22. Content headers</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">Content-Base<sup>a</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The base URL for resolving relative URLs within the body</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Content-Encoding &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Any encoding that was performed on the body</span></p>
<table>
<tr><td>
<p><a name="bookmark767"></a><span class="font23" style="font-style:italic;">Table 3-22. Content headers (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-Language</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">The natural language that is best used to understand the body</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-Length</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">The length or size of the body</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-Location</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">Where the resource actually is located</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-MD5</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">An MD5 checksum of the body</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-Range</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">The range of bytes that this entity represents from the entire resource</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Content-Type</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">The type of object that this body is</span></p></td></tr>
</table></td></tr>
</table>
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font3"><sup>a</sup> The Content-Base header is not defined in RFC 2616.</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark768"></a><span class="font5" style="font-weight:bold;"><a name="bookmark769"></a>Entity caching headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark770"></a><span class="font24">The general caching headers provide directives about how or when to cache. The entity caching headers provide information about the entity being cached—for example, information needed to validate whether a cached copy of the resource is still valid and hints about how better to estimate when a cached resource may no longer be valid.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">In</span><a href="#bookmark231"><span class="font24"> Chapter 7</span></a><span class="font24">, we dive deep into the heart of caching HTTP requests and responses. We will see these headers again there. </span><a href="#bookmark771"><span class="font24">Table 3-23 </span></a><span class="font24">lists the entity caching headers.</span></p>
<table>
<tr><td>
<p><a name="bookmark771"></a><span class="font24">.</span><span class="font23" style="font-style:italic;">Table 3-23. Entity caching headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ETag</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">The entity tag associated with this entity<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Expires</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The date and time at which this entity will no longer be valid and will need to be fetched from the original source</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Last-Modified</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The last date and time when this entity changed</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark772"></a><span class="font3"><sup>a</sup> Entity tags are basically identifiers for a particular version of a resource.</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark773"></a><span class="font9" style="font-weight:bold;"><a name="bookmark30"></a><a name="bookmark774"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For more information, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/rfc2616/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/rfc2616/rfc2616.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol,” by R. Fielding, J. Gettys, J. Mogul, H.</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Frystyk, L. Mastinter, P. Leach, and T. Berners-Lee.</span></p>
<p><span class="font24" style="font-style:italic;">HTTP Pocket Reference</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Clintin Wong, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p><a href="http://www.w3.org/Protocols/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">The W3C architecture page for HTTP.</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark775"></a><span class="font7" style="font-weight:bold;"><a name="bookmark776"></a><a name="bookmark226"></a>CHAPTER 4</span></p></li></ul>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark31"></a><span class="font11" style="font-weight:bold;"><a name="bookmark777"></a>Conn<a name="bookmark778"></a>ection Management</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The HTTP specifications explain HTTP messages fairly well, but they don’t talk much about HTTP connections, the critical plumbing that HTTP messages flow through. If you’re a programmer writing HTTP applications, you need to understand the ins and outs of HTTP connections and how to use them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark779"></a><span class="font24"><a name="bookmark780"></a>HTTP connection management has been a bit of a black art, learned as much from experimentation and apprenticeship as from published literature. In this chapter, you’ll learn about:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• How HTTP uses TCP connections</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Delays, bottlenecks and clogs in TCP connections</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• HTTP optimizations, including parallel, keep-alive, and pipelined connections</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• Dos and don’ts for managing connections</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark781"></a><span class="font9" style="font-weight:bold;"><a name="bookmark32"></a><a name="bookmark782"></a>TCP Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Just about all of the world’s HTTP communication is carried over TCP/IP, a popular layered set of packet-switched network protocols spoken by computers and network devices around the globe. A client application can open a TCP/IP connection to a server application, running just about anywhere in the world. Once the connection is established, messages exchanged between the client’s and server’s computers will never be lost, damaged, or received out of order.<a name="footnote12"></a><sup><a href="#bookmark783">12</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Say you want the latest power tools price list from Joe’s Hardware store:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><a href="http://www.joes-hardware.com:80/power-tools.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com:80/power-tools.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When given this URL, your browser performs the steps shown in </span><a href="#bookmark784"><span class="font24">Figure 4-1</span></a><span class="font24">. In Steps 1–3, the IP address and port number of the server are pulled from the URL. A TCP</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font24">connection is made to the web server in Step 4, and a request message is sent across the connection in Step 5. The response is read in Step 6, and the connection is closed in Step 7.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-indent:29pt;padding:0pt 0pt 14pt 0pt;"><a href="http://www.joes-hardware.com:80/power-tools.html"><span class="font4">http://www.joes-hardware.com:80/power-tools.html</span></a></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-weight:bold;">(1)</span><span class="font0"> The browser extracts the hostname &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardware.com"><span class="font4">www.joes-hardware.com</span></a></p></li>
<li>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-weight:bold;">(2)</span><span class="font0"> The browser looks up the IP address for this hostname (DNS) </span><span class="font4">202.43.78.3</span></p></li>
<li>
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-weight:bold;">(3)</span><span class="font0"> The browser gets the port number (80) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font4">80</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-92.jpg" alt="" style="width:39pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(4)</span><span class="font0"> The browser makes a TCP connection to 202.43.78.3 port 80</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-93.jpg" alt="" style="width:54pt;height:29pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">(202.43.78.3)</span></p></td></tr>
<tr><td><img src="book_files/book-94.jpg" alt="" style="width:137pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(5)</span><span class="font0"> The browser sends an HTTP GET request message to the server</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-95.jpg" alt="" style="width:32pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-96.jpg" alt="" style="width:28pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-97.jpg" alt="" style="width:135pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><a name="bookmark785"></a><span class="font1" style="font-weight:bold;">(6)</span><span class="font0"> The browser reads the HTTP response message from the server</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-98.jpg" alt="" style="width:28pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><a name="bookmark786"></a><span class="font1" style="font-weight:bold;">(7)</span><span class="font0"> The browser closes the connection</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-99.jpg" alt="" style="width:32pt;height:29pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark784"></a><span class="font23" style="font-style:italic;">Figure 4-1. Web browsers talk to web servers over TCP connections</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark787"></a><span class="font7" style="font-weight:bold;"><a name="bookmark788"></a>TCP Reliable Data Pipes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP connections really are nothing more than TCP connections, plus a few rules about how to use them. TCP connections are the reliable connections of the Internet. To send data accurately and quickly, you need to know the basics of TCP.<a name="footnote13"></a><sup><a href="#bookmark789">13</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">TCP gives HTTP a </span><span class="font24" style="font-style:italic;">reliable bit pipe</span><span class="font24">. Bytes stuffed in one side of a TCP connection come out the other side correctly, and in the right order (see </span><a href="#bookmark790"><span class="font24">Figure 4-2</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3" style="font-weight:bold;">lmth.xedni/ TEG</span></p></td><td><img src="book_files/book-100.jpg" alt="" style="width:43pt;height:38pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><a name="bookmark791"></a><span class="font1" style="font-weight:bold;"><a name="bookmark792"></a>Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-101.jpg" alt="" style="width:57pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark790"></a><span class="font23" style="font-style:italic;"><a name="bookmark793"></a>Figure 4-2. TCP carries HTTP data in order, and without corruption</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark794"></a><span class="font7" style="font-weight:bold;"><a name="bookmark795"></a>TCP Streams Are Segmented and Shipped by IP Packets</span></h3>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">TCP sends its data in little chunks called </span><span class="font24" style="font-style:italic;">IP packets</span><span class="font24"> (or </span><span class="font24" style="font-style:italic;">IP datagrams</span><span class="font24">). In this way, HTTP is the top layer in a “protocol stack” of “HTTP over TCP over IP,” as depicted in </span><a href="#bookmark796"><span class="font24">Figure 4-3</span></a><span class="font24">a. A secure variant, HTTPS, inserts a cryptographic encryption layer (called TLS or SSL) between HTTP and TCP (</span><a href="#bookmark796"><span class="font24">Figure 4-3</span></a><span class="font24">b).</span></p>
<table>
<tr><td>
<table border="1">
<tr><td colspan="3" style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td></tr>
<tr><td colspan="3" style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 229pt;"><span class="font2">HTTP</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">HTTP</span></p></td><td style="vertical-align:middle;">
<p><a name="bookmark797"></a><span class="font1" style="font-style:italic;">Application layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:31pt;"><span class="font2">TSL or SSL</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Security layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:39pt;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:39pt;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:18pt;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">HTTP</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-indent:31pt;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">HTTPS</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark796"></a><span class="font23" style="font-style:italic;">Figure 4-3. HTTP and HTTPS network protocol stacks</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When HTTP wants to transmit a message, it streams the contents of the message data, in order, through an open TCP connection. TCP takes the stream of data, chops up the data stream into chunks called segments, and transports the segments across the Internet inside envelopes called IP packets (see</span><a href="#bookmark798"><span class="font24"> Figure 4-4</span></a><span class="font24">). This is all handled by the TCP/IP software; the HTTP programmer sees none of it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Each TCP segment is carried by an IP packet from one IP address to another IP address. Each of these IP packets contains:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• An IP packet header (usually 20 bytes)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A TCP segment header (usually 20 bytes)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A chunk of TCP data (0 or more bytes)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The IP header contains the source and destination IP addresses, the size, and other flags. The TCP segment header contains TCP port numbers, TCP control flags, and numeric values used for data ordering and integrity checking.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">TCP segment #3</span></p></td></tr>
<tr><td><img src="book_files/book-102.jpg" alt="" style="width:236pt;height:76pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p><span class="font0">Version</span></p>
<p style="text-align:center;"><span class="font0">Hdr length (words)</span></p>
<p style="text-align:center;"><span class="font0">Type of service (TOS)</span></p>
<p style="text-align:center;"><span class="font0">Packet ID (16-bit number)</span></p>
<p style="text-align:center;"><span class="font0">Total datagram length (bytes)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-103.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Flags</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Fragmentation offset</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">Time to live (TTL)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Upper-level protocol</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Header checksum</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 209pt;"><span class="font0">Source IP address</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Destination IP address</span></p></td></tr>
<tr><td><img src="book_files/book-104.jpg" alt="" style="width:224pt;height:126pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-105.jpg" alt="" style="width:7pt;height:12pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-106.jpg" alt="" style="width:15pt;height:115pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-107.jpg" alt="" style="width:14pt;height:60pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-108.jpg" alt="" style="width:15pt;height:60pt;">
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark798"></a><span class="font23" style="font-style:italic;"><a name="bookmark799"></a><a name="bookmark800"></a><a name="bookmark801"></a>Figure 4-4. IP packets carry TCP segments, which carry chunks of the TCP data stream</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark802"></a><span class="font7" style="font-weight:bold;"><a name="bookmark803"></a>Keeping TCP Connections Straight</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A computer might have several TCP connections open at any one time. TCP keeps all these connections straight through </span><span class="font24" style="font-style:italic;">port numbers</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Port numbers are like employees’ phone extensions. Just as a company’s main phone number gets you to the front desk and the extension gets you to the right employee, the IP address gets you to the right computer and the port number gets you to the right application. A TCP connection is distinguished by four values:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;source-IP-address, source-port, destination-IP-address, destination-port&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Together, these four values uniquely define a connection. Two different TCP connections are not allowed to have the same values for all four address components (but different connections can have the same values for some of the components).</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">In</span><a href="#bookmark804"><span class="font24"> Figure 4-5</span></a><span class="font24">, there are four connections: A, B, C and D. The relevant information for each port is listed in </span><a href="#bookmark805"><span class="font24">Table 4-1</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-109.jpg" alt="" style="width:31pt;height:40pt;"></td></tr>
<tr><td>
<p><span class="font0">204.62.128.58</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-110.jpg" alt="" style="width:31pt;height:40pt;"></td></tr>
<tr><td>
<p><span class="font0">207.25.71.25</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-111.jpg" alt="" style="width:240pt;height:65pt;"></td></tr>
<tr><td>
<p><span class="font0">209.1.32.34</span></p>
<p><span class="font0">209.1.32.35</span></p>
<p><a name="bookmark806"></a><span class="font0">209.1.33.89</span></p></td></tr>
</table>
</div><br clear="all">
<table>
<tr><td>
<p><a name="bookmark805"></a><span class="font23" style="font-style:italic;">Table 4-1. TCP connection values</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Connection</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Source IP address</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Source port</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Destination IP address</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">Destination port</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">A</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">209.1.32.34</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">2034</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">204.62.128.58</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">4133</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">B</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">209.1.32.35</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">3227</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">204.62.128.58</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">4140</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">C</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">209.1.32.35</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">3105</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">207.25.71.25</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">80</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">D</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">209.1.33.89</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">5100</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">207.25.71.25</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">80</span></p></td></tr>
</table></td></tr>
</table>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark804"></a><span class="font23" style="font-style:italic;">Figure 4-5. Four distinct TCP connections</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Note that some of the connections share the same destination port number (C and D both have destination port 80). Some of the connections have the same source IP address (B and C). Some have the same destination IP address<a name="bookmark807"></a> (A and B, and C and D). But no two different connections share all four identical values.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark808"></a><span class="font7" style="font-weight:bold;"><a name="bookmark809"></a>Programming with TCP Sockets</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Operating systems provide different facilities for manipulating their TCP connections. Let’s take a quick look at one TCP programming interface, to make things concrete. </span><a href="#bookmark810"><span class="font24">Table 4-2 </span></a><span class="font24">shows some of the primary interfaces provided by the sockets API. This sockets API hides all the details of TCP and IP from the HTTP programmer. The sockets API was first developed for the Unix operating system, but variants are now available for almost every operating system and language.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark810"></a><span class="font23" style="font-style:italic;">Table 4-2. Common socket interface functions for programming TCP connections</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">Sockets API call</span></p>
<p><span class="font2">s = socket(&lt;parameters&gt;) bind(s, &lt;local IP:port&gt;)</span></p>
</div>
<p style="text-indent:46pt;padding:0pt 0pt 5pt 0pt;"><span class="font2" style="font-weight:bold;">Description</span></p>
<p style="text-indent:46pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Creates a new, unnamed, unattached socket.</span></p>
<p style="text-indent:46pt;padding:0pt 0pt 10pt 0pt;"><span class="font2">Assigns a local port number and interface to the socket.</span></p>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 4-2. Common socket interface functions for programming TCP connections (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Sockets API call</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><a name="bookmark811"></a><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">connect(s, &lt;remote IP:port&gt;) listen(s,...)</span></p>
<p style="text-indent:7pt;"><span class="font2">s2 = accept(s)</span></p>
<p style="text-indent:7pt;"><span class="font2">n = read(s,buffer,n)</span></p>
<p style="text-indent:7pt;"><span class="font2">n = write(s,buffer,n)</span></p>
<p style="text-indent:7pt;"><span class="font2">close(s)</span></p>
<p style="text-indent:7pt;"><span class="font2">shutdown(s,&lt;side&gt;)</span></p>
<p style="text-indent:7pt;"><span class="font2">getsockopt(s, ...)</span></p>
<p style="text-indent:7pt;"><span class="font2">setsockopt(s, ...)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Establishes a TCP connection to a local socket and a remote host and port.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Marks a local socket as legal to accept connections.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Waits for someone to establish a connection to a local port.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Tries to read n bytes from the socket into the buffer.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Tries to write n bytes from the buffer into the socket.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Completely closes the TCP connection.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Closes just the input or the output of the TCP connection.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Reads the value of an internal socket configuration option.</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Changes the value of an internal socket configuration option.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The sockets API lets you create TCP endpoint data structures, connect these endpoints to remote server TCP endpoints, and read and write data streams. The TCP API hides all the details of the underlying network protocol handshaking and the segmentation and reassembly of the TCP data stream to and from IP packets.</span></p>
<p style="text-align:justify;padding:0pt 0pt 26pt 0pt;"><span class="font24">In</span><a href="#bookmark784"><span class="font24"> Figure 4-1</span></a><span class="font24">, we showed how a web browser could download the </span><span class="font24" style="font-style:italic;">power-tools.html </span><span class="font24">web page from Joe’s Hardware store using HTTP. The pseudocode in </span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24"> sketches how we might use the sockets API to highlight the steps the client and server could perform to implement this HTTP transaction.</span></p><img src="book_files/book-112.jpg" alt="" style="width:32pt;height:28pt;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 0pt 196pt;"><span class="font1" style="font-weight:bold;">(S1)</span><span class="font0"> create new socket (</span><span class="font1" style="font-weight:bold;">socket</span><span class="font0">)</span></p></li>
<li>
<p style="padding:0pt 0pt 0pt 196pt;"><span class="font1" style="font-weight:bold;">(S2)</span><span class="font0"> bind socket to port 80 (</span><span class="font1" style="font-weight:bold;">bind</span><span class="font0">)</span></p></li>
<li>
<p style="padding:0pt 0pt 0pt 196pt;"><span class="font1" style="font-weight:bold;">(S3)</span><span class="font0"> permit socket connections (</span><span class="font1" style="font-weight:bold;">listen</span><span class="font0">)</span></p></li>
<li>
<p style="padding:0pt 0pt 8pt 196pt;"><span class="font1" style="font-weight:bold;">(S4)</span><span class="font0"> wait for connection (</span><span class="font1" style="font-weight:bold;">accept</span><span class="font0">)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C1) </span><span class="font0">get IP address &amp;&nbsp;port</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C2) </span><span class="font0">create new socket (</span><span class="font1" style="font-weight:bold;">socket</span><span class="font0">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 69pt;"><span class="font1" style="font-weight:bold;">(C3) </span><span class="font0">connect to server IP:port (</span><span class="font1" style="font-weight:bold;">connect</span><span class="font0">)</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 0pt 196pt;"><span class="font1" style="font-weight:bold;">(S5)</span><span class="font0"> application notified of connection</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C4) </span><span class="font0">connection successful &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">(S6) </span><span class="font0">start reading request (</span><span class="font1" style="font-weight:bold;">read</span><span class="font0">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C5) </span><span class="font0">send HTTP request (</span><span class="font1" style="font-weight:bold;">write</span><span class="font0">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C6) </span><span class="font0">wait for HTTP response (</span><span class="font1" style="font-weight:bold;">read</span><span class="font0">)</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 8pt 196pt;"><span class="font1" style="font-weight:bold;">(S7)</span><span class="font0"> process HTTP request message</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 0pt 69pt;"><span class="font1" style="font-weight:bold;">(C7) </span><span class="font0">process HTTP response &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">(S8) </span><span class="font0">send back HTTP response (</span><span class="font1" style="font-weight:bold;">write</span><span class="font0">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 20pt 69pt;"><span class="font1" style="font-weight:bold;">(C8) </span><span class="font0">close connection (</span><span class="font1" style="font-weight:bold;">close</span><span class="font0">) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">(S9) </span><span class="font0">close connection (</span><span class="font1" style="font-weight:bold;">close</span><span class="font0">)</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark812"></a><span class="font23" style="font-style:italic;">Figure 4-6. How TCP clients and servers communicate using the TCP sockets interface <a name="bookmark813"></a></span><span class="font24"><a name="bookmark814"></a>We begin with the web server waiting for a connection (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, S4). The client determines the IP address and port number from the URL and proceeds to establish a TCP connection to the server (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, C3). Establishing a connection can take a while, depending on how far away the server is, the load on the server, and the congestion of the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Once the connection is set up, the client sends the HTTP request (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, C5) and the server reads it (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, S6). Once the server gets the entire request message, it processes the request, performs the requested action </span><a href="#bookmark812"><span class="font24">(Figure 4-6</span></a><span class="font24">, S7), and writes the data back to the client. The client reads it (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, C6) and processes the response data (</span><a href="#bookmark812"><span class="font24">Figure 4-6</span></a><span class="font24">, C7).</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark815"></a><span class="font9" style="font-weight:bold;"><a name="bookmark33"></a><a name="bookmark816"></a>TCP Performance Considerations</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark817"></a><span class="font24">Because HTTP is layered directly on TCP, the performance of HTTP transactions depends critically on the performance of the underlying TCP plumbing. This section highlights some significant performance considerations of these TCP connections. By understanding some of the basic performance characteristics of TCP, you’ll better appreciate HTTP’s connection optimization features, and you’ll be able to design and implement higher-performance HTTP applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This section requires some understanding of the internal details of the TCP protocol. If you are not interested in (or are comfortable with) the details of TCP performance considerations, feel free to skip ahead to</span><a href="#bookmark818"><span class="font24"> “HTTP Connection Handling</span></a><span class="font24">.” Because TCP is a complex topic, we can provide only a brief overview of TCP performance here. Refer to the section</span><a href="#bookmark819"><span class="font24"> “For More Information</span></a><span class="font24">” at the end of this chapter for a list of excellent TCP references.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark820"></a><span class="font7" style="font-weight:bold;"><a name="bookmark821"></a>HTTP Transaction Delays</span></h3>
<p style="text-align:justify;"><span class="font24">Let’s start our TCP performance tour by reviewing what networking delays occur in the course of an HTTP request. </span><a href="#bookmark822"><span class="font24">Figure 4-7</span></a><span class="font24"> depicts the major connect, transfer, and processing delays for an HTTP transaction.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-113.jpg" alt="" style="width:28pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-114.jpg" alt="" style="width:82pt;height:47pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-115.jpg" alt="" style="width:32pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">DNS lookup Connect &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request Process Response Close</span></p>
</div><br clear="all">
<p><a name="bookmark822"></a><span class="font23" style="font-style:italic;">Figure 4-7. Timeline of a serial HTTP transaction</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Notice that the transaction processing time can be quite small compared to the time required to set up TCP connections and transfer the request and response messages. Unless the client or server is overloaded or executing complex dynamic resources, most HTTP delays are caused by TCP network delays.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">There are several possible causes of delay in an HTTP transaction:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">1. A client first needs to determine the IP address and port number of the web server from the URI. If the hostname in the URI was not recently visited, it may take tens of seconds to convert the hostname from a URI into an IP address using the DNS resolution infrastructure.<a name="footnote14"></a><sup><a href="#bookmark823">14</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">2. Next, the client sends a TCP connection request to the server and waits for the server to send back a connection acceptance reply. Connection setup delay occurs for every new TCP connection. This usually takes at most a second or two, but it can add up quickly when hundreds of HTTP transactions are made.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark824"></a><span class="font24">3. Once the connection is established, the client sends the HTTP request over the newly established TCP pipe. The web server reads the request message from the TCP connection as the data arrives and processes the request. It takes time for the request message to travel over the Internet and get processed by the server.</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">4. The web server then writes back the HTTP response, which also takes time.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The magnitude of these TCP network delays depends on hardware speed, the load of the network and server, the size of the request and response messages, and the distance between client and server. The delays also are significantly affected by technical intricacies of the TCP protocol.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark825"></a><span class="font7" style="font-weight:bold;"><a name="bookmark826"></a>Performance Focus Areas</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The remainder of this section outlines some of the most common TCP-related delays affecting HTTP programmers, including the causes and performance impacts of:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The TCP connection setup handshake</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• TCP slow-start congestion control</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Nagle’s algorithm for data aggregation</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• TCP’s delayed acknowledgment algorithm for piggybacked acknowledgments</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• TIME_WAIT delays and port exhaustion</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">If you are writing high-performance HTTP software, you should understand each of these factors. If you don’t need this level of performance optimization, feel free to skip ahead.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark827"></a><span class="font7" style="font-weight:bold;"><a name="bookmark828"></a><a name="bookmark829"></a>TCP Connection Handshake Delays</span></h3>
<p style="text-align:justify;"><span class="font24">When you set up a new TCP connection, even before you send any data, the TCP software exchanges a series of IP packets to negotiate the terms of the connection (see</span><a href="#bookmark830"><span class="font24"> Figure 4-8</span></a><span class="font24">). These exchanges can significantly degrade HTTP performance if the connections are used for small data transfers.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-116.jpg" alt="" style="width:28pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-117.jpg" alt="" style="width:45pt;height:32pt;"></td><td>
<p style="text-align:justify;"><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">ACK</span></p>
<p style="text-indent:10pt;"><span class="font0">GET / HTTP. . .</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0" style="text-decoration:underline;">SYN+ACK</span></p></td><td><img src="book_files/book-118.jpg" alt="" style="width:17pt;height:27pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">HTTP/1.1 304 Not modified</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-119.jpg" alt="" style="width:32pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Connection handshake delay</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Data transfer</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark830"></a><span class="font23" style="font-style:italic;">Figure 4-8. TCP requires two packet transfers to set up the connection before it can send data</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are the steps in the TCP connection handshake:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">1. To request a new TCP connection, the client sends a small TCP packet (usually 40–60 bytes) to the server. The packet has a special “SYN” flag set, which means it’s a connection request. This is shown in</span><a href="#bookmark830"><span class="font24"> Figure 4-8</span></a><span class="font24">a.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">2. If the server accepts the connection, it computes some connection parameters and sends a TCP packet back to the client, with both the “SYN” and “ACK” flags set, indicating that the connection request is accepted (see</span><a href="#bookmark830"><span class="font24"> Figure 4-8b</span></a><span class="font24">).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">3. Finally, the client sends an acknowledgment back to the server, letting it know that the connection was established successfully (see </span><a href="#bookmark830"><span class="font24">Figure 4-8</span></a><span class="font24">c). Modern TCP stacks let the client send data in this acknowledgment packet.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The HTTP programmer never sees these packets—they are managed invisibly by the TCP/IP software. All the HTTP programmer sees is a delay when creating a new TCP connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The SYN/SYN+ACK handshake (</span><a href="#bookmark830"><span class="font24">Figure 4-8</span></a><span class="font24">a and b) creates a measurable delay when HTTP transactions do not exchange much data, as is commonly the case. The TCP connect ACK packet (</span><a href="#bookmark830"><span class="font24">Figure 4-8</span></a><span class="font24">c) often is large enough to carry the entire HTTP request message,<a name="footnote15"></a><sup><a href="#bookmark831">15</a></sup><sup></sup> and many HTTP server response messages fit into a single IP packet (e.g., when the response is a small HTML file of a decorative graphic, or a 304 Not Modified response to a browser cache request).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark832"></a><span class="font24">The end result is that small HTTP transactions may spend 50% or more of their time doing TCP setup. Later sections will discuss how HTTP allows reuse of existing connections to eliminate the impact of this TCP setup delay.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark833"></a><span class="font7" style="font-weight:bold;"><a name="bookmark834"></a>Delayed Acknowledgments</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because the Internet itself does not guarantee reliable packet delivery (Internet routers are free to destroy packets at will if they are overloaded), TCP implements its own acknowledgment scheme to guarantee successful data delivery.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each TCP segment gets a sequence number and a data-integrity checksum. The receiver of each segment returns small acknowledgment packets back to the sender when segments have been received intact. If a sender does not receive an acknowledgment within a specified window of time, the sender concludes the packet was destroyed or corrupted and resends the data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because acknowledgments are small, TCP allows them to “piggyback” on outgoing data packets heading in the same direction. By combining returning acknowledgments with outgoing data packets, TCP can make more efficient use of the network. To increase the chances that an acknowledgment will find a data packet headed in the same direction, many TCP stacks implement a “delayed acknowledgment” algorithm. Delayed acknowledgments hold outgoing acknowledgments in a buffer for a certain window of time (usually 100–200 milliseconds), looking for an outgoing data packet on which to piggyback. If no outgoing data packet arrives in that time, the acknowledgment is sent in its own packet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark835"></a><span class="font24">Unfortunately, the bimodal request-reply behavior of HTTP reduces the chances that piggybacking can occur. There just aren’t many packets heading in the reverse direction when you want them. Frequently, the disabled acknowledgment algorithms introduce significant delays. Depending on your operating system, you may be able to adjust or disable the delayed acknowledgment algorithm.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Before you modify any parameters of your TCP stack, be sure you know what you are doing. Algorithms inside TCP were introduced to protect the Internet from poorly designed applications. If you modify any TCP configurations, be absolutely sure your application will not create the problems the algorithms were designed to avoid.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark836"></a><span class="font7" style="font-weight:bold;"><a name="bookmark837"></a>TCP Slow Start</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The performance of TCP data transfer also depends on the </span><span class="font24" style="font-style:italic;">age</span><span class="font24"> of the TCP connection. TCP connections “tune” themselves over time, initially limiting the maximum speed of the connection and increasing the speed over time as data is transmitted successfully. This tuning is called </span><span class="font24" style="font-style:italic;">TCP slow start</span><span class="font24">, and it is used to prevent sudden overloading and congestion of the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark838"></a><span class="font24">TCP slow start throttles the number of packets a TCP endpoint can have in flight at any one time. Put simply, each time a packet is received successfully, the sender gets permission to send two more packets. If an HTTP transaction has a large amount of data to send, it cannot send all the packets at once. It must send one packet and wait for an acknowledgment; then it can send two packets, each of which must be acknowledged, which allows four packets, etc. This is called “opening the congestion window.” Because of this congestion-control feature, new connections are slower than “tuned” connections that already have exchanged a modest amount of data. Because tuned connections are faster, HTTP includes facilities that let you reuse existing connections. We’ll talk about these HTTP “persistent connections” later in this chapter.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark839"></a><span class="font7" style="font-weight:bold;"><a name="bookmark840"></a>Nagle’s Algorithm and TCP_NODELAY</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">TCP has a data stream interface that permits applications to stream data of any size to the TCP stack—even a single byte at a time! But because each TCP segment carries at least 40 bytes of flags and headers, network performance can be degraded severely if TCP sends large numbers of packets containing small amounts of data.<a name="footnote16"></a><sup><a href="#bookmark841">16</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Nagle’s algorithm (named for its creator, John Nagle) attempts to bundle up a large amount of TCP data before sending a packet, aiding network efficiency. The algorithm is described in RFC 896, “Congestion Control in IP/TCP Internetworks.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark842"></a><span class="font24">Nagle’s algorithm discourages the sending of segments that are not full-size (a maximum-size packet is around 1,500 bytes on a LAN, or a few hundred bytes across the Internet). Nagle’s algorithm lets you send a non-full-size packet only if all other packets have been acknowledged. If other packets are still in flight, the partial data is buffered. This buffered data is sent only when pending packets are acknowledged or when the buffer has accumulated enough data to send a full packet.<a name="footnote17"></a><sup><a href="#bookmark843">17</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Nagle’s algorithm causes several HTTP performance problems. First, small HTTP messages may not fill a packet, so they may be delayed waiting for additional data that will never arrive. Second, Nagle’s algorithm interacts poorly with disabled acknowledgments—Nagle’s algorithm will hold up the sending of data until an acknowledgment arrives, but the acknowledgment itself will be delayed 100–200 milliseconds by the delayed acknowledgment algorithm.<a name="footnote18"></a><sup><a href="#bookmark844">18</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP applications often disable Nagle’s algorithm to improve performance, by setting the TCP_NODELAY parameter on their stacks. If you do this, you must ensure that you write large chunks of data to TCP so you don’t create a flurry of small packets.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark845"></a><span class="font7" style="font-weight:bold;"><a name="bookmark846"></a><a name="bookmark847"></a><a name="bookmark848"></a>TIME_WAIT Accumulation and Port Exhaustion</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">TIME_WAIT port exhaustion is a serious performance problem that affects performance benchmarking but is relatively uncommon in real deployments. It warrants special attention because most people involved in performance benchmarking eventually run into this problem and get unexpectedly poor performance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a TCP endpoint closes a TCP connection, it maintains in memory a small control block recording the IP addresses and port numbers of the recently closed connection. This information is maintained for a short time, typically around twice the estimated maximum segment lifetime (called “2MSL”; often two minutes<a name="footnote19"></a><sup><a href="#bookmark849">19</a></sup><sup></sup>), to make sure a new TCP connection with the same addresses and port numbers is not created during this time. This prevents any stray duplicate packets from the previous connection from accidentally being injected into a new connection that has the same addresses and port numbers. In practice, this algorithm prevents two connections with the exact same IP addresses and port numbers from being created, closed, and recreated within two minutes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Today’s higher-speed routers make it extremely unlikely that a duplicate packet will show up on a server’s doorstep minutes after a connection closes. Some operating systems set 2MSL to a smaller value, but be careful about overriding this value. Packets do get duplicated, and TCP data will be corrupted if a duplicate packet from a past connection gets inserted into a new stream with the same connection values.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The 2MSL connection close delay normally is not a problem, but in benchmarking situations, it can be. It’s common that only one or a few test load-generation computers are connecting to a system under benchmark test, which limits the number of client IP addresses that connect to the server. Furthermore, the server typically is listening on HTTP’s default TCP port, 80. These circumstances limit the available combinations of connection values, at a time when port numbers are blocked from reuse by TIME_WAIT.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In a pathological situation with one client and one web server, of the four values that make up a TCP connection:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;source-IP-address, source-port, destination-IP-address, destination-port&gt; </span><span class="font24">three of them are fixed—only the source port is free to change:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;client-IP, source-port, server-IP, 80&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each time the client connects to the server, it gets a new source port in order to have a unique connection. But because a limited number of source ports are available (say, 60,000) and no connection can be reused for 2MSL seconds (say, 120 seconds), this limits the connect rate to 60,000 / 120 = 500 transactions/sec. If you keep <a name="bookmark850"></a><a name="bookmark851"></a>making optimizations, and your server doesn’t get faster than about 500 transac-tio<a name="bookmark852"></a>ns/sec, make sure you are not experiencing TIME_WAIT port exhaustion. You can fix this problem by using more client load-generator machines or making sure the client and server rotate through several virtual IP addresses to add more connection combinations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Even if you do not suffer port exhaustion problems, be careful about having large numbers of open connections or large numbers of control blocks allocated for connection in wait states. Some operating systems slow down dramatically when there are numerous open connections or control blocks.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark818"></a><span class="font9" style="font-weight:bold;"><a name="bookmark34"></a><a name="bookmark853"></a>HTTP Connection Handling</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark854"></a><span class="font24">The first two sections of this chapter provided a fire-hose tour of TCP connections and their performance implications. If you’d like to learn more about TCP networking, check out the resources listed at the end of the chapter.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark855"></a><span class="font24">We’re going to switch gears now and get squarely back to HTTP. The rest of this chapter explains the HTTP technology for manipulating and optimizing connections. We’ll start with the HTTP Connection header, an often misunderstood but important part of HTTP connection management. Then we’ll talk about HTTP’s connection optimization techniques.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark856"></a><span class="font7" style="font-weight:bold;"><a name="bookmark857"></a><a name="bookmark858"></a>The Oft-Misunderstood Connection Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP allows a chain of HTTP intermediaries between the client and the ultimate origin server (proxies, caches, etc.). HTTP messages are forwarded hop by hop from the client, through intermediary devices, to the origin server (or the reverse).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In some cases, two adjacent HTTP applications may want to apply a set of options to their shared connection. The HTTP Connection header field has a comma-separated list of </span><span class="font24" style="font-style:italic;">connection tokens</span><span class="font24"> that specify options for the connection that aren’t propagated to other connections. For example, a connection that must be closed after sending the next message can be indicated by Connection: close.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Connection header sometimes is confusing, because it can carry three different types of tokens:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP header field names, listing headers relevant for only this connection</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Arbitrary token values, describing nonstandard options for this connection</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• The value </span><span class="font4">close</span><span class="font24">, indicating the persistent connection will be closed when done</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If a connection token contains the name of an HTTP header field, that header field contains connection-specific information and must not be forwarded. Any header fields listed in the Connection header must be deleted before the message is forwarded. Placing a hop-by-hop header name in a Connection header is known as</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><a name="bookmark859"></a><span class="font24">“protecting the header,” because the Connection header protects against accidental forwarding of the local header. An example is shown in </span><a href="#bookmark860"><span class="font24">Figure 4-9</span></a><span class="font24">.</span></p>
<div style="border-right:solid;float:left;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">The Connection header says the Meter header should not be forwarded, the hypothetical “bill-my-credit-card” option applies, and the persistent connection will be closed when this transaction is done.</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-120.jpg" alt="" style="width:40pt;height:35pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-121.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Cache-control: max-age=3600</span></p>
<p><span class="font3">Connection: meter, close, bill-my-credit-card</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-122.jpg" alt="" style="width:37pt;height:49pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 56pt 0pt;"><span class="font3">Meter: max-uses=3, max-refuses=6, dont-report</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark860"></a><span class="font23" style="font-style:italic;"><a name="bookmark861"></a>Figure 4-9. The Connection header allows the sender to specify connection-specific options</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">When an HTTP application receives a message with a Connection header, the receiver parses and applies all options requested by the sender. It then deletes the Connection header and all headers listed in the Connection header before forwarding the message to the next hop. In addition, there are a few hop-by-hop headers that might not be listed as values of a Connection header, but must not be proxied. These include Proxy-Authenticate, Proxy-Connection, Transfer-Encoding, and Upgrade. For more about the Connection header, see </span><a href="#bookmark248"><span class="font24">Appendix C</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark862"></a><span class="font7" style="font-weight:bold;"><a name="bookmark863"></a>Serial Transaction Delays</span></h3>
<p style="text-align:justify;"><span class="font24">TCP performance delays can add up if the connections are managed naively. For example, suppose you have a web page with three embedded images. Your browser needs to issue four HTTP transactions to display this page: one for the top-level HTML and three for the embedded images. If each transaction requires a new connection, the connection and slow-start delays can add up (see </span><a href="#bookmark864"><span class="font24">Figure 4-10</span></a><span class="font24">).<sup>*</sup></span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-123.jpg" alt="" style="width:28pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">Transaction 2 Transaction 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font0">Transaction 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-124.jpg" alt="" style="width:40pt;height:46pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-125.jpg" alt="" style="width:165pt;height:49pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-126.jpg" alt="" style="width:32pt;height:28pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Connect- 1</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect- 3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect- 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 35pt 0pt;"><a name="bookmark864"></a><span class="font23" style="font-style:italic;">Figure 4-10. Four transactions (serial)</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20">* For the purpose of this example, assume all objects are roughly the same size and are hosted from the same server, and that the DNS entry is cached, eliminating the DNS lookup time.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In addition to the real delay imposed by serial loading, there is also a psychological perception of slowness when a single image is loading and nothing is happening on the rest of the page. Users prefer multiple images to load at the same time.<a name="footnote20"></a><sup><a href="#bookmark865">20</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Another disadvantage of serial loading is that some browsers are unable to display anything onscreen until enough objects are loaded, because they don’t know the sizes of the objects until they are loaded, and they may need the size information to decide where to position the objects on the screen. In this situation, the browser may be making good progress loading objects serially, but the user may be faced with a blank white screen, unaware that any progress is being made at all.<a name="footnote21"></a><sup><a href="#bookmark866">21</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Several current and emerging techniques are available to improve HTTP connection performance. The next several sections discuss four such techniques:</span></p>
<p style="text-align:justify;"><a name="bookmark867"></a><span class="font24" style="font-style:italic;">Parallel connections</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Concurrent HTTP requests across multiple TCP connections</span></p>
<p><span class="font24" style="font-style:italic;">Persistent connections</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Reusing TCP connections to eliminate connect/close delays</span></p>
<p><span class="font24" style="font-style:italic;">Pipelined connections</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Concurrent HTTP requests across a shared TCP connection</span></p>
<p><span class="font24" style="font-style:italic;">Multiplexed connections</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">Interleaving chunks of requests and responses (experimental)</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark868"></a><span class="font9" style="font-weight:bold;"><a name="bookmark869"></a><a name="bookmark35"></a><a name="bookmark870"></a>Parallel Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">As we mentioned previously, a browser could naively process each embedded object serially by completely requesting the original HTML page, then the first embedded object, then the second embedded object, etc. But this is too slow!</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTP allows clients to open multiple connections and perform multiple HTTP transactions in parallel, as sketc<a name="bookmark871"></a>hed in </span><a href="#bookmark872"><span class="font24">Figure 4-11</span></a><span class="font24">. In this example, four embedded images are loaded in parallel, with each transaction getting its own TCP connection.<a name="footnote22"></a><sup><a href="#bookmark873">22</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark874"></a><span class="font7" style="font-weight:bold;"><a name="bookmark875"></a>Parallel Connections May Make Pages Load Faster</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Composite pages consisting of embedded objects may load faster if they take advantage of the dead time and bandwidth limits of a single connection. The delays can be</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Server 1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Server 2</span></p>
</div><br clear="all">
<p style="text-align:justify;text-indent:22pt;padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark872"></a><span class="font23" style="font-style:italic;">Figure 4-11. Each component of a page involves a separate HTTP transaction</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">overlapped, and if a single connection does not saturate the client’s Internet bandwidth, the unused bandwidth can be allocated to loading additional objects.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark876"><span class="font24">Figure 4-12</span></a><span class="font24"> shows a timeline for parallel connections, which is significantly faster than</span><a href="#bookmark864"><span class="font24"> Figure 4-10</span></a><span class="font24">. The enclosing HTML page is loaded first, and then the remaining three transactions are processed concurrently, each with their own connection.<a name="footnote23"></a><sup><a href="#bookmark877">23</a></sup><sup> </sup>Because the images are loaded in parallel, the connection delays are overlapped.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 1</span></p>
</div>
<p style="padding:0pt 0pt 25pt 0pt;"><span class="font0">Transaction 2, 3, 4 (parallel connections)</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font1" style="font-weight:bold;">Server</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 11pt 49pt;"><span class="font1" style="font-style:italic;">(Usually a small software delay between each connection)</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 4</span></p>
</div>
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark876"></a><span class="font23" style="font-style:italic;">Figure 4-12. Four transactions (parallel)</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark878"></a><span class="font7" style="font-weight:bold;"><a name="bookmark879"></a>Parallel Connections Are Not Always Faster</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Even though parallel connections may be faster, however, they are not </span><span class="font24" style="font-style:italic;">always</span><span class="font24"> faster. When the client’s network bandwidth is scarce (for example, a browser connected to the Internet through a 28.8-Kbps modem), most of the time might be spent just transferring data. In this si<a name="bookmark880"></a>tuation, a single HTTP transaction to a fast server could easily consume all of the available modem bandwidth. If multiple objects are loaded in parallel, each object will just compete for this limited bandwidth, so each object will load proportionally slower, yielding little or no performance advantage.<a name="footnote24"></a><sup><a href="#bookmark881">24</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark882"></a><span class="font24"><a name="bookmark883"></a>Also, a large number of open connections can consume a lot of memory and cause performance problems of their own. Complex web pages may have tens or hundreds of embedded objects. Clients might be able to open hundreds of connections, but few web servers will want to do that, because they often are processing requests for many other users at the same time. A hundred simultaneous users, each opening 100 connections, will put the burden of 10,000 connections on the server. This can cause significant server slowdown. The same situation is true for high-load proxies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In practice, browsers do use parallel connections, but they limit the total number of parallel connections to a small number (often four). Servers are free to close excessive connections from a particular client.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark884"></a><span class="font7" style="font-weight:bold;"><a name="bookmark885"></a><a name="bookmark886"></a>Parallel Connections May “Feel” Faster</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Okay, so parallel connections don’t always make pages load faster. But even if they don’t actually speed up the page transfer, as we said earlier, parallel connections often make users </span><span class="font24" style="font-style:italic;">feel</span><span class="font24"> that the page loads faster, because they can see progress being made as multiple component objects appear onscreen in parallel.<a name="footnote25"></a><sup><a href="#bookmark887">25</a></sup><sup></sup> Human beings perceive that web pages load faster if there’s lots of action all over the screen, even if a stopwatch actually shows the aggregate page download time to be slower!</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark888"></a><span class="font9" style="font-weight:bold;"><a name="bookmark36"></a><a name="bookmark889"></a>Persistent Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web clients often open connections to the same site. For example, most of the embedded images in a web page often come from the same web site, and a significant number of hyperlinks to other objects often point to the same site. Thus, an application that initiates an HTTP request to a server likely will make more requests to that server in the near future (to fetch the inline images, for example). This property is called </span><span class="font24" style="font-style:italic;">site locality</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For this reason, HTTP/1.1 (and enhanced versions of HTTP/1.0) allows HTTP devices to keep TCP connections open after transactions complete and to reuse the preexisting connections for future HTTP requests. TCP connections that are kept <a name="bookmark890"></a>open after transactions complete are called </span><span class="font24" style="font-style:italic;">persistent</span><span class="font24"> connections. Nonpersistent connections are closed after each transaction. Persistent connections stay open across transactions, until either the client or the server decides to close them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">By reusing an idle, persistent connection that is already open to the target server, you can avoid the slow connection setup. In addition, the already open connection can avoid the slow-start congestion adaptation phase, allowing faster data transfers.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark891"></a><span class="font7" style="font-weight:bold;"><a name="bookmark892"></a>Persistent Versus Parallel Connections</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">As we’ve seen, parallel connections can speed up the transfer of composite pages. But parallel connections have some disadvantages:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Each transaction opens/closes a new connection, costing time and bandwidth.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Each new connection has reduced performance because of TCP slow start.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• There is a practical limit on the number of open parallel connections.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark893"></a><span class="font24">Persistent connections offer some advantages over parallel connections. They reduce the delay and overhead of connection establishment, keep the connections in a tuned state, and reduce the potential number of open connections. However, persistent connections need to be managed with care, or you may end up accumulating a large number of idle connections, consuming local resources and resources on remote clients and servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Persistent connections can be most effective when used in conjunction with parallel connections. Today, many web applications open a small number of parallel connections, each persistent. There are two types of persistent connections: the older HTTP/1.0+ “keep-alive” connections and the modern HTTP/1.1 “persistent” connections. We’ll look at both flavors in the next few sections.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark894"></a><span class="font7" style="font-weight:bold;"><a name="bookmark895"></a>HTTP/1.0+ Keep-Alive Connections</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Many HTTP/1.0 browsers and servers were extended (starting around 1996) to support an early, experimental type of persistent connections called </span><span class="font24" style="font-style:italic;">keep-alive connections</span><span class="font24">. These early persistent connections suffered from some interoperability design problems that were rectified in later revisions of HTTP/1.1, but many clients and servers still use these earlier keep-alive connections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Some of the performance advantages of keep-alive connections are visible in </span><a href="#bookmark896"><span class="font24">Figure 4-13</span></a><span class="font24">, which compares the timeline for four HTTP transactions over serial connections against the same transactions over a single persistent connection. The timeline is compressed because the connect and close overheads are removed.<a name="footnote26"></a><sup><a href="#bookmark897">26</a></sup><sup></sup></span></p>
<p style="text-indent:14pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Serial connections</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-127.jpg" alt="" style="width:31pt;height:41pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font0">Transaction 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-128.jpg" alt="" style="width:15pt;height:31pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-129.jpg" alt="" style="width:41pt;height:29pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Connect- 1</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Persistent connection</span></p></td></tr>
<tr><td><img src="book_files/book-130.jpg" alt="" style="width:202pt;height:91pt;">
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p><span class="font0">Transaction 1 Transaction 2 Transaction 3 Transaction 4</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 14pt 0pt;"><a name="bookmark896"></a><span class="font23" style="font-style:italic;">Figure 4-13. Four transactions (serial versus persistent)</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark898"></a><span class="font7" style="font-weight:bold;"><a name="bookmark899"></a>Keep-Alive Operation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Keep-alive is deprecated and no longer documented in the current HTTP/1.1 specification. However, keep-alive handshaking is still in relatively common use by browsers and servers, so HTTP implementors should be prepared to interoperate with it. We’ll take a quick look at keep-alive operation now. Refer to older versions of the HTTP/1.1 specification (such as RFC 2068) for a more complete explanation of keep-alive handshaking.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Clients implementing HTTP/1.0 keep-alive connections can request that a connection be kept open by including the Connection: Keep-Alive request header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">If the server is willing to keep the connection open for the next request, it will respond with the same header in the response (see </span><a href="#bookmark900"><span class="font24">Figure 4-14</span></a><span class="font24">). If there is no Connection: keep-alive header in the response, the client assumes that the server does not support keep-alive and that the server will close the connection when the response message is sent back.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark901"></a><span class="font7" style="font-weight:bold;"><a name="bookmark902"></a>Keep-Alive Options</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that the keep-alive headers are just requests to keep the connection alive. Clients and servers do not need to agree to a keep-alive session if it is requested. They</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">GET /index.html HTTP/1.0</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a><span class="font3"> Connection: Keep-Alive</span></p></td></tr>
<tr><td><img src="book_files/book-131.jpg" alt="" style="width:262pt;height:73pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p>
<p><span class="font3">HTTP/1.0 200 O</span></p>
<p><span class="font3">Content-type: text/html Content-length: 3104 Connection: Keep-Alive</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark900"></a><span class="font23" style="font-style:italic;">Figure 4-14. HTTP/1.0 keep-alive transaction header handshake</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">can close idle keep-alive connections at any time and are free to limit the number of transactions processed on a keep-alive connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The keep-alive behavior can be tuned by comma-separated options specified in the Keep-Alive general header:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The </span><span class="font4">timeout </span><span class="font24">parameter is sent in a Keep-Alive response header. It estimates how long the server is likely to keep the connection alive for. This is not a guarantee.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The </span><span class="font4">max </span><span class="font24">parameter is sent in a Keep-Alive response header. It estimates how many more HTTP transactions the server is likely to keep the connection alive for. This is not a guarantee.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The Keep-Alive header also supports arbitrary unprocessed attributes, primarily for diagnostic and debugging purposes. The syntax is </span><span class="font24" style="font-style:italic;">name</span><span class="font24"> [= </span><span class="font24" style="font-style:italic;">value</span><span class="font24">].</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Keep-Alive header is completely optional but is permitted only when Connection: Keep-Alive also is present. Here’s an example of a Keep-Alive response header indicating that the server intends to keep the connection open for at most five more transactions, or until it has sat idle for two minutes:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Connection: Keep-Alive</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">Keep-Alive: max=5, timeout=120</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark903"></a><span class="font7" style="font-weight:bold;"><a name="bookmark904"></a>Keep-Alive Connection Restrictions and Rules</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here are some restrictions and clarifications regarding the use of keep-alive connections:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Keep-alive does not happen by default in HTTP/1.0. The client must send a Connection: Keep-Alive request header to activate keep-alive connections.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The Connection: Keep-Alive header must be sent with all messages that want to continue the persistence. If the client does not send a Connection: Keep-Alive header, the server will close the connection after that request.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Clients can tell if the server will close the connection after the response by detecting the absence of the Connection: Keep-Alive response header.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The connection can be kept open only if the length of the message’s entity body can be determined without sensing a connection close—this means that the entity body must have a correct Content-Length, have a multipart media type, or be encoded with the chunked transfer encoding. Sending the wrong Content-Length back on a keep-alive channel is bad, because the other end of the transaction will not be able to accurately detect the end of one message and the start of another.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Proxies and gateways must enforce the rules of the Connection header; the proxy or gateway must remove any header fields named in the Connection header, and the Connection header itself, before forwarding or caching the message.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark905"></a><span class="font24">• Formally, keep-alive connections should not be established with a proxy server that isn’t guaranteed to support the Connection header, to prevent the problem with dumb proxies described below. This is not always possible in practice.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Technically, any Connection header fields (including Connection: Keep-Alive) received from an HTTP/1.0 device should be ignored, because they may have been forwarded mistakenly by an older proxy server. In practice, some clients and servers bend this rule, although they run the risk of hanging on older proxies.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">• Clients must be prepared to retry requests if the connection closes before they receive the entire response, unless the request could have side effects if repeated.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark906"></a><span class="font7" style="font-weight:bold;"><a name="bookmark907"></a>Keep-Alive and Dumb Proxies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark908"></a><span class="font24">Let’s take a closer look at the subtle problem with keep-alive and dumb proxies. A web client’s Connection: Keep-Alive header is intended to affect just the single TCP link leaving the client. This is why it is named the “connection” header. If the client is talking to a web server, the client sends a Connection: Keep-Alive header to tell the server it wants keep-alive. The server sends a Connection: Keep-Alive header back if it supports keep-alive and doesn’t send it if it doesn’t.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark909"></a><span class="font5" style="font-weight:bold;"><a name="bookmark910"></a>The Connection header and blind relays</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The problem comes with proxies—in particular, proxies that don’t understand the Connection header and don’t know that they need to remove the header before proxying it down the chain. Many older or simple proxies act as </span><span class="font24" style="font-style:italic;">blind relays</span><span class="font24">, tunneling bytes from one connection to another, without specially processing the Connection header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Imagine a web client talking to a web server through a dumb proxy that is acting as a blind relay. This situation is depicted in </span><a href="#bookmark911"><span class="font24">Figure 4-15</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here’s what’s going on in this figure:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">1. In</span><a href="#bookmark911"><span class="font24"> Figure 4-15</span></a><span class="font24">a, a web client sends a message to the proxy, including the Connection: Keep-Alive header, requesting a keep-alive connection if possible. The client waits for a response to learn if its request for a keep-alive channel was granted.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Server won’t close connection when done because it thinks it has</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">been asked to speak keep-alive</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Connection: Keep-Alive</span></p></td><td><img src="book_files/book-132.jpg" alt="" style="width:48pt;height:44pt;"></td><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Connection: Keep-Alive</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-133.jpg" alt="" style="width:74pt;height:54pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-134.jpg" alt="" style="width:53pt;height:37pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(d)</span><span class="font0"> Connection: Keep-Alive </span><span class="font0" style="font-weight:bold;"><sup>Dumb proxy</sup> </span><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Connection: Keep-Alive</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-135.jpg" alt="" style="width:21pt;height:16pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Next request</span></p></td><td><img src="book_files/book-136.jpg" alt="" style="width:56pt;height:33pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Proxy waits for connection to close, ignoring any new requests on the connection</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(e)</span><span class="font0"> Client’s second request on the keep-alive connection just hangs because the proxy never processes it</span></p></li></ul>
</div><br clear="all"></li></ul>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark911"></a><span class="font23" style="font-style:italic;">Figure 4-15. Keep-alive doesn’t interoperate with proxies that don’t support Connection headers</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">2. The dumb proxy gets the HTTP request, but it doesn’t understand the Connection header (it just treats it as an extension header). The proxy has no idea what keep-alive is, so it passes the message verbatim down the chain to the server </span><a href="#bookmark911"><span class="font24">(Figure 4-15</span></a><span class="font24">b). But the Connection header is a hop-by-hop header; it applies to only a single transport link and shouldn’t be passed down the chain. Bad things are about to happen.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">3. In</span><a href="#bookmark911"><span class="font24"> Figure 4-15</span></a><span class="font24">b, the relayed HTTP request arrives at the web server. When the web server receives the proxied Connection: Keep-Alive header, it mistakenly concludes that the proxy (which looks like any other client to the server) wants to speak keep-alive! That’s fine with the web server—it agrees to speak keepalive and sends a Connection: Keep-Alive response header back in</span><a href="#bookmark911"><span class="font24"> Figure 4-15</span></a><span class="font24">c. So, at this point, the web server thinks it is speaking keep-alive with the proxy and will adhere to rules of keep-alive. But the proxy doesn’t know the first thing about keep-alive. Uh-oh.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">4. In</span><a href="#bookmark911"><span class="font24"> Figure 4-15</span></a><span class="font24">d, the dumb proxy relays the web server’s response message back to the client, passing along the Connection: Keep-Alive header from the web server. The client sees this header and assumes the proxy has agreed to speak keep-alive. So at this point, both the client and server believe they are speaking keep-alive, but the proxy they are talking to doesn’t know anything about keep-alive.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">5. Because the proxy doesn’t know anything about keep-alive, it reflects all the data it receives back to the client and then waits for the origin server to close the connection. But the origin server will not close the connection, because it believes the proxy explicitly asked the server to keep the connection open. So the proxy will hang waiting for the connection to close.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">6. When the client gets the response message back in</span><a href="#bookmark911"><span class="font24"> Figure 4-15</span></a><span class="font24">d, it moves right along to the next request, sending another request to the proxy on the keep-alive connection (see </span><a href="#bookmark911"><span class="font24">Figure 4-15</span></a><span class="font24">e). Because the proxy never expects another request on the same connection, the request is ignored and the browser just spins, making no progress.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">7. This miscommunication causes the browser to hang until the client or server ti<a name="bookmark912"></a>mes out the connection and closes it.<a name="footnote27"></a><sup><a href="#bookmark913">27</a></sup><sup></sup></span></p></li></ul>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark914"></a><span class="font5" style="font-weight:bold;"><a name="bookmark915"></a>Proxies and hop-by-hop headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark916"></a><span class="font24"><a name="bookmark917"></a>To avoid this kind of proxy miscommunication, modern proxies must never proxy the Connection header or any headers whose names appear inside the Connection values. So if a proxy receives a Connection: Keep-Alive header, it shouldn’t proxy either the Connection header or any headers named Keep-Alive.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">In addition, there are a few hop-by-hop headers that might not be listed as values of a Connection header, but must not be proxied or served as a cache response either. These include Proxy-Authenticate, Proxy-Connection, Transfer-Encoding, and Upgrade. For more information, refer back to</span><a href="#bookmark856"><span class="font24"> “The Oft-Misunderstood Connection</span></a><span class="font24"> </span><a href="#bookmark856"><span class="font24">Header</span></a><span class="font24">.”</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark918"></a><span class="font7" style="font-weight:bold;"><a name="bookmark919"></a>The Proxy-Connection Hack</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Browser and proxy implementors at Netscape proposed a clever workaround to the blind relay problem that didn’t require all web applications to support advanced versions of HTTP. The workaround introduced a new header called Proxy-Connection and solved the problem of a single blind relay interposed directly after the client— but not all other situations. Proxy-Connection is implemented by modern browsers when proxies are explicitly configured and is understood by many proxies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The idea is that dumb proxies get into trouble because they blindly forward hop-by-hop headers such as Connection: Keep-Alive. Hop-by-hop headers are relevant only for that single, particular connection and must not be forwarded. This causes trouble when the forwarded headers are misinterpreted by downstream servers as requests from the proxy itself to control its connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In the Netscape workaround, browsers send nonstandard Proxy-Connection extension headers to proxies, instead of officially supported and well-known Connection headers. If the proxy is a blind relay, it relays the nonsense Proxy-Connection header to the web server, which harmlessly ignores the header. But if the proxy is a smart proxy (capable of understanding persistent connection handshaking), it replaces the nonsense Proxy-Connection header with a Connection header, which is then sent to the server, having the desired effect.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark920"><span class="font24">Figure 4-16</span></a><span class="font24">a–d shows how a blind relay harmlessly forwards Proxy-Connection headers to the web server, which ignores the header, causing no keep-alive connection to be established between the client and proxy or the proxy and server. The smart proxy in</span><a href="#bookmark920"><span class="font24"> Figure 4-16</span></a><span class="font24">e–h understands the Proxy-Connection header as a request to speak keep-alive, and it sends out its own Connection: Keep-Alive headers to establish keep-alive connections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 77pt;"><span class="font0">The server does not recognize the Proxy-Connection header, and ignores it. No keep-alive Connection is established.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Proxy-Connection: Keep-Alive</span></p></td><td><img src="book_files/book-137.jpg" alt="" style="width:53pt;height:44pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Proxy-Connection: Keep-Alive</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-138.jpg" alt="" style="width:81pt;height:54pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">No Connection header</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-139.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">No Connection header </span><span class="font0" style="font-weight:bold;"><sup>Dumb prox</sup></span><span class="font1" style="font-weight:bold;">y</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 13pt 70pt;"><span class="font1" style="font-style:italic;">A dumb proxy forwards the Proxy-Connection header, which the server ignores.</span></p>
<p style="padding:0pt 0pt 0pt 77pt;"><span class="font0">The proxy recognizes the Proxy-Connection header, agrees to talk keep-alive with the client, and may also (optionally) decide to set up a keep-alive Connection with the server.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(e) </span><span class="font0">Proxy-Connection: Keep-Alive</span></p></td><td><img src="book_files/book-140.jpg" alt="" style="width:78pt;height:57pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(f) </span><span class="font0">Connection: Keep-Alive</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(g) </span><span class="font0">Connection: Keep-Alive</span></p></td><td><img src="book_files/book-141.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-142.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(h) </span><span class="font0">Connection: Keep-Alive </span><span class="font0" style="font-weight:bold;"><sup>Smart proxy</sup></span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 70pt;"><span class="font1" style="font-style:italic;">A smart proxy understands the Proxy-Connection header and actively sends a Connection: Keep-Alive header to the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark920"></a><span class="font23" style="font-style:italic;">Figure 4-16. Proxy-Connection header fixes single blind relay</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This scheme works around situations where there is only one proxy between the client and server. But if there is a smart proxy on either side of the dumb proxy, the problem will rear its ugly head again, as shown in</span><a href="#bookmark921"><span class="font24"> Figure 4-17</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Furthermore, it is becoming quite common for “invisible” proxies to appear in networks, either as firewalls, intercepting caches, or reverse proxy server accelerators. Because these devices are invisible to the browser, the browser will not send them Proxy-Connection headers. It is critical that transparent web applications implement persistent connections correctly.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark922"></a><span class="font7" style="font-weight:bold;"><a name="bookmark923"></a>HTTP/1.1 Persistent Connections</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">HTTP/1.1 phased out support for keep-alive connections, replacing them with an improved design called </span><span class="font24" style="font-style:italic;">persistent connections</span><span class="font24">. The goals of persistent connections are the same as those of keep-alive connections, but the mechanisms behave better.</span></p>
<p style="text-align:justify;text-indent:43pt;"><span class="font1" style="font-weight:bold;">(a) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(c)</span></p>
<p style="text-align:justify;text-indent:43pt;padding:0pt 0pt 39pt 0pt;"><span class="font0">Proxy-Connection: Keep-Alive &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proxy-Connection: Keep-Alive &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection: Keep-Alive</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(d)</span></p>
<p><span class="font0">Connection: Keep-Alive</span></p></td><td><img src="book_files/book-143.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-144.jpg" alt="" style="width:33pt;height:33pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">(f)</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 0pt 54pt;"><span class="font1" style="font-weight:bold;">Dumb (e)</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Smart</span></p>
</div>
<p style="text-align:justify;padding:0pt 0pt 8pt 19pt;"><span class="font0">onnection: Keep-Alive </span><span class="font1" style="font-weight:bold;">proxy </span><span class="font0">Connection: Keep-Alive </span><span class="font1" style="font-weight:bold;">proxy Client</span></p>
<p style="padding:0pt 0pt 22pt 71pt;"><span class="font1" style="font-style:italic;">A dumb proxy unwittingly advertises keep-Alive to browser and smart proxy.</span></p>
<p style="text-align:justify;text-indent:43pt;"><span class="font1" style="font-weight:bold;">(g) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(h)</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(i)</span></p>
<p><span class="font0">Connection: Keep-Alive</span></p>
</div>
<p style="text-align:justify;text-indent:43pt;padding:0pt 0pt 22pt 0pt;"><span class="font0">Proxy-Connection: Keep-Alive &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection: Keep-Alive</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-145.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-146.jpg" alt="" style="width:34pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><img src="book_files/book-147.jpg" alt="" style="width:36pt;height:18pt;">
<p style="text-align:justify;"><span class="font0" style="font-weight:bold;"><sup>(l)</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">Smart &nbsp;&nbsp;</span><span class="font0" style="font-weight:bold;"><sup>(k)</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">Dumb &nbsp;&nbsp;</span><span class="font0" style="font-weight:bold;"><sup>(j)</sup></span></p>
<p style="padding:0pt 0pt 26pt 0pt;"><span class="font0">Connection: Keep-Alive </span><span class="font0" style="font-weight:bold;"><sub>proxy</sub> &nbsp;&nbsp;</span><span class="font0">Connection: Keep-Alive &nbsp;&nbsp;</span><span class="font0" style="font-weight:bold;"><sub>proxy</sub> &nbsp;&nbsp;</span><span class="font0">Connection: Keep-Alive</span></p>
<div style="float:right;writing-mode:horizontal-tb;"><img src="book_files/book-148.jpg" alt="" style="width:32pt;height:25pt;">
</div>
<p style="text-align:justify;padding:0pt 0pt 11pt 71pt;"><span class="font1" style="font-style:italic;">A dumb proxy unwittingly advertises keep-Alive to smart proxy and server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark921"></a><span class="font23" style="font-style:italic;">Figure 4-17. Proxy-Connection still fails for deeper hierarchies of proxies</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark924"></a><span class="font24">Unlike HTTP/1.0+ keep-alive connections, HTTP/1.1 persistent connections are active by default. HTTP/1.1 assumes </span><span class="font24" style="font-style:italic;">all</span><span class="font24"> connections are persistent unless otherwise indicated. HTTP/1.1 applications have to explicitly add a Connection: close header to a message to indicate that a connection should close after the transaction is complete. This is a significant difference from previous versions of the HTTP protocol, where keep-alive connections were either optional or completely unsupported.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">An HTTP/1.1 client assumes an HTTP/1.1 connection will remain open after a response, unless the response contains a Connection: close header. However, clients and servers still can close idle connections at any time. Not sending Connection: close does not mean that the server promises to keep the connection open forever.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark925"></a><span class="font7" style="font-weight:bold;"><a name="bookmark926"></a>Persistent Connection Restrictions and Rules</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are the restrictions and clarifications regarding the use of persistent connections:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• After sending a Connection: close request header, the client can’t send more requests on that connection.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If a client does not want to send another request on the connection, it should send a Connection: close request header in the final request.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font24">• The connection can be kept persistent only if all messages on the connection have a correct, self-defined message length—i.e., the entity bodies must have correct Content-Lengths or be encoded with the chunked transfer encoding.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• HTTP/1.1 proxies must manage persistent connections separately with clients and servers—each persistent connection applies to a single transport hop.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• HTTP/1.1 proxy servers should not establish persistent connections with an HTTP/1.0 client (because of the problems of older proxies forwarding Connection headers) unless they know something about the capabilities of the client. This is, in practice, difficult, and many vendors bend this rule.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Regardless of the values of Connection headers, HTTP/1.1 devices may close the connection at any time, though servers should try not to close in the middle of transmitting a message and should <a name="bookmark927"></a>always respond to at least one request before closing.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark928"></a><span class="font24">• HTTP/1.1 applications must be able to recover from asynchronous closes. Clients should retry the requests as long as they don’t have side effects that could accumulate.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Clients must be prepared to retry requests if the connection closes before they receive the entire response, unless the request could have side effects if repeated.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• A single user client should maintain at most two persistent connections to any server or proxy, to prevent the server from being overloaded. Because proxies may need more connections to a server to support concurrent users, a proxy should maintain at most 2</span><span class="font24" style="font-style:italic;">N</span><span class="font24"> connections to any server or parent proxy, if there are </span><span class="font24" style="font-style:italic;">N</span><span class="font24"> users trying to access the servers.</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark929"></a><span class="font9" style="font-weight:bold;"><a name="bookmark37"></a><a name="bookmark930"></a>Pipelined Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">HTTP/1.1 permits optional </span><span class="font24" style="font-style:italic;">request pipelining</span><span class="font24"> over persistent connections. This is a further performance optimization over keep-alive connections. Multiple requests can be enqueued before the responses arrive. While the first request is streaming across the network to a server on the other side of the globe, the second and third requests can get underway. This can improve performance in high-latency network conditions, by reducing network round trips.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark931"><span class="font24">Figure 4-18</span></a><span class="font24">a-c shows how persistent connections can eliminate TCP connection delays and how pipelined requests (</span><a href="#bookmark931"><span class="font24">Figure 4-18</span></a><span class="font24">c) can eliminate transfer latencies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">There are several restrictions for pipelining:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP clients should not pipeline until they are sure the connection is persistent.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• HTTP responses must be returned in the same order as the requests. HTTP messages are not tagged with sequence numbers, so there is no way to match responses with requests if the responses are received out of order.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• HTTP clients must be prepared for the connection to close at any time and be prepared to redo any pipelined requests that did not finish. If the client opens a persistent connection and immediately issues 10 requests, the server is free to close the connection after processing only, say, 5 requests. The remaining 5</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Serial connections</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-149.jpg" alt="" style="width:31pt;height:41pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Transaction 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font0">Transaction 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-150.jpg" alt="" style="width:15pt;height:31pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-151.jpg" alt="" style="width:41pt;height:29pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Connect- 1</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Connect- 4</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Persistent connection</span></p></td></tr>
<tr><td><img src="book_files/book-152.jpg" alt="" style="width:202pt;height:91pt;">
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p><span class="font0">Transaction 1 Transaction 2 Transaction 3 Transaction 4</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Pipelined, persistent connection</span></p></td></tr>
<tr><td><img src="book_files/book-153.jpg" alt="" style="width:121pt;height:91pt;">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Transaction- 1</span></p>
<p><span class="font1" style="font-style:italic;">Transaction- 2</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-style:italic;">Transaction- 3</span></p>
<p><span class="font1" style="font-style:italic;">Transaction- 4</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Time</span></p>
</div><br clear="all"></li></ul>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark931"></a><span class="font23" style="font-style:italic;">Figure 4-18. Four transactions (pipelined connections)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">requests will fail, and the client must be willing to handle these premature closes and reissue the requests.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• HTTP clients should not pipeline requests that have side effects (such as POSTs). In general, on error, pipelining prevents clients from knowing which of a series of pipelined requests were executed by the server. Because nonidempotent requests such as POSTs cannot safely be retried, you run the risk of some methods never being executed in error conditions.</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark932"></a><span class="font9" style="font-weight:bold;"><a name="bookmark933"></a><a name="bookmark38"></a><a name="bookmark934"></a>The Mysteries of Connection Close</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Connection management—particularly knowing when and how to close connec-tions—is one of the practical black arts of HTTP. This issue is more subtle than many developers first realize, and little has been written on the subject.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark935"></a><span class="font7" style="font-weight:bold;"><a name="bookmark936"></a>“At Will” Disconnection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Any HTTP client, server, or proxy can close a TCP transport connection at any time. The connections normally are closed at the end of a message,<a name="footnote28"></a><sup><a href="#bookmark937">28</a></sup><sup></sup> but during error conditions, the connection may be closed in the middle of a header line or in other strange places.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This situation is common with pipelined persistent connections. HTTP applications are free to close persistent connections after any period of time. For example, after a persistent connection has been idle for a while, a server may decide to shut it down.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">However, the server can never know for sure that the client on the other end of the line wasn’t about to send data at the same time that the “idle” connection was being shut down by the server. If this happens, the client sees a connection error in the middle of writing its request message.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark938"></a><span class="font7" style="font-weight:bold;"><a name="bookmark939"></a>Content-Length and Truncation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each HTTP response should have an accurate Content-Length header to describe the size of the response body. Some older HTTP servers omit the Content-Length header or include an erroneous length, depending on a server connection close to signify the actual end of data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a client or proxy receives an HTTP response terminating in connection close, and the actual transferred entity length doesn’t match the Content-Length (or there is no Content-Length), the receiver should question the correctness of the length.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If the receiver is a caching proxy, the receiver should not cache the response (to minimize future compounding of a potential error). The proxy should forward the questionable message intact, without attempting to “correct” the Content-Length, to maintain semantic transparency.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark940"></a><span class="font7" style="font-weight:bold;"><a name="bookmark941"></a>Connection Close Tolerance, Retries, and Idempotency</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Connections can close at any time, even in non-error conditions. HTTP applications have to be ready to properly handle unexpected closes. If a transport connection closes while the client is performing a transaction, the client should reopen the connection and retry one time, unless the transaction has side effects. The situation is worse for pipelined connections. The client can enqueue a large number of requests, but the origin server can close the connection, leaving numerous requests unprocessed and in need of rescheduling.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Side effects are important. When a connection closes after some request data was sent but before the response is returned, the client cannot be 100% sure how much of the transaction actually was invoked by the server. Some transactions, such as GETting a static HTML page, can be repeated again and again without changing anything. Other transactions, such as POSTing an order to an online book store, shouldn’t be repeated, or you may risk multiple orders.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A transaction is </span><span class="font24" style="font-style:italic;">idempotent</span><span class="font24"> if it yields the same result regardless of whether it is executed once or many times. Implementors can assume the GET, HEAD, PUT, DELETE, TRACE, and OPTIONS methods share this property.<a name="footnote29"></a><sup><a href="#bookmark942">29</a></sup><sup></sup> Clients shouldn’t pipeline nonidempotent requests (such as POSTs). Otherwise, a premature termination of the transport connection could lead to indeterminate results. If you want to send a nonidempotent request, you should wait for the response status for the previous request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Nonidempotent methods or sequences must not be retried automatically, although user agents may offer a human operator the choice of retrying the request. For example, most browsers will offer a dialog box when reloading a cached POST response, asking if you want to post the transaction again.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark943"></a><span class="font7" style="font-weight:bold;"><a name="bookmark944"></a>Graceful Connection Close</span></h3>
<p style="text-align:justify;"><span class="font24">TCP connections are bidirectional, as shown in </span><a href="#bookmark945"><span class="font24">Figure 4-19</span></a><span class="font24">. Each side of a TCP connection has an input queue and an output queue, for data being read or written. Data placed in the output of one side will eventually show up on the input of the other side.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-154.jpg" alt="" style="width:50pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-155.jpg" alt="" style="width:79pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 14pt 0pt;"><a name="bookmark945"></a><span class="font23" style="font-style:italic;">Figure 4-19. TCP connections are bidirectional</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark946"></a><span class="font5" style="font-weight:bold;"><a name="bookmark947"></a>Full and half closes</span></h4>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font24">An application can close either or both of the TCP input and output channels. A </span><span class="font4">close( ) </span><span class="font24">sockets call closes both the input and output channels of a TCP connection.</span></p>
<p style="text-align:justify;"><a name="bookmark666"></a><span class="font24">This is called a “full close” and is depicted in</span><a href="#bookmark948"><span class="font24"> Figure 4-20</span></a><span class="font24">a. You can use the </span><span class="font4">shutdown( ) </span><span class="font24">sockets call to close either the input or output channel individually. This is called a “half close” and is depicted in</span><a href="#bookmark948"><span class="font24"> Figure 4-20b</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="padding:0pt 0pt 0pt 36pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Server full close in</span></p></td></tr>
<tr><td><img src="book_files/book-156.jpg" alt="" style="width:36pt;height:29pt;"></td><td>
<p><span class="font0">out</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">out</span></p>
<p><span class="font0">in</span></p></td><td><img src="book_files/book-157.jpg" alt="" style="width:32pt;height:41pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-158.jpg" alt="" style="width:32pt;height:23pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Server output half close (graceful close)</span></p></td></tr>
<tr><td><img src="book_files/book-159.jpg" alt="" style="width:119pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">in</span></p></td><td><img src="book_files/book-160.jpg" alt="" style="width:31pt;height:41pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">out</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Server input half close</span></p></td></tr>
<tr><td><img src="book_files/book-161.jpg" alt="" style="width:119pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">out</span></p>
<p><span class="font0">in</span></p></td><td><img src="book_files/book-162.jpg" alt="" style="width:31pt;height:41pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark948"></a><span class="font23" style="font-style:italic;">Figure 4-20. Full and half close</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark949"></a><span class="font5" style="font-weight:bold;"><a name="bookmark950"></a>TCP close and reset errors</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Simple HTTP applications can use only full closes. But when applications start talking to many other types of HTTP clients, servers, and proxies, and when they start using pipelined persistent connections, it becomes important for them to use half closes to prevent peers from getting unexpected write errors.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In general, closing the output channel of your connection is always safe. The peer on the other side of the connection will be notified that you closed the connection by getting an end-of-stream notification once all the data has been read from its buffer.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Closing the input channel of your connection is riskier, unless you know the other side doesn’t plan to send any more data. If the other side sends data to your closed input channel, the operating system will issue a TCP “connection reset by peer” message back to the other side’s machine, as shown in</span><a href="#bookmark951"><span class="font24"> Figure 4-21</span></a><span class="font24">. Most operating systems treat this as a serious error and erase any buffered data the other side has not read yet. This is very bad for pipelined connections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Say you have sent 10 pipelined requests on a persistent connection, and the responses already have arrived and are sitting in your operating system’s buffer (but the application hasn’t read them yet). Now say you send request #11, but the server decides you’ve used this connection long enough, and closes it. Your request #11 will arrive at a closed connection and will reflect a reset back to you. This reset will erase your input buffers.</span></p><img src="book_files/book-163.jpg" alt="" style="width:148pt;height:75pt;">
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark951"></a><span class="font23" style="font-style:italic;">Figure 4-21. Data arriving at closed connection generates “connection reset by peer” error</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">When you finally get to reading data, you will get a connection reset by peer error, and the buffered, unread response data will be lost, even though much of it successfully arrived at your machine.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark952"></a><span class="font5" style="font-weight:bold;"><a name="bookmark953"></a>Graceful close</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP specification counsels that when clients or servers want to close a connection unexpectedly, they should “issue a graceful close on the transport connection,” but it d<a name="bookmark954"></a>oesn’t describe how to do that.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In general, applications implementing graceful closes will first close their output channels and then wait for the peer on the other side of the connection to close </span><span class="font24" style="font-style:italic;">its </span><span class="font24">output channels. When both sides are done telling each other they won’t be sending any more data (i.e., closing output channels), the connection can be closed fully, with no risk of reset.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Unfortunately, there is no guarantee that the peer implements or checks for half closes. For this reason, applications wanting to close gracefully should half close their output channels and periodically check the status of their input channels (looking for data or for the end of the stream). If the input channel isn’t closed by the peer within some timeout period, the application may force connection close to save resources.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark819"></a><span class="font9" style="font-weight:bold;"><a name="bookmark39"></a><a name="bookmark955"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This completes our overview of the HTTP plumbing trade. Please refer to the following reference sources for more information about TCP performance and HTTP connection-management facilities.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark956"></a><span class="font7" style="font-weight:bold;"><a name="bookmark957"></a>HTTP Connections</span></h3>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol—HTTP/1.1,” is the official specification for HTTP/1.1; it explains the usage of and HTTP header fields for implementing parallel, persistent, and pipelined HTTP connections. This document does not cover the proper use of the underlying TCP connections.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2068.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2068.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 20pt;"><span class="font24">RFC 2068 is the 1997 version of the HTTP/1.1 protocol. It contains explanation of the HTTP/1.0+ Keep-Alive connections that is missing from RFC 2616.</span></p>
<p><a href="http://www.ics.uci.edu/pub/ietf/http/draft-ietf-http-connection-00.txt"><span class="font24" style="font-style:italic;">http://www.ics.uci.edu/pub/ietf/http/draft-ietf-http-connection-00.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 20pt;"><span class="font24">This expired Internet draft, “HTTP Connection Management,” has some good discussion of issues facing HTTP connection management.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark958"></a><span class="font7" style="font-weight:bold;"><a name="bookmark959"></a>HTTP Performance Issues</span></h3>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/HTTP/Performance/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP/Performance/</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 20pt;"><span class="font24">This W3C web page, entitled “HTTP Performance Overview,” contains a few papers and tools related to HTTP performance and connection management.</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/HTTP/1.0/HTTPPerformance.html"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP/1.0/HTTPPerformance.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 20pt;"><span class="font24">This short memo by Simon Spero, “Analysis of HTTP Performance Problems,” is one of the earliest (1994) assessments of HTTP connection performance. The memo gives some early performance measurements of the effect of connection setup, slow start, and lack of connection sharing.</span></p>
<p><a href="ftp://gatekeeper.dec.com/pub/DEC/WRL/research-reports/WRL-TR-95.4.pdf"><span class="font24" style="font-style:italic;">ftp://gatekeeper.dec.com/pub/DEC/WRL/research-reports/WRL-TR-95.4.pdf</span></a></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“The Case for Persistent-Connection HTTP.”</span></p>
<p><a href="http://www.isi.edu/lsam/publications/phttp_tcp_interactions/paper.html"><span class="font24" style="font-style:italic;">http://www.isi.edu/lsam/publications/phttp_tcp_interactions/paper.html</span></a></p>
<p style="text-indent:20pt;"><span class="font24">“Performance Interactions Between P-HTTP and TCP Implementations.” </span><a href="http://www.sun.com/sun-on-net/performance/tcp.slowstart.html"><span class="font24" style="font-style:italic;">http://www.sun.com/sun-on-net/performance/tcp.slowstart.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 20pt;"><span class="font24">“TCP Slow Start Tuning for Solaris” is a web page from Sun Microsystems that talks about some of the practical implications of TCP slow start. It’s a useful read, even if you are working with different operating systems.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark960"></a><span class="font7" style="font-weight:bold;"><a name="bookmark961"></a>TCP/IP</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following three books by W. Richard Stevens are excellent, detailed engineering texts on TCP/IP. These are extremely useful for anyone using TCP:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">TCP Illustrated, Volume I: The Protocols</span></p>
<p style="text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">W. Richard Stevens, Addison Wesley</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">UNIX Network Programming, Volume 1: Networking APIs</span></p>
<p style="text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">W. Richard Stevens, Prentice-Hall</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">UNIX Network Programming, Volume 2: The Implementation</span></p>
<p style="text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">W. Richard Stevens, Prentice-Hall</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The following papers and specifications describe TCP/IP and features that affect its performance. Some of these specifications are over 20 years old and, given the worldwide success of TCP/IP, probably can be classified as historical treasures:</span></p>
<p style="text-align:justify;"><a href="http://www.acm.org/sigcomm/ccr/archive/2001/jan01/ccr-200101-mogul.pdf"><span class="font24" style="font-style:italic;">http://www.acm.org/sigcomm/ccr/archive/2001/jan01/ccr-200101-mogul.pdf</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">In “Rethinking the TCP Nagle Algorithm,” Jeff Mogul and Greg Minshall present a modern perspective on Nagle’s algorithm, outline what applications should and should not use the algorithm, and propose several modifications.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2001.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2001.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 2001, “TCP Slow Start, Congestion Avoidance, Fast Retransmit, and Fast Recovery Algorithms,” defines the TCP slow-start algorithm.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc1122.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1122.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 1122, “Requirements for Internet Hosts—Communication Layers,” discusses TCP acknowledgment and delayed acknowledgments.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc896.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc896.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 896, “Congestion Control in IP/TCP Internetworks,” was released by John Nagle in 1984. It describes the need for TCP congestion control and introduces what is now called “Nagle’s algorithm.”</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc0813.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc0813.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 813, “Window and Acknowledgement Strategy in TCP,” is a historical (1982) specification that describes TCP window and acknowledgment implementation strategies and provides an early description of the delayed acknowledgment technique.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc0793.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc0793.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 793, “Transmission Control Protocol,” is Jon Postel’s classic 1981 definition of the TCP protocol.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 3pt 0pt;"><a name="bookmark228"></a><span class="font9" style="font-weight:bold;"><a name="bookmark962"></a><a name="bookmark963"></a>PART II</span></h1>
<p style="text-align:right;padding:0pt 0pt 113pt 0pt;"><a name="bookmark218"></a><span class="font12" style="font-weight:bold;">HTTP Architecture</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark40"></a><span class="font24"><a name="bookmark41"></a>The six chapters of Part II highlight the HTTP server, proxy, cache, gateway, and robot applications, which are the building blocks of web systems architecture:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark229"><span class="font24">Chapter 5, </span><span class="font24" style="font-style:italic;">Web Servers</span></a><span class="font24">, gives an overview of web server architectures.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark230"><span class="font24">Chapter 6, </span><span class="font24" style="font-style:italic;">Proxies</span></a><span class="font24">, describes HTTP proxy servers, which are intermediary servers that connect HTTP clients and act as platforms for HTTP services and controls.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark231"><span class="font24">Chapter 7, </span><span class="font24" style="font-style:italic;">Caching</span></a><span class="font24">, delves into the science of web caches—devices that improve performance and reduce traffic by making local copies of popular documents.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark964"><span class="font24">Chapter 8, </span><span class="font24" style="font-style:italic;">Integration Points: Gateways, Tunnels, and Relays</span></a><span class="font24">, explains applications that allow HTTP to interoperate with software that speaks different protocols, including SSL encrypted protocols.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark233"><span class="font24">Chapter 9, </span><span class="font24" style="font-style:italic;">Web Robots</span></a><span class="font24">, wraps up our tour of HTTP architecture with web clients.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark234"><span class="font24">Chapter 10, </span><span class="font24" style="font-style:italic;">HTTP-NG</span></a><span class="font24">, covers future topics for HTTP—in particular, HTTP-NG.</span></p></li></ul>
<p style="text-align:right;padding:0pt 0pt 4pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 5</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark229"></a><span class="font11" style="font-weight:bold;"><a name="bookmark42"></a><a name="bookmark965"></a>Web Servers</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark966"></a><span class="font24"><a name="bookmark967"></a><a name="bookmark968"></a>Web servers dish out billions of web pages a day. They tell you the weather, load up your online shopping carts, and let you find long-lost high-school buddies. Web servers are the workhorses of the World Wide Web. In this chapter, we:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Survey the many different types of software and hardware web servers.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Describe how to write a simple diagnostic web server in Perl.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Explain how web servers process HTTP transactions, step by step.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Where it helps to make things concrete, our examples use the Apache web server and its configuration options.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark969"></a><span class="font9" style="font-weight:bold;"><a name="bookmark970"></a><a name="bookmark43"></a><a name="bookmark971"></a>Web Servers Come in All Shapes and Sizes</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A web server processes HTTP requests and serves responses. The term “web server” can refer either to web server software or to the particular device or computer dedicated to serving the web pages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web servers comes in all flavors, shapes, and sizes. There are trivial 10-line Perl script web servers, 50-MB secure commerce engines, and tiny servers-on-a-card. But whatever the functional differences, all web servers receive HTTP requests for resources and serve content back to the clients (look back to </span><a href="#bookmark297"><span class="font24">Figure 1-5</span></a><span class="font24">).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark972"></a><span class="font7" style="font-weight:bold;"><a name="bookmark973"></a>Web Server Implementations</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web servers implement HTTP and the related TCP connection handling. They also manage the resources served by the web server and provide administrative features to configure, control, and enhance the web server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The web server logic implements the HTTP protocol, manages web resources, and provides web server administrative capabilities. The web server logic shares responsibilities for managing TCP connections with the operating system. The underlying operating system manages the hardware details of the underlying computer system and provides TCP/IP network support, filesystems to hold web resources, and process management to control current computing activities.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web servers are available in many forms:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark974"></a><span class="font24">• You can install and run general-purpose software web servers on standard computer systems.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If you don’t want the hassle of installing software, you can purchase a web server appliance, in which the software comes preinstalled and preconfigured on a computer, often in a snazzy-looking chassis.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Given the miracles of microprocessors, some companies even offer embedded web servers implemented in a small number of computer chips, making them perfect administration consoles for consumer devices.</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">Let’s look at each of those types of implementations.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark975"></a><span class="font7" style="font-weight:bold;"><a name="bookmark976"></a><a name="bookmark977"></a>General-Purpose Software Web Servers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">General-purpose software web servers run on standard, network-enabled computer systems. You can choose open source software (such as Apache or W3C’s Jigsaw) or commercial software (such as Microsoft’s and iPlanet’s web servers). Web server software is available for just about every computer and operating system.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">While there are tens of thousands of different kinds of web server programs (including custom-crafted, special-purpose web servers), most web server software comes from a small number of organizations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In February 2002, the Netcraft survey (</span><a href="http://www.netcraft.com/survey/"><span class="font24" style="font-style:italic;">http://www.netcraft.com/survey/</span></a><span class="font24">) showed three vendors dominating the public Internet web server market (see</span><a href="#bookmark978"><span class="font24"> Figure 5-1</span></a><span class="font24">):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The free Apache software powers nearly 60% of all Internet web servers.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Microsoft web server makes up another 30%.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 17pt 0pt;"><span class="font24">• Sun iPlanet servers comprise another 3%.</span></p>
<table>
<tr><td><img src="book_files/book-164.jpg" alt="" style="width:346pt;height:103pt;"></td></tr>
<tr><td>
<p><a name="bookmark978"></a><span class="font23" style="font-style:italic;">Figure 5-1. Web server market share as estimated by Netcraft’s automated survey</span></p></td></tr>
</table></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark979"></a><span class="font24">Take these numbers with a few grains of salt, however, as the Netcraft survey is commonly believed to exaggerate the dominance of Apache software. First, the survey counts servers independent of server popularity. Proxy server access studies from large ISPs suggest that the amount of pages served from Apache servers is much less than 60% but still exceeds Microsoft and Sun iPlanet. Additionally, it is anecdotally believed that Microsoft and iPlanet servers are more popular than Apache inside corporate enterprises.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark980"></a><span class="font7" style="font-weight:bold;"><a name="bookmark981"></a>Web Server Appliances</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark982"></a><span class="font24" style="font-style:italic;">Web server appliances</span><span class="font24"> are prepackaged software/hardware solutions. The vendor preinstalls a software server onto a vendor-chosen computer platform and preconfigures the software. Some examples of web server appliances include:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Sun/Cobalt RaQ web appliances (</span><a href="http://www.cobalt.com"><span class="font24" style="font-style:italic;">http://www.cobalt.com</span></a><span class="font24">)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Toshiba Magnia SG10 (</span><a href="http://www.toshiba.com"><span class="font24" style="font-style:italic;">http://www.toshiba.com</span></a><span class="font24">)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• IBM Whistle web server appliance (</span><a href="http://www.whistle.com"><span class="font24" style="font-style:italic;">http://www.whistle.com</span></a><span class="font24">)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Appliance solutions remove the need to install and configure software and often greatly simplify administration. However, the web server often is less flexible and feature-rich, and the server hardware is not easily repurposeable or upgradable.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark983"></a><span class="font7" style="font-weight:bold;"><a name="bookmark984"></a>Embedded Web Servers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark985"></a><span class="font24" style="font-style:italic;">Embedded servers</span><span class="font24"> are tiny web servers intended to be embedded into consumer products (e.g., printers or home appliances). Embedded web servers allow users to administer their consumer devices using a convenient web browser interface.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Some embedded web servers can even be implemented in less than one square inch, but they usually offer a minimal feature set. Two examples of very small embedded web servers are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• IPic match-head sized web server (</span><a href="http://www-ccs.cs.umass.edu/~shri/iPic.html"><span class="font24" style="font-style:italic;">http://www-ccs.cs.umass.edu/~shri/iPic.html</span></a><span class="font24">)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• NetMedia SitePlayer SP1 Ethernet Web Server (</span><a href="http://www.siteplayer.com"><span class="font24" style="font-style:italic;">http://www.siteplayer.com</span></a><span class="font24">)</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark986"></a><span class="font9" style="font-weight:bold;"><a name="bookmark44"></a><a name="bookmark987"></a>A Minimal Perl Web Server</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">If you want to build a full-featured HTTP server, you have some work to do. The core of the Apache web server has over 50,000 lines of code, and optional processing modules make that number much bigger.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">All this software is needed to support HTTP/1.1 features: rich resource support, virtual hosting, access control, logging, configuration, monitoring, and performance features. That said, you can create a minimally functional HTTP server in under 30 lines of Perl. Let’s take a look.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a href="#bookmark988"><span class="font24">Example 5-1 </span></a><a name="bookmark989"></a><span class="font24">shows a tiny Perl program called </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24">. This program is a useful diagnostic tool for testing interactions with clients and proxies. Like any web server, </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> waits for an HTTP connection. As soon as </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> gets the request message, it prints the message on the screen; then it waits for you to type (or paste) in a response message, which is sent back to the client. This way, </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> pretends to be a web server, records the exact HTTP request messages, and allows you to send back any HTTP response message.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">This simple </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> utility doesn’t implement most HTTP functionality, but it is a useful tool to generate server response messages the same way you can use Telnet to generate client request messages (refer back to </span><a href="#bookmark988"><span class="font24">Example 5-1</span></a><span class="font24">). You can download the </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> program from </span><a href="http://www.http-guide.com/tools/type-o-serve.pl"><span class="font24" style="font-style:italic;">http://www.http-guide.com/tools/type-o-serve.pl</span></a><span class="font24">.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark988"></a><span class="font23" style="font-style:italic;">Example 5-1. type-o-serve—a minimal Perl web server used for HTTP debugging</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">#!/usr/bin/perl</span></p>
<p><span class="font3">use Socket;</span></p>
<p><span class="font3">use Carp;</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">use FileHandle;</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3"># (1) use port 8080 by default, unless overridden on command line $port = (@ARGV ? $ARGV[0] : 8080);</span></p></li>
<li>
<p><span class="font3"># (2) create local TCP socket and set it to listen for connections</span></p></li></ul>
<p><span class="font3">$proto = getprotobyname('tcp');</span></p>
<p><span class="font3">socket(S, PF_INET, SOCK_STREAM, $proto) || die;</span></p>
<p><span class="font3">setsockopt(S, SOL_SOCKET, SO_REUSEADDR, pack(&quot;l&quot;, 1)) || die;</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">bind(S, sockaddr_in($port, INADDR_ANY)) || die; listen(S, SOMAXCONN) || die;</span></p>
<ul style="list-style:none;"><li>
<p><span class="font3"># (3) print a startup message</span></p></li></ul>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot; &lt;&lt;&lt;Type-O-Serve Accepting on Port %d&gt;&gt;&gt;\n\n&quot;,$port);</span></p>
<p><span class="font3">while (1)</span></p>
<p><span class="font3">{</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:17pt;"><span class="font3"># (4) wait for a connection C</span></p></li></ul>
<p style="text-indent:17pt;"><span class="font3">$cport_caddr = accept(C, S);</span></p>
<p style="text-indent:17pt;"><span class="font3">($cport,$caddr) = sockaddr_in($cport_caddr);</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">C-&gt;autoflush(1);</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:17pt;"><span class="font3"># (5) print who the connection is from</span></p></li></ul>
<p style="text-indent:17pt;"><span class="font3">$cname = gethostbyaddr($caddr,AF_INET);</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot; &lt;&lt;&lt;Request From '%s'&gt;&gt;&gt;\n&quot;,$cname);</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font3"># (6) read request msg until blank line, and print on screen while ($line = &lt;C&gt;)</span></p></li></ul>
<p style="text-indent:17pt;"><span class="font3">{</span></p>
<p style="text-indent:33pt;"><span class="font3">print $line;</span></p>
<p style="text-indent:33pt;"><span class="font3">if ($line =~ /^\r/) { last; }</span></p>
<p style="text-indent:17pt;"><span class="font3">}</span></p>
<p style="padding:0pt 0pt 7pt 0pt;"><span class="font23" style="font-style:italic;">Example 5-1. type-o-serve—a minimal Perl web server used for HTTP debugging (continued)</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:1pt;padding:0pt 0pt 10pt 17pt;"><span class="font3"># (7) prompt for response message, and input response lines, # sending response lines to client, until solitary &quot;.&quot; printf(&quot; &lt;&lt;&lt;Type Response Followed by '.'&gt;&gt;&gt;\n&quot;);</span></p></li></ul>
<p style="text-indent:17pt;"><span class="font3">while ($line = &lt;STDIN&gt;)</span></p>
<p style="text-indent:17pt;"><span class="font3">{</span></p>
<p style="text-indent:33pt;"><span class="font3">$line =~ s/\r//;</span></p>
<p style="text-indent:33pt;"><span class="font3">$line =~ s/\n//;</span></p>
<p style="text-indent:33pt;"><span class="font3">if ($line =~ /^\./) { last; }</span></p>
<p style="text-indent:33pt;"><span class="font3">print C $line . &quot;\r\n&quot;;</span></p>
<p style="text-indent:17pt;"><span class="font3">}</span></p>
<p style="text-indent:17pt;"><span class="font3">close(C);</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font3">}</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark990"><span class="font24">Figure 5-2</span></a><span class="font24"> shows how the administrator of Joe’s Hardware store might use </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> to test HTTP communication:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 17pt;"><span class="font24">• First, the administrator starts the </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> diagnostic server, listening on a particular port. Because Joe’s Hardware store already has a production web server listing on port 80, the administrator starts the </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> server on port 8080 (you can pick any unused port) with this command line:</span></p></li></ul>
<p style="text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">% type-o-serve.pl 8080</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 17pt;"><a name="bookmark991"></a><span class="font24">• Once </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> is running, you can point a browser to this web server. In </span><a href="#bookmark990"><span class="font24">Figure 5-2</span></a><span class="font24">, we browse to </span><a href="http://www.joes-hardware.com:8080/foo/bar/blah.txt"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com:8080/foo/bar/blah.txt</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 17pt;"><span class="font24">• The </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24"> program receives the HTTP request message from the browser and prints the contents of the HTTP request message on screen. The </span><span class="font24" style="font-style:italic;">type-o-serve </span><span class="font24">diagnostic tool then waits for the user to type in a simple response message, followed by a period on a blank line.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 17pt;"><span class="font24">•</span><span class="font24" style="font-style:italic;"> type-o-serve</span><span class="font24"> sends the HTTP response message back to the browser, and the browser displays the body of the response message.</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark992"></a><span class="font9" style="font-weight:bold;"><a name="bookmark45"></a><a name="bookmark993"></a>What Real Web Servers Do</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The Perl server we showed in </span><a href="#bookmark988"><span class="font24">Example 5-1 </span></a><span class="font24">is a trivial example web server. State-of-the-art commercial web servers are much more complicated, but they do perform several common tasks, as shown in</span><a href="#bookmark994"><span class="font24"> Figure 5-3</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">1. Set up connection—accept a client connection, or close if the client is unwanted.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">2. Receive request—read an HTTP request message from the network.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">3. Process request—interpret the request message and take action.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">4. Access resource—access the resource specified in the message.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">5. Construct response—create the HTTP response message with the right headers.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">6. Send response—send the response back to the client.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">7. Log transaction—place notes about the completed transaction in a log file.</span></p></li></ul>
<p style="text-indent:12pt;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">HTTP request message</span></p>
<p style="text-indent:16pt;"><span class="font2">GET /foo/bar/blah.txt HTTP/1.1</span></p>
<p style="text-indent:16pt;"><span class="font2">Accept: */*</span></p>
<p style="text-indent:16pt;"><span class="font2">Accept-language: en-us</span></p>
<p style="text-indent:16pt;"><span class="font2">Accept-encoding: gzip, deflate</span></p>
<p style="text-indent:16pt;"><span class="font2">User-agent: Mozilla/4.0</span></p>
<p style="text-indent:16pt;"><span class="font2">Host: </span><a href="http://www.joes.hardware.com:8080"><span class="font2">www.joes.hardware.com:8080</span></a></p>
<p style="text-indent:16pt;"><span class="font2">Connection: Keep-alive</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">type-o-serve dialog</span></p></td></tr>
<tr><td><img src="book_files/book-165.jpg" alt="" style="width:346pt;height:155pt;"></td></tr>
<tr><td>
<p><a name="bookmark990"></a><span class="font23" style="font-style:italic;">Figure 5-2. The type-o-serve utility lets you type in server responses to send back to clients</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">User space</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">HTTP server software process</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(3) </span><span class="font0">Process request</span></p></td></tr>
<tr><td><img src="book_files/book-166.jpg" alt="" style="width:78pt;height:24pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-167.jpg" alt="" style="width:17pt;height:38pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-168.jpg" alt="" style="width:21pt;height:21pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">(5) </span><span class="font0">Create response</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(2) </span><span class="font0">Receive request</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark995"></a><span class="font1" style="font-weight:bold;">(4) </span><span class="font0">Access resource</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(7) </span><span class="font0">Log transaction</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">TCP/IP network stack</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-169.jpg" alt="" style="width:19pt;height:23pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-170.jpg" alt="" style="width:41pt;height:44pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(1) </span><span class="font0">Set up connection</span></p></td></tr>
<tr><td><img src="book_files/book-171.jpg" alt="" style="width:94pt;height:43pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-172.jpg" alt="" style="width:37pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Network interface</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Object storage</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Operating system</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark994"></a><span class="font23" style="font-style:italic;">Figure 5-3. Steps of a basic web server request</span></p>
<p style="text-align:justify;"><span class="font24">The next seven sections highlight how web servers perform these basic tasks.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark996"></a><span class="font9" style="font-weight:bold;"><a name="bookmark997"></a><a name="bookmark998"></a><a name="bookmark46"></a><a name="bookmark999"></a>Step 1: Accepting Client Connections</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If a client already has a persistent connection open to the server, it can use that connection to send its request. Otherwise, the client needs to open a new connection to the server (refer back to </span><a href="#bookmark226"><span class="font24">Chapter 4</span></a><span class="font24"> to review HTTP connection-management technology).</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1000"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1001"></a>Handling New Connections</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1002"></a><span class="font24">When a client requests a TCP connection to the web server, the web server establishes the connection and determines which client is on the other side of the connection, extracting the IP address from the TCP connection.<a name="footnote30"></a><sup><a href="#bookmark1003">30</a></sup><sup></sup> Once a new connection is established and accepted, the server adds the new connection to its list of existing web server connections and prepares to watch for data on the connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1004"></a><span class="font24">The web server is free to reject and immediately close any connection. Some web servers close connections because the client IP address or hostname is unauthorized or is a known malicious client. Other identification techniques can also be used.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1005"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1006"></a>Client Hostname Identification</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Most web servers can be configured to convert client IP addresses into client hostnames, using “reverse DNS.” Web servers can use the client hostname for detailed access control and logging. Be warned that hostname lookups can take a very long time, slowing down web transactions. Many high-capacity web servers either disable hostname resolution or enable it only for particular content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1007"></a><span class="font24">You can enable hostname lookups in Apache with the </span><span class="font24" style="font-style:italic;">HostnameLookups</span><span class="font24"> configuration directive. For example, the Apache configuration directives in </span><a href="#bookmark1008"><span class="font24">Example 5-2 </span></a><span class="font24">turn on hostname resolution for only HTML and CGI resources.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1008"></a><span class="font23" style="font-style:italic;">Example 5-2. Configuring Apache to look up hostnames for HTML and CGI resources</span></p>
<p style="text-align:justify;"><span class="font3">HostnameLookups off</span></p>
<p style="text-align:justify;"><span class="font3">&lt;Files ~ &quot;\.(html|htm|cgi)$&quot;&gt;</span></p>
<p style="text-indent:17pt;"><span class="font3">HostnameLookups on</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font3">&lt;/Files&gt;</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1009"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1010"></a>Determining the Client User Through ident</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Some web servers also support the IETF </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol. The </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol lets servers find out what username initiated an HTTP connection. This information is particularly useful for web server logging—the second field of the popular Common Log Format contains the </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> username of each HTTP request.<a name="footnote31"></a><sup><a href="#bookmark1011">31</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 16pt 0pt;"><span class="font24">If a client supports the </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol, the client listens on TCP port 113 for </span><span class="font24" style="font-style:italic;">ident </span><span class="font24">requests.</span><a href="#bookmark1012"><span class="font24"> Figure 5-4</span></a><span class="font24"> shows how the </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol works. In</span><a href="#bookmark1012"><span class="font24"> Figure 5-4</span></a><span class="font24">a, the client opens an HTTP connection. The server then opens its own connection back to the client’s </span><span class="font24" style="font-style:italic;">identd</span><span class="font24"> server port (113), sends a simple request asking for the username corresponding to the new connection (specified by client and server port numbers), and retrieves from the client the response containing the username.</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> M</span><span class="font0" style="text-decoration:underline;">ary establishes new</span><span class="font0"> HTTP </span><span class="font0" style="text-decoration:underline;">connection</span></p></li></ul>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font0" style="font-weight:bold;"><sup>Port 4236</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3" style="font-weight:bold;font-style:italic;">HTTP connection</span><span class="font0" style="font-weight:bold;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<sup>Port 80</sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 85pt;"><span class="font1" style="text-decoration:underline;"><sub>4236,80</sub></span><span class="font1"> </span><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Server sends request</span></p>
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> Server establishes </span><span class="font1" style="font-style:italic;">ident</span><span class="font0"> connection </span><span class="font1" style="font-weight:bold;">Mary &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0" style="font-weight:bold;"><sup>Port 80</sup> </span><span class="font1" style="font-weight:bold;">Web server</span></p></li></ul>
<p><span class="font3" style="font-weight:bold;font-style:italic;">ident connection</span></p>
<p style="padding:0pt 0pt 10pt 60pt;"><span class="font1" style="font-weight:bold;">Port 113</span></p>
<p style="text-align:right;padding:0pt 83pt 0pt 0pt;"><span class="font0" style="text-decoration:underline;">4236,80: USERID: UNIX: mary</span></p>
<p style="text-align:right;padding:0pt 76pt 10pt 0pt;"><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Client returns </span><span class="font1" style="font-style:italic;">ident</span><span class="font0"> response</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1012"></a><span class="font23" style="font-style:italic;">Figure 5-4. Using the ident protocol to determine HTTP client user<a name="bookmark1013"></a>name</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24" style="font-style:italic;">ident</span><span class="font24"> can work inside organizations, but it does not work well across the public Internet for many reasons, including:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Many client PCs don’t run the </span><span class="font24" style="font-style:italic;">identd</span><span class="font24"> Identification Protocol daemon software.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol significantly delays HTTP transactions.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1014"></a><span class="font24">• Many firewalls won’t permit incoming </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> traffic.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol is insecure and easy to fabricate.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> protocol doesn’t support virtual IP addresses well.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• There are privacy concerns about exposing client usernames.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 16pt 0pt;"><span class="font24">You can tell Apache web servers to use </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> lookups with Apache’s </span><span class="font24" style="font-style:italic;">IdentityCheck on </span><span class="font24">directive. If no </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> information is available, Apache will fill </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> log fields with hyphens (</span><span class="font4">-</span><span class="font24">). Common Log Format log files typically contain hyphens in the second field because no </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> information is available.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1015"></a><span class="font9" style="font-weight:bold;"><a name="bookmark47"></a><a name="bookmark1016"></a>Step 2: Receiving Request Messages</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As the data arrives on connections, the web server reads out the data from the network connection and parses out the pieces of the request message (</span><a href="#bookmark1017"><span class="font24">Figure 5-5</span></a><span class="font24">).</span></p>
<p style="padding:0pt 0pt 4pt 112pt;"><span class="font1" style="font-style:italic;">Request message being read from network</span></p>
<p style="padding:0pt 0pt 0pt 115pt;"><span class="font3">GET /specials/saw-blade.gif HTTP/1.0</span><span class="font3" style="font-weight:bold;">CRLF</span></p>
<p style="padding:0pt 0pt 0pt 115pt;"><span class="font3">Accept: image/gif</span><span class="font3" style="font-weight:bold;">CRLF</span></p>
<p style="padding:0pt 0pt 21pt 115pt;"><span class="font3">Host: </span><a href="http://www.j"><span class="font3">www.j</span></a></p>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font1" style="font-weight:bold;">Internet</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font3" style="font-weight:bold;">LF CR LF CR </span><span class="font2">moc.erawdrah-seo</span></p>
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark1017"></a><span class="font23" style="font-style:italic;">Figure 5-5. Reading a request message from a connection</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">When parsing the request message, the web server:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Parses the request line looking for the request method, the specified resource identifier (URI), and the version number,<a name="footnote32"></a><sup><a href="#bookmark1018">32</a></sup><sup></sup> each separated by a single space, and ending with a carriage-return line-feed (CRLF) sequence<a name="footnote33"></a><sup><a href="#bookmark1019">33</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1020"></a><span class="font24">• Reads the message headers, each ending in CRLF</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Detects the end-of-headers blank line, ending in CRLF (if present)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Reads the request body, if any (length specified by the Content-Length header)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1021"></a><span class="font24">When parsing request messages, web servers receive input data erratically from the network. The network connection can stall at any point. The web server needs to read data from the network and temporarily store the partial message data in memory until it receives enough data to parse it and make sense of it.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1022"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1023"></a>Internal Representations of Messages</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some web servers also store the request messages in internal data structures that make the message easy to manipulate. For example, the data structure might contain pointers and lengths of each piece of the request message, and the headers might be stored in a fast lookup table so the specific values of particular headers can be accessed quickly (</span><a href="#bookmark1024"><span class="font24">Figure 5-6</span></a><span class="font24">).</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1025"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1026"></a>Connection Input/Output Processing Architectures</span></h3>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">High-performance web servers support thousands of simultaneous connections. These connections let the web server communicate with clients around the world, each with one or more connections open to the server. Some of these connections may be sending requests rapidly to the web server, while other connections trickle</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<table>
<tr><td>
<p><span class="font3">GET /specials/saw-blade.gif HTTP/1.0</span><span class="font3" style="font-weight:bold;">CRLF</span></p>
<p><span class="font3">Accept: image/gif</span><span class="font3" style="font-weight:bold;">CRLF</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.comCRLF"><span class="font3">www.joes-hardware.com</span><span class="font3" style="font-weight:bold;">CRLF</span></a></p>
<p><span class="font3" style="font-weight:bold;">CRLF</span></p></td></tr>
<tr><td><img src="book_files/book-173.jpg" alt="" style="width:312pt;height:112pt;"></td></tr>
<tr><td>
<p><a name="bookmark1024"></a><span class="font23" style="font-style:italic;"><a name="bookmark1027"></a>Figure 5-6. Parsing a request message into a convenient internal representation</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1028"></a><span class="font24">requests slowly or infrequently, and still others are idle, waiting quietly for some future activity.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web servers constantly watch for new web requests, because requests can arrive at any time. Different web server architectures service requests in different ways, as </span><a href="#bookmark1029"><span class="font24">Figure 5-7</span></a><span class="font24"> illustrates:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Single-threaded web servers (</span><a href="#bookmark1029"><span class="font24" style="font-style:italic;">Figure 5-7</span></a><span class="font24" style="font-style:italic;">a)</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Single-threaded web servers process one request at a time until completion. When the transaction is complete, the next connection is processed. This architecture is simple to implement, but during processing, all the other connections are ignored. This creates serious performance problems and is appropriate only for low-load servers and diagnostic tools like </span><span class="font24" style="font-style:italic;">type-o-serve</span><span class="font24">.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Multiprocess and multithreaded web servers </span><a href="#bookmark1029"><span class="font24" style="font-style:italic;">(Figure 5-7</span></a><span class="font24" style="font-style:italic;">b)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Multiprocess and multithreaded web servers dedicate multiple processes or higher-efficiency threads to process requests simultaneously.<a name="footnote34"></a><sup><a href="#bookmark1030">34</a></sup><sup></sup> The threads/ processes may be created on demand or in advance.<a name="footnote35"></a><sup><a href="#bookmark1031">35</a></sup><sup></sup> Some servers dedicate a thread/process for every connection, but when a server processes hundreds, thousands, or even tens of thousands of simultaneous connections, the resulting number of processes or threads may consume too much memory or system <a name="bookmark1032"></a><a name="bookmark1033"></a><a name="bookmark1034"></a>resources. Thus, many multithreaded web servers put a limit on the maximum number of threads/processes.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Multiplexed I/O servers </span><a href="#bookmark1029"><span class="font24" style="font-style:italic;">(Figure 5-7</span></a><span class="font24" style="font-style:italic;">c)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">To support large numbers of connections, many web servers adopt </span><span class="font24" style="font-style:italic;">multiplexed architectures</span><span class="font24">. In a multiplexed architecture, all the connections are simultaneously watched for activity. When a connection changes state (e.g., when data becomes available or an error condition occurs), a small amount of processing is performed on the connection; when that processing is complete, the connection is returned to the open connection list for the next change in state. Work is done on a connection only when there is something to be done; threads and processes are not tied up waiting on idle connections.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Multiplexed multithreaded web servers </span><a href="#bookmark1029"><span class="font24" style="font-style:italic;">(Figure 5-7</span></a><span class="font24" style="font-style:italic;">d)</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font24">Some systems combine multithreading and multiplexing to take advantage of multiple CPUs in the computer platform. Multiple threads (often one per physical processor) each watch the open connections (or a subset of the open connections) and perform a small amount of work on each connection.</span></p><img src="book_files/book-174.jpg" alt="" style="width:360pt;height:310pt;">
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1035"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1036"></a><a name="bookmark48"></a><a name="bookmark1037"></a>Step 3: Processing Requests</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Once the web server has received a request, it can process the request using the method, resource, headers, and optional body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some methods (e.g., POST) require entity body data in the request message. Other methods (e.g., OPTIONS) allow a request body but don’t require one. A few methods (e.g., GET) forbid entity body data in request messages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">We won’t talk about request processing here, because it’s the subject of most of the chapters in the rest of this book!</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1038"></a><span class="font9" style="font-weight:bold;"><a name="bookmark49"></a><a name="bookmark1039"></a>Step 4: Mapping and Accessing Resources</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1040"></a><span class="font24">Web servers are resource servers. They deliver precreated content, such as HTML pages or JPEG images, as well as dynamic content from resource-generating applications running on the servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Before the web server can deliver content to the client, it needs to identify the source of the content, by mapping the URI from the request message to the proper content or content generator on the web server.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1041"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1042"></a>Docroots</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web servers support different kinds of resource mapping, but the simplest form of resource mapping uses the request URI to name a file in the web server’s filesystem. Typically, a special folder in the web server filesystem is reserved for web content. This folder is called the </span><span class="font24" style="font-style:italic;">document root</span><span class="font24">, or </span><span class="font24" style="font-style:italic;">docroot</span><span class="font24">. The web server takes the URI from the request message and appends it to the document root.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">In </span><a href="#bookmark1043"><span class="font24">Figure 5-8</span></a><span class="font24">, a request arrives for </span><span class="font24" style="font-style:italic;">/specials/saw-blade.gif</span><span class="font24">. The web server in this example has document root </span><span class="font24" style="font-style:italic;">/usr/local/httpd/files</span><span class="font24">. The web server returns the file </span><span class="font24" style="font-style:italic;">/usr/ local/httpd/files/specials/saw-blade.gif</span><span class="font24">.</span></p>
<p style="text-align:right;padding:0pt 24pt 0pt 0pt;"><span class="font1" style="font-style:italic;">/usr/local/httpd/files</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Request message</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 12pt 106pt;"><span class="font3">GET /specials/saw-blade.gif HTTP/1.0 Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">object storage</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="text-indent:12pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font0">Request URI: /specials/saw-blade.gif</span></p>
</div>
<p style="padding:0pt 0pt 0pt 176pt;"><span class="font1" style="font-weight:bold;">Web server</span></p>
<p style="padding:0pt 0pt 12pt 66pt;"><span class="font0">Server resource: /usr/local/httpd/files/specials/saw-blade.gif</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1043"></a><span class="font23" style="font-style:italic;">Figure 5-8. Mapping request URI to local web server resource <a name="bookmark1044"></a></span><span class="font24"><a name="bookmark1045"></a><a name="bookmark1046"></a>To set the document root for an Apache web server, add a </span><span class="font24" style="font-style:italic;">DocumentRoot</span><span class="font24"> line to the </span><span class="font24" style="font-style:italic;">httpd.conf</span><span class="font24"> configuration file:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">DocumentRoot /usr/local/httpd/files</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Servers are careful not to let relative URLs back up out of a docroot and expose other parts of the filesystem. For example, most mature web servers will not permit this URI to see files above the Joe’s Hardware document root:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><a href="http://www.joes-hardware.com/../"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/../</span></a></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1047"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1048"></a>Virtually hosted docroots</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Virtually hosted web servers host multiple web sites on the same web server, giving each site its own distinct document root on the server. A virtually hosted web server identifies the correct document root to use from the IP address or hostname in the URI or the Host header. This way, two web sites hosted on the same web server can have completely distinct content, even if the request URIs are identical.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In </span><a href="#bookmark1049"><span class="font24">Figure 5-9</span></a><span class="font24">, the server hosts two sites: </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> and </span><a href="http://www.marys-antiques.com"><span class="font24" style="font-style:italic;">www.marys-antiques.com</span></a><span class="font24">. The server can distinguish the web sites using the HTTP Host header, or from distinct IP addresses.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• When request A arrives, the server fetches the file for </span><span class="font24" style="font-style:italic;">/docs/joe/index.html</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 17pt 0pt;"><span class="font24">• When request B arrives, the server fetches the file for </span><span class="font24" style="font-style:italic;">/docs/mary/index.html</span><span class="font24">.</span></p></li></ul>
<p style="padding:0pt 0pt 0pt 91pt;"><span class="font1" style="font-style:italic;">Request message A</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-175.jpg" alt="" style="width:31pt;height:17pt;"></td><td>
<p><span class="font3">GET /index.html HTTP/1.0</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-176.jpg" alt="" style="width:34pt;height:29pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-177.jpg" alt="" style="width:98pt;height:51pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><a href="http://www.joes-hardware.comwww.marys-antiques.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.comwww.marys-antiques.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-178.jpg" alt="" style="width:39pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-179.jpg" alt="" style="width:36pt;height:34pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-180.jpg" alt="" style="width:31pt;height:17pt;"></td><td>
<p><span class="font3">GET /index.html HTTP/1.0 Host: </span><a href="http://www.marys-antiques.com"><span class="font3">www.marys-antiques.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 91pt;"><span class="font1" style="font-style:italic;">Request message B</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1049"></a><span class="font23" style="font-style:italic;">Figure 5-9. Different docroots for virtually hosted requests</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Configuring virtually hosted docroots is simple for most web servers. For the popular Apache web server, you need to configure a </span><span class="font24" style="font-style:italic;">VirtualHost</span><span class="font24"> block for each virtual web site, and include the </span><span class="font24" style="font-style:italic;">DocumentRoot</span><span class="font24"> for each virtual server (</span><a href="#bookmark1050"><span class="font24">Example 5-3</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1050"></a><span class="font23" style="font-style:italic;">Example 5-3. Apache web server virtual host docroot configuration</span></p>
<p style="text-align:justify;"><span class="font3">&lt;VirtualHost </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a><span class="font3">&gt;</span></p>
<p style="text-align:justify;text-indent:9pt;"><span class="font3">ServerName </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 8pt 0pt;"><span class="font3">DocumentRoot /docs/joe</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font23" style="font-style:italic;">Example 5-3. Apache web server virtual host docroot configuration (continued)</span></p>
<p style="text-indent:8pt;"><span class="font3">TransferLog /logs/joe.access_log</span></p>
<p style="text-indent:8pt;"><span class="font3">ErrorLog /logs/joe.error_log</span></p>
<p style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark1051"></a><span class="font3">&lt;/VirtualHost&gt;</span></p>
<p><span class="font3">&lt;VirtualHost </span><a href="http://www.marys-antiques.com"><span class="font3">www.marys-antiques.com</span></a><span class="font3">&gt;</span></p>
<p style="text-indent:8pt;"><span class="font3">ServerName </span><a href="http://www.marys-antiques.com"><span class="font3">www.marys-antiques.com</span></a></p>
<p style="text-indent:8pt;"><span class="font3">DocumentRoot /docs/mary</span></p>
<p style="text-indent:8pt;"><span class="font3">TransferLog /logs/mary.access_log</span></p>
<p style="text-indent:8pt;"><span class="font3">ErrorLog /logs/mary.error_log</span></p>
<p style="padding:0pt 0pt 18pt 0pt;"><span class="font3">&lt;/VirtualHost&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Look forward to</span><a href="#bookmark1052"><span class="font24"> “Virtual Hosting” in Chapter 18 </span></a><span class="font24">for much more detail about virtual hosting.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1053"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1054"></a>User home directory docroots</span></h4>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><a name="bookmark1055"></a><span class="font24">Another common use of docroots gives people private web sites on a web server. A typical convention maps URIs whose paths begin with a slash and tilde (</span><span class="font4">/</span><span class="font24">~) followed by a username to a private document root for that user. The private docroot is often the folder called </span><span class="font24" style="font-style:italic;">public_html</span><span class="font24"> inside that user’s home directory, but it can be configured differently </span><a href="#bookmark1056"><span class="font24">(Figure 5-10)</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request message A</span></p></td></tr>
<tr><td><img src="book_files/book-181.jpg" alt="" style="width:345pt;height:79pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request message B</span></p>
<p><a name="bookmark1056"></a><span class="font23" style="font-style:italic;">Figure 5-10. Different docroots for different users</span></p></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1057"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1058"></a>Directory Listings</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A web server can receive requests for directory URLs, where the path resolves to a directory, not a file. Most web servers can be configured to take a few different actions when a client requests a directory URL:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;"><span class="font24">• Return an error.</span></p></li>
<li>
<p style="text-indent:8pt;"><span class="font24">• Return a special, default, “index file” instead of the directory.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Scan the directory, and return an HTML page containing the contents.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Most web servers look for a file named </span><span class="font24" style="font-style:italic;">index.html</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">index.htm</span><span class="font24"> inside a directory to represent that directory. If a user requests a URL for a directory and the directory <a name="bookmark1059"></a>contains a file named </span><span class="font24" style="font-style:italic;">index.html</span><span class="font24"> (or </span><span class="font24" style="font-style:italic;">index.htm</span><span class="font24">), the server will return the contents of that file.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In the Apache web server, you can configur<a name="bookmark1060"></a>e the set of filenames that will be interpreted as default directory files using the </span><span class="font24" style="font-style:italic;">DirectoryIndex</span><span class="font24"> configuration directive. The </span><span class="font24" style="font-style:italic;">DirectoryIndex</span><span class="font24"> directive lists all filenames that serve as directory index files, in preferred order. The following configuration line causes Apache to search a directory for any of the listed files in response to a directory URL request:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">DirectoryIndex index.html index.htm home.html home.htm index.cgi</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1061"></a><span class="font24">If no default index file is present when a user requests a directory URI, and if directory indexes are not disabled, many web servers automatically return an HTML file listing the files in that directory, and the sizes and modification dates of each file, including URI links to each file. This file listing can be convenient, but it also allows nosy people to find files on a web server that they might not normally find.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You can disable the automatic generation of directory index files with the Apache directive:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">Options -Indexes</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1062"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1063"></a>Dynamic Content Resource Mapping</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web servers also can map URIs to dynamic resources—that is, to programs that generate content on demand (</span><a href="#bookmark1064"><span class="font24">Figure 5-11</span></a><span class="font24">). In fact, a whole class of web servers called </span><span class="font24" style="font-style:italic;">application servers</span><span class="font24"> connect web servers to sophisticated backend applications. The web server needs to be able to tell when a resource is a dynamic resource, where the dynamic content generator program is located, and how to run the program. Most web servers provide basic mechanisms to identify and map dynamic resources.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Apache lets you map URI pathname components into executable program directories. When a server receives a request for a URI with an executable path component, it attempts to execute a program in a corresponding server directory. For example, the following Apache configuration directive specifies that all URIs whose paths begin with </span><span class="font24" style="font-style:italic;">/cgi-bin/</span><span class="font24"> should execute corresponding programs found in the directory </span><span class="font24" style="font-style:italic;">/usr/local/etc/httpd/cgi-programs/</span><span class="font24">:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">ScriptAlias /cgi-bin/ /usr/local/etc/httpd/cgi-programs/</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Apache also lets you mark executable files with a special file extension. This way, executable scripts can be placed in any directory. The following Apache configuration directive specifies that all web resources ending in </span><span class="font24" style="font-style:italic;">.cgi</span><span class="font24"> should be executed:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">AddHandler cgi-script .cgi</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">CGI is an early, simple, and popular interface for executing server-side applications. Modern application servers have more powerful and efficient server-side dynamic content support, including Microsoft’s Active Server Pages and Java servlets.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Filesystem</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Resources</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-182.jpg" alt="" style="width:22pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Image file</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-183.jpg" alt="" style="width:181pt;height:108pt;"></td></tr>
<tr><td>
<p><a name="bookmark1065"></a><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-184.jpg" alt="" style="width:18pt;height:23pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Text file</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-185.jpg" alt="" style="width:56pt;height:21pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Web cam gateway</span></p></td></tr>
</table>
</div><br clear="all">
<p><span class="font1" style="font-style:italic;">Stock trading gateway</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Real estate search gateway</span></p></td></tr>
<tr><td><img src="book_files/book-186.jpg" alt="" style="width:68pt;height:21pt;"></td><td>
<p><span class="font0">11000101101</span></p></td></tr>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">E-commerce gateway</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark1064"></a><span class="font23" style="font-style:italic;">Figure 5-11. A web server can serve static resources as well as dynamic resources</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1066"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1067"></a><a name="bookmark1068"></a>Server-Side Includes (SSI)</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many web servers also provide support for server-side includes. If a resource is flagged as containing server-side includes, the server processes the resource contents before sending them to the client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The contents are scanned for certain special patterns (often contained inside special HTML comments), which can be variable names or embedded scripts. The special patterns are replaced with the values of variables or the output of executable scripts. This is an easy way to create dynamic content.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1069"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1070"></a>Access Controls</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web servers also can assign access controls to particular resources. When a request arrives for an access-controlled resource, the web server can control access based on the IP address of the client, or it can issue a password challenge to get access to the resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Refer to</span><a href="#bookmark236"><span class="font24"> Chapter 12</span></a><span class="font24"> for more information about HTTP authentication.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1071"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1072"></a><a name="bookmark1073"></a><a name="bookmark50"></a><a name="bookmark1074"></a>Step 5: Building Responses</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1075"></a><span class="font24">Once the web server has identified the resource, it performs the action described in the request method and returns the response message. The response message contains a response status code, response headers, and a response body if one was generated. HTTP response codes were detailed in</span><a href="#bookmark307"><span class="font24"> “Status Codes</span></a><span class="font24">” in </span><a href="#bookmark225"><span class="font24">Chapter 3</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1076"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1077"></a>Response Entities</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the transaction generated a response body, the content is sent back with the response message. If there was a body, the response message usually contains:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A Content-Type header, describing the MIME type of the response body</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A Content-Length header, describing the size of the response body</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• The actual message body content</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1078"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1079"></a>MIME Typing</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The web server is responsible for determining the MIME type of the response body. There are many ways to configure servers to associate MIME types with resources:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">mime.types</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">The web server can use the extension of the filename to indicate MIME type. The web server scans a file containing MIME types for each extension to compute the MIME type for each resource. This extension-based type association is the most common; it is illustrated in</span><a href="#bookmark1080"><span class="font24"> Figure 5-12</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">HTTP request message contains the command and the URI</span></p></td></tr>
<tr><td><img src="book_files/book-187.jpg" alt="" style="width:71pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">saw-blade.gif file</span></p></td></tr>
<tr><td><img src="book_files/book-188.jpg" alt="" style="width:70pt;height:55pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font3">GET /specials/saw-blade.gif HTTP/1.0 Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-189.jpg" alt="" style="width:20pt;height:35pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.0 200 OK Content-type: image/gif Content-length: 8572</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Server MIME type table</span></p>
<p><span class="font2">application/msword application/postscript application/powerpoint audio/mpeg</span></p>
<p><span class="font2">image/gif</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-190.jpg" alt="" style="width:48pt;height:48pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">doc</span></p>
<p><span class="font2">ai eps ps ppt mpga mp2 gif</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">image/tiff text/html text/plain video/mpeg video/quicktime video/x-msvideo x-word/x-vrml</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">html htm</span></p>
<p><span class="font2">txt</span></p>
<p><span class="font2">mpeg mpg mpe</span></p>
<p><span class="font2">qt mov avi</span></p>
<p><span class="font2">wrl vrml</span></p>
</div><br clear="all">
<p style="text-align:justify;"><a name="bookmark1080"></a><span class="font23" style="font-style:italic;">Figure 5-12. A web server uses MIME types file to set outgoing Content-Type of resources</span></p>
<p style="text-align:justify;"><a name="bookmark1081"></a><span class="font24" style="font-style:italic;"><a name="bookmark1082"></a><a name="bookmark1083"></a><a name="bookmark1084"></a>Magic typing</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The Apache web server can scan the contents of each resource and patternmatch the content against a table of known patterns (called the </span><span class="font24" style="font-style:italic;">magic</span><span class="font24"> file) to determine the MIME type for each file. This can be slow, but it is convenient, especially if the files are named without standard extensions.</span></p>
<p style="text-align:justify;"><a name="bookmark1085"></a><span class="font24" style="font-style:italic;">Explicit typing</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Web servers can be configured to force particular files or directory contents to have a MIME type, regardless of the file extension or contents.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Type negotiation</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Some web servers can be configured to store a resource in multiple document formats. In this case, the web server can be configured to determine the “best” format to use (and the associated MIME type) by a negotiation process with the user. We’ll discuss this in</span><a href="#bookmark241"><span class="font24"> Chapter 17</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web servers also can be configured to associate particular files with MIME types.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1086"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1087"></a>Redirection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1088"></a><span class="font24">Web servers sometimes return redirection responses instead of success messages. A web server can redirect the browser to go elsewhere to perform the request. A redirection response is indicated by a 3XX return code. The Location response header contains a URI for the new or preferred location of the content. Redirects are useful for:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Permanently moved resources</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1089"></a><span class="font24">A resource might have been moved to a new location, or otherwise renamed, giving it a new URL. The web server can tell the client that the resource has been renamed, and the client can update any bookmarks, etc. before fetching the resource from its new location. The status code 301 Moved Permanently is used for this kind of redirect.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Temporarily moved resources</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">If a resource is temporarily moved or renamed, the server may want to redirect the client to the new location. But, because the renaming is temporary, the server wants the client to come back with the old URL in the future and not to update any bookmarks. The status codes 303 See Other and 307 Temporary Redirect are used for this kind of redirect.</span></p>
<p><span class="font24" style="font-style:italic;">URL augmentation</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Servers often use redirects to rewrite URLs, often to embed context. When the request arrives, the server generates a new URL containing embedded state information and redirects the user to this new URL.<a name="footnote36"></a><sup><a href="#bookmark1090">36</a></sup><sup></sup> The client follows the redirect, reissuing the request, but now including the full, state-augmented URL. This is a <a name="bookmark1091"></a>useful way of maintaining state across transactions. The status codes 303 See Other and 307 Temporary Redirect are used for this kind of redirect.</span></p>
<p><span class="font24" style="font-style:italic;">Load balancing</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">If an overloaded server gets a request, the server can redirect the client to a less heavily loaded server. The status codes 303 See Other and 307 Temporary Redirect are used for this kind of redirect.</span></p>
<p><a name="bookmark1092"></a><span class="font24" style="font-style:italic;">Server affinity</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Web servers may have local information for certain users; a server can redirect the client to a server that contains information about the client. The status codes 303 See Other and 307 Temporary Redirect are used for this kind of redirect.</span></p>
<p><span class="font24" style="font-style:italic;">Canonicalizing directory names</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">When a client requests a URI for a directory name without a trailing slash, most web servers redirect the client to a URI with the slash added, so that relative links work correctly.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1093"></a><span class="font9" style="font-weight:bold;"><a name="bookmark51"></a><a name="bookmark1094"></a>Step 6: Sending Responses</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1095"></a><span class="font24">Web servers face similar issues sending data across connections as they do receiving. The server may have many connections to many clients, some idle, some sending data to the server, and some carrying response data back to the clients.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The server needs to keep track of the connection state and handle persistent connections with special care. For nonpersistent connections, the server is expected to close its side of the connection when the entire message is sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">For persistent connections, the connection may stay open, in which case the server needs to be extra cautious to compute the Content-Length header correctly, or the client will have no way of knowing when a response ends (see</span><a href="#bookmark226"><span class="font24"> Chapter 4</span></a><span class="font24">).</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1096"></a><span class="font9" style="font-weight:bold;"><a name="bookmark52"></a><a name="bookmark1097"></a>Step 7: Logging</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Finally, when a transaction is complete, the web server notes an entry into a log file, describing the transaction performed. Most web servers provide several configurable forms of logging. Refer to</span><a href="#bookmark245"><span class="font24"> Chapter 21 </span></a><span class="font24">for more details.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1098"></a><span class="font9" style="font-weight:bold;"><a name="bookmark53"></a><a name="bookmark1099"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information on Apache, Jigsaw, and </span><span class="font24" style="font-style:italic;">ident</span><span class="font24">, check out:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Apache: The Definitive Guide</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Ben Laurie and Peter Laurie, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p><span class="font24" style="font-style:italic;">Professional Apache</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Peter Wainwright, Wrox Press.</span></p>
<p><a href="http://www.w3c.org/Jigsaw/"><span class="font24" style="font-style:italic;">http://www.w3c.org/Jigsaw/</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Jigsaw—W3C’s Server W3C Consortium Web Site.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc1413.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1413.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">RFC 1413, “Identification Protocol,” by M. St. Johns.</span></p>
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><a name="bookmark230"></a><span class="font7" style="font-weight:bold;">CHAPTER 6</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark54"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1100"></a>Proxies</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1101"></a><span class="font24"><a name="bookmark1102"></a><a name="bookmark1103"></a><a name="bookmark1104"></a>Web proxy servers are intermediaries. Proxies sit between clients and servers and act as “middlemen,” shuffling HTTP messages back and forth between the parties.This chapter talks all about HTTP proxy servers, the special support for proxy features, and some of the tricky behaviors you’ll see when you use proxy servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In this chapter, we:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Explain HTTP proxies, contrasting them to web gateways and illustrating how proxies are deployed.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Show some of the ways proxies are helpful.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Describe how proxies are deployed in real networks and how traffic is directed to proxy servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1105"></a><span class="font24">• Show how to configure your browser to use a proxy.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Demonstrate HTTP proxy requests, how they differ from server requests, and how proxies can subtly change the behavior of browsers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Explain how you can record the path of your messages through chains of proxy servers, using Via headers and the TRACE method.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Describe proxy-based HTTP access control.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Explain how proxies can interoperate between clients and servers, each of which may support different features and versions.</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1106"></a><span class="font9" style="font-weight:bold;"><a name="bookmark55"></a><a name="bookmark1107"></a>Web Intermediaries</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Web proxy servers are middlemen that fulfill transactions on the client’s behalf. Without a web proxy, HTTP clients talk directly to HTTP servers. With a web proxy, the client instead talks to the proxy, which itself communicates with the server on the client’s behalf. The client still completes the transaction, but through the good services of the proxy server.</span></p>
<p style="text-align:justify;"><a name="bookmark1108"></a><span class="font24">HTTP proxy servers are both web servers and web clients. Because HTTP clients send request messages to proxies, the proxy server must properly handle the requests and the connections and return responses, just like a web server. At the same time, the proxy itself sends requests to servers, so it must also behave like a correct HTTP client, sending requests and receiving responses (see</span><a href="#bookmark1109"><span class="font24"> Figure 6-1</span></a><span class="font24">). If you are creating your own HTTP proxy, you’ll need to carefully follow the rules for both HTTP clients and HTTP servers.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark1110"></a><span class="font0">Proxies act like SERVERS to web clients, receiving request messages, and returning response messages</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark1111"></a><span class="font0">Proxies act like CLIENTS to web servers, sending web request messages, and receiving web response messages</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Request</span></p></td></tr>
<tr><td><img src="book_files/book-191.jpg" alt="" style="width:152pt;height:91pt;"></td></tr>
<tr><td>
<p><span class="font0">Response</span></p>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-192.jpg" alt="" style="width:44pt;height:50pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Request</span></p></td></tr>
<tr><td><img src="book_files/book-193.jpg" alt="" style="width:52pt;height:35pt;"></td></tr>
<tr><td>
<p><a name="bookmark1112"></a><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Response</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1109"></a><span class="font23" style="font-style:italic;">Figure 6-1. A proxy must be both a server and a client</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1113"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1114"></a>Private and Shared Proxies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A proxy server can be dedicated to a single client or shared among many clients. Proxies dedicated to a single client are called </span><span class="font24" style="font-style:italic;">private proxies</span><span class="font24">. Proxies shared among numerous clients are called </span><span class="font24" style="font-style:italic;">public proxies</span><span class="font24">.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Public proxies</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1115"></a><span class="font24">Most proxies are public, shared proxies. It’s more cost effective and easier to administer a centralized proxy. And some proxy applications, such as caching proxy servers, become more useful as more users are funneled into the same proxy server, because they can take advantage of common requests between users.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Private proxies</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">Dedicated private proxies are not as common, but they do have a place, especially when run directly on the client computer. Some browser assistant products, as well as some ISP services, run small proxies directly on the user’s PC in order to extend browser features, improve performance, or host advertising for free ISP services.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1116"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1117"></a>Proxies Versus Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Strictly speaking, proxies connect two or more applications that speak the same protocol, while gateways hook up two or more parties that speak different protocols. A gateway acts as a “protocol converter,” allowing a client to complete a transaction with a server, even when the client and server speak different protocols.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a href="#bookmark1118"><span class="font24">Figure 6-2</span></a><span class="font24"> illustrates the difference between proxies and gateways:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The intermediary device in</span><a href="#bookmark1118"><span class="font24"> Figure 6-2</span></a><span class="font24">a is an HTTP proxy, because the proxy speaks HTTP to both the client and server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 8pt 19pt;"><span class="font24">• The intermediary device in </span><a href="#bookmark1118"><span class="font24">Figure 6-2</span></a><span class="font24">b is an HTTP/POP gateway, because it ties an HTTP frontend to a POP email backend. The gateway converts web transactions into the appropriate POP transactions, to allow the user to read email through HTTP. Web-based email programs such as Yahoo! Mail and MSN Hotmail are HTTP email gateways.</span></p>
<table>
<tr><td><img src="book_files/book-194.jpg" alt="" style="width:363pt;height:176pt;"></td></tr>
<tr><td>
<p><a name="bookmark1118"></a><span class="font23" style="font-style:italic;"><a name="bookmark1119"></a>Figure 6-2. Proxies speak the same protocol; gateways tie together different protocols</span></p></td></tr>
</table></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In practice, the difference between proxies and gateways is blurry. Because browsers and servers implement different versions of HTTP, proxies often do some amount of protocol conversion. And commercial proxy servers implement gateway functionality<a name="bookmark1120"></a> to support SSL security protocols, SOCKS firewalls, FTP access, and web-based applications. We’ll talk more about gateways in</span><a href="#bookmark232"><span class="font24"> Chapter 8</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1121"></a><span class="font9" style="font-weight:bold;"><a name="bookmark56"></a><a name="bookmark1122"></a>Why Use Proxies?</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Proxy servers can do all kinds of nifty and useful things. They can improve security, enhance performance, and save money. And because proxy servers can see and touch all the passing HTTP traffic, proxies can monitor and modify the traffic to implement many useful value-added web services. Here are examples of just a few of the ways proxies can be used:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Child filter </span><a href="#bookmark1123"><span class="font24" style="font-style:italic;">(Figure 6-3</span></a><span class="font24" style="font-style:italic;">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 19pt;"><span class="font24">Elementary schools use filtering proxies to block access to adult content, while providing unhindered access to educational sites. As shown in </span><a href="#bookmark1123"><span class="font24">Figure 6-3</span></a><span class="font24">, the</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><a name="bookmark1124"></a><span class="font24">proxy might permit unrestricted access to educational content but forcibly deny access to sites that are inappropriate for children.<a name="footnote37"></a><sup><a href="#bookmark1125">37</a></sup><sup></sup></span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-195.jpg" alt="" style="width:342pt;height:155pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">proxy</span></p>
<p><a name="bookmark1123"></a><span class="font23" style="font-style:italic;">Figure 6-3. Proxy application example: child-safe Internet filter</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-196.jpg" alt="" style="width:55pt;height:65pt;">
</div><br clear="all">
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Document access controller (</span><a href="#bookmark1126"><span class="font24" style="font-style:italic;">Figure 6-4)</span></a></p>
<p style="padding:0pt 0pt 2pt 19pt;"><a name="bookmark1127"></a><span class="font24">Proxy servers can be used to implement a uniform access-control strategy across a large set of web servers and web resources and to create an audit trail. This is useful in large corporate settings or other distributed bureaucracies.</span></p>
<p style="padding:0pt 0pt 2pt 19pt;"><span class="font24">All the access controls can be configured on the centralized proxy server, without requiring the access controls to be updated frequently on numerous web servers, of different makes and models, administered by different organizations.<a name="footnote38"></a><sup><a href="#bookmark1128">38</a></sup><sup> </sup>In</span><a href="#bookmark1126"><span class="font24"> Figure 6-4</span></a><span class="font24">, the centralized access-control proxy:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Permits client 1 to access news pages from server A without restriction</span></p></li>
<li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Gives client 2 unrestricted access to Internet content</span></p></li>
<li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Requires a password from client 3 before allowing access to server B</span></p></li></ul>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Security firewall </span><a href="#bookmark1129"><span class="font24" style="font-style:italic;">(Figure 6-5)</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Network security engineers often use proxy servers to enhance security. Proxy servers restrict which application-level protocols flow in and out of an organization, at a single secure point in the network. They also can provide hooks to scrutinize that traffic (</span><a href="#bookmark1129"><span class="font24">Figure 6-5</span></a><span class="font24">), as used by virus-eliminating web and email proxies.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-197.jpg" alt="" style="width:363pt;height:206pt;"></td></tr>
<tr><td>
<p><a name="bookmark1126"></a><span class="font23" style="font-style:italic;"><a name="bookmark1130"></a>Figure 6-4. Proxy application example: centralized document access control</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-198.jpg" alt="" style="width:342pt;height:169pt;"></td></tr>
<tr><td>
<p><a name="bookmark1129"></a><span class="font23" style="font-style:italic;">Figure 6-5. Proxy application example: security firewall</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-199.jpg" alt="" style="width:75pt;height:160pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-200.jpg" alt="" style="width:197pt;height:160pt;">
</div><br clear="all">
<p><span class="font24" style="font-style:italic;">Web cache </span><a href="#bookmark1131"><span class="font24" style="font-style:italic;">(Figure 6-6)</span></a></p>
<p style="padding:0pt 0pt 2pt 18pt;"><span class="font24">Proxy caches maintain local copies of popular documents and serve them on demand, reducing slow and costly Internet communication.</span></p>
<p style="padding:0pt 0pt 0pt 18pt;"><span class="font24">In </span><a href="#bookmark1131"><span class="font24">Figure 6-6</span></a><span class="font24">, clients 1 and 2 access object A from a nearby web cache, while clients 3 and 4 access the document from the origin server.</span></p><img src="book_files/book-201.jpg" alt="" style="width:360pt;height:223pt;">
<p style="text-align:justify;"><a name="bookmark1131"></a><span class="font24" style="font-style:italic;">Surrogate </span><a href="#bookmark1132"><span class="font24" style="font-style:italic;">(Figure 6-7)</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1133"></a><span class="font24"><a name="bookmark1134"></a><a name="bookmark1135"></a>Proxies can masquerade as web servers. These so-called </span><span class="font24" style="font-style:italic;">surrogates</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">reverse proxies</span><span class="font24"> receive real web server requests, but, unlike web servers, they may initiate communication with other servers to locate the requested content on demand.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 19pt;"><a name="bookmark1136"></a><span class="font24">Surrogates may be used to improve the performance of slow web servers for common content. In this configuration, the surrogates often are called </span><span class="font24" style="font-style:italic;">server accelerators</span><span class="font24"> (</span><a href="#bookmark1132"><span class="font24">Figure 6-7</span></a><span class="font24">). Surrogates also can be used in conjunction with content-routing functionality to create distributed networks of on-demand replicated content.</span></p>
<table>
<tr><td><img src="book_files/book-202.jpg" alt="" style="width:228pt;height:85pt;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Surrogate</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">(also known as a reverse proxy or a server accelerator)</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 9pt 0pt;"><a name="bookmark1132"></a><span class="font23" style="font-style:italic;">Figure 6-7. Proxy application example: surrogate (in a server accelerator deployment)</span></p>
<p><span class="font24" style="font-style:italic;">Content router </span><a href="#bookmark1137"><span class="font24" style="font-style:italic;">(Figure 6-8)</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Proxy servers can act as “content routers,” vectoring requests to particular web servers based on Internet traffic conditions and type of content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font24">Content routers also can be used to implement various service-level offerings. For example, content routers can forward requests to nearby replica caches if the user or content provider has paid for higher performance </span><a href="#bookmark1137"><span class="font24">(Figure 6-8</span></a><span class="font24">), or route HTTP requests through filtering proxies if the user has signed up for a filtering service. Many interesting services can be constructed using adaptive contentrouting proxies.</span></p><img src="book_files/book-203.jpg" alt="" style="width:360pt;height:252pt;">
<p style="text-align:justify;"><a name="bookmark1137"></a><span class="font24" style="font-style:italic;"><a name="bookmark1138"></a><a name="bookmark1139"></a>Transcoder </span><a href="#bookmark1140"><span class="font24" style="font-style:italic;">(Figure 6-9</span></a><span class="font24" style="font-style:italic;">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Proxy servers can modify the body format of content before delivering it to clients. This transparent translation between data representations is called </span><span class="font24" style="font-style:italic;">transcoding</span><span class="font24">.<a name="footnote39"></a><sup><a href="#bookmark1141">39</a></sup><sup> </sup>Transcoding proxies can convert GIF images into JPEG images as they fly by, to reduce size. Images also can be shrunk and reduced in color intensity to be viewable on television sets. Likewise, text files can be compressed, and small text summaries of web pages can be generated for Internet-enabled pagers and smart phones. It’s even possible for proxies to convert documents into foreign languages on the fly!</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><a href="#bookmark1140"><span class="font24">Figure 6-9</span></a><span class="font24"> shows a transcoding proxy that converts English text into Spanish text and also reformats HTML pages into simpler text that can displayed on the small screen of a mobile phone.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-204.jpg" alt="" style="width:225pt;height:134pt;"></td><td>
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;">Summer Beach Shirts</span></p>
<p><span class="font1">You’ll get lots of smiles and winks when you wear our summer beach shirts.</span></p>
<p style="text-indent:8pt;"><span class="font1">White</span></p>
<p style="text-indent:8pt;"><span class="font1">Black</span></p>
<p style="text-indent:8pt;"><span class="font1">Sunrise orange</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-205.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><a name="bookmark1142"></a><span class="font1" style="font-weight:bold;">Spanishspeaking client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-206.jpg" alt="" style="width:24pt;height:19pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-207.jpg" alt="" style="width:18pt;height:42pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Web-enabled mobile phone</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark1140"></a><span class="font23" style="font-style:italic;">Figure 6-9. Proxy application example: content transcoder</span></p>
<p><span class="font24" style="font-style:italic;">Anonymizer </span><a href="#bookmark1143"><span class="font24" style="font-style:italic;">(Figure 6-10</span></a><span class="font24" style="font-style:italic;">)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Anonymizer proxies provide heightened privacy and anonymity, by actively removing identifying characteristics from HTTP messages (e.g., client IP address, From header, Referer header, cookies, URI session IDs).<a name="footnote40"></a><sup><a href="#bookmark1144">40</a></sup><sup> <a name="footnote41"></a><a href="#bookmark1145">41</a></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">In</span><a href="#bookmark1143"><span class="font24"> Figure 6-10</span></a><span class="font24">, the anonymizing proxy makes the following changes to the user’s messages to increase privacy:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The user’s computer and OS type is removed from the User-Agent header.</span></p></li>
<li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The From header is removed to protect the user’s email address.</span></p></li>
<li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Referer header is removed to obscure other sites the user has visited.</span></p></li>
<li>
<p style="text-align:justify;text-indent:26pt;padding:0pt 0pt 21pt 0pt;"><a name="bookmark1146"></a><span class="font24">• The Cookie headers are removed to eliminate profiling and identity data.</span></p></li></ul>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">GET /something/file.html HTTP/1.0</span></p>
<div style="border-bottom:solid;float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Anonymized message doesn’t contain the common identifying information headers</span></p>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">GET /something/file.html HTTP/1.0</span></p>
<p><span class="font2">Date: Sun, 01 Oct 2000 23:25:17 GMT</span></p>
<p><span class="font2">User-agent: Mozilla/4.75</span></p></td></tr>
<tr><td><img src="book_files/book-208.jpg" alt="" style="width:136pt;height:64pt;"></td></tr>
<tr><td>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">Date: Sun, 01 Oct 2000 23:25:17 GMT</span></p>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">User-agent: Mozilla/4.75 (Win98; U)</span></p>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">From: </span><a href="mailto:joe@joes-hardware.com"><span class="font2">joe@joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">Referer: </span><a href="http://www.irs.gov/tax-audits.html"><span class="font2">http://www.irs.gov/tax-audits.html</span></a></p>
<p style="text-align:justify;text-indent:23pt;"><span class="font2">Cookie: profile=&quot;football,lite beer&quot;</span></p>
<p style="text-align:justify;text-indent:23pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Cookie: income-bracket=&quot;30K-45K&quot;</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-209.jpg" alt="" style="width:135pt;height:30pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Anonymizing proxy</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-210.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1147"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1148"></a><a name="bookmark57"></a><a name="bookmark1149"></a>Where Do Proxies Go?</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1150"></a><span class="font24">The previous section explained what proxies do. Now let’s talk about where proxies sit when they are deployed into a network architecture. We’ll cover:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• How proxies can be deployed into networks</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• How proxies can chain together into hierarchies</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• How traffic gets directed to a proxy server in the first place</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1151"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1152"></a><a name="bookmark1153"></a>Proxy Server Deployment</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">You can place proxies in all kinds of places, depending on their intended uses. </span><a href="#bookmark1154"><span class="font24">Figure 6-11 </span></a><span class="font24">sketches a few ways proxy servers can be deployed.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Egress proxy (</span><a href="#bookmark1154"><span class="font24" style="font-style:italic;">Figure 6-11</span></a><span class="font24" style="font-style:italic;">a)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1155"></a><span class="font24">You can stick proxies at the exit points of local networks to control the traffic flow between the local network and the greater Internet. You might use egress proxies in a corporation to offer firewall protection against malicious hackers outside the enterprise or to reduce bandwidth charges and improve performance of Internet traffic. An elementary school might use a filtering egress proxy to prevent precocious students from browsing inappropriate content.</span></p>
<p><span class="font24" style="font-style:italic;">Access (ingress) proxy </span><a href="#bookmark1154"><span class="font24" style="font-style:italic;">(Figure 6-11</span></a><span class="font24" style="font-style:italic;">b)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1156"></a><span class="font24">Proxies are often placed at ISP access points, processing the aggregate requests from the customers. ISPs use caching proxies to store copies of popular documents, to improve the download speed for their users (especially those with high-speed connections) and reduce Internet bandwidth costs.</span></p>
<p><span class="font24" style="font-style:italic;">Surrogates (</span><a href="#bookmark1154"><span class="font24" style="font-style:italic;">Figure 6-11</span></a><span class="font24" style="font-style:italic;">c)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Proxies frequently are deployed as surrogates (also commonly called reverse proxies) at the edge of the network, in front of web servers, where they can field all of the requests directed at the web server and ask the web server for resources only when necessary. Surrogates can add security features to web servers or improve performance by placing fast web server caches in front of slower web servers. Surrogates typically assume the name and IP address of the web server directly, so all requests go to the proxy instead of the server.</span></p>
<p><span class="font24" style="font-style:italic;">Network exchange proxy </span><a href="#bookmark1154"><span class="font24" style="font-style:italic;">(Figure 6-11</span></a><span class="font24" style="font-style:italic;">d)</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">With sufficient horsepower, proxies can be placed in the Internet peering exchange points between networks, to alleviate congestion at Internet junctions through caching and to monitor traffic flows.<a name="footnote42"></a><sup><a href="#bookmark1157">42</a></sup><sup></sup></span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Private LAN egress proxy</span></p></td></tr>
<tr><td><img src="book_files/book-211.jpg" alt="" style="width:249pt;height:86pt;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Local network</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-212.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">ISP access proxy</span></p></td></tr>
<tr><td><img src="book_files/book-213.jpg" alt="" style="width:249pt;height:189pt;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Local network</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Surrogate</span></p>
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="padding:0pt 0pt 0pt 58pt;"><span class="font1" style="font-weight:bold;">Internet</span></p>
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark1158"></a><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Network exchange proxy</span></p></td></tr>
<tr><td><img src="book_files/book-214.jpg" alt="" style="width:297pt;height:86pt;">
<p><span class="font1" style="font-weight:bold;">Network 2</span></p></td></tr>
<tr><td>
<p><span class="font0">Router</span></p>
<p style="text-align:right;"><a name="bookmark1159"></a><span class="font0">Router</span></p>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><a name="bookmark1160"></a><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark1154"></a><span class="font23" style="font-style:italic;"><a name="bookmark1161"></a>Figure 6-11. Proxies can be deployed many ways, depending on their intended use</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1162"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1163"></a>Proxy Hierarchies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxies can be cascaded in chains called </span><span class="font24" style="font-style:italic;">proxy hierarchies</span><span class="font24">. In a proxy hierarchy, messages are passed from proxy to proxy until they eventually reach the origin server (and then are passed back through the proxies to the client), as shown in </span><a href="#bookmark1164"><span class="font24">Figure 6-12</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Proxy servers in a proxy hierarchy are assigned </span><span class="font24" style="font-style:italic;">parent</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">child</span><span class="font24"> relationships. The next </span><span class="font24" style="font-style:italic;">inbound</span><span class="font24"> proxy (closer to the server) is called the parent, and the next </span><span class="font24" style="font-style:italic;">outbound </span><span class="font24">proxy (closer to the client) is called the child. In</span><a href="#bookmark1164"><span class="font24"> Figure 6-12</span></a><span class="font24">, proxy 1 is the child</span></p>
<table>
<tr><td><img src="book_files/book-215.jpg" alt="" style="width:287pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">Origin server</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 2 </span><span class="font1" style="font-style:italic;">(child of proxy 3</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 1 </span><span class="font1" style="font-style:italic;">(child of proxy 2)</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 3 </span><span class="font1" style="font-style:italic;">(parent of proxy 2)</span></p>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">parent of proxy 1)</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1164"></a><span class="font23" style="font-style:italic;"><a name="bookmark1165"></a>Figure 6-12. Three-level proxy hierarchy</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">proxy of proxy 2. Likewise, proxy 2 is the child proxy of proxy 3, and proxy 3 is the parent proxy of proxy 2.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1166"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1167"></a>Proxy hierarchy content routing</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The proxy hierarchy in </span><a href="#bookmark1164"><span class="font24">Figure 6-12 </span></a><span class="font24">is static—proxy 1 always forwards messages to proxy 2, and proxy 2 always forwards messages to proxy 3. However, hierarchies do not have to be static. A proxy server can forward messages to a varied and changing set of proxy servers and origin servers, based on many factors.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For example, in </span><a href="#bookmark1168"><span class="font24">Figure 6-13</span></a><span class="font24">, the access proxy routes to parent proxies or origin servers in different circumstances:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the requested object belongs to a web server that has paid for content distribution, the proxy could route the request to a nearby cache server that would either return the cached object or fetch it if it wasn’t available.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 8pt 19pt;"><span class="font24">• If the request was for a particular type of image, the access proxy might route the request to a dedicated compression proxy that would fetch the image and then compress it, so it would download faster across a slow modem to the client.</span></p>
<table>
<tr><td><img src="book_files/book-216.jpg" alt="" style="width:363pt;height:193pt;"></td></tr>
<tr><td>
<p><a name="bookmark1168"></a><span class="font23" style="font-style:italic;">Figure 6-13. Proxy hierarchies can be dynamic, changing for each request</span></p></td></tr>
</table></li></ul>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1169"></a><span class="font24">Here are a few other examples of dynamic parent selection:</span></p>
<p><span class="font24" style="font-style:italic;">Load balancing</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">A child proxy might pick a parent proxy based on the current level of workload on the parents, to spread the load around.</span></p>
<p><span class="font24" style="font-style:italic;">Geographic proximity routing</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">A child proxy might select a parent responsible for the origin server’s geographic region.</span></p>
<p><a name="bookmark1170"></a><span class="font24" style="font-style:italic;">Protocol/type routing</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">A child proxy might route to different parents and origin servers based on the URI. Certain types of URIs might cause the requests to be transported through special proxy servers, for special protocol handling.</span></p>
<p><span class="font24" style="font-style:italic;">Subscription-based routing</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">If publishers have paid extra money for high-performance service, their URIs might be routed to large caches or compression engines to improve performance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Dynamic parenting routing logic is implemented differently in different products, including configuration files, scripting languages, and dynamic executable plug-ins.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1171"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1172"></a>How Proxies Get Traffic</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1173"></a><span class="font24">Because clients normally talk directly to web servers, we need to explain how HTTP traffic finds its way to a proxy in the first place. There are four common ways to cause client traffic to get to a proxy:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Modify the client</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1174"></a><span class="font24">Many web clients, including Netscape and Microsoft browsers, support both manual and automated proxy configuration. If a client is configured to use a proxy server, the client sends HTTP requests directly and intentionally to the proxy, instead of to the origin server (</span><a href="#bookmark1175"><span class="font24">Figure 6-14</span></a><span class="font24">a).</span></p>
<p><span class="font24" style="font-style:italic;">Modify the network</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">There are several techniques where the network infrastructure intercepts and steers web traffic into a proxy, without the client’s knowledge or participation. This interception typically relies on switching and routing devices that watch for HTTP traffic, intercept it, and shunt the traffic into a proxy, without the client’s knowledge (</span><a href="#bookmark1175"><span class="font24">Figure 6-14</span></a><span class="font24">b). This is called an </span><span class="font24" style="font-style:italic;">intercepting</span><span class="font24"> proxy.<a name="footnote43"></a><sup><a href="#bookmark1176">43</a></sup><sup></sup></span></p>
<p><span class="font24" style="font-style:italic;">Modify the DNS namespace</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Surrogates, which are proxy servers placed in front of web servers, assume the name and IP address of the web server directly, so all requests go to them instead</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">of to the server (</span><a href="#bookmark1175"><span class="font24">Figure 6-14</span></a><span class="font24">c). This can be arranged by manually editing the DNS naming tables or by using special dynamic DNS servers that compute the appropriate proxy or server to use on-demand. In some installations, the IP address and name of the real server is changed and the surrogate is given the former address and name.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Modify the web server</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Some web servers also can be configured to redirect client requests to a proxy by sending an HTTP redirection command (response code 305) back to the client. Upon receiving the redirect, the client transacts with the proxy (</span><a href="#bookmark1175"><span class="font24">Figure 6-14</span></a><span class="font24">d).</span></p>
<p style="text-align:justify;"><span class="font24">The next section explains how to configure clients to send traffic to proxies. </span><a href="#bookmark244"><span class="font24">Chapter 20</span></a><span class="font24"> will explain how to configure the network, DNS, and servers to redirect traffic to proxy servers.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Client configured to use proxy</span></p></td></tr>
<tr><td><img src="book_files/book-217.jpg" alt="" style="width:84pt;height:28pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Network intercepts and redirects traffic to proxy</span></p></td></tr>
<tr><td><img src="book_files/book-218.jpg" alt="" style="width:157pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-219.jpg" alt="" style="width:20pt;height:36pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-220.jpg" alt="" style="width:37pt;height:27pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Server redirects HTTP requests to proxy</span></p></td></tr>
<tr><td><img src="book_files/book-221.jpg" alt="" style="width:155pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark1177"></a><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Surrogate stands in for web server</span></p></td></tr>
<tr><td><img src="book_files/book-222.jpg" alt="" style="width:103pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-223.jpg" alt="" style="width:72pt;height:47pt;"></td></tr>
<tr><td>
<p style="text-indent:10pt;"><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">(assuming the</span><span class="font0" style="font-weight:bold;"> <sup>Server </sup></span><span class="font1" style="font-style:italic;">web server’s name)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-224.jpg" alt="" style="width:36pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 16pt 0pt;"><a name="bookmark1175"></a><span class="font23" style="font-style:italic;">Figure 6-14. There are many techniques to direct web requests to proxies</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1178"></a><span class="font9" style="font-weight:bold;"><a name="bookmark58"></a><a name="bookmark1179"></a>Client Proxy Settings</span></h2>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">All modern web browsers let you configure the use of proxies. In fact, many browsers provide multiple ways of configuring proxies, including:</span></p>
<p><span class="font24" style="font-style:italic;">Manual configuration</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">You explicitly set a proxy to use.</span></p>
<p><span class="font24" style="font-style:italic;">Browser preconfiguration</span></p>
<p style="padding:0pt 0pt 5pt 19pt;"><span class="font24">The browser vendor or distributor manually preconfigures the proxy setting of the browser (or any other web client) before delivering it to customers.</span></p>
<p style="text-align:justify;"><a name="bookmark1180"></a><span class="font24" style="font-style:italic;"><a name="bookmark1181"></a><a name="bookmark1182"></a>Proxy auto-configuration (PAC)</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">You provide a URI to a JavaScript </span><span class="font24" style="font-style:italic;">proxy auto-configuration</span><span class="font24"> (PAC) file; the client fetches the JavaScript file and runs it to decide if it should use a proxy and, if so, which proxy server to use.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">WPAD proxy discovery</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">Some browsers support the Web Proxy Autodiscovery Protocol (WPAD), which automatically detects a “configuration server” from which the browser can download an auto-configuration file.<a name="footnote44"></a><sup><a href="#bookmark1183">44</a></sup><sup></sup></span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1184"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1185"></a>Client Proxy Configuration: Manual</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many web clients allow you to configure proxies manually. Both Netscape Navigator and Microsoft Internet Explorer have convenient support for proxy configuration.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1186"></a><span class="font24"><a name="bookmark1187"></a>In Netscape Navigator 6, you specify proxies through the menu selection Edit </span><span class="font14">➝ </span><span class="font24">Preferences </span><span class="font14">➝ </span><span class="font24">Advanced </span><span class="font14">➝ </span><span class="font24">Proxies and then selecting the “Manual proxy configuration” radio button.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In Microsoft Internet Explorer 5, you can manually specify proxies from the Tools </span><span class="font14">➝ </span><span class="font24">Internet Options menu, by selecting a connection, pressing “Settings,” checking the “Use a proxy server” box, and clicking “Advanced.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Other browsers have different ways of making manual configuration changes, but the idea is the same: specifying the host and port for the proxy. Several ISPs ship customers preconfigured browsers, or customized operating systems, that redirect web traffic to proxy servers.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1188"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1189"></a>Client Proxy Configuration: PAC Files</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Manual proxy configuration is simple but inflexible. You can specify only one proxy server for all content, and there is no support for failover. Manual proxy configuration also leads to administrative problems for large organizations. With a large base of configured browsers, it’s difficult or impossible to reconfigure every browser if you need to make changes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxy auto-configuration (PAC) files are a more dynamic solution for proxy configuration, because they are small JavaScript programs that compute proxy settings on the fly. Each time a document is accessed, a JavaScript function selects the proper proxy server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To use PAC files, configure your browser with the URI of the JavaScript PAC file (configuration is similar to manual configuration, but you provide a URI in an “automatic configuration” box). The browser will fetch the PAC file from this URI and use <a name="bookmark1190"></a>the JavaScript logic to compute the proper proxy server for each access. PAC files typically have a </span><span class="font24" style="font-style:italic;">.pac</span><span class="font24"> suffix and the MIME type “application/x-ns-proxy-autoconfig.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Each PAC file must define a function called </span><span class="font4">FindProxyForURL(url,host) </span><span class="font24">that computes the proper proxy server to use for accessing the URI. The return value of the function can be any of the values in </span><a href="#bookmark1191"><span class="font24">Table 6-1</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark1191"></a><span class="font23" style="font-style:italic;">Table 6-1. Proxy auto-configuration script return values</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">FindProxyForURL return value</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">DIRECT</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">Connections should be made directly, without any proxies.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">PROXY host:port</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The specified proxy should be used.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SOCKS host:port</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The specified SOCKS server should be used.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">The PAC file in</span><a href="#bookmark1192"><span class="font24"> Example 6-1 </span></a><span class="font24">mandates one proxy for HTTP transactions, another proxy for FTP transactions, and direct connections for all other kinds of transactions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1192"></a><span class="font23" style="font-style:italic;">Example 6-1. Example proxy auto-configuration file</span></p>
<p style="text-align:justify;"><a name="bookmark1193"></a><span class="font3">function FindProxyForURL(url, host) {</span></p>
<p style="text-align:justify;text-indent:17pt;"><a name="bookmark1194"></a><span class="font3">if (url.substring(0,5) == &quot;http:&quot;) {</span></p>
<p style="text-align:justify;text-indent:33pt;"><span class="font3">return &quot;PROXY http-proxy.mydomain.com:8080&quot;;</span></p>
<p style="text-align:justify;text-indent:17pt;"><span class="font3">} else if (url.substring(0,4) ==&quot;ftp:&quot;) {</span></p>
<p style="text-indent:33pt;"><span class="font3">return &quot;PROXY ftp-proxy.mydomain.com:8080&quot;;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 33pt;"><span class="font3">} else { return &quot;DIRECT&quot;;</span></p>
<p style="text-indent:17pt;"><span class="font3">}</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">}</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">For more details about PAC files, refer to </span><a href="#bookmark244"><span class="font24">Chapter 20</span></a><span class="font24">.</span></p>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1195"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1196"></a>Client Proxy Configuration: WPAD</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Another mechanism for browser configuration is the Web Proxy Autodiscovery Protocol (WPAD). WPAD is an algorithm that uses an escalating strategy of discovery mechanisms to find the appropriate PAC file for the browser automatically. A client that implements the WPAD protocol will:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Use WPAD to find the PAC URI.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Fetch the PAC file given the URI.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Execute the PAC file to determine the proxy server.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Use the proxy server for requests.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">WPAD uses a series of resource-discovery techniques to determine the proper PAC file. Multiple discovery techniques are used, because not all organizations can use all techniques. WPAD attempts each technique, one by one, until it succeeds.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1197"></a><span class="font24"><a name="bookmark1198"></a>The current WPAD specification defines the following techniques, in order:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Dynamic Host Discovery Protocol (DHCP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Service Location Protocol (SLP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• DNS well-known hostnames</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• DNS SRV records</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• DNS service URIs in TXT records</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">For more information, consult</span><a href="#bookmark244"><span class="font24"> Chapter 20</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1199"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1200"></a><a name="bookmark59"></a><a name="bookmark1201"></a>Tricky Things About Proxy Requests</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This section explains some of the tricky and much misunderstood aspects of proxy server requests, including:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• How the URIs in proxy requests differ from server requests</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• How intercepting and reverse proxies can obscure server host information</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• The rules for URI modification</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• How proxies impact a browser’s clever URI auto-completion or hostnameexpansion features</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1202"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1203"></a>Proxy URIs Differ from Server URIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web server and web proxy messages have the same syntax, with one exception. The URI in an HTTP request message differs when a client sends the request to a server instead of a proxy.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a client sends a request to a web server, the request line contains only a partial URI (without a scheme, host, or port), as shown in the following example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">GET /index.html HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">User-Agent: SuperBrowserv1.3</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a client sends a request to a proxy, however, the request line contains the full URI. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">GET </span><a href="http://www.marys-antiques.com/index.html"><span class="font3">http://www.marys-antiques.com/index.html</span></a><span class="font3"> HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">User-Agent: SuperBrowser v1.3</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Why have two different request formats, one for proxies and one for servers? In the original HTTP design, clients talked directly to a single server. Virtual hosting did not exist, and no provision was made for proxies. Because a single server knows its own hostname and port, to avoid sending redundant information, clients sent just the partial URI, without the scheme and host (and port).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When proxies emerged, the partial URIs became a problem. Proxies needed to know the name of the destination server, so they could establish their own connections to the server. And proxy-based gateways needed the scheme of the URI to connect to FTP resources and other schemes. HTTP/1.0 solved the problem by requiring the full URI for proxy requests, but it retained partial URIs for server requests (there were too many servers already deployed to change all of them to support full URIs).<a name="footnote45"></a><sup><a href="#bookmark1204">45</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">So we need to send partial URIs to servers, and full URIs to proxies. In the case of explicitly configured client proxy settings, the client knows what type of request to issue:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• When the client </span><span class="font24" style="font-style:italic;">is not</span><span class="font24"> set to use a proxy, it sends the partial URI </span><a href="#bookmark1205"><span class="font24">(Figure 6-15</span></a><span class="font24">a).</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 10pt 0pt;"><span class="font24">• When the client </span><span class="font24" style="font-style:italic;">is</span><span class="font24"> set to use a proxy, it sends the full URI (</span><a href="#bookmark1205"><span class="font24">Figure 6-15b</span></a><span class="font24">).</span></p><img src="book_files/book-225.jpg" alt="" style="width:360pt;height:350pt;"></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1206"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1207"></a><a name="bookmark1208"></a>The Same Problem with Virtual Hosting</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The proxy “missing scheme/host/port” problem is the same problem faced by virtually hosted web servers. Virtually hosted web servers share the same physical web server among many web sites. When a request comes in for the partial URI </span><span class="font24" style="font-style:italic;">/index.html</span><span class="font24">, the virtually hosted web server needs to know the hostname of the intended web site (see</span><a href="#bookmark1044"><span class="font24"> “Virtually hosted docroots” in Chapter 5 </span></a><span class="font24">and</span><a href="#bookmark1052"><span class="font24"> “Virtual</span></a><span class="font24"> </span><a href="#bookmark1052"><span class="font24">Hosting” in Chapter 18 </span></a><span class="font24">for more information).</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In spite of the problems being similar, they were solved in different ways:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Explicit proxies solve the problem by requiring a full URI in the request message.</span></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark1209"></a><span class="font24">• Virtually hosted web servers require a Host header to carry the host and port information.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1210"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1211"></a>Intercepting Proxies Get Partial URIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1212"></a><span class="font24">As long as the clients properly implement HTTP, they will send full URIs in requests to explicitly configured proxies. That solves part of the problem, but there’s a catch: a client </span><span class="font24" style="font-style:italic;">will not always know</span><span class="font24"> it’s talking to a proxy, because some proxies may be invisible to the client. Even if the client is not configured to use a proxy, the client’s traffic still may go through a surrogate or intercepting proxy. In both of these cases, the client will think it’s talking to a web server and won’t send the full URI:</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1213"></a><span class="font24">•A</span><span class="font24" style="font-style:italic;">surrogate</span><span class="font24">, as described earlier, is a proxy server taking the place of the origin server, usually by assuming its hostname or IP address. It receives the web server request and may serve cached responses or proxy requests to the real server. A client cannot distinguish a surrogate from a web server, so it sends partial URIs </span><a href="#bookmark1205"><span class="font24">(Figure 6-15</span></a><span class="font24">c).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">•An</span><span class="font24" style="font-style:italic;">intercepting proxy</span><span class="font24"> is a proxy server in the network flow that hijacks traffic from the client to the server and either serves a cached response or proxies it. Because the intercepting proxy hijacks client-to-server traffic, it will receive partial URIs that are sent to web servers (</span><a href="#bookmark1205"><span class="font24">Figure 6-15</span></a><span class="font24">d).<a name="footnote46"></a><sup><a href="#bookmark1214">46</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1215"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1216"></a>Proxies Can Handle Both Proxy and Server Requests</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because of the different ways that traffic can be redirected into proxy servers, general-purpose proxy servers should support both full URIs and partial URIs in request messages. The proxy should use the full URI if it is an explicit proxy request or use the partial URI and the virtual Host header if it is a web server request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The rules for using full and partial URIs are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• If a full URI is provided, the proxy should use it.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If a partial URI is provided, and a Host header is present, the Host header should be used to determine the origin server name and port number.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1217"></a><span class="font24">• If a partial URI is provided, and there is no Host header, the origin server needs to be determined in some other way:</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 37pt;"><a name="bookmark1218"></a><span class="font24">— If the proxy is a surrogate, standing in for an origin server, the proxy can be configured with the real server’s address and port number.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 37pt;"><span class="font24">— If the traffic was intercepted, and the interceptor makes the original IP address and port available, the proxy can use the IP address and port number from the interception technology (see </span><a href="#bookmark244"><span class="font24">Chapter 20</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 37pt;"><span class="font24">— If all else fails, the proxy doesn’t have enough information to determine the origin server and must return an error message (often suggesting that the user upgrade to a modern browser that supports Host headers).<a name="footnote47"></a><sup><a href="#bookmark1219">47</a></sup><sup></sup></span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1220"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1221"></a>In-Flight URI Modification</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Proxy servers need to be very careful about changing the request URI as they forward messages. Slight changes in the URI, even if they seem benign, may create interoperability problems with downstream servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark472"></a><span class="font24"><a name="bookmark1222"></a>In particular, some proxies have been known to “canonicalize” URIs into a standard form before forwarding them to the next hop. Seemingly benign transformations, such as replacing default HTTP ports with an explicit “:80”, or correcting URIs by replacing illegal reserved characters with their properly escaped substitutions, can cause interoperation problems.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In general, proxy servers should strive to be as tolerant as possible. They should not aim to be “protocol policemen” looking to enforce strict protocol compliance, because this could involve significant disruption of previously functional services.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In particular, the HTTP specifications forbid general intercepting proxies from rewriting the absolute path parts of URIs when forwarding them. The only exception is that they can replace an empty path with “/”.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1223"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1224"></a>URI Client Auto-Expansion and Hostname Resolution</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Browsers resolve request URIs differently, depending on whether or not a proxy is present. Without a proxy, the browser takes the URI you type in and tries to find a corresponding IP address. If the hostname is found, the browser tries the corresponding IP addresses until it gets a successful connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">But if the host isn’t found, many browsers attempt to provide some automatic “expansion” of hostnames, in case you typed in a “shorthand” abbreviation of the host (refer back to</span><a href="#bookmark464"><span class="font24"> “Expandomatic URLs” in Chapter 2</span></a><span class="font24">):<a name="footnote48"></a><sup><a href="#bookmark1225">48</a></sup><sup></sup></span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><a name="bookmark1226"></a><span class="font24">• Many browsers attempt adding a “www.” prefix and a “.com” suffix, in case you just entered the middle piece of a common web site name (e.g., to let people enter “yahoo” instead of “www.yahoo.com”).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">• Some browsers even pass your unresolvable URI to a third-party site, which attempts to correct spelling mistakes and suggest URIs you may have intended.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 18pt;"><span class="font24">• In addition, the DNS configuration on most systems allows you to enter just the prefix of the hostname, and the DNS automatically searches the domain. If you are in the domain “oreilly.com” and type in the hostname “host7,” the DNS automatically attempts to match “host7.oreilly.com”. It’s not a complete, valid hostname.</span></p></li></ul>
<h3 style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark1227"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1228"></a>URI Resolution Without a Proxy</span></h3>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark1229"><span class="font24">Figure 6-16</span></a><span class="font24"> shows an example of browser hostname auto-expansion without a proxy. In steps 2a–3c, the browser looks up variations of the hostname until a valid hostname is found.</span></p>
<p style="padding:0pt 0pt 3pt 88pt;"><span class="font1" style="font-weight:bold;">(2a) </span><span class="font0">Browser looks up host “oreilly” via DNS</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-226.jpg" alt="" style="width:33pt;height:41pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">DNS server</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 3pt 95pt;"><span class="font1" style="font-weight:bold;">(2b) </span><span class="font0">Failed, host unknown</span></p>
<p style="padding:0pt 0pt 3pt 103pt;"><span class="font1" style="font-weight:bold;">(3b) </span><span class="font0">Browser looks up host “www.oreilly.com” via DNS</span></p>
<p style="padding:0pt 0pt 11pt 110pt;"><span class="font1" style="font-weight:bold;">(3c) </span><span class="font0">Success! Get IP addresses back</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(1) </span><span class="font0">User types “oreilly” into browser’s URI location window</span></p></td></tr>
<tr><td><img src="book_files/book-227.jpg" alt="" style="width:50pt;height:19pt;"></td></tr>
</table>
</div><br clear="all">
<div style="border-bottom:solid;display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(4a) </span><span class="font0">Browser tries to connect to IP addresses, one by one, until connect successful </span><span class="font1" style="font-weight:bold;">(4b) </span><span class="font0">Success; connection established</span></p>
</div><br clear="all">
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-228.jpg" alt="" style="width:30pt;height:37pt;"></td></tr>
<tr><td>
<p><a href="http://www.oreilly.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.oreilly.com</span></a></p></td></tr>
</table>
</div>
<p style="padding:3pt 0pt 3pt 117pt;"><span class="font1" style="font-weight:bold;">(5a) </span><span class="font0">Browser sends HTTP request</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-229.jpg" alt="" style="width:52pt;height:19pt;">
</div>
<p style="text-indent:46pt;"><span class="font1" style="font-weight:bold;">(5b) </span><span class="font0">Browser gets HTTP response</span></p>
<p style="text-indent:18pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="padding:0pt 0pt 11pt 8pt;"><span class="font1" style="font-weight:bold;">(3a) </span><span class="font0">The browser does auto-expansion, converting “oreilly” into “www.oreilly.com”</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a name="bookmark1229"></a><span class="font23" style="font-style:italic;">Figure 6-16. Browser auto-expands partial hostnames when no explicit proxy is present</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">Here’s what’s going on in this figure:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">• In Step 1, the user types “oreilly” into the browser’s URI window. The browser uses “oreilly” as the hostname and assumes a default scheme of “http://”, a default port of “80”, and a default path of “/”.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• In Step 2a, the browser looks up host “oreilly.” This fails.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In Step 3a, the browser auto-expands the hostname and asks the DNS to resolve “www.oreilly.com.” This is successful.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• The browser then successfully connects to </span><a href="http://www.oreilly.com"><span class="font24" style="font-style:italic;">www.oreilly.com</span></a><span class="font24">.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1230"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1231"></a>URI Resolution with an Explicit Proxy</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When you use an explicit proxy the browser no longer performs any of these convenience expansions, because the user’s URI is passed directly to the proxy.</span></p>
<p style="text-align:justify;"><span class="font24">As shown in</span><a href="#bookmark1232"><span class="font24"> Figure 6-17</span></a><span class="font24">, the browser does not auto-expand the partial hostname when there is an explicit proxy. As a result, when the user types “oreilly” into the browser’s location window, the proxy is sent “</span><a href="http://oreilly/%e2%80%9d"><span class="font24">http://oreilly/”</span></a><span class="font24"> (the browser adds the default scheme and path but leaves the hostname as entered).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message, as sent in (4a)</span></p>
<p style="text-indent:285pt;"><a name="bookmark1233"></a><span class="font2">GET </span><a href="http://oreilly/"><span class="font2">http://oreilly/</span></a><span class="font2"> HTTP/1.0 Proxonnection: Keep-Alive User-agent: Mozilla/4.72[en] (Win98:I) <img src="book_files/book-230.jpg" alt="" style="width:6pt;height:7pt;">&nbsp;Ho: oreilly</span></p>
<p style="text-indent:285pt;"><span class="font2">Accept: <a name="footnote49"></a><sup><a href="#bookmark1234">49</a></sup>/<sup><a href="#bookmark1234">49</a></sup></span></p>
<p style="text-indent:285pt;"><span class="font2">Accept-encoding: gzip</span></p>
<p style="text-indent:285pt;"><span class="font2">Accept-language: en</span></p>
<p style="text-indent:285pt;"><span class="font2">Accept-charset: iso-8859-1,<sup><a href="#bookmark1234">49</a></sup>,utf-8</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(2a) </span><span class="font0">Proxy is explicitly configured, so the browser looks up the address of the proxy server using DNS</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-231.jpg" alt="" style="width:18pt;height:12pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(2b) </span><span class="font0">Success! Get proxy server IP addresses</span></p></td><td><img src="book_files/book-232.jpg" alt="" style="width:34pt;height:40pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">DNS server</span></p></td><td><img src="book_files/book-233.jpg" alt="" style="width:38pt;height:15pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(4b) </span><span class="font0">Proxy gets a partial hostname in the request, because the client did not auto-expand it.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(1) </span><span class="font0">User types “oreilly” into browser’s URI location window</span></p></td></tr>
<tr><td><img src="book_files/book-234.jpg" alt="" style="width:49pt;height:19pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-235.jpg" alt="" style="width:107pt;height:53pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">(3a) </span><span class="font0">Browser tries to connect to proxy</span></p>
<p><span class="font1" style="font-weight:bold;">(3b) </span><span class="font0">Success; connection established</span></p></td></tr>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p><a name="bookmark1235"></a><span class="font1" style="font-weight:bold;">(3a) </span><span class="font0">The browser does auto-expansion, converting “oreilly” into “www.oreilly.com</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-236.jpg" alt="" style="width:29pt;height:37pt;"></td></tr>
<tr><td>
<p><a href="http://www.oreilly.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.oreilly.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-237.jpg" alt="" style="width:53pt;height:19pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">(4a) </span><span class="font0">Browser sends HTTP request</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1232"></a><span class="font23" style="font-style:italic;">Figure 6-17. Browser does not auto-expand partial hostnames when there is an explicit proxy</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">For this reason, some proxies attempt to mimic as much as possible of the browser’s convenience services as they can, including “www...com” auto-expansion and addition of local domain suffixes.<sup><a href="#bookmark1234">49</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1236"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1237"></a>URI Resolution with an Intercepting Proxy</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Hostname resolution is a little different with an invisible intercepting proxy, because as far as the client is concerned, there is no proxy! The behavior proceeds much like the server case, with the browser auto-expanding hostnames until DNS success. But a significant difference occurs when the connection to the server is made, as </span><a href="#bookmark1238"><span class="font24">Figure 6-18</span></a><span class="font24"> illustrates.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-238.jpg" alt="" style="width:236pt;height:135pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-239.jpg" alt="" style="width:82pt;height:93pt;">
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1238"></a><span class="font23" style="font-style:italic;">Figure 6-18. Browser doesn’t detect dead server IP addresses when using intercepting proxies</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark1238"><span class="font24">Figure 6-18</span></a><span class="font24"> demonstrates the following transaction:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• In Step 1, the user types “oreilly” into the browser’s URI location window.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In Step 2a, the browser looks up the host “oreilly” via DNS, but the DNS server fails and responds that the host is unknown, as shown in Step 2b.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In Step 3a, the browser does auto-expansion, converting “oreilly” into “www. oreilly.com.” In Step 3b, the browser looks up the host “www.oreilly.com” via DNS. This time, as shown in Step 3c, the DNS server is successful and returns IP addresses back to the browser.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1239"></a><span class="font24">• In Step 4a, the client already has successfully resolved the hostname and has a list of IP addresses. Normally, the client tries to connect to each IP address until it succeeds, because some of the IP addresses may be dead. But with an intercepting proxy, the first connection attempt is terminated by the proxy server, not the origin server. The client believes it is successfully talking to the web server, but the web server might not even be alive.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark1240"></a><span class="font24"><a name="bookmark1241"></a>• When the proxy finally is ready to interact with the real origin server (Step 5b), the proxy may find that the IP address actually points to a down server. To provide the same level of fault tolerance provided by the browser, the proxy needs to try other IP addresses, either by reresolving the hostname in the Host header or by doing a reverse DNS lookup on the IP address. It is important that both intercepting and explicit proxy implementations support fault tolerance on DNS resolution to dead servers, because when browsers are configured to use an explicit proxy, they rely on the proxy for fault tolerance.</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1242"></a><span class="font9" style="font-weight:bold;"><a name="bookmark60"></a><a name="bookmark1243"></a>Tracing Messages</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Today, it’s not uncommon for web requests to go through a chain of two or more proxies on their way from the client to the server (</span><a href="#bookmark1244"><span class="font24">Figure 6-19</span></a><span class="font24">). For example, many</span></p>
<p style="text-align:justify;"><span class="font24">corporations use caching proxy servers to access the Internet, for security and cost savings, and many large ISPs use proxy caches to improve performance and implement features. A significant percentage of web requests today go through proxies. At the same time, it’s becoming increasingly popular to replicate content on banks of surrogate caches scattered around the globe, for performance reasons.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-240.jpg" alt="" style="width:41pt;height:25pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Surrogate cache bank</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-241.jpg" alt="" style="width:31pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-242.jpg" alt="" style="width:41pt;height:33pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-243.jpg" alt="" style="width:80pt;height:27pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1244"></a><span class="font23" style="font-style:italic;"><a name="bookmark1245"></a>Figure 6-19. Access proxies and CDN proxies create two-level proxy hierarchies</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxies are developed by different vendors. They have different features and bugs and are administrated by various organizations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As proxies become more prevalent, you need to be able to trace the flow of messages across proxies and to detect any problems, just as it is important to trace the flow of IP packets across different switches and routers.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1246"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1247"></a>The Via Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Via header field lists information about each intermediate node (proxy or gateway) through which a message passes. Each time a message goes through another node, the intermediate node must be added to the end of the Via list.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following Via string tells us that the message traveled through two proxies. It indicates that the first proxy implemented the HTTP/1.1 protocol and was called </span><span class="font24" style="font-style:italic;">proxy-62.irenes-isp.net</span><span class="font24">, and that the second proxy implemented HTTP/1.0 and was called </span><span class="font24" style="font-style:italic;">cache.joes-hardware.com</span><span class="font24">:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Via: 1.1 proxy-62.irenes-isp.net, 1.0 cache.joes-hardware.com</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Via header field is used to track the forwarding of messages, diagnose message loops, and identify the protocol capabilities of all senders along the request/response chain (</span><a href="#bookmark1248"><span class="font24">Figure 6-20</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxies also can use Via headers to detect routing loops in the network. A proxy should insert a unique string associated with itself in the Via header before sending out a request and should check for the presence of this string in incoming requests to detect routing loops in the network.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message (as received by server)</span></p>
<p style="padding:0pt 0pt 0pt 122pt;"><span class="font2">GET /index.html HTTP/1.0</span></p>
<p style="padding:0pt 0pt 0pt 122pt;"><span class="font2">Accept: text/html</span></p>
<p style="padding:0pt 0pt 0pt 122pt;"><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p style="padding:0pt 0pt 0pt 122pt;"><span class="font2">Via: 1.1 proxy-62.irenes-isp.net, 1.0 cache.joes-hardware.com</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-244.jpg" alt="" style="width:71pt;height:46pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-245.jpg" alt="" style="width:60pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">proxy-62.irenes-isp.net</span></p>
<p><span class="font1" style="font-style:italic;">(HTTP/1.1)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-246.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><a name="bookmark1249"></a><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">cache.joes-hardware.com</span></p>
<p style="text-align:justify;text-indent:23pt;"><span class="font1" style="font-style:italic;">(HTTP/1.0) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark1248"></a><span class="font23" style="font-style:italic;">Figure 6-20. Via header example</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1250"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1251"></a>Via syntax</span></h4>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The Via header field contains a comma-separated list of </span><span class="font24" style="font-style:italic;">waypoints</span><span class="font24">. Each waypoint represents an individual proxy server or gateway hop and contains information about the protocol and address of that intermediate node. Here is an example of a Via header with two waypoints:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">Via = 1.1 cache.joes-hardware.com, 1.1 proxy.irenes-isp.net</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font24">The formal syntax for a Via header is shown here:</span></p>
<p style="text-indent:19pt;"><span class="font3">Via &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;Via&quot; &quot;:&quot; 1#( waypoint )</span></p>
<p style="text-indent:19pt;"><span class="font3">waypoint &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ( received-protocol received-by [ comment ] )</span></p>
<p style="padding:0pt 0pt 3pt 19pt;"><span class="font3">received-protocol = [ protocol-name &quot;/&quot; ] protocol-version received-by = ( host [ &quot;:&quot; port ] ) | pseudonym</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Note that each Via waypoint contains up to four components: an optional protocol name (defaults to HTTP), a required protocol version, a required node name, and an optional descriptive comment:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Protocol name</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The protocol received by an intermediary. The protocol name is optional if the protocol is HTTP. Otherwise, the protocol name is prepended to the version, separated by a “/”. Non-HTTP protocols can occur when gateways connect HTTP requests for other protocols (HTTPS, FTP, etc.).</span></p>
<p><span class="font24" style="font-style:italic;">Protocol version</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The version of the message received. The format of the version depends on the protocol. For HTTP, the standard version numbers are used (“1.0”, “1.1”, etc.). The version is included in the Via field, so later applications will know the protocol capabilities of all previous intermediaries.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Node name</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The host and optional port number of the intermediary (if the port isn’t included, you can assume the default port for the protocol). In some cases an organization might not want to give out the real hostname, for privacy reasons, in which case it may be replaced by a pseudonym.</span></p>
<p style="text-align:justify;"><a name="bookmark1252"></a><span class="font24" style="font-style:italic;">Node comment</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><span class="font24">An optional comment that further describes the intermediary node. It’s common to include vendor and version information here, and some proxy servers also use the comment field to include diagnostic information about the events that occurred on that device.<a name="footnote50"></a><sup><a href="#bookmark1253">50</a></sup><sup></sup></span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1254"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1255"></a>Via request and response paths</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Both request and response messages pass through proxies, so both request and response messages have Via headers.</span></p>
<p style="text-align:justify;"><a name="bookmark1256"></a><span class="font24">Because requests and responses usually travel over the same TCP connection, response messages travel backward across the same path as the requests. If a request message goes through proxies A, B, and C, the corresponding response message travels through proxies C, B, then A. So, the Via header for responses is almost always the reverse of the Via header for responses (</span><a href="#bookmark1257"><span class="font24">Figure 6-21</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request Via header </span><span class="font0">via: 1.1 A, 1.1 B, 1.1 C</span></p></td></tr>
<tr><td><img src="book_files/book-247.jpg" alt="" style="width:187pt;height:79pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-248.jpg" alt="" style="width:49pt;height:46pt;"></td></tr>
<tr><td>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-249.jpg" alt="" style="width:47pt;height:48pt;">
</div><br clear="all">
<p style="padding:0pt 255pt 11pt 54pt;"><span class="font1" style="font-style:italic;">Reponse Via header </span><span class="font0">via: 1.1 C, 1.1 B, 1.1 A</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark1257"></a><span class="font23" style="font-style:italic;">Figure 6-21. The response Via is usually the reverse of the request Via</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1258"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1259"></a>Via and gateways</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some proxies provide gateway functionality to servers that speak non-HTTP protocols. The Via header records these protocol conversions, so HTTP applications can be aware of protocol capabilities and conversions along the proxy chain. </span><a href="#bookmark1260"><span class="font24">Figure 6-22</span></a><span class="font24"> shows an HTTP client requesting an FTP URI through an HTTP/FTP gateway.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The client sends an HTTP request for </span><a href="ftp://http-guide.com/pub/welcome.txt"><span class="font24" style="font-style:italic;">ftp://http-guide.com/pub/welcome.txt</span></a><span class="font24"> to the gateway </span><span class="font24" style="font-style:italic;">proxy.irenes-isp.net</span><span class="font24">. The proxy, acting as a protocol gateway, retrieves the desired object from the FTP server, using the FTP protocol. The proxy then sends the object back to the client in an HTTP response, with this Via header field:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 8pt 0pt;"><span class="font3">Via: FTP/1.0 proxy.irenes-isp.net (Traffic-Server/5.0.1-17882 [cMs f ])</span></p>
<p style="text-align:justify;text-indent:44pt;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">HTTP request message sent to proxy</span></p>
<p style="text-align:justify;text-indent:48pt;"><span class="font2">GET </span><a href="ftp://http-guide.com/pub/welcome.txt"><span class="font2">ftp://http-guide.com/pub/welcome.txt</span></a><span class="font2"> HTTP/1.0</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">FTP request</span></p></td><td><img src="book_files/book-250.jpg" alt="" style="width:56pt;height:44pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-style:italic;">FTP response</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">http-guide.com</span></p>
<p><span class="font1" style="font-weight:bold;">FTP server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-251.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-252.jpg" alt="" style="width:39pt;height:16pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">proxy.irenes-isp.net </span><span class="font1" style="font-style:italic;">(HTTP/1.0)</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;text-indent:44pt;padding:0pt 0pt 5pt 0pt;"><span class="font1" style="font-style:italic;">HTTP response message</span></p>
<p style="text-align:justify;text-indent:48pt;"><a name="bookmark1261"></a><span class="font2"><a name="bookmark1262"></a>HTTP/1.0 200 OK</span></p>
<p style="text-align:justify;text-indent:48pt;"><span class="font2">Date: Sun, 11 Nov 2001 21:01:59 GMT</span></p>
<p style="text-align:justify;text-indent:48pt;"><span class="font2">Via: FTP/1.0 proxy.irenes-isp.net (Traffic-Server/5.0.1-17882 [cMsf])</span></p>
<p style="text-align:justify;text-indent:48pt;"><span class="font2">Last-modified: Sun, 11 Nov 2001 21:05:24 GMT</span></p>
<p style="text-align:justify;text-indent:48pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Content-type: text/plain</span></p>
<p style="text-align:justify;text-indent:48pt;padding:0pt 0pt 13pt 0pt;"><span class="font2">Hi there. This is an FTP server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1260"></a><span class="font23" style="font-style:italic;">Figure 6-22. HTTP/FTP gateway generates Via headers, logging the received protocol (FTP)</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark1263"></a><span class="font24">Notice the received protocol is FTP. The optional comment contains the brand and version number of the proxy server and some vendor diagnostic information. You can read all about gateways in</span><a href="#bookmark232"><span class="font24"> Chapter 8</span></a><span class="font24">.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1264"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1265"></a><a name="bookmark1266"></a>The Server and Via headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Server response header field describes the software used by the origin server. Here are a few examples:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Apache/1.3.14 (Unix) PHP/4.0.4</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Netscape-Enterprise/4.1</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">If a response message is being forwarded through a proxy, make sure the proxy does not modify the Server header. The Server header is meant for the origin server. Instead, the proxy should add a Via entry.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1267"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1268"></a>Privacy and security implications of Via</span></h4>
<p style="text-align:justify;padding:0pt 0pt 43pt 0pt;"><span class="font24">There are some cases when we want don’t want exact hostnames in the Via string. In general, unless this behavior is explicitly enabled, when a proxy server is part of a network firewall it should not forward the names and ports of hosts behind the firewall, because knowledge of network architecture behind a firewall might be of use to a malicious party.<sup>*</sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 7pt;"><span class="font20">* Malicious people can use the names of computers and version numbers to learn about the network architecture behind a security perimeter. This information might be helpful in security attacks. In addition, the names of computers might be clues to private projects within an organization.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If Via node-name forwarding is not enabled, proxies that are part of a security perimeter should replace the hostname with an appropriate pseudonym for that host. Generally, though, proxies should try to retain a Via waypoint entry for each proxy server, even if the real name is obscured.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1269"></a><span class="font24"><a name="bookmark1270"></a>For organizations that have very strong privacy requirements for obscuring the design and topology of internal network architectures, a proxy may combine an ordered sequence of Via waypoint entries (with identical received-protocol values) into a single, joined entry. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Via: 1.0 foo, 1.1 devirus.company.com, 1.1 access-logger.company.com</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">could be collapsed to:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Via: 1.0 foo, 1.1 concealed-stuff</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark1271"></a><span class="font24">Don’t combine multiple entries unless they all are under the same organizational control and the hosts already have been replaced by pseudonyms. Also, don’t combine entries that have different received-protocol values.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1272"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1273"></a>The TRACE Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark747"></a><span class="font24">Proxy servers can change messages as the messages are forwarded. Headers are added, modified, and removed, and bodies can be converted to different formats. As proxies become more sophisticated, and more vendors deploy proxy products, interoperability problems increase. To easily diagnose proxy networks, we need a way to conveniently watch how messages change as they are forwarded, hop by hop, through the HTTP proxy network.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1274"></a><span class="font24">HTTP/1.1’s TRACE method lets you trace a request message through a chain of proxies, observing what proxies the message passes through and how each proxy modifies the request message. TRACE is very useful for debugging proxy flows.<a name="footnote51"></a><sup><a href="#bookmark1275">51</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">When the TRACE request reaches the destination server,<a name="footnote52"></a><sup><a href="#bookmark1276">52</a></sup><sup></sup> the entire request message is reflected back to the sender, bundled up in the body of an HTTP response (see </span><a href="#bookmark1277"><span class="font24">Figure 6-23</span></a><span class="font24">). When the TRACE response arrives, the client can examine the exact message the server received and the list of proxies through which it passed (in the Via header). The TRACE response has Content-Type message/http and a 200 OK status.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1278"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1279"></a>Max-Forwards</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Normally, TRACE messages travel all the way to the destination server, regardless of the number of intervening proxies. You can use the Max-Forwards header to limit</span></p>
<div style="border-bottom:solid;display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-253.jpg" alt="" style="width:317pt;height:106pt;"></td></tr>
<tr><td>
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-Type: message/http</span></p>
<p><span class="font2">Content-Length: 269</span></p>
<p><span class="font2">Via: 1.1 cache.joes-hardware.com, 1.1 p1127.att.net, 1.1 proxy.irenes-isp.net</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">TRACE /index.html HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Accept: text/html</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Via: 1.1 proxy.irenes-isp.net, 1.1 p1127.att.net, 1.1 cache.joes-hardware.com</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font2">X-Magic-CDN-Thingy: 134-AF-0003</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font2">Cookie: access-isp=&quot;Irene’s ISP, California&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 8pt 0pt;"><span class="font2">Client-ip: 209.134.49.32</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Received request</span></p>
</div>
<p style="text-align:justify;text-indent:12pt;padding:0pt 0pt 11pt 0pt;"><span class="font1" style="font-style:italic;">TRACE response</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1277"></a><span class="font23" style="font-style:italic;">Figure 6-23. TRACE response reflects back the received request message</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">the number of proxy hops for TRACE and OPTIONS requests, which is useful for testing a chain of proxies forwarding messages in an infinite loop or for checking the effects of particular proxy servers in the middle of a chain. Max-Forwards also limits the forwarding of OPTIONS messages (see</span><a href="#bookmark1280"><span class="font24"> “Proxy Interoperation</span></a><span class="font24">”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1281"></a><span class="font24">The Max-Forwards request header field contains a single integer indicating the remaining number of times this request message may be forwarded (</span><a href="#bookmark1282"><span class="font24">Figure 6-24</span></a><span class="font24">). If the Max-Forwards value is zero (Max-Forwards: 0), the receiver must reflect the TRACE message back toward the client without forwarding it further, even if the receiver is not the origin server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If the received Max-Forwards value is greater than zero, the forwarded message must contain an updated Max-Forwards field with a value decremented by one. All proxies and gateways should support Max-Forwards. You can use Max-Forwards to view the request at any hop in a proxy chain.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1283"></a><span class="font9" style="font-weight:bold;"><a name="bookmark61"></a><a name="bookmark1284"></a>Proxy Authentication</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxies can serve as access-control devices. HTTP defines a mechanism called </span><span class="font24" style="font-style:italic;">proxy authentication</span><span class="font24"> that blocks requests for content until the user provides valid accesspermission credentials to the proxy:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 6pt 19pt;"><span class="font24">• When a request for restricted content arrives at a proxy server, the proxy server can return a 407 Proxy Authorization Required status code demanding access</span></p></li></ul>
<p style="text-indent:23pt;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">TRACE request</span></p>
<p style="text-indent:26pt;"><span class="font2">TRACE /index.html HTTP/1.1</span></p>
<p style="text-indent:26pt;"><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p style="text-indent:26pt;"><span class="font2">Max-Forwards: 2</span></p>
<p style="text-indent:26pt;"><span class="font2">Accept: text/html</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Max-Forwards= 1</span></p>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Max-Forwards= 0</span></p>
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 1 </span><span class="font1" style="font-style:italic;">(proxy.irenes-isp.net)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy 3</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark1285"></a><span class="font1" style="font-style:italic;">(p1127.att.net) (cache.joes-hardware.com) (</span><a href="http://www.joes-hardware.com"><span class="font1" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font1" style="font-style:italic;">)</span></p>
</div><br clear="all">
<p style="text-align:justify;text-indent:27pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font2">Content-Type: message/http</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font2">Content-Length: 269</span></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Via: 1.1 p1127.att.net, 1.1 proxy.irenes-isp.net</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">TRACE /index.html HTTP/1.1</span></p>
</div>
<p style="padding:0pt 0pt 2pt 96pt;"><span class="font1" style="font-style:italic;">Received request</span></p>
<p style="text-align:justify;"><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:30pt;"><span class="font2">Accept: text/html</span></p>
<p style="text-align:justify;text-indent:30pt;"><span class="font2">Via: 1.1 proxy.irenes-isp.net, 1.1 p1127.att.net</span></p>
<p style="text-align:justify;text-indent:30pt;"><span class="font2">X-Magic-CDN-Thingy: 134-AF-0003</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 30pt;"><span class="font2">Cookie: access-isp=&quot;Irene’s ISP, California&quot; Client-ip: 209.134.49.32</span></p>
<p style="text-align:justify;text-indent:23pt;padding:0pt 0pt 11pt 0pt;"><span class="font1" style="font-style:italic;">TRACE response</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><a name="bookmark1282"></a><span class="font23" style="font-style:italic;">Figure 6-24. You can limit the forwarding hop count with the Max-Forwards header field </span><span class="font24">credentials, accompanied by a Proxy-Authenticate header field that describes how to provide those credentials (</span><a href="#bookmark1286"><span class="font24">Figure 6-25</span></a><span class="font24">b).</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• When the client receives the 407 response, it attempts to gather the required credentials, either from a local database or by prompting the user.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Once the credentials are obtained, the client resends the request, providing the required credentials in a Proxy-Authorization header field.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark1287"></a><span class="font24">• If the credentials are valid, the proxy passes the original request along the chain </span><a href="#bookmark1286"><span class="font24">(Figure 6-25</span></a><span class="font24">c); otherwise, another 407 reply is sent.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxy authentication generally does not work well when there are multiple proxies in a chain, each participating in authentication. People have proposed enhancements to HTTP to associate authentication credentials with particular waypoints in a proxy chain, but those enhancements have not been widely implemented.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Be sure to read </span><a href="#bookmark236"><span class="font24">Chapter 12</span></a><span class="font24"> for a detailed explanation of HTTP’s authentication mechanisms.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1280"></a><span class="font9" style="font-weight:bold;"><a name="bookmark62"></a><a name="bookmark1288"></a>Proxy Interoperation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Clients, servers, and proxies are built by multiple vendors, to different versions of the HTTP specification. They support various features and have different bugs. Proxy servers need to intermediate between client-side and server-side devices, which may implement different protocols and have troublesome quirks.</span></p>
<table>
<tr><td><img src="book_files/book-254.jpg" alt="" style="width:360pt;height:312pt;"></td></tr>
<tr><td>
<p><a name="bookmark1286"></a><span class="font23" style="font-style:italic;"><a name="bookmark1289"></a>Figure 6-25. Proxies can implement authentication to control access to content</span></p></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1290"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1291"></a>Handling Unsupported Headers and Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The proxy server may not understand all the header fields that pass through it. Some headers may be newer than the proxy itself; others may be customized header fields unique to a particular application. Proxies must forward unrecognized header fields and must maintain the relative order of header fields with the same name.<a name="footnote53"></a><sup><a href="#bookmark1292">53</a></sup><sup></sup> Similarly, if a proxy is unfamiliar with a method, it should try to forward the message to the next hop, if possible.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">Proxies that cannot tunnel unsupported methods may not be viable in most networks today, because Hotmail access through Microsoft Outlook makes extensive use of HTTP extension methods.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1293"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1294"></a><a name="bookmark1295"></a><a name="bookmark1296"></a><a name="bookmark1297"></a>OPTIONS: Discovering Optional Feature Support</span></h3>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">The HTTP OPTIONS method lets a client (or proxy) discover the supported functionality (for example, supported methods) of a web server or of a particular resource on a web server (</span><a href="#bookmark1298"><span class="font24">Figure 6-26</span></a><span class="font24">). Clients can use OPTIONS to determine a server’s capabilities before interacting with the server, making it easier to interoperate with proxies and servers of different feature levels.</span></p><img src="book_files/book-255.jpg" alt="" style="width:285pt;height:88pt;">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1298"></a><span class="font23" style="font-style:italic;">Figure 6-26. Using OPTIONS to find a server’s supported methods</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the URI of the OPTIONS request is an asterisk (<a name="footnote54"></a><sup><a href="#bookmark1299">54</a></sup></span><span class="font4"></span><span class="font24">), the request pertains to the entire server’s supported functionality. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">OPTIONS <sup><a href="#bookmark1299">54</a></sup>&nbsp;HTTP/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the URI is a real resource, the OPTIONS request inquires about the features availab<a name="bookmark1300"></a>le to that particular resource:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">OPTIONS </span><a href="http://www.joes-hardware.com/index.html"><span class="font3">http://www.joes-hardware.com/index.html</span></a><span class="font3"> HTTP/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">On success, the OPTIONS method returns a 200 OK response that includes various header fields that describe optional features that are supported on the server or available to the resource. The only header field that HTTP/1.1 specifies in the response is the Allow header, which describes what methods are supported by the server (or particular resource on the server).<sup><a href="#bookmark1299">54</a></sup><sup></sup> OPTIONS allows an optional response body with more information, but this is undefined.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1301"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1302"></a>The Allow Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Allow entity header field lists the set of methods supported by the resource identified by the request URI, or the entire server if the request URI is <sup><a href="#bookmark1299">54</a></sup></span><span class="font4"></span><span class="font24">. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Allow: GET, HEAD, PUT</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Allow header can be used as a request header to recommend the methods to be supported by the new resource. The server is not required to support these methods <a name="bookmark1303"></a>and should include an Allow header in the matching response, listing the actual supported methods.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">A proxy can’t modify the Allow header field even if it does not understand all the methods specified, because the client might have other paths to talk to the origin server.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1304"></a><span class="font9" style="font-weight:bold;"><a name="bookmark63"></a><a name="bookmark1305"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/rfc2616/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/rfc2616/rfc2616.txt</span></a></p>
<p style="text-indent:19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol,” by R. Fielding, J. Gettys, J. Mogul, H.</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Frystyk, L. Mastinter, P. Leach, and T. Berners-Lee.</span></p>
<p><a href="http://search.ietf.org/rfc/rfc3040.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc3040.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">RFC 3040, “Internet Web Replication and Caching Taxonomy.”</span></p>
<p><span class="font24" style="font-style:italic;">Web Proxy Servers</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Ari Luotonen, Prentice Hall Computer Books.</span></p>
<p><a href="http://search.ietf.org/rfc/rfc3143.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc3143.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">RFC 3143, “Known HTTP Proxy/Caching Problems.”</span></p>
<p><span class="font24" style="font-style:italic;">Web Caching</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Duane Wessels, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p style="text-align:right;padding:0pt 0pt 4pt 0pt;"><a name="bookmark231"></a><span class="font7" style="font-weight:bold;">CHAPTER 7</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark64"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1306"></a>Caching</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1307"></a><span class="font24"><a name="bookmark1308"></a><a name="bookmark1309"></a><a name="bookmark1310"></a><a name="bookmark1311"></a><a name="bookmark1312"></a>Web caches are HTTP devices that automatically keep copies of popular documents. When a web request arrives at a cache, if a local “cached” copy is available, the document is served from the local storage instead of from the origin server. Caches have the following benefits:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Caches </span><span class="font24" style="font-style:italic;">reduce redundant data transfers</span><span class="font24">, saving you money in network charges.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Caches </span><span class="font24" style="font-style:italic;">reduce network bottlenecks</span><span class="font24">. Pages load faster without more bandwidth.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Caches </span><span class="font24" style="font-style:italic;">reduce demand on origin servers</span><span class="font24">. Servers reply faster and avoid overload.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Caches </span><span class="font24" style="font-style:italic;">reduce distance delays</span><span class="font24">, because pages load slower from farther away.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In this chapter, we explain how caches improve performance and reduce cost, how to measure their effectiveness, and where to place caches to maximize impact. We also explain how HTTP keeps cached copies fresh and how caches interact with other caches and servers.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1313"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1314"></a><a name="bookmark1315"></a><a name="bookmark65"></a><a name="bookmark1316"></a>Redundant Data Transfers</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">When multiple clients access a popular origin server page, the server transmits the same document multiple times, once to each client. The same bytes travel across the network over and over again. These redundant data transfers eat up expensive network bandwidth, slow down transfers, and overload web servers. With caches, the cache keeps a copy of the first server response. Subsequent requests can be fulfilled from the cached copy, reducing wasteful, duplicate traffic to and from origin servers.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1317"></a><span class="font9" style="font-weight:bold;"><a name="bookmark66"></a><a name="bookmark1318"></a>Bandwidth Bottlenecks</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Caches also can reduce network bottlenecks. Many networks provide more bandwidth to local network clients than to remote servers (</span><a href="#bookmark1319"><span class="font24">Figure 7-1</span></a><span class="font24">). Clients access servers at the speed of the slowest network on the way. If a client gets a copy from a cache on a fast LAN, caching can boost performance—especially for larger documents.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-256.jpg" alt="" style="width:339pt;height:184pt;">
<p><span class="font1" style="font-weight:bold;">San Francisco branch office</span></p>
<p style="text-align:right;"><span class="font0">Server</span></p></td></tr>
<tr><td>
<p><span class="font0">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Cache</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Slow WAN connection to server (1.4 Mbit/sec T1)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark1320"></a><span class="font1" style="font-style:italic;">Fast connection to cache (100 Mbit/sec ethernet)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Atlanta corporate headquarters</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1319"></a><span class="font23" style="font-style:italic;">Figure 7-1. Limited wide area bandwidth creates a bottleneck that caches can improve</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In</span><a href="#bookmark1319"><span class="font24"> Figure 7-1</span></a><span class="font24">, it might take 30 seconds for a user in the San Francisco branch of Joe’s Hardware, Inc. to download a 5-MB inventory file from the Atlanta headquarters, across the 1.4-Mbps T1 Internet connection. If the document was cached in the San Francisco office, a local user might be able to get the same document in less than a second across the Ethernet connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1321"><span class="font24">Table 7-1 </span></a><span class="font24">shows how bandwidth affects transfer time for a few different network speeds and a few different sizes of documents. Bandwidth causes noticeable delays for larger documents, and the speed difference between different network types is dramatic.<a name="footnote55"></a><sup><a href="#bookmark1322">55</a></sup><sup></sup> A 56-Kbps modem would take 749 seconds (over 12 minutes) to transfer a 5-MB file that could be transported in under a second across a fast Ethernet LAN.</span></p>
<table>
<tr><td>
<p><a name="bookmark1321"></a><span class="font23" style="font-style:italic;">Table 7-1. Bandwidth-imposed transfer time delays, idealized (time in seconds)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Large HTML (15 KB)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">JPEG (40 KB)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Large JPEG (150 KB)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Large file (5 MB)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Dialup modem (56 Kbit/sec)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2.19</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">5.85</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">21.94</span></p></td><td style="vertical-align:top;">
<p><span class="font2">748.98</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">DSL (256 Kbit/sec)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">.48</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">1.28</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">4.80</span></p></td><td style="vertical-align:top;">
<p><span class="font2">163.84</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">T1 (1.4 Mbit/sec)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">.09</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.23</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.85</span></p></td><td style="vertical-align:top;">
<p><span class="font2">29.13</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Slow Ethernet (10 Mbit/sec)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">.01</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.03</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.12</span></p></td><td style="vertical-align:top;">
<p><span class="font2">4.19</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">DS3 (45 Mbit/sec)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">.00</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.01</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">.03</span></p></td><td style="vertical-align:top;">
<p><span class="font2">.93</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Fast Ethernet (100 Mbit/sec)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">.00</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">.00</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">.01</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">.42</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1323"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1324"></a><a name="bookmark67"></a><a name="bookmark1325"></a>Flash Crowds</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark1326"></a><span class="font24">Caching is especially important to break up flash crowds. Flash crowds occur when a sudden event (such as breaking news, a bulk email announcement, or a celebrity event) causes many people to access a web document at nearly the same time </span><a href="#bookmark1327"><span class="font24">(Figure 7-2)</span></a><span class="font24">. The resulting redundant traffic spike can cause a catastrophic collapse of networks and web servers.</span></p>
<table>
<tr><td><img src="book_files/book-257.jpg" alt="" style="width:361pt;height:197pt;"></td></tr>
<tr><td>
<p><a name="bookmark1327"></a><span class="font23" style="font-style:italic;"><a name="bookmark1328"></a>Figure 7-2. Flash crowds can overload web servers</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">When the “Starr Report” detailing Kenneth Starr’s investigation of U.S. President Clinton was released to the Internet on September 11, 1998, the U.S. House of Representatives web servers received over 3 million requests per hour, 50 times the average server load. One news web site, CNN.com, reported an average of over 50,000 requests every second to its servers.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1329"></a><span class="font9" style="font-weight:bold;"><a name="bookmark68"></a><a name="bookmark1330"></a>Distance Delays</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Even if bandwidth isn’t a problem, distance might be. Every network router adds delays to Internet traffic. And even if there are not many routers between client and server, the speed of light alone can cause a significant delay.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">The direct distance from Boston to San Francisco is about 2,700 miles. In the very best case, at the speed of light (186,000 miles/sec), a signal could travel from Boston to San Francisco in about 15 milliseconds and complete a round trip in 30 milliseconds.<a name="footnote56"></a><sup><a href="#bookmark1331">56</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">Say a web page contains 20 small images, all located on a server in San Francisco. If a client in Boston opens four parallel connections to the server, and keeps the connections alive, the speed of light alone contributes almost 1/4 second (240 msec) to the download time (</span><a href="#bookmark1332"><span class="font24">Figure 7-3</span></a><span class="font24">). If the server is in Tokyo (6,700 miles from Boston), the delay grows to 600 msec. Moderately complicated web pages can incur several seconds of speed-of-light delays.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td rowspan="2" style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:middle;">
<p style="text-align:justify;text-indent:14pt;"><span class="font1" style="font-weight:bold;">C</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p><span class="font1" style="font-weight:bold;">onnection 1</span></p></td><td style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:middle;">
<p style="text-align:justify;text-indent:14pt;"><span class="font1" style="font-weight:bold;">C</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p><span class="font1" style="font-weight:bold;">onnection 2</span></p></td><td style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:middle;">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">C</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p><span class="font1" style="font-weight:bold;">onnection 3</span></p></td><td style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">C</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p><span class="font1" style="font-weight:bold;">onnection 4</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font1">30 msec 30 msec 30 msec 30 msec 30 msec 30 msec 30 msec 30 msec</span></p></td><td colspan="3" style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 69pt;"><span class="font1">30 msec 30 msec 30 msec 30 msec 30 msec 30 msec</span></p></td><td colspan="3" style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:10pt 0pt 0pt 69pt;"><span class="font1">30 msec 30 msec 30 msec 30 msec 30 msec 30 msec</span></p></td><td colspan="7" style="vertical-align:top;">
<p style="text-align:justify;text-indent:36pt;padding:12pt 0pt 0pt 0pt;"><span class="font0">Client in Boston</span></p>
<p style="text-align:justify;text-indent:36pt;padding:0pt 0pt 7pt 0pt;"><span class="font0">Server in San Francisco</span></p>
<p style="text-indent:36pt;"><span class="font0">speed of light 30 msec round trip</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark1332"></a><span class="font23" style="font-style:italic;">Figure 7-3. Speed of light can cause significant delays, even with parallel, keep-alive connections</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Placing caches in nearby machine rooms can shrink document travel distance from thousands of miles to tens of yards.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1333"></a><span class="font9" style="font-weight:bold;"><a name="bookmark69"></a><a name="bookmark1334"></a>Hits and Misses</span></h2>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">So caches can help. But a cache doesn’t store a copy of </span><span class="font24" style="font-style:italic;">every</span><span class="font24"> document in the world.<a name="footnote57"></a><sup><a href="#bookmark1335">57</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><a name="bookmark1336"></a><span class="font24">Some requests that arrive at a cache can be served from an available copy. This is called a </span><span class="font24" style="font-style:italic;">cache hit</span><span class="font24"> (</span><a href="#bookmark1337"><span class="font24">Figure 7-4</span></a><span class="font24">a). Other requests arrive at a cache only to be forwarded to the origin server, because no copy is available. This is called a </span><span class="font24" style="font-style:italic;">cache miss </span><a href="#bookmark1337"><span class="font24">(Figure 7-4b</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-258.jpg" alt="" style="width:37pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a ) </span><span class="font0">Cache hit</span></p></td></tr>
<tr><td><img src="book_files/book-259.jpg" alt="" style="width:34pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:right;"><span class="font0">Cache object</span></p></td><td><img src="book_files/book-260.jpg" alt="" style="width:65pt;height:40pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Cache</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b ) </span><span class="font0">Cache miss</span></p></td></tr>
<tr><td><img src="book_files/book-261.jpg" alt="" style="width:33pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-262.jpg" alt="" style="width:147pt;height:46pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font0">object</span></p>
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark1338"></a><span class="font1" style="font-weight:bold;">(c ) </span><span class="font0">Cache revalidate hit</span></p>
<p><span class="font0">Server object</span></p></td></tr>
<tr><td><img src="book_files/book-263.jpg" alt="" style="width:209pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="text-align:right;"><span class="font0">Cache object</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1337"></a><span class="font23" style="font-style:italic;">Figure 7-4. Cache hits, misses, and revalidations</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1339"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1340"></a>Revalidations</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because the origin server content can change, caches have to check every now and then that their copies are still up-to-date with the server. These “freshness checks” are called HTTP </span><span class="font24" style="font-style:italic;">revalidations </span><a href="#bookmark1337"><span class="font24" style="font-style:italic;">(</span><span class="font24">Figure 7-4</span></a><span class="font24">c). To make revalidations efficient, HTTP defines special requests tha<a name="bookmark1341"></a>t can quickly chec<a name="bookmark1342"></a>k if content is still fresh, without fetching the entire object from the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A cache can revalidate a copy any time it wants, and as often as it wants. But because caches often contain millions of documents, and because network bandwidth is scarce, most caches revalidate a copy only when it is requested by a client and when the copy is old enough to warrant a check. We’ll explain the HTTP rules for freshness checking later in the chapter.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a cache needs to revalidate a cached copy, it sends a small revalidation request to the origin server. If the content hasn’t changed, the server responds with a tiny 304 Not Modified response. As soon as the cache learns the copy is still valid, it marks the copy temporarily fresh again and serves the copy to the client </span><a href="#bookmark1343"><span class="font24">(Figure 7-5</span></a><span class="font24">a). This is called a </span><span class="font24" style="font-style:italic;">revalidate hit</span><span class="font24"> or a </span><span class="font24" style="font-style:italic;">slow hit</span><span class="font24">. It’s slower than a pure cache hit, because it </span><span class="font24" style="font-style:italic;">does</span><span class="font24"> need to check with the origin server, but it’s faster than a cache miss, because no object data is retrieved from the server.</span></p>
<p style="padding:0pt 0pt 4pt 73pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Revalidate hit (slow hit)</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-264.jpg" alt="" style="width:41pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:right;"><span class="font0">Cache object</span></p></td><td><img src="book_files/book-265.jpg" alt="" style="width:66pt;height:40pt;"></td><td>
<p><span class="font0">Freshness check</span></p>
<p><span class="font0">Still fresh</span></p></td></tr>
<tr><td colspan="3">
<p><span class="font1" style="font-weight:bold;">Cache</span></p></td></tr>
</table>
</div>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-266.jpg" alt="" style="width:34pt;height:35pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 84pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="padding:0pt 0pt 0pt 73pt;"><a name="bookmark1344"></a><span class="font1" style="font-style:italic;">Server object same as cached copy</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Revalidate miss</span></p></td></tr>
<tr><td><img src="book_files/book-267.jpg" alt="" style="width:54pt;height:35pt;"></td></tr>
<tr><td>
<p style="text-indent:12pt;padding:0pt 0pt 2pt 0pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-style:italic;">Cached copy is out of date</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Server object</span></p></td><td><img src="book_files/book-268.jpg" alt="" style="width:49pt;height:46pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Server object</span></p></td><td><img src="book_files/book-269.jpg" alt="" style="width:61pt;height:37pt;"></td><td>
<p><span class="font0">Freshness check</span></p></td></tr>
<tr><td colspan="3">
<p><span class="font1" style="font-weight:bold;">Cache</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1343"></a><span class="font23" style="font-style:italic;">Figure 7-5. Successful revalidations are faster than cache misses; failed revalidations are nearly identical to misses</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP gives us a few tools to revalidate cached objects, but the most popular is the If-Modified-Since header. When added to a GET request, this header tells the server to send the object only if it has been modified since the time the copy was cached.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here is what happens when a GET If-Modified-Since request arrives at the server in three circumstances—when the server content is not modified, when the server content has been changed, and when the object on the server is deleted:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Revalidate hit</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><a name="bookmark1345"></a><span class="font24">If the server object isn’t modified, the server sends the client a small HTTP 304 Not Modified response. This is depicted in </span><a href="#bookmark1346"><span class="font24">Figure 7-6</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark1347"></a><span class="font1" style="font-style:italic;">Revalidate request with If-Modified-Since</span></p></td></tr>
<tr><td><img src="book_files/book-270.jpg" alt="" style="width:224pt;height:114pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">“Still fresh” response</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-271.jpg" alt="" style="width:47pt;height:37pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Cache </span><span class="font1" style="font-style:italic;">(browser cache or proxy cache)</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1346"></a><span class="font23" style="font-style:italic;">Figure 7-6. HTTP uses If-Modified-Since header for revalidation</span></p>
<p><span class="font24" style="font-style:italic;">Revalidate miss</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font24">If the server object is different from the cached copy, the server sends the client a normal HTTP 200 OK response, with the full content.</span></p>
<p><a name="bookmark1348"></a><span class="font24" style="font-style:italic;">Object deleted</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark1349"></a><span class="font24">If the server object has been deleted, the server sends back a 404 Not Found response, and the cache deletes its copy.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1350"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1351"></a>Hit Rate</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The fraction of requests that are served from cache is called the </span><span class="font24" style="font-style:italic;">cache hit rate</span><span class="font24"> (or cache hit ratio),<a name="footnote58"></a><sup><a href="#bookmark1352">58</a></sup><sup></sup> or sometimes the </span><span class="font24" style="font-style:italic;">document hit rate</span><span class="font24"> (or document hit ratio). The hit rate ranges from 0 to 1 but is often described as a percentage, where 0% means that every request was a miss (had to get the document across the network), and 100% means every request was a hit (had a copy in the cache).<a name="footnote59"></a><sup><a href="#bookmark1353">59</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Cache administrators would like the cache hit rate to approach 100%. The actual hit rate you get depends on how big your cache is, how similar the interests of the cache users <a name="bookmark1354"></a>are, how frequently the cached data is changing or personalized, and how the caches are configured. Hit rate is notoriously difficult to predict, but a hit rate of 40% is decent for a modest web cache today. The nice thing about caches is that even a modest-sized cache may contain enough popular documents to significantly improve performance and reduce traffic. Caches work hard to ensure that useful content stays in the cache.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1355"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1356"></a>Byte Hit Rate</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Document hit rate doesn’t tell the whole story, though, because documents are not all the same size. Some large objects might be accessed less often but contribute more to overall data traffic, because of their size. For this reason, some people prefer the </span><span class="font24" style="font-style:italic;">byte hit rate</span><span class="font24"> metric (especially those folks who are billed for each byte of traffic!).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The byte hit rate represents the fraction of all bytes transferred that were served from cache. This metric captures the degree of traffic savings. A byte hit rate of 100% means every byte came from the cache, and no traffic went out across the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Document hit rate and byte hit rate are both useful gauges of cache performance. Document hit rate describes how many web transactions are kept off the outgoing network. Because transactions have a fixed time component that can often be large (setting up a TCP connection to a server, for example), improving the document hit rate will optimize for overall latency (delay) reduction. Byte hit rate describes how many bytes are kept off the Internet. Improving the byte hit rate will optimize for bandwidth savings.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1357"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1358"></a><a name="bookmark1359"></a>Distinguishing Hits and Misses</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1360"></a><span class="font24">Unfortunately, HTTP provides no way for a client to tell if a response was a cache hit or an origin server access. In both cases, the response code will be 200 OK, indicating that the response has a body. Some commercial proxy caches attach additional information to Via headers to describe what happened in the cache.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One way that a client can usually detect if the response came from a cache is to use the Date header. By comparing the value of the Date header in the response to the current time, a client can often detect a cached response by its older date value. Another way a client can detect a cached response is the Age header, which tells how old the response is (see</span><a href="#bookmark1361"><span class="font24"> “Age” in Appendix C</span></a><span class="font24">).</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1362"></a><span class="font9" style="font-weight:bold;"><a name="bookmark70"></a><a name="bookmark1363"></a>Cache Topologies</span></h2>
<p style="text-align:justify;"><span class="font24">Caches can be dedicated to a single user or shared between thousands of users. Dedicated caches are called </span><span class="font24" style="font-style:italic;">private caches</span><span class="font24">. Private caches are personal caches, containing popular pages for a single user (</span><a href="#bookmark1364"><span class="font24">Figure 7-7</span></a><span class="font24">a). Shared caches are called </span><span class="font24" style="font-style:italic;">public caches</span><span class="font24">. Public caches contain the pages popular in the user community (</span><a href="#bookmark1364"><span class="font24">Figure 7-7b</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a ) </span><span class="font0">Accessing private cache</span></p></td></tr>
<tr><td><img src="book_files/book-272.jpg" alt="" style="width:88pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font0" style="font-weight:bold;"><sup>Client</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-weight:bold;">Private cache</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-273.jpg" alt="" style="width:27pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-274.jpg" alt="" style="width:47pt;height:36pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark1365"></a><span class="font1" style="font-weight:bold;">(b ) </span><span class="font0">Accessing shared public cache</span></p></td></tr>
<tr><td><img src="book_files/book-275.jpg" alt="" style="width:139pt;height:78pt;">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Public cache</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-276.jpg" alt="" style="width:27pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1364"></a><span class="font23" style="font-style:italic;">Figure 7-7. Public and private caches</span></p>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1366"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1367"></a>Private Caches</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Private caches don’t need much horsepower or storage space, so they can be made small and cheap. Web browsers have private caches built right in—most browsers cache popular documents in the disk and memory of your personal computer and allow you to configure the cache size and settings. You also can peek inside the browser caches to see what they contain. For example, with Microsoft Internet</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1368"></a><span class="font24"><a name="bookmark1369"></a><a name="bookmark1370"></a>Explorer, you can get the cache contents from the Tools </span><span class="font14">➝ </span><span class="font24">Internet Options.. . dialog box. MSIE calls the cached documents “Temporary Files” and lists them in a file display, along with the associated URLs and document expiration times. You can view Netscape Navigator’s cache contents through the special URL </span><span class="font24" style="font-style:italic;">about:cache</span><span class="font24">, which gives you a “Disk Cache statistics” page showing the cache contents.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1371"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1372"></a>Public Proxy Caches</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Public caches are special, shared proxy servers called </span><span class="font24" style="font-style:italic;">caching proxy servers</span><span class="font24"> or, more commonly, </span><span class="font24" style="font-style:italic;">proxy caches</span><span class="font24"> (proxies were discussed in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">). Proxy caches serve documents from the local cache or contact the server on the user’s behalf. Because a public cache receives accesses from multiple users, it has more opportunity to eliminate redundant traffic.<a name="footnote60"></a><sup><a href="#bookmark1373">60</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1374"></a><span class="font24"><a name="bookmark1375"></a>In</span><a href="#bookmark1376"><span class="font24"> Figure 7-8</span></a><span class="font24">a, each client redundantly accesses a new, “hot” document (not yet in the private cache). Each private cache fetches the same document, crossing the network multiple times. With a shared, public cache, as in </span><a href="#bookmark1376"><span class="font24">Figure 7-8</span></a><span class="font24">b, the cache needs to fetch the popular object only once, and it uses the shared copy to service all requests, reducing network traffic.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Proxy caches follow the rules for proxies described in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">. You can configure your browser to use a proxy cache by specifying a manual proxy or by configuring a proxy auto-configuration file (see</span><a href="#bookmark1180"><span class="font24"> “Client Proxy Configuration: Manual” in Chapter 6</span></a><span class="font24">). You also can force HTTP requests through caches without configuring your browser by using intercepting proxies (see</span><a href="#bookmark244"><span class="font24"> Chapter 20</span></a><span class="font24">).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1377"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1378"></a>Proxy Cache Hierarchies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In practice, it often makes sense to deploy </span><span class="font24" style="font-style:italic;">hierarchies</span><span class="font24"> of caches, where cache misses in smaller caches are funneled to larger </span><span class="font24" style="font-style:italic;">parent caches</span><span class="font24"> that service the leftover “distilled” traffic. </span><a href="#bookmark1379"><span class="font24">Figure 7-9</span></a><span class="font24"> shows a two-level cache hierarchy.<a name="footnote61"></a><sup><a href="#bookmark1380">61</a></sup><sup></sup> The idea is to use small, inexpensive caches near the clients and progressively larger, more powerful caches up the hierarchy to hold documents shared by many users.<a name="footnote62"></a><sup><a href="#bookmark1381">62</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Hopefully, most users will get cache hits on the nearby, level-1 caches (as shown in </span><a href="#bookmark1379"><span class="font24">Figure 7-9</span></a><span class="font24">a). If not, larger parent caches may be able to handle their requests </span><a href="#bookmark1379"><span class="font24">(Figure 7-9b</span></a><span class="font24">). For deep cache hierarchies it’s possible to go through long chains of</span></p>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Redundant accesses from private caches</span></p></td></tr>
<tr><td><img src="book_files/book-277.jpg" alt="" style="width:174pt;height:112pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Shared caches can reduce traffic</span></p></td></tr>
<tr><td><img src="book_files/book-278.jpg" alt="" style="width:222pt;height:113pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1376"></a><span class="font23" style="font-style:italic;"><a name="bookmark1382"></a><a name="bookmark1383"></a>Figure 7-8. Shared, public caches can decrease network traffic</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">caches, but each intervening proxy does impose some performance penalty that can become noticeable as the proxy chain becomes long.<a name="footnote63"></a><sup><a href="#bookmark1384">63</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1385"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1386"></a>Cache Meshes, Content Routing, and Peering</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Some network architects build complex </span><span class="font24" style="font-style:italic;">cache meshes</span><span class="font24"> instead of simple cache hierarchies. Proxy caches in cache meshes talk to each other in more sophisticated ways, and make dynamic cache communication decisions, deciding which parent caches to talk to, or deciding to bypass caches entirely and direct themselves to the origin server. Such proxy caches can be described as </span><span class="font24" style="font-style:italic;">content routers</span><span class="font24">, because they make routing decisions about how to access, manage, and deliver content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Caches designed for content routing within cache meshes may do all of the following (among other things):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Select between a parent cache or origin server dynamically, based on the URL.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 6pt 0pt;"><span class="font24">• Select a particular parent cache dynamically, based on the URL.</span></p><img src="book_files/book-279.jpg" alt="" style="width:360pt;height:279pt;"></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><a name="bookmark1379"></a><span class="font24"><a name="bookmark1387"></a><a name="bookmark1388"></a>• Search caches in the local area for a cached copy before going to a parent cache.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark1389"></a><span class="font24">• Allow other caches to access portions of their cached content, but do not permit Internet transit through their cache.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1390"></a><span class="font24">These more complex relationships between caches allow different organizations to </span><span class="font24" style="font-style:italic;">peer</span><span class="font24"> with each other, connecting their caches for mutual benefit. Caches that provide selective peering support are called </span><span class="font24" style="font-style:italic;">sibling caches</span><span class="font24"> </span><a href="#bookmark1391"><span class="font24">(Figure 7-10</span></a><span class="font24">). Because HTTP doesn’t provide sibling cache support, people have extended HTTP with protocols, such as the Internet Cache Protocol (ICP) and the HyperText Caching Protocol (HTCP). We’ll talk about these protocols in</span><a href="#bookmark244"><span class="font24"> Chapter 20</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1392"></a><span class="font9" style="font-weight:bold;"><a name="bookmark71"></a><a name="bookmark1393"></a>Cache Processing Steps</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Modern commercial proxy caches are quite complicated. They are built to be very high-performance and to support advanced features of HTTP and other technologies. But, despite some subtle details, the basic workings of a web cache are mostly simple. A basic cache-processing sequence for an HTTP GET message consists of seven steps (illustrated in </span><a href="#bookmark1394"><span class="font24">Figure 7-11</span></a><span class="font24">):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">1. Receiving—Cache reads the arriving request message from the network.</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">2. Parsing—Cache parses the message, extracting the URL and headers.</span></p><img src="book_files/book-280.jpg" alt="" style="width:239pt;height:180pt;"></li></ul>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark1391"></a><span class="font23" style="font-style:italic;">Figure 7-10. Sibling caches</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1395"></a><span class="font24">3. Lookup—Cache checks if a local copy is available and, if not, fetches a copy (and stores it locally).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">4. Freshness check—Cache checks if cached copy is fresh enough and, if not, asks server for any updates.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">5. Response creation—Cache makes a response message with the new headers and cached body.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1396"></a><span class="font24">6. Sending—Cache sends the response back to the client over the network.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">7. Logging—Optionally, cache creates a log file entry describing the transaction.</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1397"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1398"></a>Step 1: Receiving</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In Step 1, the cache detects activity on a network connection and reads the incoming data. High-performance caches read data simultaneously from multiple incoming connections and begin processing the transaction before the entire message has arrived.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1399"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1400"></a>Step 2: Parsing</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Next, the cache parses the request message into pieces and places the header parts in easy-to-manipulate data structures. This makes it easier for the caching software to process the header fields and fiddle with them.<a name="footnote64"></a><sup><a href="#bookmark1401">64</a></sup><sup></sup></span></p>
<table>
<tr><td><img src="book_files/book-281.jpg" alt="" style="width:335pt;height:214pt;"></td></tr>
<tr><td>
<p><a name="bookmark1394"></a><span class="font23" style="font-style:italic;"><a name="bookmark1402"></a>Figure 7-11. Processing a fresh cache hit</span></p></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1403"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1404"></a>Step 3: Lookup</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1405"></a><span class="font24">In Step 3, the cache takes the URL and checks for a local copy. The local copy might be stored in memory, on a local disk, or even in another nearby computer. Professional-grade caches use fast algorithms to determine whether an object is available in the local cache. If the document is not available locally, it can be fetched from the origin server or a parent proxy, or return a failure, based on the situation and configuration.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The cached object contains the server response body and the original server response headers, so the correct server headers can be returned during a cache hit. The cached object also includes some </span><span class="font24" style="font-style:italic;">metadata</span><span class="font24">, used for bookkeeping how long the object has been sitting in the cache, how many times it was used, etc.<a name="footnote65"></a><sup><a href="#bookmark1406">65</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1407"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1408"></a>Step 4: Freshness Check</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP lets caches keep copies of server documents for a period of time. During this time, the document is considered “fresh” and the cache can serve the document without contacting the server. But once the cached copy has sat around for too long, past the document’s </span><span class="font24" style="font-style:italic;">freshness limit</span><span class="font24">, the object is considered “stale,” and the cache needs to <a name="bookmark1409"></a>revalidate with the server to check for any document changes before serving it. Complicating things further are any request headers that a client sends to a cache, which themselves can force the cache to either revalidate or avoid validation altogether.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTP has a set of very complicated rules for freshness checking, made worse by the large number of configuration options cache products support and by the need to interoperate with non-HTTP freshness standards. We’ll devote most of the rest of this chapter to explaining freshness calculations.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1410"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1411"></a>Step 5: Response Creation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because we want the cached response to look like it came from the origin server, the cache uses the cached server response headers as the starting point for the response headers. These base headers are then modified and augmented by the cache.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1412"></a><span class="font24">The cache is responsible for adapting the headers to match the client. For example, the server may return an HTTP/1.0 response (or even an HTTP/0.9 response), while the client expects an HTTP/1.1 response, in which case the cache must translate the headers accordingly. Caches also insert cache freshness information (Cache-Control, Age, and Expires headers) and often include a Via header to note that a proxy cache served the request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1413"></a><span class="font24">Note that the cache should </span><span class="font24" style="font-style:italic;">not</span><span class="font24"> adjust the Date header. The Date header represents the date of the object when it was originally generated at the origin server.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1414"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1415"></a>Step 6: Sending</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Once the response headers are ready, the cache sends the response back to the client. Like all proxy servers, a proxy cache needs to manage the connection with the client. High-performance caches work hard to send the data efficiently, often avoiding copying the document content between the local storage and the network I/O buffers.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1416"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1417"></a>Step 7: Logging</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Most caches keep log files and statistics about cache usage. After each cache transaction is complete, the cache updates statistics counting the number of cache hits and misses (and other relevant metrics) and inserts an entry into a log file showing the request type, URL, and what happened.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The most popular cache log formats are the Squid log format and the Netscape extended common log format, but many cache products allow you to create custom log files. We discuss log file formats in detail in</span><a href="#bookmark245"><span class="font24"> Chapter 21</span></a><span class="font24">.</span></p>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1418"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1419"></a><a name="bookmark1420"></a><a name="bookmark1421"></a>Cache Processing Flowchart</span></h3>
<table>
<tr><td>
<p><a href="#bookmark1422"><span class="font24">Figure 7-12</span></a><a name="bookmark1423"></a><span class="font24"> shows, in simplified form, how a cache processes a request to GET a URL.<sup>*</sup></span></p></td></tr>
<tr><td><img src="book_files/book-282.jpg" alt="" style="width:360pt;height:209pt;"></td></tr>
</table>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1424"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1422"></a><a name="bookmark1425"></a><a name="bookmark72"></a><a name="bookmark1426"></a>Keeping Copies Fresh</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1427"></a><span class="font24"><a name="bookmark1428"></a><a name="bookmark1429"></a>Cached copies might not all be consistent with the documents on the server. After all, documents do change over time. Reports might change monthly. Online newspapers change daily. Financial data may change every few seconds. Caches would be useless if they always served old data. Cached data needs to maintain some consistency with the server data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1430"></a><span class="font24">HTTP includes simple mechanisms to keep cached data sufficiently consistent with servers, without requiring servers to remember which caches have copies of their documents. HTTP calls these simple mechanisms </span><span class="font24" style="font-style:italic;">document expiration</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">server revalidation</span><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1431"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1432"></a>Document Expiration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 25pt 0pt;"><span class="font24">HTTP lets an origin server attach an “expiration date” to each document, using special HTTP Cache-Control and Expires headers (</span><a href="#bookmark1433"><span class="font24">Figure 7-13)</span></a><span class="font24">. Like an expiration date on a quart of milk, these headers dictate how long content should be viewed as fresh.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 7pt;"><span class="font20">* The revalidation and fetching of a resource as outlined in </span><a href="#bookmark1422"><span class="font20">Figure 7-12</span></a><span class="font20"> can be done in one step with a conditional request (see</span><a href="#bookmark1434"><span class="font20"> “Revalidation with Conditional Methods</span></a><span class="font20">”).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.0 200 OK</span></p>
<p><span class="font2">Date: Sat, 29 Jun 2002, 14:30:00 GMT</span></p>
<p><span class="font2">Content-type: text/plain</span></p>
<p><span class="font2">Content-length: 67</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">Expires: Fri, 05 Jul 2002, 05:00:00 GMT</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">Independence Day sale at Joe's Hardware Come shop with us today!</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:center;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> Expires header</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.0 200 OK</span></p>
<p><span class="font2">Date: Sat, 29 Jun 2002, 14:30:00 GMT</span></p>
<p><span class="font2">Content-type: text/plain</span></p>
<p><span class="font2">Content-length: 67</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">Cache-Control: max-age=484200</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">Independence Day sale at Joe's Hardware Come shop with us today!</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:center;padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> Cache-Control: max-age header</span></p></li></ul>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1433"></a><span class="font23" style="font-style:italic;">Figure 7-13. Expires and Cache Control headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Until a cache document expires, the cache can serve the copy as often as it wants, without ever contacting the server—unless, of course, a client request includes headers that prevent serving a cached or unvalidated resource. But, once the cached document expires, the cache must check with the server to ask if the document has changed and, if so, get a fresh copy (with a new expiration date).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1435"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1436"></a>Expiration Dates and Ages</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Servers specify expiration dates using the HTTP/1.0+ Expires or the HTTP/1.1 Cache-Control: max-age response headers, which accompany a response body. The Expires and Cache-Control: max-age headers do basically the same thing, but the newer Cache-Control header is preferred, because it uses a relative time instead of an absolute date. Absolute dates depend on computer clocks being set correctly. </span><a href="#bookmark1437"><span class="font24">Table 7-2</span></a><span class="font24"> lists the expiration response headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1437"></a><span class="font23" style="font-style:italic;">Table 7-2. Expiration response headers</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2" style="font-weight:bold;">Header &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="padding:0pt 0pt 2pt 86pt;"><span class="font2">Cache-Control: max-age The max-age value defines the maximum age of the document—the maximum legal elapsed time (in seconds) from when a document is first generated to when it can no longer be considered fresh enough to serve.</span></p>
<p style="padding:0pt 0pt 2pt 95pt;"><span class="font3">Cache-Control: max-age=484200</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Expires</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 29pt;"><span class="font2">Specifies an absolute expiration date. If the expiration date is in the past, the document is no longer fresh.</span></p>
<p style="text-align:justify;text-indent:38pt;"><span class="font3">Expires: Fri, 05 Jul 2002, 05:00:00 GMT</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s say today is June 29, 2002 at 9:30 am Eastern Standard Time (EST), and Joe’s Hardware store is getting ready for a Fourth of July sale (only five days away). Joe wants to put a special web page on his web server and set it to expire at midnight EST on the night of July 5, 2002. If Joe’s server uses the older-style Expires headers, the server response message (</span><a href="#bookmark1433"><span class="font24">Figure 7-13</span></a><span class="font24">a) might include this header:<a name="footnote66"></a><sup><a href="#bookmark1438">66</a></sup><sup></sup></span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 7pt 0pt;"><span class="font3">Expires: Fri, 05 Jul 2002, 05:00:00 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1439"></a><span class="font24"><a name="bookmark1440"></a><a name="bookmark1441"></a>If Joe’s server uses the newer Cache-Control: max-age headers, the server response message (</span><a href="#bookmark1433"><span class="font24">Figure 7-13</span></a><span class="font24">b) might contain this header:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Cache-Control: max-age=484200</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In case that wasn’t immediately obvious, 484,200 is the number of seconds between the current date, June 29, 2002 at 9:30 am EST, and the sale end date, July 5, 2002 at midnight. There are 134.5 hours (about 5 days) until the sale ends. With 3,600 seconds in each hour, that leaves 484,200 seconds until the sale ends.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1442"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1443"></a>Server Revalidation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Just because a cached document has expired doesn’t mean it is actually different from what’s living on the origin server; it just means that it’s time to check. This is called “server revalidation,” meaning the cache needs to ask the origin server whether the document has changed:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If revalidation shows the content </span><span class="font24" style="font-style:italic;">has changed</span><span class="font24">, the cache gets a new copy of the document, stores it in place of the old data, and sends the document to the client.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If revalidation shows the content </span><span class="font24" style="font-style:italic;">has not changed</span><span class="font24">, the cache only gets new headers, including a new expiration date, and updates the headers in the cache.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This is a nice system. The cache doesn’t have to verify a document’s freshness for every request—it has to revalidate with the server only once the document has expired. This saves server traffic and provides better user response time, without serving stale content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The HTTP protocol requires a correctly behaving cache to return one of the following:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A cached copy that is “fresh enough”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A cached copy that has been revalidated with the server to ensure it’s still fresh</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• An error message, if the origin server to revalidate with is down<a name="footnote67"></a><sup><a href="#bookmark1444">67</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• A cached copy, with an attached warning that it might be incorrect</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1434"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1445"></a><a name="bookmark1446"></a>Revalidation with Conditional Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP’s conditional methods make revalidation efficient. HTTP allows a cache to send a “conditional GET” to the origin server, asking the server to send back an object body only if the document is different from the copy currently in the cache. In this manner, the freshness check and the object fetch are combined into a single conditional GET. Conditional GETs are initiated by adding special conditional headers to GET request messages. The web server returns the object only if the condition is true.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1447"></a><span class="font24"><a name="bookmark1448"></a>HTTP defines five conditional request headers. The two that are most useful for cache revalidation are If-Modified-Since and If-None-Match.<sup>*</sup> All conditional headers begin with the prefix “If-”.</span><a href="#bookmark1449"><span class="font24"> Table 7-3 </span></a><span class="font24">lists the conditional response headers used in cache revalidation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1449"></a><span class="font23" style="font-style:italic;">Table 7-3. Two conditional headers used in cache revalidation</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">Header</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">If-Modified-Since:</span></p>
<p><span class="font3" style="font-style:italic;">&lt;date&gt;</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">If-None-Match: </span><span class="font3" style="font-style:italic;">&lt;tags&gt;</span></p>
</div>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">Description</span></p>
<p style="padding:0pt 0pt 4pt 7pt;"><span class="font2">Perform the requested method if the document has been modified since the specified date. This is used in conjunction with the Last-Modified server response header, to fetch content only if the content has been modified from the cached version.</span></p>
<p style="padding:0pt 0pt 15pt 7pt;"><span class="font2">Instead of matching on last-modified date, the server may provide special tags (see </span><a href="#bookmark1450"><span class="font2">“ETag” in</span></a><span class="font2"> </span><a href="#bookmark1450"><span class="font2">Appendix C</span></a><span class="font2">) on the document that act like serial numbers. The If-None-Match header performs the requested method if the cached tags differ from the tags in the server’s document.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1451"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1452"></a>If-Modified-Since: Date Revalidation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The most common cache revalidation header is If-Modified-Since. If-Modified-Since revalidation requests often are called “IMS” requests. IMS requests instruct a server to perform the request only if the resource has changed since a certain date:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the document was modified since the specified date, the If-Modified-Since condition is true, and the GET succeeds normally. The new document is returned to the cache, along with new headers containing, among other information, a new expiration date.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the document was not modified since the specified date, the condition is false, and a small 304 Not Modified response message is returned to the client, without a document body, for efficiency.<sup>†</sup> Headers are returned in the response; however, only the headers that need updating from the original need to be returned. For example, the Content-Type header does not usually need to be sent, since it usually has not changed. A new expiration date typically is sent.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The If-Modified-Since header works in conjunction with the Last-Modified server response header. The origin server attaches the last modification date to served documents. When a cache wants to revalidate a cached document, it includes an If-Modi-fied-Since header with the date the cached copy was last modified:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 45pt 0pt;"><span class="font3">If-Modified-Since: &lt;cached last-modified date&gt;</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 7pt;"><span class="font20">* Other conditional headers include If-Unmodified-Since (useful for partial document transfers, when you need to ensure the document is unchanged before you fetch another piece of it), If-Range (to support caching of incomplete documents), and If-Match (useful for concurrency control when dealing with web servers).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 7pt;"><span class="font20">† If an old server that doesn’t recognize the If-Modified-Since header gets the conditional request, it interprets it as a normal GET. In this case, the system will still work, but it will be less efficient due to unnecessary transmittal of unchanged document data.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">If the content has changed in the meantime, the last modification date will be different, and the origin server will send back the new document. Otherwise, the server will note that the cache’s last-modified date matches the server document’s current last-modified date, and it will return a 304 Not Modified response.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">For example, as shown in</span><a href="#bookmark1453"><span class="font24"> Figure 7-14</span></a><span class="font24">, if your cache revalidates Joe’s Hardware’s Fourth of July sale announcement on July 3, you will receive back a Not Modified response (</span><a href="#bookmark1453"><span class="font24">Figure 7-14</span></a><span class="font24">a). But if your cache revalidates the document after the sale ends at midnight on July 5, the cache will receive a new document, because the server content has changed (</span><a href="#bookmark1453"><span class="font24">Figure 7-14b</span></a><span class="font24">).</span></p>
<p style="padding:0pt 0pt 3pt 59pt;"><span class="font1" style="font-style:italic;">Conditional request</span></p>
<p style="padding:0pt 0pt 0pt 63pt;"><span class="font3">GET /announce.html HTTP/1.0</span></p>
<p style="padding:0pt 0pt 47pt 63pt;"><span class="font3">If-Modified-Since: Sat, 29 Jun 2002, 14:30:00 GMT</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-283.jpg" alt="" style="width:62pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<p><span class="font3">HTTP/1.0 304 Not Modified</span></p>
<p><span class="font3">Date: Wed, 03 Jul 2002, 19:18:23 GMT</span></p>
<p style="padding:0pt 0pt 3pt 113pt;"><span class="font3">Expires: Fri, 05 Jul 2002, 14:30:00 GMT</span></p>
<p style="padding:0pt 0pt 0pt 254pt;"><span class="font1" style="font-style:italic;">Response</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> If-Modified-Since successful revalidation</span></p></li></ul>
<p style="padding:0pt 0pt 3pt 59pt;"><span class="font1" style="font-style:italic;">Conditional request</span></p>
<p style="padding:0pt 0pt 0pt 63pt;"><span class="font3">GET /announce.html HTTP/1.0</span></p>
<p style="padding:0pt 0pt 47pt 63pt;"><span class="font3">If-Modified-Since: Sat, 29 Jun 2002, 14:30:00 GMT</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-284.jpg" alt="" style="width:62pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<p><span class="font3">HTTP/1.0 200 OK</span></p>
<p><span class="font3">Date: Fri, 05 Jul 2002, 17:54:40 GMT</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-285.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-286.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 0pt 113pt;"><span class="font3">Content-type: text/plain</span></p>
<p style="padding:0pt 0pt 0pt 113pt;"><span class="font3">Content-length: 124</span></p>
<p style="padding:0pt 0pt 6pt 113pt;"><span class="font3">Expires: Mon, 09 Sep 2002, 05:00:00 GMT</span></p>
<p style="padding:0pt 0pt 3pt 113pt;"><span class="font3">All exterior house paint on sale through Labor Day. Just another reason for you to shop this summer at Joe's Hardware!</span></p>
<p style="padding:0pt 0pt 0pt 254pt;"><span class="font1" style="font-style:italic;">Response</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> If-Modified-Since failed revalidation</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark1453"></a><span class="font23" style="font-style:italic;">Figure 7-14. If-Modified-Since revalidations return 304 if unchanged or 200 with new body if changed</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Note that some web servers don’t implement If-Modified-Since as a true date comparison. Instead, they do a string match between the IMS date and the last-modified date. As such, the semantics behave as “if not last modified on this exact date” instead of “if modified since this date.” This alternative semantic works fine for <a name="bookmark1454"></a>cache expiration, when you are using the last-modified date as a kind of serial number, but it prevents clients from using the If-Modified-Since header for true timebased purposes.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1455"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1456"></a>If-None-Match: Entity Tag Revalidation</span></h3>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">There are some situations when the last-modified date revalidation isn’t adequate:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1457"></a><span class="font24">• Some documents may be rewritten periodically (e.g., from a background process) but actually often contain the same data. The modification dates will change, even though the content hasn’t.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Some documents may have changed, but only in ways that aren’t important enough to warrant caches worldwide to reload the data (e.g., spelling or comment changes).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Some servers cannot accurately determine the last modification dates of their pages.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• For servers that serve documents that change in sub-second intervals (e.g. realtime monitors), the one-second granularity of modification dates might not be adequate.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To get around these problems, HTTP allows you to compare document “version identifiers” called </span><span class="font24" style="font-style:italic;">entity tags</span><span class="font24"> (ETags). Entity tags are arbitrary labels (quoted strings) attached to the document. They might contain a serial number or version name for the document, or a checksum or other fingerprint of the document content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When the publisher makes a document change, he can change the document’s entity tag to represent this new version. Caches can then use the If-None-Match conditional header to GET a new copy of the document if the entity tags have changed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><span class="font24">In</span><a href="#bookmark1458"><span class="font24"> Figure 7-15</span></a><span class="font24">, the cache has a document with entity tag “v2.6”. It revalidates with the origin server asking for a new object only if the tag “v2.6” no longer matches. In </span><a href="#bookmark1458"><span class="font24">Figure 7-15</span></a><span class="font24">, the tag still matches, so a 304 Not Modified response is returned.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 58pt;"><span class="font1" style="font-style:italic;">Conditional request</span></p>
<p style="text-align:justify;padding:0pt 190pt 47pt 62pt;"><span class="font3">GET /announce.html HTTP/1.0 If-None-Match: &quot;v2.6&quot;</span></p>
<div style="border-right:solid;float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-287.jpg" alt="" style="width:19pt;height:23pt;"></td></tr>
<tr><td>
<p style="text-align:center;padding:0pt 0pt 4pt 0pt;"><span class="font0">ETag: “v2.6”</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Cache</span></p></td></tr>
</table>
</div>
<div style="border-left:solid;float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-288.jpg" alt="" style="width:18pt;height:23pt;"></td></tr>
<tr><td>
<p><span class="font0">ETag: “v2.6”</span></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Server</span></p>
</div>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.0 304 Not Modified</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Date: Wed, 03 Jul 2002, 19:18:23 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 112pt;"><span class="font3">ETag: &quot;v2.6&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 112pt;"><span class="font3">Expires: Fri, 05 Jul 2002, 05:00:00 GMT</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font1" style="font-style:italic;">Response</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1458"></a><span class="font23" style="font-style:italic;">Figure 7-15. If-None-Match revalidates because entity tag still matches <a name="bookmark1459"></a></span><span class="font24"><a name="bookmark1460"></a>If the entity tag on the serv<a name="bookmark1461"></a>er had changed (perhaps to “v3.0”), the server would return the new content in a 200 OK response, along with the content and new ETag.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Several entity tags can be included in an If-None-Match header, to tell the server that the cache already has copies of objects with those entity tags:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">If-None-Match: &quot;v2.6&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">If-None-Match: &quot;v2.4&quot;,&quot;v2.5&quot;,&quot;v2.6&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">If-None-Match: &quot;foobar&quot;,&quot;A34FAC0095&quot;,&quot;Profiles in Courage&quot;</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1462"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1463"></a>Weak and Strong Validators</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Caches use entity tags to determine whether the cached version is up-to-date with respect to the server (much like they use last-modified dates). In this way, entity tags and last-modified dates both are </span><span class="font24" style="font-style:italic;">cache validators</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Servers may sometimes want to allow cosmetic or insignificant changes to documents without invalidating all cached copies. HTTP/1.1 supports “weak validators,” which allow the server to claim “good enough” equivalence even if the contents have changed slightly.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Strong validators change any time the content changes. Weak validators allow some content change but generally change when the significant meaning of the content changes. Some operations cannot be performed using weak validators (such as conditional partial-range fetches), so servers identify validators that are weak with a “W/” prefix:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">ETag: W/&quot;v2.6&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">If-None-Match: W/&quot;v2.6&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1464"></a><span class="font24"><a name="bookmark1465"></a>A strong entity tag must change whenever the associated entity value changes in any way. A weak entity tag should change whenever the associated entity changes in a semantically significant way.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Note that an origin server must avoid reusing a specific strong entity tag value for two different entities, or reusing a specific weak entity tag value for two semantically different entities. Cache entries might persist for arbitrarily long periods, regardless of expiration times, so it might be inappropriate to expect that a cache will never again attempt to validate an entry using a validator that it obtained at some point in the past.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1466"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1467"></a>When to Use Entity Tags and Last-Modified Dates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP/1.1 clients must use an entity tag validator if a server sends back an entity tag. If the server sends back only a Last-Modified value, the client can use If-Modified-Since validation. If both an entity tag and a last-modified date are available, the client should use both revalidation schemes, allowing both HTTP/1.0 and HTTP/1.1 caches to respond appropriately.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1468"></a><span class="font24"><a name="bookmark1469"></a>HTTP/1.1 origin servers should send an entity tag validator unless it is not feasible to generate one, and it may be a weak entity tag instead of a strong entity tag, if there are benefits to weak validators. Also, it’s preferred to also send a last-modified value.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If an HTTP/1.1 cache or server receives a request with both If-Modified-Since and entity tag conditional headers, it must not return a 304 Not Modified response unless doing so is consistent with all of the conditional header fields in the request.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1470"></a><span class="font9" style="font-weight:bold;"><a name="bookmark73"></a><a name="bookmark1471"></a>Controlling Cachability</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP defines several ways for a server to specify how long a document can be cached before it expires. In decreasing order of priority, the server can:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Attach a Cache-Control: no-store header to the response.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Attach a Cache-Control: no-cache header to the response.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Attach a Cache-Control: must-revalidate header to the response.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Attach a Cache-Control: max-age header to the response.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Attach an Expires date header to the response.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Attach no expiration information, letting the cache determine its own heuristic expiration date.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This section describes the cache controlling headers. The next section,</span><a href="#bookmark1472"><span class="font24"> “Setting Cache</span></a><span class="font24"> </span><a href="#bookmark1472"><span class="font24">Controls</span></a><span class="font24">,” describes how to assign different cache information to different content.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1473"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1474"></a>No-Cache and No-Store Response Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP/1.1 offers several ways to limit the caching of objects, or the serving of cached objects, to maintain freshness. The no-store and no-cache headers prevent caches from serving unverified cached objects:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Cache-Control: no-store</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Cache-Control: no-cache</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Pragma: no-cache</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A response that is marked &quot;no-store&quot; forbids a cache from making a copy of the response. A cache would typically forward a no-store response to the client, and then delete the object, as would a non-caching proxy server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A response that is marked &quot;no-cache&quot; can actually be stored in the local cache storage. It just cannot be served from the cache to the client without first revalidating the freshness with the origin server. A better name for this header might be &quot;do-not-serve-from-cache-without-revalidation.&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Pragma: no-cache header is included in HTTP/1.1 for backward compatibility with HTTP/1.0+. HTTP 1.1 applications should use Cache-Control: no-cache, except when dealing with HTTP 1.0 applications, which understand only Pragma: no-cache.<sup>*</sup></span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1475"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1476"></a><a name="bookmark1477"></a><a name="bookmark1478"></a>Max-Age Response Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1479"></a><span class="font24"><a name="bookmark1480"></a>The Cache-Control: max-age header indicates the number of seconds since it came from the server for which a document can be considered fresh. There is also an s-maxage header (note the absence of a hyphen in “maxage”) that acts like max-age but applies only to shared (public) caches:</span></p>
<p style="text-indent:19pt;"><span class="font3">Cache-Control: max-age=3600</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Cache-Control: s-maxage=3600</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Servers can request that caches either not cache a document or refresh on every access by setting the maximum aging to zero:</span></p>
<p style="text-indent:19pt;"><span class="font3">Cache-Control: max-age=0</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">Cache-Control: s-maxage=0</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1481"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1482"></a>Expires Response Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The deprecated Expires header specifies an actual expiration date instead ofatimein seconds. The HTTP designers later decided that, because many servers have unsynchronized or incorrect clocks, it would be better to represent expiration in elapsed seconds, rather than absolute time. An analogous freshness lifetime can be calculated by computing the number of seconds difference between the expires value and the date value:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Expires: Fri, 05 Jul 2002, 05:00:00 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some servers also send back an Expires: 0 response header to try to make documents always expire, but this syntax is illegal and can cause problems with some software. You should try to support this construct as input, but shouldn’t generate it.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1483"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1484"></a>Must-Revalidate Response Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Caches may be configured to serve stale (expired) objects, in order to improve performance. If an origin server wishes caches to strictly adhere to expiration information, it can attach a Cache-Control:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font5">Cache-Control: must-revalidate</span></p>
<p style="text-align:justify;padding:0pt 0pt 45pt 0pt;"><span class="font24">The Cache-Control: must-revalidate response header tells caches they cannot serve a stale copy of this object without first revalidating with the origin server. Caches are still free to serve fresh copies. If the origin server is unavailable when a cache attempts a must-revalidate freshness check, the cache must return a 504 Gateway Timeout error.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 7pt;"><span class="font20">* Pragma no-cache is technically valid only for HTTP requests, yet it is widely used as an extension header for both HTTP erquests and responses.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1485"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1486"></a><a name="bookmark1487"></a>Heuristic Expiration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1488"></a><span class="font24"><a name="bookmark1489"></a>If the response doesn’t contain either a Cache-Control: max-age header or an Expires header, the cache may compute a heuristic maximum age. Any algorithm may be used, but if the resulting maximum age is greater than 24 hours, a Heuristic Expiration Warning (Warning 13) header should be added to the response headers. As far as we know, few browsers make this warning information available to users.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">One popular heuristic expiration algorithm, the </span><span class="font24" style="font-style:italic;">LM-Factor</span><span class="font24"> algorithm, can be used if the document contains a last-modified date. The LM-Factor algorithm uses the last-modified date as an estimate of how volatile a document is. Here’s the logic:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If a cached document was last changed in the distant past, it may be a stable document and less likely to change suddenly, so it is safer to keep it in the cache longer.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the cached document was modified just recently, it probably changes frequently, so we should cache it only a short while before revalidating with the server.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The actual LM-Factor algorithm computes the time between when the cache talked to the server and when the server said the document was last modified, takes some fraction of this intervening time, and uses this fraction as the freshness duration in the cache. Here is some Perl pseudocode for the LM-factor algorithm:</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font3">$time_since_modify = max(0, $server_Date - $server_Last_Modified); $server_freshness_limit = int($time_since_modify * $lm_factor);</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1490"><span class="font24">Figure 7-16</span></a><span class="font24"> depicts the LM-factor freshness period graphically. The cross-hatched line indicates the freshness period, using an LM-factor of 0.2.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font0">20% of time between fetch and last modification</span></p>
<p style="padding:0pt 0pt 0pt 65pt;"><span class="font1" style="font-style:italic;">(LM-factor= 0.2)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font0">Cached copy is fresh for time period</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font0">New expiration time</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font0">Last modified</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 143pt;"><span class="font1" style="font-style:italic;">Time</span></p>
<p style="padding:0pt 0pt 0pt 59pt;"><span class="font0">When cache talked</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 71pt;"><span class="font0">to server</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark1490"></a><span class="font23" style="font-style:italic;">Figure 7-16. Computing a freshness period using the LM-Factor algorithm</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Typically, people place upper bounds on heuristic freshness periods so they can’t grow excessively large. A week is typical, though more conservative sites use a day.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Finally, if you don’t have a last-modified date either, the cache doesn’t have much information to go on. Caches typically assign a default freshness period (an hour or a day is typical) for documents without any freshness clues. More conservative caches sometimes choose freshness lifetimes of 0 for these heuristic documents, forcing the cache to validate that the data is still fresh before each time it is served to a client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark1491"></a><span class="font24">One last note about heuristic freshness calculations—they are more common than you might think. Many origin servers still don’t generate Expires and max-age headers. Pick your cache’s expiration defaults carefully!</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1492"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1493"></a>Client Freshness Constraints</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web browsers have a Refresh or Reload button to forcibly refresh content, which might be stale in the browser or proxy caches. The Refresh button issues a GET request with additional Cache-control request headers that force a revalidation or unconditional fetch from the server. The precise Refresh behavior depends on the particular browser, document, and intervening cache configurations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">Clients use Cache-Control request headers to tighten or loosen expiration constraints. Clients can use Cache-control headers to make the expiration more strict, for applications that need the very freshest documents (such as the manual Refresh button). On the other hand, clients might also want to relax the freshness requirements as a compromise to improve performance, reliability, or expenses. </span><a href="#bookmark1494"><span class="font24">Table 7-4</span></a><span class="font24"> summarizes the Cache-Control request directives.</span></p>
<table>
<tr><td>
<p><a name="bookmark1494"></a><span class="font23" style="font-style:italic;">Table 7-4. Cache-Control request directives</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2" style="font-weight:bold;">Purpose</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: max-stale</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">The cache is free to serve a stale document. If the </span><span class="font3" style="font-style:italic;">&lt;s&gt;</span><span class="font2"> parameter is specified, the docu-</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: max-stale =</span></p>
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">&lt;s&gt;</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font2">ment must not be stale by more than this amount of time. This relaxes the caching rules.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: min-fresh =</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">The document must still be fresh for at least </span><span class="font3" style="font-style:italic;">&lt;s&gt;</span><span class="font2"> seconds in the future. This makes the</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">&lt;s&gt;</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font2">caching rules more strict.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: max-age = </span><span class="font3" style="font-style:italic;">&lt;s&gt;</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">The cache cannot return a document that has been cached for longer than </span><span class="font3" style="font-style:italic;">&lt;s&gt;</span><span class="font2"> seconds. This directive makes the caching rules more strict, unless the max-stale directive also is set, in which case the age can exceed its expiration time.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Cache-Control: no-cache Pragma: no-cache</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font2">This client won’t accept a cached resource unless it has been revalidated.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: no-store</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">The cache should delete every trace of the document from storage as soon as possible, because it might contain sensitive information.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cache-Control: only-if-cached</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">The client wants a copy only if it is in the cache.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1495"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1496"></a>Cautions</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Document expiration isn’t a perfect system. If a publisher accidentally assigns an expiration date too far in the future, any document changes she needs to make won’t necessarily show up in all caches until the document has expired.<a name="footnote68"></a><sup><a href="#bookmark1497">68</a></sup><sup></sup> For this reason, <a name="bookmark1498"></a><a name="bookmark1499"></a>many publishers don’t use distant expiration dates. Also, many publishers don’t even use expiration dates, making it tough for caches to know how long the document will be fresh.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1472"></a><span class="font9" style="font-weight:bold;"><a name="bookmark74"></a><a name="bookmark1500"></a>Setting Cache Controls</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1501"></a><span class="font24">Different web servers provide different mechanisms for setting HTTP cache-control and expiration headers. In this section, we’ll talk briefly about how the popular Apache web server supports cache controls. Refer to your web server documentation for specific details.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1502"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1503"></a>Controlling HTTP Headers with Apache</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1504"></a><span class="font24">The Apache web server provides several mechanisms for setting HTTP cachecontrolling headers. Many of these mechanisms are not enabled by default—you have to enable them (in some cases first obtaining Apache extension modules). Here is a brief description of some of the Apache features:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">mod_headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The mod_headers module lets you set individual headers. Once this module is loaded, you can augment the Apache configuration files with directives to set individual HTTP headers. You also can use these settings in combination with Apache’s regular expressions and filters to associate headers with individual content. Here is an example of a configuration that could mark all HTML files in a directory as uncachable:</span></p>
<p style="text-indent:37pt;"><span class="font3">&lt;Files *.html&gt;</span></p>
<p style="text-align:justify;text-indent:45pt;"><span class="font3">Header set Cache-control no-cache</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">&lt;/Files&gt;</span></p>
<p><a name="bookmark1505"></a><span class="font24" style="font-style:italic;">mod_expires</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The mod_expires module provides program logic to automatically generate Expires headers with the correct expiration dates. This module allows you to set expirat<a name="bookmark1506"></a>ion dates for some time period after a document was last accessed or after its last-modified date. The module also lets you assign different expiration dates to different file types and use convenient verbose descriptions, like “access plus 1 month,” to describe cachability. Here are a few examples:</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font3">ExpiresDefault A3600</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font3">ExpiresDefault M86400</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font3">ExpiresDefault &quot;access plus 1 week&quot;</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font3">ExpiresByType text/html &quot;modification plus 2 days 6 hours 12 minutes&quot; </span><span class="font24" style="font-style:italic;">mod_cern_meta</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The mod_cern_meta module allows you to associate a file of HTTP headers with particular objects. When you enable this module, you create a set of “metafiles,” one for each document you want to control, and add the desired headers to each metafile.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1507"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1508"></a><a name="bookmark1509"></a>Controlling HTML Caching Through HTTP-EQUIV</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP server response headers are used to carry back document expiration and cache-control information. Web servers interact with configuration files to assign the correct cache-control headers to served documents.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To make it easier for authors to assign HTTP header information to served HTML documents without interacting with web server configuration files, HTML 2.0 defined the &lt;META HTTP-EQUIV&gt; tag. This optional tag sits at the top of an HTML document and defines HTTP headers that should be associated with the document. Here is an example of a &lt;META HTTP-EQUIV&gt; tag set to mark the HTML document uncachable:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;HTML&gt;</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font3">&lt;HEAD&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">&lt;TITLE&gt;My Document&lt;/TITLE&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">&lt;META HTTP-EQUIV=&quot;Cache-control&quot; CONTENT=&quot;no-cache&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font3">&lt;/HEAD&gt;</span></p>
<p style="text-align:justify;text-indent:39pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">...</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This HTTP-EQUIV tag was originally intended to be used by web servers. Web servers were supposed to parse HTML for &lt;META HTTP-EQUIV&gt; tags and insert the prescribed headers into the HTTP response, as documented in HTML RFC 1866:</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font23">An HTTP server may use this information to process the document. In particular, it may include a header field in the responses to requests for this document: the header name is taken from the HTTP-EQUIV attribute value, and the header value is taken from the value of the CONTENT attribute.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unfortunately, few web servers and proxies support this optional feature because of the extra server load, the values being static, and the fact that it supports only HTML and not the many other file types.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1510"></a><span class="font24">However, some browsers do parse and adhere to HTTP-EQUIV tags in the HTML content, treating the embedded headers like real HTTP headers (</span><a href="#bookmark1511"><span class="font24">Figure 7-17</span></a><span class="font24">). This is unfortunate, because HTML browsers that do support HTTP-EQUIV may apply different cache-control rules than intervening proxy caches. This causes confusing cache expiration behavior.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In general, &lt;META HTTP-EQUIV&gt; tags are a poor way of controlling document cachability. The only sure-fire way to communicate cache-control requests for documents is through HTTP headers sent by a properly configured server.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1512"></a><span class="font9" style="font-weight:bold;"><a name="bookmark75"></a><a name="bookmark1513"></a>Detailed Algorithms</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP specification provides a detailed, but slightly obscure and often confusing, algorithm for computing document aging and cache freshness. In this section, we’ll discuss the HTTP freshness computation algorithms in detail (the “Fresh enough?” diamond in </span><a href="#bookmark1422"><span class="font24">Figure 7-12</span></a><span class="font24">) and explain the motivation behind them.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">HTML file</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font0">Some HTTP servers can be configured to parse HTML files for special &lt;META HTTP-EQUIV&gt; tags. These metadata tags (in the HTML document) describe HTTP headers that the author would like to be received by the client.</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font0">Unfortunately, most web servers don’t process HTTP-EQUIV tags, and even fewer proxies do. This causes client caches to receive cache-control commands that proxy caches do not always see.</span></p>
<p style="text-indent:29pt;padding:0pt 0pt 3pt 0pt;"><span class="font1" style="font-style:italic;">HTTP request</span></p>
<p style="text-indent:33pt;padding:0pt 0pt 6pt 0pt;"><span class="font3">GET /xyz.html HTTP/1.0</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">&lt;HTML&gt;</span></p>
<p><span class="font2">&lt;HEAD&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font2">&lt;META HTTP-EQUIV=</span><span class="font3">&quot;</span><span class="font2">Cache-control</span><span class="font3">&quot; </span><span class="font2">CONTENT=</span><span class="font3">&quot;</span><span class="font2">max-age=3600</span><span class="font3">&quot;</span><span class="font2">&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font2">&lt;META HTTP-EQUIV=&quot;Content-type&quot; CONTENT=</span><span class="font3">&quot;</span><span class="font2">text/html; charset=utf-8</span><span class="font3">&quot;</span><span class="font2">&gt;</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">&lt;/HEAD&gt;</span></p>
<p><span class="font2">&lt;BODY&gt;</span></p>
<p><span class="font2">Welcome to XYZ Industries, a &lt;B&gt;leader&lt;/B&gt; in mechanical drilling machines for 30 years. Our new line of 100% automated manufacturing tools sets the standard for CAM, at a suprisingly low price.</span></p>
<p><span class="font2">&lt;/BODY&gt;</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-289.jpg" alt="" style="width:73pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-290.jpg" alt="" style="width:40pt;height:16pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-291.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.0 200 OK</span></p>
<p><span class="font3">Date: Fri, 07 Apr 2002, 19:21:13 GMT</span></p>
<p><span class="font3">Content-length: 124</span></p>
<p><span class="font3">Cache-control: max-age=3600</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Content-type: text/html; charset=utf-8</span></p>
<p><span class="font3">&lt;HTML&gt;</span></p>
<p><span class="font3">&lt;HEAD&gt;</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font3">&lt;META HTTP-EQUIV=&quot;Cache-control&quot; CONTENT=&quot;max-age=3600&quot;</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font3">&lt;META HTTP-EQUIV=&quot;Content-type&quot; CONTENT=&quot;text/html; charset=utf-8&quot;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">&lt;/HEAD&gt;</span></p>
<p><span class="font3">&lt;BODY&gt;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Welcome to XYZ Industries, a &lt;B&gt;leader&lt;/B&gt; in mechanical drilling machines for...</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">HTTP response</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-292.jpg" alt="" style="width:20pt;height:23pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Some servers will insert HTTP-<a name="bookmark1514"></a>EQUIV specified headers into the response header for proxies to see. Others servers will not.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark1511"></a><span class="font23" style="font-style:italic;">Figure 7-17. HTTP-EQUIV tags cause problems, because most software ignores them</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font24">This section will be most useful to readers working with cache internals. To help illustrate the wording in the HTTP specification, we will make use of Perl pseudocode. If you aren’t interested in the gory details of cache expiration formulas, feel free to skip this section.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1515"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1516"></a>Age and Freshness Lifetime</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To tell whether a cached document is fresh enough to serve, a cache needs to compute only two values: the cached copy’s </span><span class="font24" style="font-style:italic;">age</span><span class="font24"> and the cached copy’s </span><span class="font24" style="font-style:italic;">freshness lifetime</span><span class="font24">. If the age of a cached copy is less than the freshness lifetime, the copy is fresh enough to serve. In Perl:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">$is_fresh_enough = ($age &lt;&nbsp;$freshness_lifetime);</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1517"></a><span class="font24">The age of the document is the total time the document has “aged” since it was sent from the server (or was last revalidated by the server).<a name="footnote69"></a><sup><a href="#bookmark1518">69</a></sup><sup></sup> Because a cache might not know if a document response is coming from an upstream cache or a server, it can’t assume that the document is brand new. It must determine the document’s age, either from an explicit Age header (preferred) or by processing the server-generated Date header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1519"></a><span class="font24">The freshness lifetime of a document tells how old a cached copy can get before it is no longer fresh enough to serve to clients. The freshness lifetime takes into account the expiration date of the document and any freshness overrides the client might request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1520"></a><span class="font24">Some clients may be willing to accept slightly stale documents (using the Cache-Control: max-stale header). Other clients may not accept documents that will become stale in the near future (using the Cache-Control: min-fresh header). The cache combines the server expiration information with the client freshness requirements to determine the maximum freshness lifetime.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1521"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1522"></a>Age Computation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The age of the response is the total time since the response was issued from the server (or revalidated from the server). The age includes the time the response has floated around in the routers and gateways of the Internet, the time stored in intermediate caches, and the time the response has been resident in your cache. </span><a href="#bookmark1523"><span class="font24">Example 7-1 </span></a><span class="font24">provides pseudocode for the age calculation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1523"></a><span class="font23" style="font-style:italic;">Example 7-1. HTTP/1.1 age-calculation algorithm calculates the overall age of a cached document</span></p>
<p style="text-align:justify;"><span class="font3">$apparent_age = max(0, $time_got_response - $Date_header_value); $corrected_apparent_age = max($apparent_age, $Age_header_value); $response_delay_estimate = ($time_got_response - $time_issued_request);</span></p>
<p style="text-align:justify;"><span class="font3">$age_when_document_arrived_at_our_cache =</span></p>
<p style="text-indent:17pt;"><span class="font3">$corrected_apparent_age + $response_delay_estimate;</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">$how_long_copy_has_been_in_our_cache = $current_time - $time_got_response;</span></p>
<p><span class="font3">$age = $age_when_document_arrived_at_our_cache +</span></p>
<p style="text-indent:29pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">$how_long_copy_has_been_in_our_cache;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The particulars of HTTP age calculation are a bit tricky, but the basic concept is simple. Caches can tell how old the response was when it arrived at the cache by examining the Date or Age headers. Caches also can note how long the document has been sitting in the local cache. Summed together, these values are the entire age of the response. HTTP throws in some magic to attempt to compensate for clock skew and network delays, but the basic computation is simple enough:</span></p>
<p style="padding:0pt 0pt 5pt 47pt;"><span class="font3">$age = $age_when_document_arrived_at_our_cache + $how_long_copy_has_been_in_our_cache;</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">A cache can pretty easily determine how long a cached copy has been cached locally (a matter of simple bookkeeping), but it is harder to determine the age of a response when it arrives at the cache, because not all servers have synchronized clocks and because we don’t know where the response has been. The complete age-calculation algorithm tries to remedy this.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1524"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1525"></a>Apparent age is based on the Date header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If all computers shared the same, exactly correct clock, the age ofa cached document would simply be the “apparent age” of the document—the current time minus the time when the server sent the document. The server send time is simply the value of the Date header. The simplest initial age calculation would just use the apparent age:</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font3">$apparent_age = $time_got_response - $Date_header_value; $age_when_document_arrived_at_our_cache = $apparent_age;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unfortunately, not all clocks are well synchronized. The client and server clocks may differ by many minutes, or even by hours or days when clocks are set improperly.<a name="footnote70"></a><sup><a href="#bookmark1526">70</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web applications, especially caching proxies, have to be prepared to interact with servers with wildly differing clock values. The problem is called </span><span class="font24" style="font-style:italic;">clock skew</span><span class="font24">—the difference between two computers’ clock settings. Because of clock skew, the apparent age sometimes is inaccurate and occasionally is negative.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the age is ever negative, we just set it to zero. We also could sanity check that the apparent age isn’t ridiculously large, but large apparent ages might actually be correct. We might be talking to a parent cache that has cached the document for a long time (the cache also stores the original Date header):</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font3">$apparent_age = max(0, $time_got_response - $Date_header_value); $age_when_document_arrived_at_our_cache = $apparent_age;</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Be aware that the Date header describes the original origin server date. Proxies and caches must </span><span class="font24" style="font-style:italic;">not</span><span class="font24"> change this date!</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1527"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1528"></a>Hop-by-hop age calculations</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">So, we can eliminate negative ages caused by clock skew, but we can’t do much about overall loss of accuracy due to clock skew. HTTP/1.1 attempts to work around the lack of universal synchronized clocks by asking each device to accumulate relative aging into an Age header, as a document passes through proxies and caches. This way, no cross-server, end-to-end clock comparisons are needed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Age header value increases as the document passes through proxies. HTTP/1.1-aware applications should augment the Age header value by the time the document sat in each application and in network transit. Each intermediate application can easily compute the document’s resident time by using its local clock.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">However, any non-HTTP/1.1 device in the response chain will not recognize the Age header and will either proxy the header unchanged or remove it. So, until HTTP/1.1 is universally adopted, the Age header will be an underestimate of the relative age.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The relative age values are used in addition to the Date-based age calculation, and the most conservative of the two age estimates is chosen, because either the crossserver Date value or the Age-computed value may be an underestimate (the most conservative is the oldest age). This way, HTTP tolerates errors in Age headers as well, while erring on the side of fresher content:</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 19pt;"><span class="font3">$apparent_age = max(0, $time_got_response - $Date_header_value); $corrected_apparent_age = max($apparent_age, $Age_header_value); $age_when_document_arrived_at_our_cache = $corrected_apparent_age;</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1529"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1530"></a>Compensating for network delays</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Transactions can be slow. This is the major motivation for caching. But for very slow networks, or overloaded servers, the relative age calculation may significantly underestimate the age of documents if the documents spend a long time stuck in network or server traffic jams.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Date header indicates when the document left the origin server,<a name="footnote71"></a><sup><a href="#bookmark1531">71</a></sup><sup></sup> but it doesn’t say how long the document spent in transit on the way to the cache. If the document came through a long chain of proxies and parent caches, the network delay might be significant.<a name="footnote72"></a><sup><a href="#bookmark1532">72</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There is no easy way to measure one-way network delay from server to cache, but it is easier to measure the round-trip delay. A cache knows when it requested the document and when it arrived. HTTP/1.1 conservatively corrects for these network delays by adding the entire round-trip delay. This cache-to-server-to-cache delay is an overestimate of the server-to-cache delay, but it is conservative. If it is in error, it will only make the documents appear older than they really are and cause unnecessary revalidations. Here’s how the calculation is made:</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font3">$apparent_age = max(0, $time_got_response - $Date_header_value); $corrected_apparent_age = max($apparent_age, $Age_header_value); $response_delay_estimate = ($time_got_response - $time_issued_request); $age_when_document_arrived_at_our_cache =</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">$corrected_apparent_age + $response_delay_estimate;</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1533"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1534"></a>Complete Age-Calculation Algorithm</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The last section showed how to compute the age of an HTTP-carried document when it arrives at a cache. Once this response is stored in the cache, it ages further. When a request arrives for the document in the cache, we need to know how long the document has been resident in the cache, so we can compute the current document age:</span></p>
<p style="padding:0pt 0pt 5pt 47pt;"><span class="font3">$age = $age_when_document_arrived_at_our_cache + $how_long_copy_has_been_in_our_cache;</span></p>
<p style="text-align:justify;"><span class="font24">Ta-da! This gives us the complete HTTP/1.1 age-calculation algorithm we presented in </span><a href="#bookmark1523"><span class="font24">Example 7-1</span></a><span class="font24">. This is a matter of simple bookkeeping—we know when the document arrived at the cache (</span><span class="font4">$time_got_response</span><span class="font24">) and we know when the current request arrived (right now), so the resident time is just the difference. This is all shown graphically in</span><a href="#bookmark1535"><span class="font24"> Figure 7-18</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Age of cached document</span></p></td></tr>
<tr><td><img src="book_files/book-293.jpg" alt="" style="width:210pt;height:13pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-294.jpg" alt="" style="width:34pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="text-align:right;"><span class="font0">Server processing Server processing Response’s time &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network delay</span></p></td></tr>
<tr><td><img src="book_files/book-295.jpg" alt="" style="width:143pt;height:78pt;"></td><td>
<p style="text-align:right;padding:0pt 0pt 18pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">current_time</span></p>
<p><span class="font1" style="font-style:italic;">cache resident time</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-296.jpg" alt="" style="width:41pt;height:43pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Cache</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-297.jpg" alt="" style="width:12pt;height:29pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">time_issued_request time_got_response</span></p></td></tr>
<tr><td><img src="book_files/book-298.jpg" alt="" style="width:94pt;height:37pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-299.jpg" alt="" style="width:11pt;height:7pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-300.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">time_client_issued_request</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1535"></a><span class="font23" style="font-style:italic;">Figure 7-18. The age of a cached document includes resident time in the network and cache</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1536"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1537"></a>Freshness Lifetime Computation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Recall that we’re trying to figure out whether a cached document is fresh enough to serve to a client. To answer this question, we must determine the age of the cached document and compute the freshness lifetime based on server and client constraints. We just explained how to compute the age; now let’s move on to freshness lifetimes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The freshness lifetime of a document tells how old a document is allowed to get before it is no longer fresh enough to serve to a particular client. The freshness lifetime depends on server and client constraints. The server may have information about the publication change rate of the document. Very stable, filed reports may stay fresh for years. Periodicals may be up-to-date only for the time remaining until the next scheduled publication—next week, or 6:00 am tomorrow.</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font24">Clients may have certain other guidelines. They may be willing to accept slightly stale content, if it is faster, or they might need the most up-to-date content possible. Caches serve the users. We must adhere to their requests.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1538"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1539"></a>Complete Server-Freshness Algorithm</span></h3>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1540"><span class="font24">Example 7-2</span></a><span class="font24"> shows a Perl algorithm to compute server freshness limits. It returns the maximum age that a document can reach and still be served by the server.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1540"></a><span class="font23" style="font-style:italic;">Example 7-2. Server freshness constraint calculation</span></p>
<p><span class="font3">sub server_freshness_limit</span></p>
<p><span class="font3">{</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">local($heuristic,$server_freshness_limit,$time_since_last_modify);</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">$heuristic = 0;</span></p>
<p style="text-indent:19pt;"><span class="font3">if ($Max_Age_value_set)</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:37pt;"><span class="font3">$server_freshness_limit = $Max_Age_value;</span></p>
<p style="text-indent:19pt;"><span class="font3">}</span></p>
<p style="text-indent:19pt;"><span class="font3">elsif ($Expires_value_set)</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:37pt;"><span class="font3">$server_freshness_limit = $Expires_value - $Date_value;</span></p>
<p style="text-indent:19pt;"><span class="font3">}</span></p>
<p style="text-indent:19pt;"><span class="font3">elsif ($Last_Modified_value_set)</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:37pt;"><span class="font3">$time_since_last_modify = max(0, $Date_value - $Last_Modified_value);</span></p>
<p style="text-indent:37pt;"><span class="font3">$server_freshness_limit = int($time_since_last_modify * $lm_factor);</span></p>
<p style="text-indent:37pt;"><span class="font3">$heuristic = 1;</span></p>
<p style="text-indent:19pt;"><span class="font3">}</span></p>
<p style="text-indent:19pt;"><span class="font3">else</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:37pt;"><span class="font3">$server_freshness_limit = $default_cache_min_lifetime;</span></p>
<p style="text-indent:37pt;"><span class="font3">$heuristic = 1;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">}</span></p>
<p style="text-indent:19pt;"><span class="font3">if ($heuristic)</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:37pt;"><span class="font3">if ($server_freshness_limit &gt;&nbsp;$default_cache_max_lifetime)</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 37pt;"><span class="font3">{ $server_freshness_limit = $default_cache_max_lifetime; } if ($server_freshness_limit &lt;&nbsp;$default_cache_min_lifetime) { $server_freshness_limit = $default_cache_min_lifetime; }</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">}</span></p>
<p style="text-indent:19pt;"><span class="font3">return($server_freshness_limit);</span></p>
<p><span class="font3">}</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Now let’s look at how the client can override the document’s server-specified age limit. </span><a href="#bookmark1541"><span class="font24">Example 7-3 </span></a><span class="font24">shows a Perl algorithm to take a server freshness limit and modify it by the client constraints. It returns the maximum age that a document can reach and still be served by the cache without revalidation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1541"></a><span class="font23" style="font-style:italic;">Example 7-3. Client freshness constraint calculation</span></p>
<p style="text-align:justify;"><span class="font3">sub client_modified_freshness_limit {</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">$age_limit = server_freshness_limit(); ## From</span><a href="#bookmark1540"><span class="font3"> Example 7-2</span></a></p>
<p style="text-indent:17pt;"><span class="font3">if ($Max_Stale_value_set)</span></p>
<p style="text-indent:17pt;"><span class="font3">{</span></p>
<p style="text-indent:33pt;"><span class="font3">if ($Max_Stale_value == $INT_MAX)</span></p>
<p style="padding:0pt 0pt 0pt 33pt;"><span class="font3">{ $age_limit = $INT_MAX; } else</span></p>
<p style="text-indent:33pt;"><span class="font3">{ $age_limit = server_freshness_limit() + $Max_Stale_value; }</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">}</span></p>
<p style="text-indent:17pt;"><span class="font3">if ($Min_Fresh_value_set)</span></p>
<p style="text-indent:17pt;"><span class="font3">{</span></p>
<p style="text-indent:33pt;"><a name="bookmark1542"></a><span class="font3">$age_limit = min($age_limit, server_freshness_limit() - $Min_Fresh_value_set);</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">}</span></p>
<p style="text-indent:17pt;"><span class="font3">if ($Max_Age_value_set)</span></p>
<p style="text-indent:17pt;"><span class="font3">{</span></p>
<p style="text-indent:33pt;"><span class="font3">$age_limit = min($age_limit, $Max_Age_value);</span></p>
<p style="text-indent:17pt;"><span class="font3">}</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">}</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1543"></a><span class="font24">The whole process involves two variables: the document’s age and its freshness limit. The document is “fresh enough” if the age is less than the freshness limit. The algorithm in</span><a href="#bookmark1541"><span class="font24"> Example 7-3</span></a><span class="font24"> just takes the server freshness limit and slides it around based on additional client constraints. We hope this section made the subtle expiration algorithms described in the HTTP specifications a bit clearer.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1544"></a><span class="font9" style="font-weight:bold;"><a name="bookmark76"></a><a name="bookmark1545"></a>Caches and Advertising</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If you’ve made it this far, you’ve realized that caches improve performance and reduce traffic. You know caches can help users and give them a better experience, and you know caches can help network operators reduce their traffic.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1546"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1547"></a>The Advertiser’s Dilemma</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You might also expect content providers to like caches. After all, if caches were everywhere, content providers wouldn’t have to buy big multiprocessor web servers to keep up with demand—and they wouldn’t have to pay steep network service charges to feed the same data to their viewers over and over again. And better yet, caches make the flashy articles and advertisements show up even faster and look even better on the viewer’s screens, encouraging them to consume more content and see more advertisements. And that’s just what content providers want! More eyeballs and more advertisements!</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">But that’s the rub. Many content providers are paid through advertising—in particular, they get paid every time an advertisement is shown to a user (maybe just a fraction of a penny or two, but they add up if you show a million ads a day!). And that’s the problem with caches—they can hide the real access counts from the origin server. If caching was perfect, an origin server might not receive any HTTP accesses at all, because they would be absorbed by Internet caches. But, if you are paid on access counts, you won’t be celebrating.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1548"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1549"></a>The Publisher’s Response</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Today, advertisers use all sorts of “cache-busting” techniques to ensure that caches don’t steal their hit stream. They slap no-cache headers on their content. They serve advertisements through CGI gateways. They rewrite advertisement URLs on each access.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1550"></a><span class="font24">And these cache-busting techniques aren’t just for proxy caches. In fact, today they are targeted primarily at the cache that’s enabled in every web browser. Unfortunately, while over-aggressively trying to maintain their hit stream, some content providers are reducing the positive effects of caching to their site.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In the ideal world, content providers would let caches absorb their traffic, and the caches would tell them how many hits they got. Today, there are a few ways caches can do this.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One solution is to configure caches to revalidate with the origin server on every access. This pushes a hit to the origin server for each access but usually does not transfer any body data. Of course, this slows down the transaction.<a name="footnote73"></a><sup><a href="#bookmark1551">73</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1552"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1553"></a>Log Migration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">One ideal solution wouldn’t require sending hits through to the server. After all, the cache can keep a log of all the hits. Caches could just distribute the hit logs to servers. In fact, some large cache providers have been know to manually process and hand-deliver cache logs to influential content providers to keep the content providers happy.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1554"></a><span class="font24">Unfortunately, hit logs are large, which makes them tough to move. And cache logs are not standardized or organized to separate logs out to individual content providers. Also, there are authentication and privacy issues.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1555"></a><span class="font24">Proposals have been made for efficient (and less efficient) log-redistribution schemes. None are far enough developed to be adopted by web software vendors. Many are extremely complex and require joint business partnerships to succeed.<a name="footnote74"></a><sup><a href="#bookmark1556">74</a></sup><sup></sup> Several corporate ventures have been launched to develop supporting infrastructure for advertising revenue reclamation.</span></p>
<h3 style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark1557"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1558"></a>Hit Metering and Usage Limiting</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 2227, “Simple Hit-Metering and Usage-Limiting for HTTP,” defines a much simpler scheme. This protocol adds one new header to HTTP, called Meter, that periodically carries hit counts for particular URLs back to the servers. This way, servers get periodic updates from caches about the number of times cached documents were hit.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In addition, the server can control how many times documents can be served from cache, or a wall clock timeout, before the cache must report back to the server. This is called usage limiting; it allows servers to control how much a cached resource can be used before it needs to report back to the origin server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">We’ll describe RFC 2227 in detail in</span><a href="#bookmark245"><span class="font24"> Chapter 21</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1559"></a><span class="font9" style="font-weight:bold;"><a name="bookmark77"></a><a name="bookmark1560"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information on caching, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/rfc2616/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/rfc2616/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol,” by R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Mastinter, P. Leach, and T. Berners-Lee.</span></p>
<p><span class="font24" style="font-style:italic;">Web Caching</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Duane Wessels, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p><a href="http://search.ietf.org/rfc/rfc3040.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc3040.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 3040, “Internet Web Replication and Caching Taxonomy.”</span></p>
<p><span class="font24" style="font-style:italic;">Web Proxy Servers</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Ari Luotonen, Prentice Hall Computer Books.</span></p>
<p><a href="http://search.ietf.org/rfc/rfc3143.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc3143.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 3143, “Known HTTP Proxy/Caching Problems.”</span></p>
<p><a href="http://www.squid-cache.org"><span class="font24" style="font-style:italic;">http://www.squid-cache.org</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Squid Web Proxy Cache.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 8</span></p>
<h1 style="text-align:right;padding:0pt 0pt 85pt 103pt;"><a name="bookmark1561"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1562"></a><a name="bookmark232"></a><a name="bookmark78"></a><a name="bookmark1563"></a>Integration Points: Gateways, Tunnels, and Relays</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Web has proven to be an incredible tool for disseminating content. Over time, people have moved from just wanting to put static documents online to wanting to share ever more complex resources, such as database content or dynamically generated HTML pages. HTTP applications, like web browsers, have provided users with a unified means of accessing content over the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP also has come to be a fundamental building block for application developers, who piggyback other protocols on top of HTTP (for example, using HTTP to tunnel or relay other protocol traffic through corporate firewalls, by wrapping that traffic in HTTP). HTTP is used as a protocol for all of the Web’s resources, and it’s also a protocol that other applications and application protocols make use of to get their jobs done.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark964"></a><span class="font24">This chapter takes a general look at some of the methods that developers have come up with for using HTTP to access different resources and examines how developers use HTTP as a framework for enabling other protocols and application communication.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1564"></a><span class="font24">In this chapter, we discuss:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Gateways, which interface HTTP with other protocols and applications</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Application interfaces, which allow different types of web applications to communicate with one another</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Tunnels, which let you send non-HTTP traffic over HTTP connections</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Relays, which are a type of simplified HTTP proxy used to forward data one hop at a time</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1565"></a><span class="font9" style="font-weight:bold;"><a name="bookmark79"></a><a name="bookmark1566"></a>Gateways</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The history behind HTTP extensions and interfaces was driven by people’s needs. When the desire to put more complicated resources on the Web emerged, it rapidly became clear that no single application could handle all imaginable resources.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To get around this problem, developers came up with the notion of a </span><span class="font24" style="font-style:italic;">gateway</span><span class="font24"> that could serve as a sort of interpreter, abstracting a way to get at the resource. A gateway is the glue between resources and applications. An application can ask (through HTTP or some other defined interface) a gateway to handle the request, and the gateway can provide a response. The gateway can speak the query language to the database or generate the dynamic content, acting like a portal: a request goes in, and a response comes out.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark1567"><span class="font24">Figure 8-1 </span></a><span class="font24">depicts a kind of resource gateway. Here, the Joe’s Hardware server is acting as a gateway to database content—note that the client is simply asking for a resource through HTTP, and the Joe’s Hardware server is interfacing with a gateway to get at the resource.</span></p>
<p style="text-align:justify;text-indent:9pt;"><span class="font1" style="font-style:italic;">Client is requesting:</span></p>
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><a href="http://www.joes-hardware.com/query-db.cgi?newproducts"><span class="font1" style="font-style:italic;">http://www.joes-hardware.com/query-db.cgi?newproducts</span></a></p>
<p style="text-indent:45pt;padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">GET /query-db.cgi?newproducts HTTP/1.1</span></p>
<p><a name="bookmark1568"></a><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">Accept: *</span></p></td></tr>
<tr><td><img src="book_files/book-301.jpg" alt="" style="width:265pt;height:54pt;"></td></tr>
<tr><td>
<p><span class="font3">New product list:</span></p>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<p><span class="font1" style="font-weight:bold;">Gateway</span></p>
<p><span class="font1" style="font-weight:bold;">Database</span></p></td></tr>
</table>
</div><br clear="all">
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-302.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">HTTP/FTP server-side FTP gateway</span></p></td></tr>
<tr><td><img src="book_files/book-303.jpg" alt="" style="width:226pt;height:39pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p>
<p><span class="font1" style="font-weight:bold;">Gateway</span></p>
<p><span class="font1" style="font-weight:bold;">FTP server</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">HTTPS/HTTP client-side security gateway</span></p></td></tr>
<tr><td><img src="book_files/book-304.jpg" alt="" style="width:226pt;height:39pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">HTTPS client</span></p>
<p><span class="font1" style="font-weight:bold;">Gateway</span></p>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">HTTP/CGI server-side application gateway</span></p>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">CGI (or other API)</span></p></td></tr>
<tr><td><img src="book_files/book-305.jpg" alt="" style="width:207pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p>
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Program</span></p>
<p><span class="font1" style="font-weight:bold;">Application server gateway</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1569"></a><span class="font23" style="font-style:italic;"><a name="bookmark1570"></a>Figure 8-2. Three web gateway examples</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">• In </span><a href="#bookmark1569"><span class="font24">Figure 8-2</span></a><span class="font24">c, the gateway connects HTTP clients to server-side application programs, through an application server gateway API. When you purchase from e-commerce stores on the Web, check the weather forecast, or get stock quotes, you are visiting application server gateways.</span></p></li></ul>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1571"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1572"></a>Client-Side and Server-Side Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web gateways speak HTTP on one side and a different protocol on the other side.<a name="footnote75"></a><sup><a href="#bookmark1573">75</a></sup><sup> </sup>Gateways are described by their client- and server-side protocols, separated by a slash:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">&lt;client-protocol&gt;/&lt;server-protocol&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">So a gateway joining HTTP clients to NNTP news servers is an </span><span class="font24" style="font-style:italic;">HTTP/NNTP gateway</span><span class="font24">. We use the terms “server-side gateway” and “client-side gateway” to describe what side of the gateway the conversion is done for:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">•</span><span class="font24" style="font-style:italic;"> Server-side gateways</span><span class="font24"> speak HTTP with clients and a foreign protocol with servers (HTTP/<sup><a href="#bookmark1573">75</a></sup>).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 6pt 19pt;"><span class="font24">•</span><span class="font24" style="font-style:italic;"> Client-side gateways</span><span class="font24"> speak foreign protocols with clients and HTTP with servers (<sup><a href="#bookmark1573">75</a></sup>/HTTP).</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1574"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1575"></a><a name="bookmark80"></a><a name="bookmark1576"></a>Protocol Gateways</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You can direct HTTP traffic to gateways the same way you direct traffic to proxies. Most commonly, you explicitly configure browsers to use gateways, intercept traffic transparently, or configure gateways as surrogates (reverse proxies).</span></p>
<p style="text-align:justify;"><a href="#bookmark1577"><span class="font24">Figure 8-3 </span></a><span class="font24">shows the dialog boxes used to configure a browser to use server-side FTP gateways. In the configuration shown, the browser is configured to use </span><span class="font24" style="font-style:italic;">gw1.joes-hardware.com</span><span class="font24"> as an HTTP/FTP gateway for all FTP URLs. Instead of sending FTP commands to an FTP server, the browser will send HTTP commands to the HTTP/ FTP gateway </span><span class="font24" style="font-style:italic;">gw1.joes-hardware.com</span><span class="font24"> on port 8080.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-306.jpg" alt="" style="width:196pt;height:142pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Navigator manual proxy settings</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-307.jpg" alt="" style="width:128pt;height:135pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">MSIE manual proxy settings</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1577"></a><span class="font23" style="font-style:italic;">Figure 8-3. Configuring an HTTP/FTP gateway</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1578"></a><span class="font24">The result of this gateway configuration is shown in</span><a href="#bookmark1579"><span class="font24"> Figure 8-4</span></a><span class="font24">. Normal HTTP traffic is unaffected; it continues to flow directly to origin servers. But requests for FTP URLs are sent to the gateway </span><span class="font24" style="font-style:italic;">gw1.joes-hardware.com</span><span class="font24"> within HTTP requests. The gateway performs the FTP transactions on the client’s behalf and carries results back to the client by HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The following sections describe common kinds of gateways: server protocol converters, server-side security gateways, client-side security gateways, and application servers.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1580"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1581"></a>HTTP/*: Server-Side Web Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Server-side web gateways convert client-side HTTP requests into a foreign protocol, as the requests travel inbound to the origin server (see </span><a href="#bookmark1582"><span class="font24">Figure 8-5</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In</span><a href="#bookmark1582"><span class="font24"> Figure 8-5</span></a><span class="font24">, the gateway receives an HTTP request for an FTP resource:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="ftp://ftp.irs.gov/pub/00-index.txt"><span class="font3">ftp://ftp.irs.gov/pub/00-index.txt</span></a></p>
<p style="text-indent:23pt;"><span class="font2">GET </span><a href="http://www.cnn.com/HTTP/1.0"><span class="font2">http://www.cnn.com/HTTP/1.0</span></a></p>
<p style="text-indent:23pt;"><span class="font2">Host: </span><a href="http://www.cnn.com"><span class="font2">www.cnn.com</span></a></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-308.jpg" alt="" style="width:42pt;height:46pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Web server </span><span class="font1" style="font-style:italic;">(</span><a href="http://www.cnn.com"><span class="font1" style="font-style:italic;">www.cnn.com</span></a><span class="font1" style="font-style:italic;">)</span></p></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-309.jpg" alt="" style="width:108pt;height:46pt;"></td></tr>
<tr><td>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">HTTP/FTP gateway &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FTP server</span></p>
<p style="text-align:right;"><span class="font1" style="font-style:italic;">(gw1.joes-hardware.com) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><a href="ftp://ftp.irs.gov"><span class="font1" style="font-style:italic;">ftp.irs.gov</span></a><span class="font1" style="font-style:italic;">)</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;text-indent:23pt;padding:0pt 0pt 8pt 0pt;"><span class="font2">User-agent: SuperBrowser 4.2</span></p>
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">HTTP</span></p></td></tr>
<tr><td><img src="book_files/book-310.jpg" alt="" style="width:39pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p></td></tr>
</table>
<p style="text-indent:38pt;padding:0pt 0pt 8pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">HTTP</span></p>
<p style="text-indent:23pt;"><span class="font2">GET </span><a href="ftp://ftp.irs.gov/pub/00-index.txt"><span class="font2">ftp://ftp.irs.gov/pub/00-index.txt</span></a><span class="font2"> HTTP/1.0</span></p>
<p style="text-indent:23pt;"><span class="font2">Host: </span><a href="ftp://ftp.irs.gov"><span class="font2">ftp.irs.gov</span></a></p>
<p style="text-align:justify;text-indent:23pt;padding:0pt 0pt 14pt 0pt;"><span class="font2">User-agent: SuperBrowser 4.2</span></p>
<p style="padding:0pt 0pt 21pt 0pt;"><a name="bookmark1579"></a><span class="font23" style="font-style:italic;">Figure 8-4. Browsers can configure particular protocols to use particular gateways</span></p>
<p style="padding:0pt 0pt 0pt 250pt;"><span class="font2">USER anonymous</span></p>
<p style="padding:0pt 0pt 0pt 250pt;"><span class="font2">PASS joe</span></p>
<p style="padding:0pt 0pt 0pt 250pt;"><span class="font2">CWD /pub</span></p>
<p style="padding:0pt 0pt 0pt 250pt;"><span class="font2">TYPE A</span></p>
<div style="border-bottom:solid;float:left;writing-mode:horizontal-tb;">
<p><span class="font2">GET </span><a href="ftp://ftp.irs.gov/pub/00-index.txt"><span class="font2">ftp://ftp.irs.gov/pub/00-index.txt</span></a><span class="font2"> HTTP/1.0</span></p>
<p><span class="font2">Host: </span><a href="ftp://ftp.irs.gov"><span class="font2">ftp.irs.gov</span></a></p>
<p><span class="font2">User-agent: SuperBrowser 4.2</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-311.jpg" alt="" style="width:33pt;height:34pt;"></td><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">HTTP</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 0pt 51pt;"><span class="font2">MDTM 00-index.txt</span></p>
<p style="padding:0pt 0pt 0pt 51pt;"><span class="font2">PASV</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font0">Port 21</span></p></td></tr>
<tr><td><img src="book_files/book-312.jpg" alt="" style="width:40pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">FTP server</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 8pt 51pt;"><span class="font2">RETR 00-index.txt</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-313.jpg" alt="" style="width:44pt;height:38pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">HTTP/FTP inbound conversion gateway</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font1" style="font-style:italic;">FTP control connection</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font1" style="font-style:italic;text-decoration:underline;">FTP data connectio</span><span class="font1" style="font-style:italic;">n </span><span class="font2">...data..</span></p>
<p style="padding:0pt 0pt 12pt 260pt;"><span class="font1" style="font-style:italic;">Inbound</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1582"></a><span class="font23" style="font-style:italic;">Figure 8-5. The HTTP/FTP gateway translates HTTP request into FTP requests</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The gateway proceeds to open an FTP connection to the FTP port on the origin server (port 21) and speak the FTP protocol to fetch the object. The gateway does the following:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Sends the USER and PASS commands to log in to the server</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Issues the CWD command to change to the proper directory on the server</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Sets the download type to ASCII</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Fetches the document’s last modification time with MDTM</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Tells the server to expect a passive data retrieval request using PASV</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Requests the object retrieval using RETR</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 8pt 19pt;"><span class="font24">• Opens a data connection to the FTP server on a port returned on the control channel; as soon as the data channel is opened, the object content flows back to the gateway</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1583"></a><span class="font24">When the retrieval is complete, the object will be sent to the client in an HTTP response.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1584"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1585"></a>HTTP/HTTPS: Server-Side Security Gateways</span></h3>
<p style="text-align:justify;"><a name="bookmark1586"></a><span class="font24">Gateways can be used to provide extra privacy and security for an organization, by encrypting all inbound web requests. Clients can browse the Web using normal HTTP, but the gateway will automatically encrypt the user’s sessions (</span><a href="#bookmark1587"><span class="font24">Figure 8-6</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET </span><a href="http://www.cnn.com/"><span class="font2">http://www.cnn.com/</span></a><span class="font2"> HTTP/1.0 Host: </span><a href="http://www.cnn.com"><span class="font2">www.cnn.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font2">mdsnrt734tngfd/p0f92piub5. lod9fuo8w34b4/;p-90[g9yk,8 U|t6y6/%$!&amp;9890G&amp;*&amp;98...</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-314.jpg" alt="" style="width:94pt;height:53pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Secure web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">User-agent: Superbrowser 4.2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-315.jpg" alt="" style="width:109pt;height:44pt;"></td><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">HTTP over SSL (HTTPS)</span></p></td></tr>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">HTTP/HTTPS inbound security gateway</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-316.jpg" alt="" style="width:33pt;height:34pt;"></td><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">HTTP</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">HTTP client</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1587"></a><span class="font23" style="font-style:italic;">Figure 8-6. Inbound HTTP/HTTPS security gateway</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1588"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1589"></a>HTTPS/HTTP: Client-Side Security Accelerator Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 20pt 0pt;"><span class="font24">Recently, HTTPS/HTTP gateways have become popular as security accelerators. These HTTPS/HTTP gateways sit in front of the web server, usually as an invisible intercepting gateway or a reverse proxy. They receive secure HTTPS traffic, decrypt the secure traffic, and make normal HTTP requests to the web server </span><a href="#bookmark1590"><span class="font24">(Figure 8-7)</span></a><span class="font24">.</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-317.jpg" alt="" style="width:17pt;height:23pt;">
</div>
<p style="padding:0pt 0pt 0pt 65pt;"><span class="font1" style="font-weight:bold;">Protected internal LAN</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font2">mdsnrt734tngfd/p0f92piub5. lod9fuo8w34b4/;p-90[g9yk,8 U|t6y6/%$!&amp;9890G&amp;*&amp;98...</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET </span><a href="http://www.cnn.com/"><span class="font2">http://www.cnn.com/</span></a><span class="font2"> HTTP/1.0</span></p>
<p><span class="font2">Host: </span><a href="http://www.cnn.com"><span class="font2">www.cnn.com</span></a></p>
<p><span class="font2">User-agent: Superbrowser 4.2</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-318.jpg" alt="" style="width:85pt;height:47pt;"></td></tr>
<tr><td>
<p><a href="http://www.cnn.com"><span class="font1" style="font-weight:bold;">www.cnn.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">HTTP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">HTTPS/HTTP security accelerator gateway</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Browser</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1590"></a><span class="font23" style="font-style:italic;">Figure 8-7. HTTPS/HTTP security accelerator gateway</span></p>
<p style="text-align:justify;"><span class="font24">These gateways often include special decryption hardware to decrypt secure traffic much more efficiently than the origin server, removing load from the origin server. Because these gateways send unencrypted traffic between the gateway and origin server, you need to use caution to make sure the network between the gateway and origin server is secure.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1591"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1592"></a><a name="bookmark81"></a><a name="bookmark1593"></a>Resource Gateways</span></h2>
<p style="text-align:justify;"><a name="bookmark1594"></a><span class="font24">So far, we’ve been talking about gateways that connect clients and servers across a network. However, the most common form of gateway, the application server, combines the destination server and gateway into a single server. Application servers are server-side gateways that speak HTTP with the client and connect to an application program on the server side (see </span><a href="#bookmark1595"><span class="font24">Figure 8-8</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-319.jpg" alt="" style="width:105pt;height:71pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-320.jpg" alt="" style="width:40pt;height:34pt;"></td></tr>
<tr><td>
<p><a name="bookmark1596"></a><span class="font1" style="font-weight:bold;">Client A</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-321.jpg" alt="" style="width:94pt;height:104pt;"></td><td>
<p style="padding:0pt 0pt 27pt 0pt;"><span class="font1" style="font-style:italic;">Camera device and software</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 5pt 0pt;"><span class="font0">11000101101</span></p>
<p style="padding:0pt 0pt 16pt 0pt;"><span class="font1" style="font-style:italic;">E-commerce application</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-322.jpg" alt="" style="width:93pt;height:63pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-323.jpg" alt="" style="width:40pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client B</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1595"></a><span class="font23" style="font-style:italic;">Figure 8-8. An application server connects HTTP clients to arbitrary backend applications</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In</span><a href="#bookmark1595"><span class="font24"> Figure 8-8</span></a><span class="font24">, two clients are connecting to an application server using HTTP. But, instead of sending back files from the server, the <a name="bookmark1597"></a>application server passes the requests through a gateway </span><span class="font24" style="font-style:italic;">application programming interface</span><span class="font24"> (API) to applications running on the server:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Client A’s request is received and, based on the URI, is sent through an API to a digital camera application. The resulting camera image is bundled up into an HTTP response message and sent back to the client, for display in the client’s browser.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Client B’s URI is for an e-commerce application. Client B’s requests are sent through the server gateway API to the e-commerce software, and the results are sent back to the browser. The e-commerce software interacts with the client, walking the user through a sequence of HTML pages to complete a purchase.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The first popular API for application gateways was the </span><span class="font24" style="font-style:italic;">Common Gateway Interface </span><span class="font24">(CGI). CGI is a standardized set of interfaces that web servers use to launch programs in response to HTTP requests for special URLs, collect the program output, and send it back in HTTP responses. Over the past several years, commercial web servers have provided more sophisticated interfaces for connecting web servers to applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Early web servers were fairly simple creations, and the simple approach that was taken for implementing an interface for gateways has stuck to this day.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a request comes in for a resource that needs a gateway, the server spawns the helper application to handle the request. The helper application is passed the data it needs. Often this is just the entire request or something like the query the user wants to run on the database (from the query string of the URL; see</span><a href="#bookmark224"><span class="font24"> Chapter 2</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><span class="font24">It then returns a response or response data to the server, which vectors it off to the client. The server and gateway are separate applications, so the lines of responsibility are kept clear.</span><a href="#bookmark1598"><span class="font24"> Figure 8-9</span></a><span class="font24"> shows the basic mechanics behind server and gateway application interactions.</span></p>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server internal view</span></p></td></tr>
<tr><td><img src="book_files/book-324.jpg" alt="" style="width:257pt;height:102pt;"></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark1598"></a><span class="font23" style="font-style:italic;"><a name="bookmark1599"></a>Figure 8-9. Server gateway application mechanics</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This simple protocol (request in, hand off, and respond) is the essence behind the oldest and one of the most common server extension interfaces, CGI.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1600"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1601"></a>Common Gateway Interface (CGI)</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Common Gateway Interface was the first and probably still is the most widely used server extension. It is used throughout the Web for things like dynamic HTML, credit card processing, and querying databases.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Since CGI applications are separate from the server, they can be implemented in almost any language, including Perl, Tcl, C, and various shell languages. And because CGI is simple, almost all HTTP servers support it. The basic mechanics of the CGI model are shown in</span><a href="#bookmark1598"><span class="font24"> Figure 8-9</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">CGI processing is invisible to users. From the perspective of the client, it’s just making a normal request. It is completely unaware of the hand-off procedure going on between the server and the CGI application. The client’s only hint that a CGI application might be involved would be the presence of the letters “cgi” and maybe “?” in the URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1602"></a><span class="font24"><a name="bookmark1603"></a>So CGI is wonderful, right? Well, yes and no. It provides a simple, functional form of glue between servers and pretty much any type of resource, handling any translation that needs to occur. The interface also is elegant in protecting the server from buggy extensions (if the extension were glommed onto the server itself, it could cause an error that might end up crashing the server).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">However, this separation incurs a cost in performance. The overhead to spawn a new process for every CGI request is quite high, limiting the performance of servers that use CGI and taxing the server machine’s resources. To try to get around this problem, a new form of CGI—aptly dubbed </span><span class="font24" style="font-style:italic;">Fast CGI</span><span class="font24">—has been developed. This interface mimics CGI, but it runs as a persistent daemon, eliminating the performance penalty of setting up and tearing down a new process for each request.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1604"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1605"></a>Server Extension APIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The CGI protocol provides a clean way to interface external interpreters with stock HTTP servers, but what if you want to alter the behavior of the server itself, or you just want to eke every last drop of performance you can get out of your server? For these two needs, server developers have provided server extension APIs, which provide a powerful interface for web developers to interface their own modules with an HTTP server directly. Extension APIs allow programmers to graft their own code onto the server or completely swap out a component of the server and replace it with thei<a name="bookmark1606"></a>r own.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1607"></a><span class="font24">Most popular servers provide one or more extension APIs for developers. Since these extensions often are tied to the architecture of the server itself, most of them are specific to one server type. Microsoft, Netscape, Apache, and other server flavors all have API interfaces that allow developers to alter the behavior of the server or provide custom interfaces to different resources. These custom interfaces provide a powerful interface for developers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One example of a server extension is Microsoft’s FrontPage Server Extension (FPSE), which supports web publishing services for FrontPage authors. FPSE is able to interpret remote procedure call (RPC) commands sent by FrontPage clients. These commands are piggybacked on HTTP (specifically, overlaid on the HTTP POST method). For details, see</span><a href="#bookmark1608"><span class="font24"> “FrontPage Server Extensions for Publishing Support” in Chapter 19</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1609"></a><span class="font9" style="font-weight:bold;"><a name="bookmark82"></a><a name="bookmark1610"></a>Application Interfaces and Web Services</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We’ve discussed resource gateways as ways for web servers to communicate with applications. More generally, with web applications providing ever more types of services, it becomes clear that HTTP can be part of a foundation for linking together applications. One of the trickier issues in wiring up applications is negotiating the protocol interface between the two applications so that they can exchange data— often this is done on an application-by-application basis.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1611"></a><span class="font24">To work together, applications usually need to exchange more complex information with one another than is expressible in HTTP headers. A couple of examples of extending HTTP or layering protocols on top of HTTP in order <a name="bookmark1612"></a>to exchange customized information are described in</span><a href="#bookmark243"><span class="font24"> Chapter 19</span></a><span class="font24">.</span><a href="#bookmark1608"><span class="font24"> “FrontPage Server Extensions for Pub</span></a><span class="font24"></span><a href="#bookmark1608"><span class="font24">lishing Support” in Chapter 19</span></a><a name="bookmark1613"></a><span class="font24"> talks about layering RPCs over HTTP POST messages, and</span><a href="#bookmark1614"><span class="font24"> “WebDAV and Collaborative Authoring</span></a><span class="font24">” talks about adding XML to HTTP headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1615"></a><span class="font24"><a name="bookmark1616"></a>The Internet community has developed a set of standards and protocols that allow web applications to talk to each other. These standards are loosely referred to as </span><span class="font24" style="font-style:italic;">web services</span><span class="font24">, although the term can mean standalone web applications (building blocks) themselves. The premise of web services is not new, but they are a new mechanism for applications to share information. Web services are built on stand<a name="bookmark1617"></a>ard web technologies, such as HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web services exchange information using XML over SOAP. The Extensible Markup Language (XML) provides a way to create and interpret customized information about a data object. The Simple Object Access Protocol (SOAP) is a standard for adding XML information to HTTP messages.<a name="footnote76"></a><sup><a href="#bookmark1618">76</a></sup><sup></sup></span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1619"></a><span class="font9" style="font-weight:bold;"><a name="bookmark83"></a><a name="bookmark1620"></a>Tunnels</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1621"></a><span class="font24"><a name="bookmark1622"></a>We’ve discussed different ways that HTTP can be used to enable access to various kinds of resources (through gateways) and to enable application-to-application communication. In this section, we’ll take a look at another use of HTTP, </span><span class="font24" style="font-style:italic;">web tunnels</span><span class="font24">, which enable access to applications that speak non-HTTP protocols through HTTP applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web tunnels let you send non-HTTP traffic through HTTP connections, allowing other protocols to piggyback on top of HTTP. The most common reason to use web tunnels is to embed non-HTTP traffic inside an HTTP connection, so it can be sent through firewalls that allow only web traffic.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1623"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1624"></a>Establishing HTTP Tunnels with CONNECT</span></h3>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Web tunnels are established using HTTP’s CONNECT method. The CONNECT protocol is not part of the core HTTP/1.1 specification,<a name="footnote77"></a><sup><a href="#bookmark1625">77</a></sup><sup></sup> but it is a widely implemented extension. Technical specifications can be found in Ari Luotonen’s expired Internet draft specification, “Tunneling TCP based protocols through Web proxy servers,” or in his book </span><span class="font24" style="font-style:italic;">Web Proxy Servers</span><span class="font24">, both of which are cited at the end of this chapter.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The CONNECT method asks a tunnel gateway to create a TCP connection to an arbitrary destination server and port and to blindly relay subsequent data between client and server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark1626"><span class="font24">Figure 8-10</span></a><span class="font24"> shows how the CONNECT method works to establish a tunnel to a gateway:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In </span><a href="#bookmark1626"><span class="font24">Figure 8-10</span></a><span class="font24">a, the client sends a CONNECT request to the tunnel gateway. The client’s CONNECT method asks the tunnel gateway to open a TCP connection (here, to the host named </span><span class="font24" style="font-style:italic;">orders.joes-hardware.com</span><span class="font24"> on port 443, the normal SSL port).</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The TCP connection is created in </span><a href="#bookmark1626"><span class="font24">Figure 8-10</span></a><span class="font24">b and</span><a href="#bookmark1626"><span class="font24"> Figure 8-10</span></a><span class="font24">c.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Once the TCP connection is established, the gateway notifies the client </span><a href="#bookmark1626"><span class="font24">(Figure 8-10</span></a><span class="font24">d) by sending an HTTP 200 Connection Established response.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• At this point, the tunnel is set up. Any data sent by the client over the HTTP tunnel will be relayed directly to the outgoing TCP connection, and any data sent by the server will be relayed to the client over the HTTP tunnel.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-325.jpg" alt="" style="width:33pt;height:39pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">The tunnel goes between client and gateway</span></p></td></tr>
<tr><td><img src="book_files/book-326.jpg" alt="" style="width:186pt;height:36pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Gateway </span><span class="font1" style="font-style:italic;">(Tunnel endpoint)</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="text-indent:12pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font1" style="font-style:italic;">CONNECT request sent</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Normal SSL connection</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">orders.joes-hardware.com</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">CONNECT orders.joes-hardware.com:443 HTTP/1.0 User-agent: SuperBrowser: 4.2</span></p></td></tr>
<tr><td><img src="book_files/book-327.jpg" alt="" style="width:138pt;height:24pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font1" style="font-style:italic;">HTTP connection ready message returned </span><span class="font2">HTTP/1.0 200 Connection established</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-328.jpg" alt="" style="width:133pt;height:43pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">(e) </span><span class="font1" style="font-style:italic;">At this point, arbitrary, bidirectional communication of raw data occurs, until connection close</span></p>
<p><span class="font2">mdsnrt734tngfd/p0f92piub5. lod9fuo8w34b4/;p-90[g9yk,8 U|t6y6/%$!&amp;9890G&amp;*&amp;98...</span></p></td></tr>
<tr><td><img src="book_files/book-329.jpg" alt="" style="width:166pt;height:83pt;">
<p style="text-align:right;"><span class="font2">gal1304-*&amp;hsgd</span></p></td><td>
<p style="text-align:justify;"><span class="font2">mdsnrt734tngfd/p0f92piub5. lod9fuo8w34b4/;p-90[g9yk,8 U|t6y6/%$!&amp;9890G&amp;*&amp;98...</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">gal1304-*&amp;hsgd</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-330.jpg" alt="" style="width:17pt;height:37pt;">
</div><br clear="all"></li></ul>
<p style="text-align:justify;"><a name="bookmark1626"></a><span class="font23" style="font-style:italic;">Figure 8-10. Using CONNECT to establish an SSL tunnel</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">The example in</span><a href="#bookmark1626"><span class="font24"> Figure 8-10 </span></a><span class="font24">describes an SSL tunnel, where SSL traffic is sent over an HTTP connection, but the CONNECT method can be used to establish a TCP connection to any server using any protocol.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1627"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1628"></a>CONNECT requests</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The CONNECT syntax is identical in form to other HTTP methods, with the exception of the start line. The request URI is replaced by a hostname, followed by a colon, followed by a port number. Both the host and the port must be specified:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">CONNECT home.netscape.com:443 HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">User-agent: Mozilla/4.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">After the start line, there are zero or more HTTP request header fields, as in other HTTP messages. As usual, the lines <a name="bookmark1629"></a>end in CRLFs, and the list of headers ends with a bare CRLF.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1630"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1631"></a>CONNECT responses</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">After the request is sent, the client waits for a response from the gateway. As with normal HTTP messages, a 200 response code indicates success. By convention, the reason phrase in the response is normally set to “Connection Established”:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.0 200 Connection Established</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Proxy-agent: Netscape-Proxy/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Unlike normal HTTP responses, the response does not need to include a ContentType header. No content type is required<a name="footnote78"></a><sup><a href="#bookmark1632">78</a></sup><sup></sup> because the connection becomes a raw byte relay, instead of a message carrier.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1633"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1634"></a>Data Tunneling, Timing, and Connection Management</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because the tunneled data is opaque to the gateway, the gateway cannot make any assumptions about the order and flow of packets. Once the tunnel is established, data is free to flow in any direction at any time.<a name="footnote79"></a><sup><a href="#bookmark1635">79</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As a performance optimization, clients are allowed to send tunnel data after sending the CONNECT request but before receiving the response. This gets data to the server faster, but it means that the gateway must be able to handle data following the request properly. In particular, the gateway cannot assume that a network I/O request will return only header data, and the gateway must be sure to forward any data read with the header to the server, when the connection is ready. Clients that pipeline data <a name="bookmark1636"></a>after the request must be prepared to resend the request data if the response comes back as an authentication challenge or other non-200, nonfatal status. <a name="footnote80"></a><sup><a href="#bookmark1637">80</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If at any point either one of the tunnel endpoints gets disconnected, any outstanding data that came from that endpoint will be passed to the other one, and after that also the other connection will be terminated by the proxy. If there is undelivered data for the closing endpoint, that data will be discarded.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1638"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1639"></a>SSL Tunneling</span></h3>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Web tunnels were first developed to carry encrypted SSL traffic through firewalls. Many organizations funnel all traffic through packet-filtering routers and proxy servers to enhance security. But some protocols, such as encrypted SSL, cannot be proxied by traditional proxy servers, because the information is encrypted. Tunnels let the SSL traffic be carried through the port 80 HTTP firewall by transporting it through an HTTP connection </span><a href="#bookmark1640"><span class="font24">(Figure 8-11</span></a><span class="font24">).</span></p>
<table>
<tr><td><img src="book_files/book-331.jpg" alt="" style="width:360pt;height:220pt;"></td></tr>
<tr><td>
<p><a name="bookmark1640"></a><span class="font23" style="font-style:italic;">Figure 8-11. Tunnels let non-HTTP traffic flow through HTTP connections</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">To allow SSL traffic to flow through existing proxy firewalls, a tunneling feature was added to HTTP, in which raw, encrypted data is placed inside HTTP messages and sent through normal HTTP channels </span><a href="#bookmark1641"><span class="font24">(Figure 8-12</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Port 443</span></p></td><td><img src="book_files/book-332.jpg" alt="" style="width:38pt;height:48pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Direct SSL connection</span></p></td></tr>
<tr><td><img src="book_files/book-333.jpg" alt="" style="width:45pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-334.jpg" alt="" style="width:14pt;height:22pt;"></td><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td><td><img src="book_files/book-335.jpg" alt="" style="width:19pt;height:20pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">SSL connection</span></p>
</div><br clear="all">
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">SSL through HTTP tunnel</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-336.jpg" alt="" style="width:39pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-337.jpg" alt="" style="width:57pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-338.jpg" alt="" style="width:31pt;height:19pt;"></td></tr>
<tr><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td><td><img src="book_files/book-339.jpg" alt="" style="width:20pt;height:23pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">SSL connection</span></p></td><td><img src="book_files/book-340.jpg" alt="" style="width:21pt;height:23pt;"></td><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Tunnel start</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><span class="font1" style="font-style:italic;text-decoration:underline;">Tunnel endpoint</span></p>
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Port 80</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Tunnel carries SSL traffic, intended for port 443, over a plain old HTTP connection</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3" style="font-weight:bold;">SSL</span></p></td><td><img src="book_files/book-341.jpg" alt="" style="width:19pt;height:23pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP connection</span></p></td><td><img src="book_files/book-342.jpg" alt="" style="width:18pt;height:23pt;"></td><td>
<p><span class="font3" style="font-weight:bold;">HTTP</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">HTTP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">SSL</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1641"></a><span class="font23" style="font-style:italic;"><a name="bookmark1642"></a>Figure 8-12. Direct SSL connection vs. tunnelled SSL connection</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In </span><a href="#bookmark1641"><span class="font24">Figure 8-12</span></a><span class="font24">a, SSL traffic is sent directly to a secure web server (on SSL port 443). In</span><a href="#bookmark1641"><span class="font24"> Figure 8-12</span></a><span class="font24">b, SSL traffic is encapsulated into HTTP messages and sent over HTTP port 80 connections, until it is decapsulated back into normal SSL connections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Tunnels often are used to let non-HTTP traffic pass through port-filtering firewalls. This can be put to good use, for example, to allow secure SSL traffic to flow through firewalls. However, this feature can be abused, allowing malicious protocols to flow into an organization through the HTTP tunnel.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1643"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1644"></a>SSL Tunneling Versus HTTP/HTTPS Gateways</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTPS protocol (HTTP over SSL) can alternatively be gatewayed in the same way as other protocols: having the gateway (instead of the client) initiate the SSL session with the remote HTTPS server and then perform the HTTPS transaction on the client’s part. The response will be received and decrypted by the proxy and sent to the client over (insecure) HTTP. This is the way gateways handle FTP. However, this approach has several disadvantages:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The client-to-gateway connection is normal, insecure HTTP.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The client is not able to perform SSL client authentication (authentication based on X509 certificates) to the remote server, as the proxy is the authenticated party.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• The gateway needs to support a full SSL implementation.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1645"></a><span class="font24">Note that this mechanism, if used for SSL tunneling, does not require an implementation of SSL in the proxy. The SSL session is established between the client generating the request and the destination (secure) web server; the proxy server in between merely tunnels the encrypted data and does not take any other part in the secure transaction.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1646"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1647"></a>Tunnel Authentication</span></h3>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font24">Other features of HTTP can be used with tunnels where appropriate. In particular, the proxy authentication support can be used with tunnels to authenticate a client’s right to use a tunnel (</span><a href="#bookmark1648"><span class="font24">Figure 8-13</span></a><span class="font24">).</span></p>
<p style="text-indent:50pt;"><span class="font1" style="font-style:italic;text-decoration:underline;">The tunnel goes between client and gateway</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Normal SLL connection</span></p>
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Gateway </span><span class="font1" style="font-style:italic;">(Tunnel endpoint)</span></p>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font1" style="font-style:italic;">CONNECT request sent</span></p>
<p><span class="font2">CONNECT orders.joes-hardware.com:443 HTTP/1.0 User-agent: SuperBrowser 4.2</span></p></td></tr>
<tr><td><img src="book_files/book-343.jpg" alt="" style="width:166pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font1" style="font-style:italic;">Authentication challange returned</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">orders.joes-hardware.com</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:justify;"><span class="font2">HTTP/1.0 407 Proxy authentication required Proxy-authenticate: Basic realm=&quot;wormhole&quot;</span></p></td></tr>
<tr><td><img src="book_files/book-344.jpg" alt="" style="width:138pt;height:23pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font1" style="font-style:italic;">CONNECT request sent, with proper authorization</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">CONNECT orders.joes-hardware.com:443 HTTP/1.0</span></p>
<p><span class="font2">User-agent: SuperBrowser 4.2</span></p>
<p><a name="bookmark1649"></a><span class="font2">Proxy-authorization: Basic YnJpYW4tdG90dHk6T3ch</span></p></td></tr>
<tr><td><img src="book_files/book-345.jpg" alt="" style="width:284pt;height:41pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(f) </span><span class="font1" style="font-style:italic;">HTTP connection ready message returned </span><span class="font2">HTTP/1.0 200 Connection established</span></p></td></tr>
<tr><td><img src="book_files/book-346.jpg" alt="" style="width:155pt;height:28pt;"></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1648"></a><span class="font23" style="font-style:italic;">Figure 8-13. Gateways can proxy-authenticate a client before it’s allowed to use a tunnel</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1650"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1651"></a>Tunnel Security Considerations</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In general, the tunnel gateway cannot verify that the protocol being spoken is really what it is supposed to tunnel. Thus, for example, mischievous users might use tunnels intended for SSL to tunnel Internet gaming traffic through a corporate firewall, <a name="bookmark1652"></a><a name="bookmark1653"></a>or malicious users might use tunnels to open Telnet sessions or to send email that bypasses corporate email scanners.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">To minimize abuse of tunnels, the gateway should open tunnels only for particular well-known ports, such as 443 for HTTPS.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1654"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1655"></a><a name="bookmark84"></a><a name="bookmark1656"></a>Relays</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP </span><span class="font24" style="font-style:italic;">relays</span><span class="font24"> are simple HTTP proxies that do not fully adhere to the HTTP specifications. Relays process enough HTTP to establish connections, then blindly forward bytes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because HTTP is complicated, it’s sometimes useful to implement bare-bones proxies that just blindly forward traffic, without performing all of the header and method logic. Because blind relays are easy to implement, they sometimes are used to provide simple filtering, diagnostics, or content transformation. But they should be deployed with great caution, because of the serious potential for interoperability problems.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">One of the more common (and infamous) problems with some implementations of simple blind relays relates to their potential to cause keep-alive connections to hang, because they don’t properly process the Connection header. This situation is depicted in </span><a href="#bookmark1657"><span class="font24">Figure 8-14</span></a><span class="font24">.</span></p>
<p style="padding:0pt 0pt 0pt 212pt;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Server won’t close connection when done because it thinks it has been asked to speak keep-alive</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Connection: Keep-Alive</span></p></td><td><img src="book_files/book-347.jpg" alt="" style="width:47pt;height:48pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Connection: Keep-Alive</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-348.jpg" alt="" style="width:40pt;height:33pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Blind relay</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Connection: Keep-Alive</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Connection: Keep-Alive</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Relay waits for connection to close, ignoring any new requests on the connection</span></p>
</div><br clear="all">
<p style="padding:0pt 204pt 10pt 43pt;"><span class="font1" style="font-weight:bold;">(f) </span><span class="font0">Client’s second request on the keep-alive connection just hangs because the relay never processes it</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1657"></a><span class="font23" style="font-style:italic;">Figure 8-14. Simple blind relays can hang if they are single-tasking and don’t support the Connection header</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s what’s going on in this figure:</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 2pt 19pt;"><span class="font24">• In </span><a href="#bookmark1657"><span class="font24">Figure 8-14</span></a><span class="font24">a, a web client sends a message to the relay, including the Connection: Keep-Alive header, requesting a keep-alive connection if possible. The client waits for a response to learn if its request for a keep-alive channel was granted.</span></p></li>
<li>
<p style="padding:0pt 0pt 3pt 19pt;"><span class="font24">• The relay gets the HTTP request, but it doesn’t understand the Connection header, so it passes the message verbatim down the chain to the server </span><a href="#bookmark1657"><span class="font24">(Figure 8-14</span></a><span class="font24">b). However, the Connection header is a hop-by-hop header; it applies only to a single transport link and shouldn’t be passed down the chain. Bad things are about to start happening!</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In</span><a href="#bookmark1657"><span class="font24"> Figure 8-14</span></a><span class="font24">b, the relayed HTTP request arrives at the web server. When the web server receives the proxied Connection: Keep-Alive header, it mistakenly concludes that the relay (which looks like any other client to the server) wants to speak keep-alive! That’s fine with the web server—it agrees to speak keep-alive and sends a Connection: Keep-Alive response header back in </span><a href="#bookmark1657"><span class="font24">Figure 8-14</span></a><span class="font24">c. So, at this point, the web server thinks it is speaking keep-alive with the relay, and it will adhere to rules of keep-alive. But the relay doesn’t know anything about keep-alive.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In </span><a href="#bookmark1657"><span class="font24">Figure 8-14</span></a><span class="font24">d, the relay forwards the web server’s response message back to the client, passing along the Connection: Keep-Alive header from the web server. The client sees this header and assumes the relay has agreed to speak keep-alive. At this point, both the client and server believe they are speaking keep-alive, but the relay to which they are talking doesn’t know the first thing about keep-alive.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Because the relay doesn’t know anything about keepalive, it forwards all the data it receives back to the client, waiting for the origin server to close the connection. But the origin server will not close the connection, because it believes the relay asked the server to keep the connection open! So, the relay will hang waiting for the connection to close.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• When the client gets the response message back in</span><a href="#bookmark1657"><span class="font24"> Figure 8-14</span></a><span class="font24">d, it moves right along to the next request, sending another request to the relay on the keep-alive connection (</span><a href="#bookmark1657"><span class="font24">Figure 8-14</span></a><span class="font24">e). Simple relays usually never expect another request on the same connection. The browser just spins, making no progress.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are ways to make relays slightly smarter, to remove these risks, but any simplification of proxies runs the risk of interoperation problems. If you are building simple HTTP relays for a particular purpose, be cautious how you use them. For any wide-scale deployment, you should strongly consider using a real, HTTP-compliant proxy server instead.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1658"></a><span class="font24">For more information about relays and connection management, see</span><a href="#bookmark905"><span class="font24"> “Keep-Alive</span></a><span class="font24"> </span><a href="#bookmark905"><span class="font24">and Dumb Proxies” in Chapter 4</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1659"></a><span class="font9" style="font-weight:bold;">For More Information</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/rfc2616/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/rfc2616/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol,” by R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Mastinter, P. Leach, and T. Berners-Lee.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Web Proxy Servers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Ari Luotonen, Prentice Hall Computer Books.</span></p>
<p><a href="http://www.alternic.org/drafts/drafts-l-m/draft-luotonen-web-proxy-tunneling-01.txt"><span class="font24" style="font-style:italic;">http://www.alternic.org/drafts/drafts-l-m/draft-luotonen-web-proxy-tunneling-01.txt</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Tunneling TCP based protocols through Web proxy servers,” by Ari Luotonen.</span></p>
<p><a href="http://cgi-spec.golux.com"><span class="font24" style="font-style:italic;">http://cgi-spec.golux.com</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The Common Gateway Interface—RFC Project Page.</span></p>
<p><a href="http://www.w3.org/TR/2001/WD-soap12-part0-20011217/"><span class="font24" style="font-style:italic;">http://www.w3.org/TR/2001/WD-soap12-part0-20011217/</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">W3C—SOAP Version 1.2 Working Draft.</span></p>
<p><span class="font24" style="font-style:italic;">Programming Web Services with SOAP</span></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">James Snell, Doug Tidwell, and Pavel Kulchenko, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p><a href="http://www.w3.org/TR/2002/WD-wsa-reqs-20020429"><span class="font24" style="font-style:italic;">http://www.w3.org/TR/2002/WD-wsa-reqs-20020429</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">W3C—Web Services Architecture Requirements.</span></p>
<p><span class="font24" style="font-style:italic;">Web Services Essentials</span></p>
<p style="text-indent:18pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Ethan Cermai, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p style="text-align:right;padding:0pt 0pt 4pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 9</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark233"></a><span class="font11" style="font-weight:bold;"><a name="bookmark86"></a><a name="bookmark1660"></a>Web Robots</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1661"></a><span class="font24"><a name="bookmark1662"></a><a name="bookmark1663"></a><a name="bookmark1664"></a>We continue our tour of HTTP architecture with a close look at the self-animating user agents called </span><span class="font24" style="font-style:italic;">web robots</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web robots are software programs that automate a series of web transactions without human interaction. Many robots wander from web site to web site, fetching content, following hyperlinks, and processing the data they find. These kinds of robots are given colorful names such as “crawlers,” “spiders,” “worms,” and “bots” because of the way they automatically explore web sites, seemingly with minds of their own.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are a few examples of web robots:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Stock-graphing robots issue HTTP GETs to stock market servers every few minutes and use the data to build stock price trend graphs.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1665"></a><span class="font24"><a name="bookmark1666"></a>• Web-census robots gather “census” information about the scale and evolution of the World Wide Web. They wander the Web counting the number of pages and recording the size, language, and media type of each page.<a name="footnote81"></a><sup><a href="#bookmark1667">81</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Search-engine robots collect all the documents they find to create search databases.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Comparison-shopping robots gather web pages from online store catalogs to build databases of products and their prices.</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1668"></a><span class="font9" style="font-weight:bold;"><a name="bookmark87"></a><a name="bookmark1669"></a>Crawlers and Crawling</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web crawlers are robots that recursively traverse information webs, fetching first one web page, then all the web pages to which that page points, then all the web pages to which those pages point, and so on. When a robot recursively follows web links, it is called a </span><span class="font24" style="font-style:italic;">crawler</span><span class="font24"> or a </span><span class="font24" style="font-style:italic;">spider</span><span class="font24"> because it “crawls” along the web created by HTML hyperlinks.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1670"></a><span class="font24">Internet search engines use crawlers to wander about the Web and pull back all the documents they encounter. These documents are then processed to create a searchable database, allowing users to find documents that contain particular words. With billions of web pages out there to find and bring back, these search-engine spiders necessarily are some of the most sophisticated robots. Let’s look in more detail at how crawlers work.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1671"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1672"></a>Where to Start: The “Root Set”</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before you can unleash your hungry crawler, you need to give it a starting point. The initial set of URLs that a crawler starts visiting is referred to as the </span><span class="font24" style="font-style:italic;">root set</span><span class="font24">. When picking a root set, you should choose URLs from enough different places that crawling all the links will eventually get you to most of the web pages that interest you.</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font24">What’s a good root set to use for crawling the web in </span><a href="#bookmark1673"><span class="font24">Figure 9-1</span></a><span class="font24">? As in the real Web, there is no single document that eventually links to every document. If you start with document A in </span><a href="#bookmark1673"><span class="font24">Figure 9-1</span></a><span class="font24">, you can get to B, C, and D, then to E and F, then to J, and then to K. But there’s no chain of links from A to G or from A to N.</span></p>
<p style="padding:0pt 0pt 18pt 0pt;"><span class="font3" style="font-weight:bold;">A &nbsp;GLS</span></p>
<p style="padding:0pt 0pt 18pt 0pt;"><span class="font3" style="font-weight:bold;">BCD &nbsp;HI &nbsp;MN &nbsp;TU</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 79pt;"><span class="font3" style="font-weight:bold;">EF &nbsp;&nbsp;&nbsp;&nbsp;J &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3" style="font-weight:bold;">KPQR</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark1673"></a><span class="font23" style="font-style:italic;">Figure 9-1. A root set is needed to reach all pages</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some web pages in this web, such as S, T, and U, are nearly stranded—isolated, without any links pointing at them. Perhaps these lonely pages are new, and no one has found them yet. Or perhaps they are really old or obscure.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In general, you don’t need too many pages in the root set to cover a large portion of the web. In </span><a href="#bookmark1673"><span class="font24">Figure 9-1</span></a><span class="font24">, you need only A, G, and S in the root set to reach all pages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Typically, a good root set consists of the big, popular web sites (for example, </span><span class="font24" style="font-style:italic;">http:// </span><a href="http://www.yahoo.com"><span class="font24" style="font-style:italic;">www.yahoo.com</span></a><span class="font24">), a list of newly created pages, and a list of obscure pages that aren’t often linked to. Many large-scale production crawlers, such as those used by Internet search engines, have a way for users to submit new or obscure pages into the root set. This root set grows over time and is the seed list for any fresh crawls.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1674"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1675"></a><a name="bookmark1676"></a>Extracting Links and Normalizing Relative Links</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As a crawler moves through the Web, it is constantly retrieving HTML pages. It needs to parse out the URL links in each page it retrieves and add them to the list of pages that need to be crawled. While a crawl is progressing, this list often expands rapidly, as the crawler discovers new links that need to be explored.<a name="footnote82"></a><sup><a href="#bookmark1677">82</a></sup><sup></sup> Crawlers need to do some simple HTML parsing to extract these links and to convert relative URLs into their absolute form.</span><a href="#bookmark441"><span class="font24"> “Relative URLs” in Chapter 2</span></a><span class="font24"> discusses how to do this conversion.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1678"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1679"></a><a name="bookmark1680"></a>Cycle Avoidance</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When a robot crawls a web, it must be very careful not to get stuck in a loop, or </span><span class="font24" style="font-style:italic;">cycle</span><span class="font24">. Look at the crawler in </span><a href="#bookmark1681"><span class="font24">Figure 9-2</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• In</span><a href="#bookmark1681"><span class="font24"> Figure 9-2</span></a><span class="font24">a, the robot fetches page A, sees that A links to B, and fetches page B.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• In</span><a href="#bookmark1681"><span class="font24"> Figure 9-2b</span></a><span class="font24">, the robot fetches page B, sees that B links to C, and fetches page C.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• In</span><a href="#bookmark1681"><span class="font24"> Figure 9-2</span></a><span class="font24">c, the robot fetches page C and sees that C links to A. If the robot fetches page A again, it will end up in a cycle, fetching A, B, C, A, B, C, A. ..</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-349.jpg" alt="" style="width:93pt;height:60pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-350.jpg" alt="" style="width:94pt;height:56pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-351.jpg" alt="" style="width:94pt;height:54pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-352.jpg" alt="" style="width:43pt;height:20pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-353.jpg" alt="" style="width:43pt;height:20pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-354.jpg" alt="" style="width:43pt;height:20pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> Robot fetches page A, follows link, fetches B</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> Robot follows link and fetches page C</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><a name="bookmark1682"></a><span class="font1" style="font-weight:bold;">(c)</span><span class="font0"> Robot follows link and is back to A</span></p></li></ul>
</div><br clear="all"></li></ul>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1681"></a><span class="font23" style="font-style:italic;">Figure 9-2. Crawling over a web of hyperlinks</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">Robots must know where they’ve been to avoid cycles. Cycles can lead to robot traps that can either halt or slow down a robot’s progress.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1683"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1684"></a>Loops and Dups</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Cycles are bad for crawlers for at least three reasons:</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 4pt 19pt;"><span class="font24">• They get the crawler into a loop where it can get stuck. A loop can cause a poorly designed crawler to spin round and round, spending all its time fetching <a name="bookmark1685"></a><a name="bookmark1686"></a>the same pages over and over again. The crawler can burn up lots of network bandwidth and may be completely unable to fetch any other pages.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1687"></a><span class="font24">• While the crawler is fetching the same pages repeatedly, the web server on the other side is getting pounded. If the crawler is well connected, it can overwhelm the web site and prevent any real users from accessing the site. Such denial of service can be grounds for legal claims.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Even if the looping isn’t a problem itself, the crawler is fetching a large number of duplicate pages (often called “dups,” which rhymes with “loops”). The crawler’s application will be flooded with duplicate content, which may make the application useless. An example of this is an Internet search engine that returns hundreds of matches of the exact same page.</span></p></li></ul>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1688"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1689"></a>Trails of Breadcrumbs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Unfortunately, keeping track of where you’ve been isn’t always so easy. At the time of this writing, there are billions of distinct web pages on the Internet, not counting content generated from dynamic gateways.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">If you are going to crawl a big chunk of the world’s web content, you need to be prepared to visit billions of URLs. Keeping track of which URLs have been visited can be quite challenging. Because of the huge number of URLs, you need to use sophisticated data structures to quickly determine which URLs you’ve visited. The data structures need to be efficient in speed and memory use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1690"></a><span class="font24">Speed is important because hundreds of millions of URLs require fast search structures. Exhaustive searching of URL lists is out of the question. At the very least, a robot will need to use a search tree or hash table to be able to quickly determine whether a URL has been visited.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1691"></a><span class="font24">Hundreds of millions of URLs take up a lot of space, too. If the average URL is 40 characters long, and a web robot crawls 500 million URLs (just a small portion of the Web), a search data structure could require 20 GB or more of memory just to hold the URLs (40 bytes per URL </span><span class="font5">× </span><span class="font24">500 million URLs = 20 GB)!</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are some useful techniques that large-scale web crawlers use to manage where they visit:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Trees and hash tables</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Sophisticated robots might use a search tree or a hash table to keep track of visited URLs. These are software data structures that make URL lookup much faster.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Lossy presence bit maps</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">To minimize space, some large-scale crawlers use lossy data structures such as presence bit arrays. Each URL is converted into a fixed size number by a hash function, and this number has an associated “presence bit” in an array. When a <a name="bookmark1692"></a><a name="bookmark1693"></a>URL is crawled, the corresponding presence bit is set. If the presence bit is already set, the crawler assumes the URL has already been crawled.<a name="footnote83"></a><sup><a href="#bookmark1694">83</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Checkpoints</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Be sure to save the list of visited URLs to disk, in case the robot program crashes.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Partitioning</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">As the Web grows, it may become impractical to complete a crawl with a single robot on a single computer. That computer may not have enough memory, disk space, computing power, or network bandwidth to complete a crawl.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1695"></a><span class="font24">Some large-scale web robots use “farms” of robots, each a separate computer, working in tandem. Each robot is assigned a particular “slice” of URLs, for which it is responsible. Together, the robots work to crawl the Web. The individual robots may need to communicate to pass URLs back and forth, to cover for malfunctioning peers, or to otherwise coordinate their efforts.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">A good reference book for implementing huge data structures is </span><span class="font24" style="font-style:italic;">Managing Gigabytes: Compressing and Indexing Documents and Images</span><span class="font24">, by Witten, et. al (Morgan Kaufmann). This book is full of tricks and techniques for managing large amounts of data.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1696"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1697"></a>Aliases and Robot Cycles</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Even with the right data structures, it is sometimes difficult to tell if you have visited a page before, because of URL “aliasing.” Two URLs are </span><span class="font24" style="font-style:italic;">aliases</span><span class="font24"> if the URLs look different but really refer to the same resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1698"><span class="font24">Table 9-1 </span></a><span class="font24">illustrates a few simple ways that different URLs can point to the same resource.</span></p>
<table>
<tr><td>
<p><a name="bookmark1698"></a><span class="font23" style="font-style:italic;">Table 9-1. Different URLs that alias to the same documents</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">First URL</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Second URL</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font2" style="font-weight:bold;">When aliased</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">a</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/bar.html"><span class="font3" style="font-style:italic;">http://www.foo.com/bar.html</span></a></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><a href="http://www.foo.com:80/bar"><span class="font3" style="font-style:italic;">http://www.foo.com:80/bar</span></a><span class="font3" style="font-style:italic;"> html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">Port is 80 by default</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">b</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/~fred"><span class="font3" style="font-style:italic;">http://www.foo.com/~fred</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><a href="http://www.foo.com/%7Ffred"><span class="font3" style="font-style:italic;">http://www.foo.com/%7Ffred</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font2">%7F is same as ~</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">c</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/x"><span class="font3" style="font-style:italic;">http://www.foo.com/x</span></a><span class="font3" style="font-style:italic;"> html#early</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><a href="http://www.foo.com/x"><span class="font3" style="font-style:italic;">http://www.foo.com/x</span></a><span class="font3" style="font-style:italic;"> html#middle</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">Tags don’t change the page</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">d</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/readme.htm"><span class="font3" style="font-style:italic;">http://www.foo.com/readme.htm</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><a href="http://www.foo.com/README.HTM"><span class="font3" style="font-style:italic;">http://www.foo.com/README.HTM</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font2">Case-insensitive server</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">e</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/"><span class="font3" style="font-style:italic;">http://www.foo.com/</span></a></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><a href="http://www.foo.com/index.html"><span class="font3" style="font-style:italic;">http://www.foo.com/index.html</span></a></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">Default page is </span><span class="font3" style="font-style:italic;">index.html</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">f</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a href="http://www.foo.com/index.html"><span class="font3" style="font-style:italic;">http://www.foo.com/index.html</span></a></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><a href="http://209.231.87.45/index.html"><span class="font3" style="font-style:italic;">http://209.231.87.45/index.html</span></a></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><a href="http://www.foo.com"><span class="font3" style="font-style:italic;">www.foo.com</span></a><span class="font2"> has this IP address</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1699"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1700"></a><a name="bookmark1701"></a>Canonicalizing URLs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Most web robots try to eliminate the obvious aliases up front by “canonicalizing” URLs into a standard form. A robot might first convert every URL into a canonical form, by:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">1. Adding “:80” to the hostname, if the port isn’t specified</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">2. Converting all </span><span class="font4">%xx </span><span class="font24">escaped characters into their character equivalents</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">3. Removing </span><span class="font4"># </span><span class="font24">tags</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">These steps can eliminate the aliasing problems shown in </span><a href="#bookmark1698"><span class="font24">Table 9-1</span></a><span class="font24">a–c. But, without knowing information about the particular web server, the robot doesn’t have any good way of avoiding the duplicates from </span><a href="#bookmark1698"><span class="font24">Table 9-1</span></a><span class="font24">d–f:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The robot would need to know whether the web server was case-insensitive to avoid the alias in </span><a href="#bookmark1698"><span class="font24">Table 9-1</span></a><span class="font24">d.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1702"></a><span class="font24">• The robot woul<a name="bookmark1703"></a>d need to know the web server’s index-page configuration for this directory to know whether the URLs in</span><a href="#bookmark1698"><span class="font24"> Table 9-1</span></a><span class="font24">e were aliases.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The robot would need to know if the web server was configured to do virtual hosting (covered in </span><a href="#bookmark229"><span class="font24">Chapter 5</span></a><span class="font24">) to know if the URLs in </span><a href="#bookmark1698"><span class="font24">Table 9-1</span></a><span class="font24">f were aliases, even if it knew the hostname and IP address referred to the same physical computer.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">URL canonicalization can eliminate the basic syntactic aliases, but robots will encounter other URL aliases that can’t be eliminated through converting URLs to standard forms.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1704"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1705"></a>Filesystem Link Cycles</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Symbolic links on a filesystem can cause a particularly insidious kind of cycle, because they can create an illusion of an infinitely deep directory hierarchy where none exists. Symbolic link cycles usually are the result of an unintentional error by the server administrator, but they also can be created by “evil webmasters” as a malicious trap for robots.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a href="#bookmark1706"><span class="font24">Figure 9-3 </span></a><span class="font24">shows two filesystems. In</span><a href="#bookmark1706"><span class="font24"> Figure 9-3</span></a><span class="font24">a, </span><span class="font24" style="font-style:italic;">subdir</span><span class="font24"> is a normal directory. In </span><a href="#bookmark1706"><span class="font24">Figure 9-3</span></a><span class="font24">b, </span><span class="font24" style="font-style:italic;">subdir</span><span class="font24"> is a symbolic link pointing back to </span><span class="font24" style="font-style:italic;">/</span><span class="font24">. In both figures, assume the file </span><span class="font24" style="font-style:italic;">/index.html</span><span class="font24"> contains a hyperlink to the file </span><span class="font24" style="font-style:italic;">subdir/index.html</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Using </span><a href="#bookmark1706"><span class="font24">Figure 9-3</span></a><span class="font24">a’s filesystem, a web crawler may take the following actions:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">1.</span><span class="font4"> GET </span><a href="http://www.foo.com/index.html"><span class="font4">http://www.foo.com/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">/index.html</span><span class="font24">, find link to </span><span class="font24" style="font-style:italic;">subdir/index.html</span><span class="font24">.</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">2.</span><span class="font4"> GET </span><a href="http://www.foo.com/subdir/index.html"><span class="font4">http://www.foo.com/subdir/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">subdir/index.html</span><span class="font24">, find link to </span><span class="font24" style="font-style:italic;">subdir/logo.gif</span><span class="font24">.</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">3.</span><span class="font4"> GET </span><a href="http://www.foo.com/subdir/logo.gif"><span class="font4">http://www.foo.com/subdir/logo.gif</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">subdir/logo.gif</span><span class="font24">, no more links, all done.</span></p><img src="book_files/book-355.jpg" alt="" style="width:360pt;height:148pt;">
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1706"></a><span class="font24">But in</span><a href="#bookmark1706"><span class="font24"> Figure 9-3</span></a><span class="font24">b’s filesystem, the following might happen:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">1.</span><span class="font4"> GET </span><a href="http://www.foo.com/index.html"><span class="font4">http://www.foo.com/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">/index.html</span><span class="font24">, find link to </span><span class="font24" style="font-style:italic;">subdir/index.html</span><span class="font24">.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">2.</span><span class="font4"> GET </span><a href="http://www.foo.com/subdir/index.html"><span class="font4">http://www.foo.com/subdir/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">subdir/index.html</span><span class="font24">, but get back same </span><span class="font24" style="font-style:italic;">index.html</span><span class="font24">.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">3.</span><span class="font4"> GET </span><a href="http://www.foo.com/subdir/subdir/index.html"><span class="font4">http://www.foo.com/subdir/subdir/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">subdir/subdir/index.html</span><span class="font24">.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">4.</span><span class="font4"> GET </span><a href="http://www.foo.com/subdir/subdir/subdir/index.html"><span class="font4">http://www.foo.com/subdir/subdir/subdir/index.html</span></a></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Get </span><span class="font24" style="font-style:italic;">subdir/subdir/subdir/index.html</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The problem with</span><a href="#bookmark1706"><span class="font24"> Figure 9-3b</span></a><span class="font24"> is that </span><span class="font24" style="font-style:italic;">subdir/</span><span class="font24"> is a cycle back to </span><span class="font24" style="font-style:italic;">/</span><span class="font24">, but because the URLs look different, the robot doesn’t know from the URL alone that the documents are identical. The unsuspecting robot runs the risk of getting into a loop. Without some kind of loop detection, this cycle will continue, often until the length of the URL exceeds the robot’s or the server’s limits.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1707"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1708"></a>Dynamic Virtual Web Spaces</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">It’s possible for malicious webmasters to intentionally create sophisticated crawler loops to trap innocent, unsuspecting robots. In particular, it’s easy to publish a URL that looks like a normal file but really is a gateway application. This application can whip up HTML on the fly that contains links to imaginary URLs on the same server. When these imaginary URLs are requested, the nasty server fabricates a new HTML page with new imaginary URLs.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The malicious web server can take the poor robot on an Alice-in-Wonderland journey through an infinite virtual web space, even if the web server doesn’t really contain any files. Even worse, it can make it very difficult for the robot to detect the cycle, because the URLs and HTML can look very different each time. </span><a href="#bookmark1709"><span class="font24">Figure 9-4</span></a><span class="font24"> shows an example of a malicious web server generating bogus content.</span></p>
<table>
<tr><td>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">Request message</span></p></td></tr>
<tr><td><img src="book_files/book-356.jpg" alt="" style="width:345pt;height:209pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web robot client</span></p>
<p><a name="bookmark1710"></a><span class="font2">A few sites exist that are just malicious gateway applications, whose sole purpose is to trap unsuspecting robots with bogus content . In this example, the gateway dynamically generates an infinite number of fake web pages, each pointing to the next.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark1709"></a><span class="font23" style="font-style:italic;">Figure 9-4. Malicious dynamic web space example</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">More commonly, well-intentioned webmasters may unwittingly create a crawler trap through symbolic links or dynamic content. For example, consider a CGI-based calendaring program that generates a monthly calendar and a link to the next month. A real user would not keep requesting the next-month link forever, but a robot that is unaware of the dynamic nature of the content might keep requesting these resources indefinitely.<a name="footnote84"></a><sup><a href="#bookmark1711">84</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1712"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1713"></a>Avoiding Loops and Dups</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There is no foolproof way to avoid all cycles. In practice, well-designed robots need to include a set of heuristics to try to avoid cycles.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Generally, the more autonomous a crawler is (less human oversight), the more likely it is to get into trouble. There is a bit of a trade-off that robot implementors need to make—these heuristics can help avoid problems, but they also are somewhat “lossy,” because you can end up skipping valid content that looks suspect.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Some techniques that robots use to behave better in a web full of robot dangers are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Canonicalizing URLs</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Avoid syntactic aliases by converting URLs into standard form.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Breadth-first crawling</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Crawlers have a large set of potential URLs to crawl at any one time. By scheduling the URLs to visit in a breadth-first manner, across web sites, you can minimize the impact of cycles. Even if you hit a robot trap, you still can fetch hundreds of thousands of pages from other web sites before returning to fetch a page from the cycle. If you operate depth-first, diving head-first into a single site, you may hit a cycle and never escape to other sites.<a name="footnote85"></a><sup><a href="#bookmark1714">85</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Throttling<a name="footnote86"></a><sup><a href="#bookmark1715">86</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Limit the number of pages the robot can fetch from a web site in a period of time. If the robot hits a cycle and continually tries to access aliases from a site, you can cap the total number of duplicates generated and the total number of accesses to the server by throttling.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Limit URL size</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The robot may refuse to crawl URLs beyond a certain length (1KB is common). If a cycle causes the URL to grow in size, a length limit will eventually stop the cycle. Some web servers fail when given long URLs, and robots caught in a URL-increasing cycle can cause some web servers to crash. This may make webmasters misinterpret the robot as a denial-of-service attacker.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">As a caution, this technique can certainly lead to missed content. Many sites today use URLs to help manage user state (for example, storing user IDs in the URLs referenced in a page). URL size can be a tricky way to limit a crawl; however, it can provide a great flag for a user to inspect what is happening on a particular site, by logging an error whenever requested URLs reach a certain size.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">URL/site blacklist</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Maintain a list of known sites and URLs that correspond to robot cycles and traps, and avoid them like the plague. As new problems are found, add them to the blacklist.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">This requires human action. However, most large-scale crawlers in production today have some form of a blacklist, used to avoid certain sites because of inherent problems or something malicious in the sites. The blacklist also can be used to avoid certain sites that have made a fuss about being crawled.<a name="footnote87"></a><sup><a href="#bookmark1716">87</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Pattern detection</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Cycles caused by filesystem symlinks and similar misconfigurations tend to follow patterns; for example, the URL may grow with components duplicated. Some robots view URLs with repeating components as potential cycles and refuse to crawl URLs with more than two or three repeated components.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Not all repetition is immediate (e.g., “/subdir/subdir/subdir...”). It’s possible to have cycles of period 2 or other intervals, such as “/subdir/images/subdir/ images/subdir/images/...”. Some robots look for repeating patterns of a few different periods.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Content fingerprinting</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Fingerprinting is a more direct way of detecting duplicates that is used by some of the more sophisticated web crawlers. Robots using content fingerprinting take the bytes in the content of the page and compute a </span><span class="font24" style="font-style:italic;">checksum</span><span class="font24">. This checksum is a compact representation of the content of the page. If a robot ever fetches a page whose checksum it has seen before, the page’s links are not crawled—if the robot has seen the page’s content before, it has already initiated the crawling of the page’s links.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The checksum function must be chosen so that the odds of two different pages having the same checksum are small. Message digest functions such as MD5 are popular for fingerprinting.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Because some web servers dynamically modify pages on the fly, robots sometimes omit certain parts of the web page content, such as embedded links, from the checksum calculation. Still, dynamic server-side includes that customize arbitrary page content (adding dates, access counters, etc.) may prevent duplicate detection.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Human monitoring</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The Web is a wild place. Your brave robot eventually will stumble into a problem that none of your techniques will catch. All production-quality robots must be desig<a name="bookmark1717"></a>ned with diagnostics and logging, so human beings can easily monitor the robot’s progress and be warned quickly if something unusual is happening. In some cases, angry net citizens will highlight the problem for you by sending you nasty email.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Good spider heuristics for crawling datasets as vast as the Web are always works in progress. Rules are built over time and adapted as new types of resources are added to the Web. Good rules are always evolving.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Many smaller, more customized crawlers skirt some of these issues, as the resources (servers, network bandwidth, etc.) that are impacted by an errant crawler are manageable, or possibly even are under the control of the person performing the crawl (such as on an intranet site). These crawlers rely on more human monitoring to prevent problems.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1718"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1719"></a><a name="bookmark88"></a><a name="bookmark1720"></a>Robotic HTTP</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1721"></a><span class="font24">Robots are no different from any other HTTP client program. They too need to abide by the rules of the HTTP specification. A robot that is making HTTP requests and advertising itself as an HTTP/1.1 client needs to use the appropriate HTTP request headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Many robots try to implement the minimum amount of HTTP needed to request the content they seek. This can lead to problems; however, it’s unlikely that this behavior will change anytime soon. As a result, many robots make HTTP/1.0 requests, because that protocol has few requirements.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1722"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1723"></a><a name="bookmark1724"></a>Identifying Request Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1725"></a><span class="font24">Despite the minimum amount of HTTP that robots tend to support, most do implem<a name="bookmark1726"></a>ent and send some identification headers—most notably, the User-Agent HTTP header. It’s recommended that robot implementors send some basic header information to notify the site of the capabilities of the robot, the robot’s identity, and where it originated.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1727"></a><span class="font24">This is useful information both for tracking down the owner of an errant crawler and for giving the server some information about what types of content the robot can handle. Some of the basic identifying headers that robot implementors are encouraged to implement are:</span></p>
<p style="text-align:justify;"><a name="bookmark1728"></a><span class="font24" style="font-style:italic;">User-Agent</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1729"></a><span class="font24">Tells the server the name of the robot making the request.</span></p>
<p><span class="font24" style="font-style:italic;">From</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Provides the email address of the robot’s user/administrator.<a name="footnote88"></a><sup><a href="#bookmark1730">88</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Accept</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Tells the server what media types are okay to send.<a name="footnote89"></a><sup><a href="#bookmark1731">89</a></sup><sup></sup> This can help ensure that the robot receives only content in which it’s interested (text, images, etc.).</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Referer</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">Provides the URL of the document that contains the current request-URL.<a name="footnote90"></a><sup><a href="#bookmark1732">90</a></sup><sup></sup></span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1733"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1734"></a>Virtual Hosting</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Robot implementors need to support the Host header. Given the prevalence of virtual hosting (</span><a href="#bookmark229"><span class="font24">Chapter 5 </span></a><span class="font24">discusses virtually hosted servers in more detail), not including the Host HTTP header in requests can lead to robots identifying the wrong content with a particular URL. HTTP/1.1 requires the use of the Host header for this reason.</span></p>
<p style="text-align:justify;"><span class="font24">Most servers are configured to serve a particular site by default. Thus, a crawler not including the Host header can make a request to a server serving two sites, like those in </span><a href="#bookmark1735"><span class="font24">Figure 9-5 </span></a><span class="font24">(</span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> and </span><a href="http://www.foo.com"><span class="font24" style="font-style:italic;">www.foo.com</span></a><span class="font24">) and, if the server is configured to serve </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> by default (and does not require the Host header), a request for a page on </span><a href="http://www.foo.com"><span class="font24" style="font-style:italic;">www.foo.com</span></a><span class="font24"> can result in the crawler getting content from the Joe’s Hardware site. Worse yet, the crawler will actually think the content from Joe’s Hardware was from </span><a href="http://www.foo.com"><span class="font24" style="font-style:italic;">www.foo.com</span></a><span class="font24">. I am sure you can think of some more unfortunate situations if documents from two sites with polar political or other views were served from the same server.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-357.jpg" alt="" style="width:36pt;height:54pt;"></td><td>
<p><span class="font0">Robot tries to request </span><span class="font1" style="font-style:italic;">/index.html </span><span class="font0">from </span><a href="http://www.foo.com"><span class="font1" style="font-style:italic;">www.foo.com</span></a><span class="font0">, but does not include a Host header.</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Server is configured to serve both sites, but serves Joe’s Hardware by default.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Web robot client</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1736"></a><span class="font1" style="font-style:italic;">Request message</span></p>
<p><a name="bookmark1737"></a><span class="font2">GET /index.html HTTP/1.0</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">User-agent: ShopBot 1.0</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-358.jpg" alt="" style="width:29pt;height:29pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><a href="http://www.joes-hardware.comwww.foo.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.comwww.foo.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 185pt;"><span class="font2">HTTP/1.0 200 OK</span></p>
<p><span class="font2">[...]</span></p>
<p style="padding:0pt 0pt 0pt 185pt;"><span class="font2">&lt;HTML&gt;</span></p>
<p style="padding:0pt 0pt 15pt 185pt;"><span class="font2">&lt;TITLE&gt;Welcome to Joe's Hardware!&lt;/TITLE&gt; [...]</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1735"></a><span class="font23" style="font-style:italic;">Figure 9-5. Example of virtual docroots causing trouble if no Host header is sent with the request</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1738"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1739"></a>Conditional Requests</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Given the enormity of some robotic endeavors, it often makes sense to minimize the amount of content a robot retrieves. As in the case of Internet search-engine robots, with potentially billions of web pages to download, it makes sense to re-retrieve content only if it has changed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Some of these robots implement conditional HTTP requests,<a name="footnote91"></a><sup><a href="#bookmark1740">91</a></sup><sup></sup> comparing timestamps or entity tags to see if the last version that they retrieved has been updated. This is very similar to the way that an HTTP cache checks the validity of the local copy of a previously fetched resource. See</span><a href="#bookmark231"><span class="font24"> Chapter 7</span></a><span class="font24"> for more on how caches validate local copies of resources.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1741"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1742"></a><a name="bookmark1743"></a><a name="bookmark1744"></a><a name="bookmark1745"></a>Response Handling</span></h3>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Because many robots are interested primarily in getting the content requested through simple GET methods, often they don’t do much in the way of response handling. However, robots that use some features of HTTP (such as conditional requests), as well as those that want to better explore and interoperate with servers, need to be able to handle different types of HTTP responses.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1746"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1747"></a>Status codes</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1748"></a><span class="font24">In general, robots should be able to handle at least the common or expected status codes. All robots should understand HTTP status codes such as 200 OK and 404 Not Found. They also should be able to deal with status codes that they don’t explicitly understand based on the general category of response. </span><a href="#bookmark575"><span class="font24">Table 3-2</span></a><span class="font24"> in</span><a href="#bookmark225"><span class="font24"> Chapter 3</span></a><span class="font24"> gives a breakdown of the different status-code categories and their meanings.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">It is important to note that some servers don’t always return the appropriate error codes. Some servers even return 200 OK HTTP status codes with the text body of the message describing an error! It’s hard to do much about this—it’s just something for implementors to be aware of.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1749"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1750"></a>Entities</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Along with information embedded in the HTTP headers, robots can look for information in the entity itself. Meta HTML tags,<a name="footnote92"></a><sup><a href="#bookmark1751">92</a></sup><sup></sup> such as the meta </span><span class="font4">http-equiv </span><span class="font24">tag, are a means for content authors to embed additional information about resources. The </span><span class="font4">http-equiv </span><span class="font24">tag itself is a way for content authors to override certain headers that the server handling their content may serve:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;meta http-equiv=&quot;Refresh&quot; content=&quot;1;URL=index.html&quot;&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This tag instructs the receiver to treat the document as if its HTTP response header contained a Refresh HTTP header with the value “1, URL=index.html”.<a name="footnote93"></a><sup><a href="#bookmark1752">93</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some servers actually parse the contents of HTML pages prior to sending them and include </span><span class="font4">http-equiv </span><span class="font24">directives as headers; however, some do not. Robot implementors may want to scan the HEAD elements of HTML documents to look for </span><span class="font4">http-equiv </span><span class="font24">information. <a name="footnote94"></a><sup><a href="#bookmark1753">94</a></sup><sup></sup></span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1754"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1755"></a>User-Agent Targeting</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1756"></a><span class="font24">Web administrators should keep in mind that many robots will visit their sites and therefore should expect requests from them. Many sites optimize content for various user agents, attempting to detect browser types to ensure that various site features are supported. By doing this, the sites serve error pages instead of content to robots. Performing a text search for the phrase “your browser does not support frames” on some search engines will yield a list of results for error pages that contain that phrase, when in fact the HTTP client was not a browser at all, but a robot.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Site administrators should plan a strategy for handling robot requests. For example, instead of limiting their content development to specific browser support, they can develop catch-all pages for non–feature rich browsers and robots. At a minimum, they should expect robots to visit their sites and not be caught off guard when they do.<a name="footnote95"></a><sup><a href="#bookmark1757">95</a></sup><sup></sup></span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1758"></a><span class="font9" style="font-weight:bold;"><a name="bookmark89"></a><a name="bookmark1759"></a>Misbehaving Robots</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are many ways that wayward robots can cause mayhem. Here are a few mistakes robots can make, and the impact of their misdeeds:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Runaway robots</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Robots issue HTTP requests much faster than human web surfers, and they commonly run on fast computers with fast network links. If a robot contains a programming logic error, or gets caught in a cycle, it can throw intense load against a web server—quite possibly enough to overload the server and deny service to anyone else. All robot authors must take extreme care to design in safeguards to protect against runaway robots.</span></p>
<p><span class="font24" style="font-style:italic;">Stale URLs</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Some robots visit lists of URLs. These lists can be old. If a web site makes a big change in its content, robots may request large numbers of nonexistent URLs. This annoys some web site administrators, who don’t like their error logs filling with access requests for nonexistent documents and don’t like having their web server capacity reduced by the overhead of serving error pages.</span></p>
<p><span class="font24" style="font-style:italic;">Long, wrong URLs</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">As a result of cycles and programming errors, robots may request large, nonsense URLs from web sites. If the URL is long enough, it may reduce the performance of the web server, clutter the web server access logs, and even cause fragile web servers to crash.</span></p>
<p><a name="bookmark1760"></a><span class="font24" style="font-style:italic;">Nosy robots<a name="footnote96"></a><sup><a href="#bookmark1761">96</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Some robots may get URLs that point to private data and make that data easily accessible through Internet search engines and other applications. If the owner of the data didn’t actively advertise the web pages, she may view the robotic publishing as a nuisance at best and an invasion of privacy at worst.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark1762"></a><span class="font24">Usually this happens because a hyperlink to the “private” content that the robot followed already exists (i.e., the content isn’t as secret as the owner thought it was, or the owner forgot to remove a preexisting hyperlink). Occasionally it happens when a robot is very zealous in trying to scavenge the documents on a site, perhaps by fetching the contents of a directory, even if no explicit hyperlink exists. Robot implementors retrieving large amounts of data from the Web should be aware that their robots are likely to retrieve sensitive data at some point—data that the site implementor never intended to be accessible over the Internet. This sensitive data can include password files or even credit card information. Clearly, a mechanism to disregard content once this is pointed out (and remove it from any search index or archive) is important. Malicious search engine and archive users have been known to exploit the abilities of large-scale web crawlers to find content—some search engines, such as Google,<a name="footnote97"></a><sup><a href="#bookmark1763">97</a></sup><sup></sup> actually archive representations of the pages they have crawled, so even if content is removed, it can still be found and accessed for some time.</span></p>
<p><a name="bookmark1764"></a><span class="font24" style="font-style:italic;">Dynamic gateway access</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">Robots don’t always know what they are accessing. A robot may fetch a URL whose content comes from a gateway application. In this case, the data obtained may be special-purpose and may be expensive to compute. Many web site administrators don’t like naïve robots requesting documents that come from gateways.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1765"></a><span class="font9" style="font-weight:bold;"><a name="bookmark90"></a><a name="bookmark1766"></a>Excluding Robots</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The robot community understood the problems that robotic web site access could cause. In 1994, a simple, voluntary technique was proposed to keep robots out of where they don’t belong and provide webmasters with a mechanism to better control their behavior. The standard was named the “Robots Exclusion Standard” but is often just called </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24">, after the file where the access-control information is stored.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The idea of </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> is simple. Any web server can provide an optional file named </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> in the document root of the server. This file contains information about what robots can access what parts of the server. If a robot follows this voluntary</span></p>
<p style="text-align:justify;padding:0pt 0pt 24pt 0pt;"><span class="font24">standard, it will request the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file from the web site before accessing any other resource from that site. For example, the robot in</span><a href="#bookmark1767"><span class="font24"> Figure 9-6 </span></a><span class="font24">wants to download </span><a href="http://www.joes-hardware.com/specials/acetylene-torches.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/specials/acetylene-torches.html</span></a><span class="font24"> from Joe’s Hardware. Before the robot can request the page, however, it needs to check the </span><span class="font24" style="font-style:italic;">robots.txt </span><span class="font24">file to see if it has permission to fetch this page. In this example, the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file does not block the robot, so the robot fetches the page.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-359.jpg" alt="" style="width:29pt;height:44pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web robot client</span></p></td></tr>
</table>
</div><img src="book_files/book-360.jpg" alt="" style="width:27pt;height:37pt;">
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1768"></a><span class="font0">Robot parses the </span><span class="font1" style="font-style:italic;">robots.txt</span><span class="font0"> file and determines if it is allowed to access the </span><span class="font1" style="font-style:italic;">acetylene-torches.html</span><span class="font0"> file.</span></p>
<p style="text-align:justify;"><span class="font0">It is, so it proceeds with the request.</span></p></td><td><img src="book_files/book-361.jpg" alt="" style="width:168pt;height:104pt;"></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1767"></a><span class="font23" style="font-style:italic;">Figure 9-6. Fetching robots.txt and verifying accessibility before crawling the target file</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1769"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1770"></a>The Robots Exclusion Standard</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Robots Exclusion Standard is an ad hoc standard. At the time of this writing, no official standards body owns this standard, and vendors implement different subsets of the standard. Still, some ability to manage robots’ access to web sites, even if imperfect, is better than none at all, and most major vendors and search-engine crawlers implement support for the exclusion standard.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">There are three revisions of the Robots Exclusion Standard, though the naming of the versions is not well defined. We adopt the version numbering shown in</span><a href="#bookmark1771"><span class="font24"> Table 9-2</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1771"></a><span class="font23" style="font-style:italic;">Table 9-2. Robots Exclusion Standard versions</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Version Title and description &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Date</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">0.0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Standard for Robot Exclusion—Martijn Koster’s original </span><span class="font3" style="font-style:italic;">robots.txt</span><span class="font2"> mechanism with Disallow &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;June 1994</span></p>
<p style="text-align:justify;text-indent:43pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">directive</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">1.0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Method for Web Robots Control—Martijn Koster’s IETF draft with additional support for Allow &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nov. 1996</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">2.0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An Extended Standard for Robot Exclusion—Sean Conner’s extension including regex and timing &nbsp;&nbsp;&nbsp;Nov. 1996</span></p>
<p style="text-align:justify;text-indent:43pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">information; not widely supported</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark1772"></a><span class="font24">Most robots today adopt the v0.0 or v1.0 standards. The v2.0 standard is much more complicated and hasn’t been widely adopted. It may never be. We’ll focus on the v1.0 standard here, because it is in wide use and is fully compatible with v0.0.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1773"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1774"></a><a name="bookmark1775"></a>Web Sites and robots.txt Files</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before visiting any URLs on a web site, a robot must retrieve and process the </span><span class="font24" style="font-style:italic;">robots.txt </span><span class="font24">file on the web site, if it is present.<a name="footnote98"></a><sup><a href="#bookmark1776">98</a></sup><sup></sup> There is a single </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> resource for the entire web site defined by the hostname and port number. If the site is virtually hosted, there can be a different </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file for each virtual docroot, as with any other file.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Currently, there is no way to install “local” </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> files in individual subdirectories of a web site. The webmaster is responsible for creating an aggregate </span><span class="font24" style="font-style:italic;">robots.txt </span><span class="font24">file that describes the exclusion rules for all content on the web site.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1777"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1778"></a>Fetching robots.txt</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1779"></a><span class="font24">Robots fetch the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> resource using the HTTP GET method, like any other file on the web server. The server returns the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file, if present, in a text/plain body. If the server responds with a 404 Not Found HTTP status code, the robot can assume that there are no robotic access restrictions and that it can request any file.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Robots should pass along identifying information in the From and User-Agent headers to help site administrators track robotic accesses and to provide contact information in the event that the site administrator needs to inquire or complain about the robot. Here’s an example HTTP crawler request from a commercial web robot:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET /robots.txt HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: Slurp/2.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 14pt 0pt;"><span class="font3">Date: Wed Oct 3 20:22:48 EST 2001</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1780"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1781"></a>Response codes</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many web sites do not have a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> resource, but the robot doesn’t know that. It must attempt to get the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> resource from every site. The robot takes different actions depending on the result of the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> retrieval:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• If the server responds with a success status (HTTP status code 2XX), the robot must parse the content and apply the exclusion rules to fetches from that site.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• If the server response indicates the resource does not exist (HTTP status code 404), the robot can assume that no exclusion rules are active and that access to the site is not restricted by </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1782"></a><span class="font24">• If the server response indicates access restrictions (HTTP status code 401 or 403) the robot should regard access to the site as completely restricted.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the request attempt results in temporary failure (HTTP status code 503), the robot should defer visits to the site until the resource can be retrieved.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">• If the server response indicates redirection (HTTP status code 3XX), the robot should follow the redirects until the resource is found.</span></p></li></ul>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1783"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1784"></a><a name="bookmark1785"></a>robots.txt File Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file has a very simple, line-oriented syntax. There are three types of lines in a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file: blank lines, comment lines, and rule lines. Rule lines look like HTTP headers (&lt;</span><span class="font24" style="font-style:italic;">Field</span><span class="font24">&gt;: &lt;</span><span class="font24" style="font-style:italic;">value</span><span class="font24">&gt;) and are used for pattern matching. For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># this robots.txt file allows Slurp &amp;&nbsp;Webcrawler to crawl</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3"># the public parts of our site, but no other robots...</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: slurp</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: webcrawler</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Disallow: /private</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: <a name="footnote99"></a><sup><a href="#bookmark1786">99</a></sup></span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Disallow:</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The lines in a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file are logically separated into “records.” Each record describes a set of exclusion rules for a particular set of robots. This way, different exclusion rules can be applied to different robots.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1787"></a><span class="font24">Each record consists of a set of rule lines, terminated by a blank line or end-of-file character. A record starts with one or more User-Agent lines, specifying which robots are affected by this record, followed by Disallow and Allow lines that say what URLs these robots can access.<sup><a href="#bookmark1786">99</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The previous example shows a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file that allows the </span><span class="font24" style="font-style:italic;">Slurp</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">Webcrawler </span><span class="font24">robots to access any file except those files in the </span><span class="font24" style="font-style:italic;">private</span><span class="font24"> subdirectory. The same file also prevents any other robots from accessing anything on the site.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Let’s look at the User-Agent, Disallow, and Allow lines.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1788"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1789"></a>The User-Agent line</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Each robot’s record starts with one or more User-Agent lines, of the form:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">User-Agent: &lt;robot-name&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">or:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">User-Agent: <sup><a href="#bookmark1786">99</a></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The robot name (chosen by the robot implementor) is sent in the User-Agent header of the robot’s HTTP GET request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1790"></a><span class="font24">When a robot processes a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file, it must obey the record with either:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• The first robot name that is a case-insensitive substring of the robot’s name</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• The first robot name that is “<a name="footnote100"></a><sup><a href="#bookmark1791">100</a></sup>”</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the robot can’t find a User-Agent line that matches its name, and can’t find a wild-carded “User-Agent: <sup><a href="#bookmark1791">100</a></sup>” line, no record matches, and access is unlimited.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Because the robot name matches case-insensitive substrings, be careful about false matches. For example, “User-Agent: bot” matches all the robots named </span><span class="font24" style="font-style:italic;">Bot</span><span class="font24">, </span><span class="font24" style="font-style:italic;">Robot</span><span class="font24">, </span><span class="font24" style="font-style:italic;">Bottom-Feeder</span><span class="font24">, </span><span class="font24" style="font-style:italic;">Spambot</span><span class="font24">, and </span><span class="font24" style="font-style:italic;">Dont-Bother-Me</span><span class="font24">.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1792"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1793"></a>The Disallow and Allow lines</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Disallow and Allow lines immediately follow the User-Agent lines of a robot exclusion record. They describe which URL paths are explicitly forbidden or explicitly allowed for the specified robots.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The robot must match the desired URL against </span><span class="font24" style="font-style:italic;">all</span><span class="font24"> of the Disallow and Allow rules for the exclusion record, in order. The first match found is used. If no match is found, the URL is allowed.<sup><a href="#bookmark1791">100</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For an Allow/Disallow line to match a URL, the rule path must be a case-sensitive prefix of the URL path. For example, “Disallow: /tmp” matches all of these URLs:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><a href="http://www.joes-hardware.com/tmp"><span class="font3">http://www.joes-hardware.com/tmp</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><a href="http://www.joes-hardware.com/tmp/"><span class="font3">http://www.joes-hardware.com/tmp/</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><a href="http://www.joes-hardware.com/tmp/pliers.html"><span class="font3">http://www.joes-hardware.com/tmp/pliers.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><a href="http://www.joes-hardware.com/tmpspc/stuff.txt"><span class="font3">http://www.joes-hardware.com/tmpspc/stuff.txt</span></a></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1794"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1795"></a>Disallow/Allow prefix matching</span></h4>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here are a few more details about Disallow/Allow prefix matching:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Disallow and Allow rules require case-sensitive prefix matches. The asterisk has no special meaning (unlike in User-Agent lines), but the universal wildcarding effect can be obtained from the empty string.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Any “escaped” characters (%XX) in the rule path or the URL path are unescaped back into bytes before comparison (with the exception of %2F, the forward slash, which must match exactly).</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• If the rule path is the empty string, it matches everything.</span></p></li></ul>
<p style="padding:0pt 0pt 5pt 0pt;"><a href="#bookmark1796"><span class="font24">Table 9-3 </span></a><span class="font24">lists several examples of matching between rule paths and URL paths.</span></p>
<table>
<tr><td>
<p><a name="bookmark1796"></a><span class="font23" style="font-style:italic;">Table 9-3. Robots.txt path matching examples</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Rule path</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">URL path</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2" style="font-weight:bold;">Match?</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Comments</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">/tmp</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/tmp</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Rule path == URL path</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">/tmp</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/tmpfile.html</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Rule path is a prefix of URL path</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">/tmp</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/tmp/a html</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Rule path is a prefix of URL path</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">/tmp/</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/tmp</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font15">✗</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/tmp/</span><span class="font2"> is not a prefix of </span><span class="font3" style="font-style:italic;">/tmp</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">README.TXT</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Empty rule path matches everything</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">/~fred/hi.html</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">%7Efred/hi.html</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">%7E is treated the same as ~</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">/%7Efred/hi.html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/~fred/hi.html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">%7E is treated the same as ~</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">/%7efred/hi.html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">/%7Efred/hi.html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font15">✓</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Case isn’t significant in escapes</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark1797"></a><span class="font3" style="font-style:italic;">/~fred/hi.html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3" style="font-style:italic;">~fred%2Fhi html</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font15">✗</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">%2F is slash, but slash is a special case that must match exactly</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Prefix matching usually works pretty well, but there are a few places where it is not expressive enough. If there are particular subdirectories for which you also want to disallow crawling, regardless of what the prefix of the path is, </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> provides no m<a name="bookmark1798"></a>eans for this. For example, you might want to avoid crawling of RCS version control subdirectories. Version 1.0 of the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> scheme provides no way to support this, other than separately enumerating every path to every RCS subdirectory.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1799"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1800"></a>Other robots.txt Wisdom</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are some other rules with respect to parsing the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file may contain fields other than User-Agent, Disallow, and Allow, as the specification evolves. A robot should ignore any field it doesn’t understand.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1801"></a><span class="font24">• For backward compatibility, breaking of lines is not allowed.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Comments are allowed anywhere in the file; they consist of optional whitespace, followed by a comment character (</span><span class="font4">#</span><span class="font24">) followed by the comment, until the end-of-line character.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Version 0.0 of the Robots Exclusion Standard didn’t support the Allow line. Some robots implement only the Version 0.0 specification and ignore Allow lines. In this situation, a robot will behave conservatively, not retrieving URLs that are permitted.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1802"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1803"></a>Caching and Expiration of robots.txt</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">If a robot had to refetch a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file before every file access, it would double the load on web servers, as well as making the robot less efficient. Instead, robots are expected to fetch the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file periodically and cache the results. The cached copy of </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> should be used by the robot until the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file expires. Standard HTTP cache-control mechanisms are used by both the origin server and robots to control the caching of the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file. Robots should take note of Cache-Control and Expires headers in the HTTP response.<a name="footnote101"></a><sup><a href="#bookmark1804">101</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Many production crawlers today are not HTTP/1.1 clients; webmasters should note that those crawlers will not necessarily understand the caching directives provided for the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1805"></a><span class="font24">If no Cache-Control directives are present, the draft specification allows caching for seven days. But, in practice, this often is too long. Web server administrators who did not know about </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> often create one in response to a robotic visit, but if the lack of a </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file is cached for a week, the newly created </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file will appear to have no effect, and the site administrator will accuse the robot administrator of not adhering to the Robots Exclusion Standard.<a name="footnote102"></a><sup><a href="#bookmark1806">102</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1807"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1808"></a>Robot Exclusion Perl Code</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A few publicly available Perl libraries exist to interact with </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> files. One example is the WWW::RobotsRules module available for the CPAN public Perl archive.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The parsed </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file is kept in the WWW::RobotRules object, which provides methods to check if access to a given URL is prohibited. The same WWW:: RobotRules object can parse multiple </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> files.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Here are the primary methods in the WWW::RobotRules API:</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">Create RobotRules object</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">$rules = WWW::RobotRules-&gt;new($robot_name);</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">Load the robots.txt file</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">$rules-&gt;parse($url, $content, $fresh_until);</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24" style="font-style:italic;">Check if a site URL is fetchable</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">$can_fetch = $rules-&gt;allowed($url);</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Here’s a short Perl program that demonstrates the use of WWW::RobotRules:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">require WWW::RobotRules;</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># Create the RobotRules object, naming the robot &quot;SuperRobot&quot;</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">my $robotsrules = new WWW::RobotRules 'SuperRobot/1.0';</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">use LWP::Simple qw(get);</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># Get and parse the robots.txt file for Joe's Hardware, accumulating the rules</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">$url = &quot;</span><a href="http://www.joes-hardware.com/robots.txt"><span class="font3">http://www.joes-hardware.com/robots.txt</span></a><span class="font3">&quot;;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">my $robots_txt = get $url;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">$robotsrules-&gt;parse($url, $robots_txt);</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:19pt;"><a name="bookmark1809"></a><span class="font3"># Get and parse the robots.txt file for Mary's Antiques, accumulating the rules</span></p></li></ul>
<p style="text-indent:19pt;"><span class="font3">$url = &quot;</span><a href="http://www.marys-antiques.com/robots.txt"><span class="font3">http://www.marys-antiques.com/robots.txt</span></a><span class="font3">&quot;;</span></p>
<p style="text-indent:19pt;"><span class="font3">my $robots_txt = get $url;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">$robotsrules-&gt;parse($url, $robots_txt);</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:19pt;"><span class="font3"># Now RobotRules contains the set of robot exclusion rules for several</span></p></li>
<li>
<p style="text-indent:19pt;"><span class="font3"># different sites. It keeps them all separate. Now we can use RobotRules</span></p></li>
<li>
<p style="text-indent:19pt;"><span class="font3"># to test if a robot is allowed to access various URLs.</span></p></li></ul>
<p style="text-indent:19pt;"><span class="font3">if ($robotsrules-&gt;allowed($some_target_url))</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-indent:31pt;"><span class="font3">$c = get $url;</span></p>
<p style="text-indent:31pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">...</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">}</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">The following is a hypothetical </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file for </span><a href="http://www.marys-antiques.com"><span class="font24" style="font-style:italic;">www.marys-antiques.com</span></a><span class="font24">:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">#####################################################################</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># This is the robots.txt file for Mary's Antiques web site</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3"># ####################################################################</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># Keep Suzy's robot out of all the dynamic URLs because it doesn't</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># understand them, and out of all the private data, except for the</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3"># small section Mary has reserved on the site for Suzy.</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: Suzy-Spider</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Disallow: /dynamic</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Allow: /private/suzy-stuff</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Disallow: /private</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># The Furniture-Finder robot was specially designed to understand</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># Mary's antique store's furniture inventory program, so let it</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3"># crawl that resource, but keep it out of all the other dynamic</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3"># resources and out of all the private data.</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: Furniture-Finder</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Allow: /dynamic/check-inventory</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Disallow: /dynamic</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Disallow: /private</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3"># Keep everyone else out of the dynamic gateways and private data.</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: *</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Disallow: /dynamic</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Disallow: /private</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file contains a record for the robot called </span><span class="font24" style="font-style:italic;">SuzySpider</span><span class="font24">, a record for the robot called </span><span class="font24" style="font-style:italic;">FurnitureFinder</span><span class="font24">, and a default record for all other robots. Each record applies a different set of access policies to the different robots:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• The exclusion record for </span><span class="font24" style="font-style:italic;">SuzySpider</span><span class="font24"> keeps the robot from crawling the store inventory gateway URLs that start with </span><span class="font24" style="font-style:italic;">/dynamic</span><span class="font24"> and out of the private user data, except for the section reserved for Suzy.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The record for the </span><span class="font24" style="font-style:italic;">FurnitureFinder</span><span class="font24"> robot permits the robot to crawl the furniture inventory gateway URL. Perhaps this robot understands the format and rules of Mary’s gateway.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• All other robots are kept out of all the dynamic and private web pages, though they can crawl the remainder of the URLs.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1810"><span class="font24">Table 9-4</span></a><span class="font24"> lists some examples for different robot accessibility to the Mary’s Antiques web site.</span></p>
<table>
<tr><td>
<p><a name="bookmark1810"></a><span class="font23" style="font-style:italic;"><a name="bookmark1811"></a>Table 9-4. Robot accessibility to the Mary’s Antiques web site</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">URL</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2" style="font-weight:bold;">SuzySpider</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2" style="font-weight:bold;">FurnitureFinder</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:10pt;"><span class="font2" style="font-weight:bold;">NosyBot</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✓</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/index.html"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/index.html</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✓</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/private/payroll.xls"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/private/payroll.xls</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✗</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/private/suzy-stuff/taxes.txt"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/private/suzy-stuff/taxes.txt</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✗</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/dynamic/buy-stuff?id=3546"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/dynamic/buy-stuff?id=3546</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✗</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a href="http://www.marys-antiques.com/dynamic/check-inventory?kitchen"><span class="font3" style="font-style:italic;">http://www.marys-antiques.com/dynamic/check-inventory?kitchen</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font15">✗</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font15">✓</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font15">✗</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1812"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1813"></a>HTML Robot-Control META Tags</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1814"></a><span class="font24">The </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file allows a site administrator to exclude robots from some or all of a web site. One of the disadvantages of the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> file is that it is owned by the web site administrator, not the author of the individual content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTML page authors have a more direct way of restricting robots from individual pages. They can add robot-control tags to the HTML documents directly. Robots that adhere to the robot-control HTML tags will still be able to fetch the documents, but if a robot exclusion tag is present, they will disregard the documents. For example, an Internet search-engine robot would not include the document in its search index. As with the </span><span class="font24" style="font-style:italic;">robots.txt</span><span class="font24"> standard, participation is encouraged but not enforced.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Robot exclusion tags are implemented using HTML META tags, using the form:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 14pt 0pt;"><span class="font3">&lt;META NAME=&quot;ROBOTS&quot; CONTENT=</span><span class="font3" style="font-style:italic;">directive-list</span><span class="font3">&gt;</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1815"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1816"></a><a name="bookmark1817"></a>Robot META directives</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">There are several types of robot META directives, and new directives are likely to be added over time and as search engines and their robots expand their activities and feature sets. The two most-often-used robot META directives are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">NOINDEX</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Tells a robot not to process the page’s content and to disregard the document (i.e., not include the content in any index or database).</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">&lt;META NAME=&quot;ROBOTS&quot; CONTENT=&quot;NOINDEX&quot;&gt;</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">NOFOLLOW</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Tells a robot not to crawl any outgoing links from the page.</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;META NAME=&quot;ROBOTS&quot; CONTENT=&quot;NOFOLLOW&quot;&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In addition to NOINDEX and NOFOLLOW, there are the opposite INDEX and FOLLOW directives, the NOARCHIVE directive, and the ALL and NONE directives. These robot META tag directives are summarized as follows:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">INDEX</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Tells a robot that it may index the contents of the page.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">FOLLOW</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Tells a robot that it may crawl any outgoing links in the page.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">NOARCHIVE</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Tells a robot that it should not cache a local copy of the page.<a name="footnote103"></a><sup><a href="#bookmark1818">103</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">ALL</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Equivalent to INDEX, FOLLOW.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">NONE</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Equivalent to NOINDEX, NOFOLLOW.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The robot META tags, like all HTML META tags, must appear in the HEAD section of an HTML page:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;html&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;head&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;meta name=&quot;robots&quot; content=&quot;noindex,nofollow&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;title&gt;...&lt;/title&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;/head&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;body&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">...</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">&lt;/body&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/html&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that the “robots” name of the tag and the content are case-insensitive.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You obviously should not specify conflicting or repeating directives, such as:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;meta name=&quot;robots&quot; content=&quot;INDEX,NOINDEX,NOFOLLOW,FOLLOW,FOLLOW&quot;&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">the behavior of which likely is undefined and certainly will vary from robot implementation to robot implementation.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1819"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1820"></a>Search engine META tags</span></h4>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">We just discussed robots META tags, used to control the crawling and indexing activity of web robots. All robots META tags contain the </span><span class="font24" style="font-style:italic;">name=&quot;robots&quot;</span><span class="font24"> attribute.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a name="bookmark1821"></a><span class="font24">Many other types of META tags are available, including those shown in </span><a href="#bookmark1822"><span class="font24">Table 9-5</span></a><span class="font24">. The DESCRIPTION and KEYWORDS META tags are useful for content-indexing search-engine robots.</span></p>
<table>
<tr><td>
<p><a name="bookmark1822"></a><span class="font23" style="font-style:italic;">Table 9-5. Additional META tag directives</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">name=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">content=</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark1823"></a><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">DESCRIPTION</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">&lt;text&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows an author to define a short text summary of the web page. Many search engines look at META DESCRIPTION tags, allowing page authors to specify appropriate short abstracts to describe their web pages.</span></p>
<p style="text-indent:15pt;"><span class="font3">&lt;meta name=&quot;description&quot;</span></p>
<p style="text-indent:23pt;"><span class="font3">content=&quot;Welcome to Mary's Antiques web site&quot;&gt;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark1824"></a><span class="font2">KEYWORDS</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">&lt;comma list&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Associates a comma-separated list of words that describe the web page, to assist in keyword searches.</span></p>
<p style="text-indent:15pt;"><span class="font3">&lt;meta name=&quot;keywords&quot;</span></p>
<p style="text-indent:23pt;"><span class="font3">content=&quot;antiques,mary,furniture,restoration&quot;&gt;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">REVISIT-AFTER <sup>a</sup></span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">&lt;no. days&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Instructs the robot or search engine that the page should be revisited, presumably because it is subject to change, after the specified number of days.</span></p>
<p style="text-indent:15pt;"><span class="font3">&lt;meta name=&quot;revisit-after&quot; content=&quot;10 days&quot;&gt;</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> This directive is not likely to have wide support.</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1825"></a><span class="font9" style="font-weight:bold;"><a name="bookmark91"></a><a name="bookmark1826"></a>Robot Etiquette</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">In 1993, Martijn Koster, a pioneer in the web robot community, wrote up a list of guidelines for authors of web robots. While some of the advice is dated, much of it still is quite useful. Martijn’s original treatise, “Guidelines for Robot Writers,” can be found at </span><a href="http://www.robotstxt.org/wc/guidelines.html"><span class="font24" style="font-style:italic;">http://www.robotstxt.org/wc/guidelines.html</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark1827"><span class="font24">Table 9-6</span></a><span class="font24"> provides a modern update for robot designers and operators, based heavily on the spirit and content of the original list. Most of these guidelines are targeted at World Wide Web robots; however, they are applicable to smaller-scale crawlers too.</span></p>
<table>
<tr><td>
<p><a name="bookmark1827"></a><span class="font23" style="font-style:italic;">Table 9-6. Guidelines for web robot operators</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Guideline</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2" style="font-weight:bold;">(1) Identification</span></p>
<p style="text-indent:7pt;"><span class="font2">Identify Your Robot</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Use the HTTP User-Agent field to tell web servers the name of your robot. This will help administrators understand what your robot is doing. Some robots also include a URL describing the purpose and policies of the robot in the User-Agent header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Identify Your Machine</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Make sure your robot runs from a machine with a DNS entry, so web sites can reverse-DNS the robot IP address into a hostname. This will help the administrator identify the organization responsible for the robot.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Identify a Contact</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Use the HTTP From field to provide a contact email address.</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Guideline</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">(2) Operations</span></p>
<p style="text-indent:7pt;"><span class="font2">Be Alert</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Your robot will generate questions and complaints. Some of this is caused by robots that run astray. You must be cautious and watchful that your robot is behaving correctly. If your robot runs around the clock, you need to be extra careful. You may need to have operations people monitoring the robot 24</span><span class="font4">×</span><span class="font2">7 until your robot is well seasoned.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Be Prepared</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">When you begin a major robotic journey, be sure to notify people at your organization. Your organization will want to watch for network bandwidth consumption and be ready for any public inquiries.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Monitor and Log</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Your robot should be richly equipped with diagnostics and logging, so you can track progress, identify any robot traps, and sanity check that everything is working right. We cannot stress enough the importance of monitoring and logging a robot’s behavior. Problems and complaints will arise, and having detailed logs of a crawler’s behavior can help a robot operator backtrack to what has happened. This is important not only for debugging your errant web crawler but also for defending its behavior against unjustified complaints.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Learn and Adapt</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Each crawl, you will learn new things. Adapt your robot so it improves each time and avoids the common pitfalls.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">(3) Limit Yourself</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Filter on URL</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Ifa URL looks like it refers to data that you don’t understand or are not interested in, you might want to skip it. For example, URLs ending in “.Z”, “.gz”, “.tar”, or “.zip” are likely to be compressed files or archives. URLs ending in “.exe” are likely to be programs. URLs ending in “.gif”, “.tif”, “.jpg” are likely to be images. Make sure you get what you are after.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Filter Dynamic URLs</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Usually, robots don’t want to crawl content from dynamic gateways. The robot won’t know how to properly format and post queries to gateways, and the results are likely to be erratic or transient. If a URL contains “cgi” or has a “?”, the robot may want to avoid crawling the URL.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Filter with Accept Headers</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Your robot should use HTTP Accept headers to tell servers what kind of content it understands.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Adhere to </span><span class="font3" style="font-style:italic;">robots.txt</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Your robot should adhere to the </span><span class="font3" style="font-style:italic;">robots.txt</span><span class="font2"> controls on the site.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Throttle Yourself</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Your robot should count the number of accesses to each site and when they occurred, and use this information to ensure that it doesn’t visit any site too frequently. When a robot accesses a site more frequently than every few minutes, administrators get suspicious. When a robot accesses a site every few seconds, some administrators get angry. When a robot hammers a site as fast as it can, shutting out all other traffic, administrators will be furious.</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">In general, you should limit your robot to a few requests per minute maximum, and ensure a few seconds between each request. You also should limit the total number of accesses to a site, to prevent loops.</span></p></td></tr>
<tr><td colspan="2" style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">(4) Tolerate Loops and Dups and Other Problems</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Handle All Return Codes</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">You must be prepared to handle all HTTP status codes, including redirects and errors. You should also log and monitor these codes. A large number of non-success results on a site should cause investigation. It may be that many URLs are stale, or the server refuses to serve documents to robots.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Canonicalize URLs</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Try to remove common aliases by normalizing all URLs into a standard form.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Aggressively Avoid Cycles</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Work very hard to detect and avoid cycles. Treat the process of operating a crawl as a feedback loop. The results of problems and their resolutions should be fed back into the next crawl, making your crawler better with each iteration.</span></p></td></tr>
</table>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Guideline</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:10pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Monitor for Traps</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Some types of cycles are intentional and malicious. These may be intentionally hard to detect. Monitor for large numbers of accesses to a site with strange URLs. These may be traps.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Maintain a Blacklist</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">When you find traps, cycles, broken sites, and sites that want your robot to stay away, add them to a blacklist, and don’t visit them again.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">(5) Scalability</span></p>
<p style="text-indent:7pt;"><span class="font2">Understand Space</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Work out the math in advance for how large a problem you are solving. You may be surprised how much memory your application will require to complete a robotic task, because of the huge scale of the Web.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Understand Bandwidth</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Understand how much network bandwidth you have available and how much you will need to complete your robotic task in the required time. Monitor the actual usage of network bandwidth. You probably will find that the outgoing bandwidth (requests) is much smaller than the incoming bandwidth (responses). By monitoring network usage, you also may find the potential to better optimize your robot, allowing it to take better advantage of the network bandwidth by better usage of its TCP connections.<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Understand Time</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Understand how long it should take for your robot to complete its task, and sanity check that the progress matches your estimate. If your robot is way off your estimate, there probably is a problem worth investigating.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Divide and Conquer</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">For large-scale crawls, you will likely need to apply more hardware to get the job done, either using big multiprocessor servers with multiple network cards, or using multiple smaller computers working in unison.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">(6) Reliability</span></p>
<p style="text-indent:7pt;"><span class="font2">Test Thoroughly</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Test your robot thoroughly internally before unleashing it on the world. When you are ready to test off-site, run a few, small, maiden voyages first. Collect lots of results and analyze your performance and memory use, estimating how they will scale up to the larger problem.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Checkpoint</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Any serious robot will need to save a snapshot of its progress, from which it can restart on failure. There will be failures: you will find software bugs, and hardware will fail. Large-scale robots can’t start from scratch each time this happens. Design in a checkpoint/restart feature from the beginning.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Fault Resiliency</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><a name="bookmark1828"></a><span class="font2">Anticipate failures, and design your robot to be able to keep making progress when they occur.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2" style="font-weight:bold;">(7) Public Relations</span></p>
<p style="text-indent:7pt;"><span class="font2">Be Prepared</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Your robot probably will upset a number of people. Be prepared to respond quickly to their enquiries. Make a web page policy statement describing your robot, and include detailed instructions on how to create a </span><span class="font3" style="font-style:italic;">robots.txt</span><span class="font2"> file.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Be Understanding</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Some of the people who contact you about your robot will be well informed and supportive; others will be naïve. A few will be unusually angry. Some may well seem insane. It’s generally unproductive to argue the importance of your robotic endeavor. Explain the Robots Exclusion Standard, and if they are still unhappy, remove the complainant URLs immediately from your crawl and add them to the blacklist.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Be Responsive</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">Most unhappy webmasters are just unclear about robots. If you respond immediately and professionally, 90% of the complaints will disappear quickly. On the other hand, if you wait several days before responding, while your robot continues to visit a site, expect to find a very vocal, angry opponent.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3">See </span><a href="#bookmark226"><span class="font3">Chapter 4 </span></a><span class="font3">for more on optimizing TCP performance.</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1829"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1830"></a><a name="bookmark92"></a><a name="bookmark1831"></a>Search Engines</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The most widespread web robots are used by Internet search engines. Internet search engines allow users to find documents about any subject all around the world.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many of the most popular sites on the Web today are search engines. They serve as a starting point for many web users and provide the invaluable service of helping users find the information in which they are interested.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web crawlers feed Internet search engines, by retrieving the documents that exist on the Web and allowing the search engines to create indexes of what words appear in what documents, much like the index at the back of this book. Search engines are the leading source of web robots—let’s take a quick look at how they work.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1832"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1833"></a>Think Big</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When the Web was in its infancy, search engines were relatively simple databases that helped users locate documents on the Web. Today, with the billions of pages accessible on the Web, search engines have become essential in helping Internet users find information. They also have become quite complex, as they have had to evolve to handle the sheer scale of the Web.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With billions of web pages and many millions of users looking for information, search engines have to deploy sophisticated crawlers to retrieve these billions of web pages, as well as sophisticated query engines to handle the query load that millions of users generate.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1834"></a><span class="font24">Think about the task of a production web crawler, having to issue billions of HTTP queries in order to retrieve the pages needed by the search index. If each request took half a second to complete (which is probably slow for some servers and fast for others<a name="footnote104"></a><sup><a href="#bookmark1835">104</a></sup><sup></sup>), that still takes (for 1 billion documents):</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">0.5 seconds </span><span class="font5">× </span><span class="font24">(1,000,000,000) / ((60 sec/day) </span><span class="font5">× </span><span class="font24">(60 min/hour) </span><span class="font5">× </span><span class="font24">(24 hour/day))</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">which works out to roughly 5,700 days if the requests are made sequentially! Clearly, large-scale crawlers need to be more clever, parallelizing requests and using banks of machines to complete the task. However, because of its scale, trying to crawl the entire Web still is a daunting challenge.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1836"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1837"></a>Modern Search Engine Architecture</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Today’s search engines build complicated local databases, called “full-text indexes,” about the web pages around the world and what they contain. These indexes act as a sort of card catalog for all the documents on the Web.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Search-engine crawlers gather up web pages and bring them home, adding them to the full-text index. At the same time, search-engine users issue queries against the full-text index through web search gateways such as HotBot (</span><a href="http://www.hotbot.com"><span class="font24" style="font-style:italic;">http://www.hotbot.com</span></a><span class="font24">) or Google (</span><a href="http://www.google.com"><span class="font24" style="font-style:italic;">http://www.google.com</span></a><span class="font24">). Because the web pages are changing all the time, and because of the amount of time it can take to crawl a large chunk of the Web, the full-text index is at best a snapshot of the Web.</span></p>
<p style="text-align:justify;"><span class="font24">The high-level architecture of a modern search engine is shown in </span><a href="#bookmark1838"><span class="font24">Figure 9-7</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-362.jpg" alt="" style="width:109pt;height:145pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Search engine crawler/indexer</span></p>
<p><span class="font1" style="font-weight:bold;">Web server</span></p>
<p><span class="font0">Crawling and indexing</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-363.jpg" alt="" style="width:43pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">User</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-364.jpg" alt="" style="width:137pt;height:56pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web search &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Full-text index</span></p>
<p><span class="font1" style="font-weight:bold;">gateway &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Web server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-365.jpg" alt="" style="width:47pt;height:69pt;"></td></tr>
<tr><td>
<p><a name="bookmark1839"></a><span class="font1" style="font-weight:bold;">User</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Web server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-366.jpg" alt="" style="width:43pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">User</span></p>
<p><span class="font0">Web search users</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Query engine</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark1838"></a><span class="font23" style="font-style:italic;">Figure 9-7. A production search engine contains cooperating crawlers and query gateways</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1840"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1841"></a>Full-Text Index</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">A full-text index is a database that takes a word and immediately tells you all the documents that contain that word. The documents themselves do not need to be scanned after the index is created.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark1842"><span class="font24">Figure 9-8</span></a><span class="font24"> shows three documents and the corresponding full-text index. The fulltext index lists the documents containing each word.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The word “a” is in documents A and B.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The word “best” is in documents A and C.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The word “drill” is in documents A and B.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The word “routine” is in documents B and C.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The word “the” is in all three documents, A, B, and C.</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-367.jpg" alt="" style="width:106pt;height:53pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">B</span></p></td></tr>
<tr><td><img src="book_files/book-368.jpg" alt="" style="width:106pt;height:104pt;"></td></tr>
</table>
</div></li></ul>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">Word</span></p>
<p style="text-indent:198pt;"><span class="font2">a best buy drill electric fat fire from have into know lose routine the to today tools tragedy turned</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">us</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">we</span></p>
<p style="text-indent:198pt;padding:0pt 0pt 10pt 0pt;"><span class="font2">workmaster</span></p>
<div style="border-left:solid;float:right;writing-mode:horizontal-tb;"><img src="book_files/book-369.jpg" alt="" style="width:29pt;height:215pt;">
</div>
<p style="padding:0pt 0pt 14pt 0pt;"><a name="bookmark1842"></a><span class="font23" style="font-style:italic;"><a name="bookmark1843"></a>Figure 9-8. Three documents and a full-text index</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1844"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1845"></a>Posting the Query</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1846"></a><span class="font24">When a user issues a query to a web search-engine gateway, she fills out an HTML form and her browser sends the form to the gateway, using an HTTP GET or POST request. The gateway program extracts the search query and converts the web UI query into the expression used to search the full-text index.<a name="footnote105"></a><sup><a href="#bookmark1847">105</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a href="#bookmark1848"><span class="font24">Figure 9-9</span></a><span class="font24"> shows a simple user query to the </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> site. The user types “drills” into the search box form, and the browser translates this into a GET request with the query parameter as part of the URL.<a name="footnote106"></a><sup><a href="#bookmark1849">106</a></sup><sup></sup> The Joe’s Hardware web server receives the query and hands it off to its search gateway application, which returns the resulting list of documents to the web server, which in turn formats those results into an HTML page for the user.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1850"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1851"></a>Sorting and Presenting the Results</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Once a search engine has used its index to determine the results of a query, the gateway application takes the results and cooks up a results page for the end user.</span></p>
<p style="text-indent:33pt;padding:0pt 0pt 10pt 0pt;"><span class="font0" style="font-weight:bold;">Welcome to Joe’s Hardware</span></p>
<p style="text-indent:33pt;padding:0pt 0pt 19pt 0pt;"><span class="font1">Search for: </span><span class="font0" style="text-decoration:underline;">drills</span></p>
<p style="padding:0pt 0pt 0pt 75pt;"><span class="font1">Submit</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-370.jpg" alt="" style="width:43pt;height:24pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 2pt 34pt;"><span class="font0">User fills out HTML search form (with a GET action HTTP method) on site in browser and hits Submit</span></p>
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p><a name="bookmark1852"></a><span class="font2">GET /search.html?query=drills HTTP/1.1</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p>
<p><span class="font2">Accept: *</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">User-agent: ShopBot</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;padding:0pt 19pt 12pt 0pt;"><span class="font0">Query: “drills”</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font0">Results: File</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">“BD.html”</span></p></td><td><img src="book_files/book-371.jpg" alt="" style="width:30pt;height:32pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Search gateway</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 178pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="padding:0pt 0pt 0pt 178pt;"><span class="font2">Content-type: text/html</span></p>
<p style="padding:0pt 0pt 5pt 178pt;"><span class="font2">Content-length: 1037</span></p>
<p><span class="font2">&lt;HTML&gt;</span></p>
<p style="padding:0pt 0pt 0pt 178pt;"><span class="font2">&lt;HEAD&gt;&lt;TITLE&gt;Search Results&lt;/TITLE&gt;</span></p>
<p style="padding:0pt 0pt 14pt 178pt;"><span class="font2">&lt;A HREF=/BD.html&gt;Black and Decker Drills&lt;/A&gt; [...]</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1848"></a><span class="font23" style="font-style:italic;">Figure 9-9. Example search query request</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1853"></a><span class="font24">Since many web pages can contain any given word, search engines deploy clever algorithms to try to rank the results. For example, in </span><a href="#bookmark1842"><span class="font24">Figure 9-8</span></a><span class="font24">, the word “best” appears in multiple documents; search engines need to know the order in which they should present the list of result documents in order to present users with the most relevant results. This is called </span><span class="font24" style="font-style:italic;">relevancy ranking</span><span class="font24">—the process of scoring and ordering a list of search results.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">To better aid this process, many of the larger search engines actually use census data collected during the crawl of the Web. For example, counting how many links point to a given page can help determine its popularity, and this information can be used to weight the order in which results are presented. The algorithms, tips from crawling, and other tricks used by search engines are some of their most guarded secrets.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1854"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1855"></a>Spoofing</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Since users often get frustrated when they do not see what they are looking for in the first few results of a search query, the order of search results can be important in finding a site. There is a lot of incentive for webmasters to attempt to get their sites listed near the top of the results sections for the words that they think best describe <a name="bookmark1856"></a><a name="bookmark1857"></a>their sites, particularly if the sites are commercial and are relying on users to find them and use their services.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This desire for better listing has led to a lot of gaming of the search system and has created a constant tug-of-war between search-engine implementors and those seeking to get their sites listed prominently. Many webmasters list tons of keywords (some irrelevant) and deploy fake pages, or </span><span class="font24" style="font-style:italic;">spoofs</span><span class="font24">—even gateway applications that generate fake pages that may better trick the search engines’ relevancy algorithms for particular words.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As a result of all this, search engine and robot implementors constantly have to tweak their relevancy algorithms to better catch these spoofs.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1858"></a><span class="font9" style="font-weight:bold;"><a name="bookmark93"></a><a name="bookmark1859"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information on web clients, refer to:</span></p>
<p style="text-align:justify;"><a href="http://www.robotstxt.org/wc/robots.html"><span class="font24" style="font-style:italic;">http://www.robotstxt.org/wc/robots.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The Web Robots Pages—resources for robot developers, including the registry of Internet Robots.</span></p>
<p><a href="http://www.searchengineworld.com"><span class="font24" style="font-style:italic;">http://www.searchengineworld.com</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Search Engine World—resources for search engines and robots.</span></p>
<p><a href="http://www.searchtools.com"><span class="font24" style="font-style:italic;">http://www.searchtools.com</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Search Tools for Web Sites and Intranets—resources for search tools and robots.</span></p>
<p><a href="http://search.cpan.org/doc/ILYAZ/perl_ste/WWW/RobotRules.pm"><span class="font24" style="font-style:italic;">http://search.cpan.org/doc/ILYAZ/perl_ste/WWW/RobotRules.pm</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RobotRules Perl source.</span></p>
<p><a href="http://www.conman.org/people/spc/robots2.html"><span class="font24" style="font-style:italic;">http://www.conman.org/people/spc/robots2.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">An Extended Standard for Robot Exclusion.</span></p>
<p><span class="font24" style="font-style:italic;">Managing Gigabytes: Compressing and Indexing Documents and Images</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Witten, I., Moffat, A., and Bell, T., Morgan Kaufmann.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><a name="bookmark234"></a><span class="font7" style="font-weight:bold;">CHAPTER 10</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark1860"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1861"></a>HTTP-NG</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1862"></a><span class="font24"><a name="bookmark1863"></a>As this book nears completion, HTTP is celebrating its tenth birthday. And it has been quite an accomplished decade for this Internet protocol. Today, HTTP moves the absolute majority of digital traffic around the world.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1864"></a><span class="font24">But as HTTP grows into its teenage years it faces a few challenges. In some ways, the pace of HTTP adoption has gotten ahead of its design. Today, people are using HTTP as a foundation for many diverse applications, over many different networking technologies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This chapter outlines some of the trends and challenges for the future of HTTP, and a proposal for a next-generation architecture called HTTP-NG. While the working group for HTTP-NG has disbanded and its rapid adoption now appears unlikely, it nonetheless outlines some potential future directions of HTTP.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1865"></a><span class="font9" style="font-weight:bold;"><a name="bookmark95"></a><a name="bookmark1866"></a>HTTP’s Growing Pains</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP originally was conceived as a simple technique for accessing linked multimedia content from distributed information servers. But, over the past decade, HTTP and its derivatives have taken on a much broader role.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP/1.1 now provides tagging and fingerprinting to track document versions, methods to support document uploading and interactions with programmatic gateways, support for multilingual content, security and authentication, caching to reduce traffic, pipelining to reduce latency, persistent connections to reduce startup time and improve bandwidth, and range accesses to implement partial updates. Extensions and derivatives of HTTP have gone even further, supporting document publishing, application serving, arbitrary messaging, video streaming, and foundations for wireless multimedia access. HTTP is becoming a kind of “operating system” for distributed media applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1867"></a><span class="font24">The design of HTTP/1.1, while well considered, is beginning to show some strains as HTTP is used more and more as a unified substrate for complex remote operations. There are at least four areas where HTTP shows some growing pains:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Complexity</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">HTTP is quite complex, and its features are interdependent. It is decidedly painful and error-prone to correctly implement HTTP software, because of the complex, interwoven requirements and the intermixing of connection management, message handling, and functional logic.</span></p>
<p><span class="font24" style="font-style:italic;">Extensibility</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">HTTP is difficult to extend incrementally. There are many legacy HTTP applications that create incompatibilities for protocol extensions, because they contain no technology for autonomous functionality extensions.</span></p>
<p><span class="font24" style="font-style:italic;">Performance</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1868"></a><span class="font24">HTTP has performance inefficiencies. Many of these inefficiencies will become more serious with widespread adoption of high-latency, low-throughput wireless access technologies.</span></p>
<p><span class="font24" style="font-style:italic;">Transport dependence</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">HTTP is designed around a TCP/IP network stack. While there are no restrictions against alternative substacks, there has been little work in this area. HTTP needs to provide better support for alternative substacks for it to be useful as a broader messaging platform in embedded and wireless applications.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1869"></a><span class="font9" style="font-weight:bold;"><a name="bookmark96"></a><a name="bookmark1870"></a>HTTP-NG Activity</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1871"></a><span class="font24">In the summer of 1997, the World Wide Web Consortium launched a special project to investigate and propose a major new version of HTTP that would fix the problems related to complexity, extensibility, performance, and transport dependence. This new HTTP was called HTTP: The Next Generation (HTTP-NG).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">A set of HTTP-NG proposals was presented at an IETF meeting in December 1998. These proposals outlined one possible major evolution of HTTP. This technology has not been widely implemented (and may never be), but HTTP-NG does represent the most serious effort toward extending the lineage of HTTP. Let’s look at HTTP-NG in more detail.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1872"></a><span class="font9" style="font-weight:bold;"><a name="bookmark97"></a><a name="bookmark1873"></a>Modularize and Enhance</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The theme of HTTP-NG can be captured in three words: “modularize and enhance.” Instead of having connection management, message handling, server processing logic, and protocol methods all intermixed, the HTTP-NG working group proposed modularizing the protocol into three layers, illustrated in </span><a href="#bookmark1874"><span class="font24">Figure 10-1</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark1875"></a><span class="font24"><a name="bookmark1876"></a><a name="bookmark1877"></a>• Layer 1, the </span><span class="font24" style="font-style:italic;">message transport layer</span><span class="font24">, focuses on delivering opaque messages between endpoints, independent of the function of the messages. The message transport layer supports various substacks (for example, stacks for wireless environments) and focuses on the problems of efficient message delivery and handling. The HTTP-NG project team proposed a protocol called </span><span class="font24" style="font-style:italic;">WebMUX</span><span class="font24"> for this layer.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Layer 2, the </span><span class="font24" style="font-style:italic;">remote invocation layer</span><span class="font24">, defines request/response functionality where clients can invoke operations on server resources. This layer is independent of message transport and of the precise semantics of the operations. It just provides a standard way of invoking any server operation. This layer attempts to provide an extensible, object-oriented framework more like CORBA, DCOM, and Java RMI than like the static, server-defined methods of HTTP/1.1. The HTTP-NG project team proposed the </span><span class="font24" style="font-style:italic;">Binary Wire Protocol</span><span class="font24"> for this layer.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 9pt 19pt;"><span class="font24">• Layer 3, the </span><span class="font24" style="font-style:italic;">web application layer</span><span class="font24">, provides most of the content-management logic. All of the HTTP/1.1 methods (GET, POST, PUT, etc.), as well as the HTTP/1.1 header parameters, are defined here. This layer also supports other services built on top of remote invocation, such as WebDAV.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td rowspan="2" style="vertical-align:top;">
<p style="padding:12pt 0pt 12pt 99pt;"><span class="font1" style="font-style:italic;">Layer 3</span></p>
<p style="text-align:right;padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-style:italic;">HTTP-NG Layer 2</span></p>
<p style="padding:0pt 0pt 12pt 99pt;"><span class="font1" style="font-style:italic;">Layer 1</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;padding:0pt 0pt 11pt 0pt;"><span class="font2">Web application functions</span></p>
<p style="text-align:center;padding:0pt 0pt 11pt 0pt;"><span class="font2">Remote operation invocation</span></p>
<p style="text-align:center;padding:0pt 0pt 11pt 0pt;"><span class="font2">Message transport</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font1" style="font-style:italic;">Binary Wire Protocol</span></p>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">WebMUX</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:center;padding:5pt 0pt 0pt 0pt;"><span class="font2">Underlying network transport</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:5pt 0pt 0pt 0pt;"><span class="font1" style="font-style:italic;">TCP/IP</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark1874"></a><span class="font23" style="font-style:italic;"><a name="bookmark1878"></a>Figure 10-1. HTTP-NG separates functions into layers</span></p></td></tr>
</table></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Once the HTTP components are modularized, they can be enhanced to provide better performance and richer functionality.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1879"></a><span class="font9" style="font-weight:bold;"><a name="bookmark98"></a><a name="bookmark1880"></a>Distributed Objects</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Much of the philosophy and functionality goals of HTTP-NG borrow heavily from structured, object-oriented, distributed-objects systems such as CORBA and DCOM. Distributed-objects systems can help with extensibility and feature functionality.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">A community of researchers has been arguing for a convergence between HTTP and more sophisticated distributed-objects systems since 1996. For more information about the merits of a distributed-objects paradigm for the Web, check out the early paper from Xerox PARC entitled “Migrating the Web Toward Distributed Objects” (</span><a href="ftp://ftp.parc.xerox.com/pub/ilu/misc/webilu.html"><span class="font24" style="font-style:italic;">ftp://ftp.parc.xerox.com/pub/ilu/misc/webilu.html</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1881"></a><span class="font24">The ambitious philosophy of unifying the Web and distributed objects created resistance to HTTP-NG’s adoption in some communities. Some past distributed-objects systems suffered from heavyweight implementation and formal complexity. The HTTP-NG project team attempted to address some of these concerns in the requirements.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1882"></a><span class="font9" style="font-weight:bold;"><a name="bookmark99"></a><a name="bookmark1883"></a>Layer 1: Messaging</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Let’s take a closer look at the three layers of HTTP-NG, starting with the lowes<a name="bookmark1884"></a>t layer. The message transport layer is concerned with the efficient delivery of messages, independent of the meaning and purpose of the messages. The message transport layer provides an API for messaging, regardless of the actual underlying network stack.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This layer focuses on improving the performance of messaging, including:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Pipelining and batching messages to reduce round-trip latency</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1885"></a><span class="font24">• Reusing connections to reduce latency and improve delivered bandwidth</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Multiplexing multiple message streams in parallel, over the same connection, to optimize shared connections while preventing starvation of message streams</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Efficient message segmentation to make it easier to determine message boundaries</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The HTTP-NG team invested much of its energy into the development of the Web-MUX protocol for layer 1 message transport. WebMUX is a high-performance message protocol that fragments and interleaves messages across a multiplexed TCP connection. We discuss WebMUX in a bit more detail later in this chapter.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1886"></a><span class="font9" style="font-weight:bold;"><a name="bookmark100"></a><a name="bookmark1887"></a>Layer 2: Remote Invocation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1888"></a><span class="font24">The middle layer of the HTTP-NG architecture supports remote method invocation. This layer provides a generic request/response framework where clients invoke operations on server resources. This layer does not concern itself with the implementation and semantics of the particular operations (caching, security, method logic, etc.); it is concerned only with the interface to allow clients to remotely invoke server operations. Many remote method invocation standards already are available (CORBA, DCOM, and Java RMI, to name a few), and this layer is not intended to support every nifty feature of these systems. However, there is an explicit goal to extend the richness of HTTP RMI support from that provided by HTTP/1.1. In particular, there is a goal to provide more general remote procedure call support, in an extensible, object-oriented manner.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The HTTP-NG team proposed the Binary Wire Protocol for this layer. This protocol supports a high-performance, extensible technology for invoking well-described operations on a server and carrying back the results. We discuss the Binary Wire Protocol in a bit more detail later in this chapter.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark1889"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1890"></a><a name="bookmark101"></a><a name="bookmark1891"></a>Layer 3: Web Application</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The web application layer is where the semantics and application-specific logic are performed. The HTTP-NG working group shied away from the temptation to extend the HTTP application features, focusing instead on formal infrastructure.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1892"></a><span class="font24">The web application layer describes a system for providing application-specific services. These services are not monolithic; different APIs may be available for different applications. For example, the web application for HTTP/1.1 would constitute a different application from WebDAV, though they may share some common parts. The HTTP-NG architecture allows multiple applications to coexist at this level, sharing underlying facilities, and provides a mechanism for adding new applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The philosophy of the web application layer is to provide equivalent functionality for HTTP/1.1 and extension interfaces, while recasting them into a framework of extensible distributed objects. You can read more about the web application layer interfaces at </span><a href="http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-larner-nginterfaces-00.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-larner-nginterfaces-00.txt</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1893"></a><span class="font9" style="font-weight:bold;"><a name="bookmark102"></a><a name="bookmark1894"></a>WebMUX</span></h2>
<p style="text-align:justify;"><span class="font24">The HTTP-NG working group has invested much of its energy in the development of the WebMUX standard for message transport. WebMUX is a sophisticated, high-performance message system, where messages can be transported in parallel across a multiplexed TCP connection. Individual message streams, produced and consumed at different rates, can efficiently be packetized and multiplexed over a single or small number of TCP connections (see </span><a href="#bookmark1895"><span class="font24">Figure 10-2</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-372.jpg" alt="" style="width:33pt;height:19pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-373.jpg" alt="" style="width:268pt;height:88pt;"></td><td>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font1" style="font-style:italic;">Message A</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font1" style="font-style:italic;">Message B</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font1" style="font-style:italic;">Message C</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font1" style="font-style:italic;">Message D</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-374.jpg" alt="" style="width:48pt;height:42pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1895"></a><span class="font23" style="font-style:italic;">Figure 10-2. WebMUX can multiplex multiple messages over a single connection</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">Here are some of the significant goals of the WebMUX protocol:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Simple design.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• High performance.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Multiplexing—Multiple data streams (of arbitrary higher-level protocols) can be interleaved dynamically and efficiently over a single connection, without stalling data waiting for slow producers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1896"></a><span class="font24">• Credit-based flow control—Data is produced and consumed at different rates, and senders and receivers have different amounts of memory and CPU resources available. WebMUX uses a “credit-based” flow-control scheme, where receivers preannounce interest in receiving data to prevent resource-scarcity deadlocks.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark1897"></a><span class="font24"><a name="bookmark1898"></a>• Alignment preserving—Data alignment is preserved in the multiplexed stream so that binary data can be sent and processed efficiently.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Rich functionality—The interface is rich enough to support a sockets API.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">You can read more about the WebMUX Protocol at </span><a href="http://www.w3.org/Protocols/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/</span></a><span class="font24" style="font-style:italic;"> MUX/WD-mux-980722.html</span><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1899"></a><span class="font9" style="font-weight:bold;"><a name="bookmark103"></a><a name="bookmark1900"></a>Binary Wire Protocol</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP-NG team proposed the Binary Wire Protocol to enhance how the nextgeneration HTTP protocol supports remote operations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP-NG defines “object types” and assigns each object type a list of methods. Each object type is assigned a URI, so its description and methods can be advertised. In this way, HTTP-NG is proposing a more extensible and object-oriented execution model than that provided with HTTP/1.1, where all methods were statically defined in the servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Binary Wire Protocol carries operation-invocation requests from the client to the server and operation-result replies from the server to the client across a stateful connection. The stateful connection provides extra efficiency.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1901"></a><span class="font24">Request messages contain the operation, the target object, and optional data values. Reply messages carry back the termination status of the operation, the serial number of the matching request (allowing arbitrary ordering of parallel requests and responses), and optional return values. In addition to request and reply messages, this protocol defines several internal control messages used to improve the efficiency and robustness of the connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">You can read more about the Binary Wire Protocol at </span><a href="http://www.w3.org/Protocols/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/</span></a><span class="font24" style="font-style:italic;"> HTTP-NG/1998/08/draft-janssen-httpng-wire-00.txt</span><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1902"></a><span class="font9" style="font-weight:bold;"><a name="bookmark104"></a><a name="bookmark1903"></a>Current Status</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">At the end of 1998, the HTTP-NG team concluded that it was too early to bring the HTTP-NG proposals to the IETF for standardization. There was concern that the industry and community had not yet fully adjusted to HTTP/1.1 and that the significant HTTP-NG rearchitecture to a distributed-objects paradigm would have been extremely disruptive without a clear transition plan.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Two proposals were made:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 20pt;"><a name="bookmark1904"></a><span class="font24">• Instead of attempting to promote the entire HTTP-NG rearchitecture in one step, it was proposed to focus on the WebMUX transport technology. But at the time of this writing, there hasn’t been sufficient interest to establish a WebMUX working group.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 20pt;"><span class="font24">• An effort was launched to investigate whether formal protocol types can be made flexible enough for use on the Web, perhaps using XML. This is especially important for a distributed-objects system that is extensible. This work is still in progress.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">At the time of this writing, no major driving HTTP-NG effort is underway. But, with the ever-increasing use of HTTP, its growing use as a platform for diverse applications, and the growing adoption of wireless and consumer Internet technology, some of the techniques proposed in the HTTP-NG effort may prove significant in HTTP’s teenage years.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1905"></a><span class="font9" style="font-weight:bold;"><a name="bookmark105"></a><a name="bookmark1906"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information about HTTP-NG, please refer to the following detailed specifications and activity reports:</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/HTTP-NG/"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP-NG/</span></a></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">HTTP-NG Working Group (Proposed), W3C Consortium Web Site.</span></p>
<p><a href="http://www.w3.org/Protocols/MUX/WD-mux-980722.html"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/MUX/WD-mux-980722.html</span></a></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“The WebMUX Protocol,” by J. Gettys and H. Nielsen.</span></p>
<p style="padding:0pt 0pt 3pt 20pt;"><a href="http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-janssen-httpng-wire-00.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-janssen-httpng-wire-00.txt</span></a><span class="font24" style="font-style:italic;"> </span><span class="font24">“Binary Wire Protocol for HTTP-NG,” by B. Janssen.</span></p>
<p style="text-align:justify;"><a href="http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-larner-nginterfaces-00.txt"><span class="font24" style="font-style:italic;">http://www.w3.org/Protocols/HTTP-NG/1998/08/draft-larner-nginterfaces-00.txt</span></a></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“HTTP-NG Web Interfaces,” by D. Larner.</span></p>
<p><a href="ftp://ftp.parc.xerox.com/pub/ilu/misc/webilu.html"><span class="font24" style="font-style:italic;">ftp://ftp.parc.xerox.com/pub/ilu/misc/webilu.html</span></a></p>
<p style="text-align:justify;text-indent:20pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">“Migrating the Web Toward Distributed Objects,” by D. Larner.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 3pt 0pt;"><a name="bookmark1907"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1908"></a>PART III</span></h1>
<p style="text-align:right;padding:0pt 0pt 82pt 74pt;"><a name="bookmark106"></a><span class="font12" style="font-weight:bold;"><a name="bookmark107"></a><a name="bookmark219"></a>Identification, Authorization, and Security</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The four chapters in Part III present a suite of techniques and technologies to track identity, enforce security, and control access to content:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark235"><span class="font24">Chapter 11, </span><span class="font24" style="font-style:italic;">Client Identification and Cookies</span></a><span class="font24">, talks about techniques to identify users, so content can be personalized to the user audience.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark236"><span class="font24">Chapter 12, </span><span class="font24" style="font-style:italic;">Basic Authentication</span></a><span class="font24">, highlights the basic mechanisms to verify user identity. This chapter also examines how HTTP authentication interfaces with databases.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark237"><span class="font24">Chapter 13, </span><span class="font24" style="font-style:italic;">Digest Authentication</span></a><span class="font24">, explains digest authentication, a complex proposed enhancement to HTTP that provides significantly enhanced security.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark238"><span class="font24">Chapter 14, </span><span class="font24" style="font-style:italic;">Secure HTTP</span></a><span class="font24">, is a detailed overview of Internet cryptography, digital certificates, and the Secure Sockets Layer (SSL).</span></p></li></ul>
<h1 style="text-align:right;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1909"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1910"></a>CHAPTER 11</span></h1>
<p style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark1911"></a><span class="font11" style="font-weight:bold;"><a name="bookmark1912"></a><a name="bookmark235"></a><a name="bookmark1913"></a><a name="bookmark1914"></a>Client Identification and Cookies</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1915"></a><span class="font24">Web servers may talk to thousands of different clients simultaneously. These servers often need to keep track of who they are talking to, rather than treating all requests as coming from anonymous clients. This chapter discusses some of the technologies that servers can use to identify who they are talking to.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1916"></a><span class="font9" style="font-weight:bold;"><a name="bookmark109"></a><a name="bookmark1917"></a>The Personal Touch</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP began its life as an anonymous, stateless, request/response protocol. A request came from a client, was processed by the server, and a response was sent back to the client. Little information was available to the web server to determine what user sent the request or to keep track of a sequence of requests from the visiting user.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Modern web sites want to provide a personal touch. They want to know more about users on the other ends of the connections and be able to keep track of those users as they browse. Popular online shopping sites like Amazon.com personalize their sites for you in several ways:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Personal greetings</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Welcome messages and page contents are generated specially for the user, to make the shopping experience feel more personal.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Targeted recommendations</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">By learning about the interests of the customer, stores can suggest products that they believe the customer will appreciate. Stores can also run birthday specials near customers’ birthdays and other significant days.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Administrative information on file</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Online shoppers hate having to fill in cumbersome address and credit card forms over and over again. Some sites store these administrative details in a database. Once they identify you, they can use the administrative information on file, making the shopping experience much more convenient.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Session tracking</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">HTTP transactions are stateless. Each request/response happens in isolation. Many web sites want to build up incremental state as you interact with the site (for example, filling an online shopping cart). To do this, web sites need a way to distinguish HTTP transactions from different users.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1918"></a><span class="font24"><a name="bookmark1919"></a><a name="bookmark1920"></a>This chapter summarizes a few of the techniques used to identify users in HTTP. HTTP itself was not born with a rich set of identification features. The early web-site designers (practical folks that they were) built their own technologies to identify users. Each technique has <a name="bookmark1921"></a>its strengths and weaknesses. In this chapter, we’ll discuss the following mechanisms to identify users:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP headers that carry information about user identity</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client IP address tracking, to identify users by their IP addresses</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• User login, using authentication to identify users</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Fat URLs, a technique for embedding identity in URLs</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• Cookies, a powerful but efficient technique for maintaining persistent identity</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1922"></a><span class="font9" style="font-weight:bold;"><a name="bookmark110"></a><a name="bookmark1923"></a>HTTP Headers</span></h2>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1924"><span class="font24">Table 11-1 </span></a><span class="font24">shows the seven HTTP request headers that most commonly carry information about the user. We’ll discuss the first three now; the last four headers are used for more advanced identification techniques that we’ll discuss later.</span></p>
<table>
<tr><td>
<p><a name="bookmark1924"></a><span class="font23" style="font-style:italic;"><a name="bookmark1925"></a>Table 11-1. HTTP headers carry clues about users</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Header name</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2" style="font-weight:bold;">Header type</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">From</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">User’s email address</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">User-Agent</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">User’s browser software</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Referer</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">Page user came from by following link</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Authorization</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">Username and password (discussed later)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Client-ip</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Extension (Request)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">Client’s IP address (discussed later)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">X-Forwarded-For</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Extension (Request)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:23pt;"><span class="font2">Client’s IP address (discussed later)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cookie</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">Extension (Request)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:23pt;"><span class="font2">Server-generated ID label (discussed later)</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The From header contains the user’s email address. Ideally, this would be a viable source of user identification, because each user would have a different email address. However, few browsers send From headers, due to worries of unscrupulous servers collecting email addresses and using them for junk mail distribution. In practice, From headers are sent by automated robots or spiders so that if something goes astray, a webmaster has someplace to send angry email complaints.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1926"></a><span class="font24"><a name="bookmark1927"></a>The User-Agent header tells the server information about the browser the user is using, including the name and version of the program, and often information about the operating system. This sometimes is useful for customizing content to interoperate well with particular browsers and their attributes, but that doesn’t do much to help identify the particular user in any meaningful way. Here are two User-Agent headers, one sent by Netscape Navigator and the other by Microsoft Internet Explorer:</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24" style="font-style:italic;">Navigator 6.2</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 27pt;"><span class="font3">User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.4) Gecko/20011128 Netscape6/6.2.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24" style="font-style:italic;">Internet Explorer 6.01</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1928"></a><span class="font24">The <a name="bookmark1929"></a>Referer header provides the URL of the page the user is coming from. The Ref-erer header alone does not directly identify the user, but it does tell what page the user previously visited. You can use this to better understand user browsing behavior and user interests. For example, if you arrive at a web server coming from a baseball site, the server may infer you are a baseball fan.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1930"></a><span class="font24">The From, User-Agent, and Referer headers are insufficient for dependable identification purposes. The remaining sections discuss more precise schemes to identify particular users.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1931"></a><span class="font9" style="font-weight:bold;"><a name="bookmark111"></a><a name="bookmark1932"></a>Client IP Address</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Early web pioneers tried using the IP address of the client as a form of identification. This scheme works if each user has a distinct IP address, if the IP address seldom (if ever) changes, and if the web server can determine the client IP address for each request. While the client IP address typically is not present in the HTTP headers,<a name="footnote107"></a><sup><a href="#bookmark1933">107</a></sup><sup> </sup>web servers can find the IP address of the other side of the TCP connection carrying the HTTP request. For example, on Unix systems, the </span><span class="font24" style="font-style:italic;">getpeername</span><span class="font24"> function call returns the client IP address of the sending machine:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">status = getpeername(tcp_connection_socket,...);</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unfortunately, using the client IP address to identify the user has numerous weaknesses that limit its effectiveness as a user-identification technology:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Client IP addresses describe only the computer being used, not the user. If multiple users share the same computer, they will be indistinguishable.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Many Internet service providers dynamically assign IP addresses to users when they log in. Each time they log in, they get a different address, so web servers can’t assume that IP addresses will identify a user across login sessions.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark1934"></a><span class="font24"><a name="bookmark1935"></a>• To enhance security and manage scarce addresses, many users browse the Internet through Network Address Translation (NAT) firewalls. These NAT devices obscure the IP addresses of the real clients behind the firewall, converting the actual client IP address into a single, shared firewall IP address (and different port numbers).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 16pt 19pt;"><span class="font24">• HTTP proxies and gateways typically open new TCP connections to the origin server. The web server will see the IP address of the proxy server instead of that of the client. Some proxies attempt to work around this problem by adding special Client-ip or X-Forwarded-For HTTP extension headers to preserve the original IP address (</span><a href="#bookmark1936"><span class="font24">Figure 11-1</span></a><span class="font24">). But not all proxies support this behavior.</span></p>
<table>
<tr><td><img src="book_files/book-375.jpg" alt="" style="width:237pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Proxy server</span></p>
<p><span class="font0">56.41.11.4</span></p>
<p><span class="font0">209.172.34.56</span></p>
<p style="text-align:center;"><span class="font0">Client-ip: 209.172.34.56 X-Forwarded-For: 209.172.34.56</span></p></td></tr>
</table></li></ul>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark1936"></a><span class="font23" style="font-style:italic;">Figure 11-1. Proxies can add extension headers to pass along the original client IP address</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1937"></a><span class="font24">Some web sites still use client IP addresses to keep track of the users between sessions,<a name="bookmark1938"></a> but not many. There are too many places where IP address targeting doesn’t work well.</span></p>
<p style="text-align:justify;padding:0pt 0pt 16pt 0pt;"><span class="font24">A few sites even use client IP addresses as a security feature, serving documents only to users from a particular IP address. While this may be adequate within the confines of an intranet, it breaks down in the Internet, primarily because of the ease with which IP addresses are spoofed (forged). The presence of intercepting proxies in the path also breaks this scheme.</span><a href="#bookmark238"><span class="font24"> Chapter 14</span></a><span class="font24"> discusses much stronger schemes for controlling access to privileged documents.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark1939"></a><span class="font9" style="font-weight:bold;"><a name="bookmark112"></a><a name="bookmark1940"></a>User Login</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Rather than passively trying to guess the identity of a user from his IP address, a web server can explicitly ask the user who he is by requiring him to authenticate (log in) with a username and password.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">To help make web site logins easier, HTTP includes a built-in mechanism to pass username information to web sites, using the WWW-Authenticate and Authorization headers. Once logged in, the browsers continually send this login information with each request to the site, so the information is always available. We’ll discuss this HTTP authentication in much more detail in </span><a href="#bookmark236"><span class="font24">Chapter 12</span></a><span class="font24">, but let’s take a quick look at it now.</span></p>
<p style="text-align:justify;"><span class="font24">If a server wants a user to register before providing access to the site, it can send back an HTTP 401 Login Required response code to the browser. The browser will then display a login dialog box and supply the information in the next request to the browser, using the Authorization header.<a name="footnote108"></a><sup><a href="#bookmark1941">108</a></sup><sup></sup> This is depicted in</span><a href="#bookmark1942"><span class="font24"> Figure 11-2</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(a)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">GET /index.html HTTP/1.0 Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p></td></tr>
<tr><td><img src="book_files/book-376.jpg" alt="" style="width:196pt;height:62pt;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-377.jpg" alt="" style="width:34pt;height:30pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b)</span></p></td></tr>
<tr><td><img src="book_files/book-378.jpg" alt="" style="width:65pt;height:56pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">HTTP/1.0 401 Login Required</span></p>
<p><span class="font2">WWW-authenticate: Basic realm=&quot;Plumbing and Fixtures&quot;</span></p></td></tr>
<tr><td><img src="book_files/book-379.jpg" alt="" style="width:218pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-380.jpg" alt="" style="width:27pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET /index.html HTTP/1.0</span></p>
<p><span class="font2">Host: </span><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a><span class="font2"> Authorization: Basic am910jRmdW4=</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-381.jpg" alt="" style="width:178pt;height:55pt;"></td></tr>
<tr><td>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-382.jpg" alt="" style="width:34pt;height:30pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(d)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">HTTP/1.0 200 OK</span></p>
<p><span class="font2">Content-length: 4342 Content-type: text/html</span></p></td></tr>
<tr><td><img src="book_files/book-383.jpg" alt="" style="width:218pt;height:31pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-384.jpg" alt="" style="width:27pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark1942"></a><span class="font23" style="font-style:italic;">Figure 11-2. Registering username using HTTP authentication headers</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Here’s what’s happening in this figure:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In</span><a href="#bookmark1942"><span class="font24"> Figure 11-2</span></a><span class="font24">a, a browser makes a request from the </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> site.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The site doesn’t know the identity of the user, so in</span><a href="#bookmark1942"><span class="font24"> Figure 11-2</span></a><span class="font24">b, the server requests a login by returning the 401 Login Required HTTP response code and adds the WWW-Authenticate header. This causes the browser to pop up a login dialog box.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Once the user enters a username and a password (to sanity check his identity), the browser repeats the original request. This time it adds an Authorization header, specifying the username and password. The username and password are scrambled, to hide them from casual or accidental network observers.<a name="footnote109"></a><sup><a href="#bookmark1943">109</a></sup><sup></sup></span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Now, the server is aware of the user’s identity.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• For future requests, the browser will automatically issue the stored username and password when asked and will often even send it to the site when not asked. This makes it possible to log in once to a site and have your identity maintained through the session, by having the browser send the Authorization header as a <a name="bookmark1944"></a>token of your identity on each request to the server.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1945"></a><span class="font24">However, logging in to web sites is tedious. As Fred browses from site to site, he’ll need to log in for each site. To make matters worse, it is likely that poor Fred will need to remember different usernames and passwords for different sites. His favorite username, “fred,” will already have been chosen by someone else by the time he visits many sites, and some sites will have different rules about the length and composition of usernames and passwords. Pretty soon, Fred will give up on the Internet and go back to watching Oprah. The next section discusses a solution to this problem.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark1946"></a><span class="font9" style="font-weight:bold;"><a name="bookmark113"></a><a name="bookmark1947"></a>Fat URLs</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Some web sites keep track of user identity by generating special versions of each URL for each user. Typically, a real URL is extended by adding some state information to the start or end of the URL path. As the user browses the site, the web server dynamically generates hyperlinks that continue to maintain the state information in the URLs.</span></p>
<p style="text-align:justify;"><span class="font24">URLs modified to include user state information are called </span><span class="font24" style="font-style:italic;">fat URLs</span><span class="font24">. The following are some example fat URLs used in the Amazon.com e-commerce web site. Each URL is suffixed by a user-unique identification number (002-1145265-8016838, in this case) that helps track a user as she browses the store. </span><span class="font3">...</span></p>
<p style="padding:0pt 0pt 0pt 27pt;"><span class="font3">&lt;a href=&quot;/exec/obidos/tg/browse/-/229220/ref=gr_gifts/</span><span class="font3" style="font-weight:bold;">002-1145265-8016838</span><span class="font3">&quot;&gt;All Gifts&lt;/a&gt;&lt;br&gt;</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font3">&lt; a href=&quot;/exec/obidos/wishlist/ref=gr_pl1_/</span><span class="font3" style="font-weight:bold;">002-1145265-8016838</span><span class="font3">&quot;&gt;Wish List&lt;/a&gt;&lt;br&gt; ...</span></p></li>
<li>
<p style="padding:0pt 0pt 0pt 27pt;"><span class="font3">&lt; a href=&quot;</span><a href="http://s1.amazon.com/exec/varzea/tg/armed-forces/-//ref=gr_af_/002-1145265-8016838%22%3eSalute"><span class="font3">http://s1.amazon.com/exec/varzea/tg/armed-forces/-//ref=gr_af_/</span><span class="font3" style="font-weight:bold;">002-1145265-8016838</span><span class="font3">&quot;&gt;Salute</span></a><span class="font3"> Our Troops&lt;/a&gt;&lt;br&gt;</span></p></li>
<li>
<p style="padding:0pt 0pt 3pt 27pt;"><span class="font3">&lt; a href=&quot;/exec/obidos/tg/browse/-/749188/ref=gr_p4_/</span><span class="font3" style="font-weight:bold;">002-1145265-8016838</span><span class="font3">&quot;&gt;Free Shipping&lt;/a&gt;&lt;br&gt;</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 0pt 27pt;"><a name="bookmark1948"></a><span class="font3">&lt;a href=&quot;/exec/obidos/tg/browse/-/468532/ref=gr_returns/</span><span class="font3" style="font-weight:bold;">002-1145265-8016838</span><span class="font3">&quot;&gt;Easy Returns&lt;/a&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 27pt;"><span class="font3">...</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">You can use fat URLs to tie the independent HTTP transactions with a web server into a single “session” or “visit.” The first time a user visits the web site, a unique ID is generated, it is added to the URL in a server-recognizable way, and the server redirects the client to this fat URL. Whenever the server gets a request for a fat URL, it can look up any incremental state associated with that user ID (shopping carts, profiles, etc.), and it rewrites all outgoing hyperlinks to make them fat, to maintain the user ID.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Fat URLs can be used to identify users as they browse a site. But this technology does have several serious problems. Some of these problems include:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Ugly URLs</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The fat URLs displayed in the browser are confusing for new users.</span></p>
<p><span class="font24" style="font-style:italic;">Can’t share URLs</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The fat URLs contain state information about a particular user and session. If you mail that URL to someone else, you may inadvertently be sharing your accumulated personal information.</span></p>
<p><span class="font24" style="font-style:italic;">Breaks caching</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Generating user-specific versions of each URL means that there are no longer commonly accessed URLs to cache.</span></p>
<p><span class="font24" style="font-style:italic;">Extra server load</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The server needs to rewrite HTML pages to fatten the URLs.</span></p>
<p><a name="bookmark1949"></a><span class="font24" style="font-style:italic;">Escape<a name="bookmark1950"></a> hatches</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">It is too easy for a user to accidentally “escape” from the fat URL session by jumping to another site or by requesting a particular URL. Fat URLs work only if the user strictly follows the premodified links. If the user escapes, he may lose his progress (perhaps a filled shopping cart) and will have to start again.</span></p>
<p><span class="font24" style="font-style:italic;">Not persistent across sessions</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">All information is lost when the user logs out, unless he bookmarks the particular fat URL.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark1951"></a><span class="font9" style="font-weight:bold;"><a name="bookmark114"></a><a name="bookmark1952"></a>Cookies</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Cookies are the best current way to identify users and allow persistent sessions. They don’t suffer many of the problems of the previous techniques, but they often are used in conjunction with those techniques for extra value. Cookies were first developed by Netscape but now are supported by all major browsers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Because cookies are important, and they define new HTTP headers, we’re going to explore them in more detail than we did the previous techniques. The presence of cookies also impacts caching, and most caches and browsers disallow caching of any cookied content. The following sections present more details.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1953"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1954"></a><a name="bookmark1955"></a>Types of Cookies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1956"></a><span class="font24"><a name="bookmark1957"></a>You can classify cookies broadly into two types: session cookies and persistent cookies. A session cookie is a temporary cookie that keeps track of settings and preferences as a user navigates a site. A session cookie is deleted when the user exits the browser. Persistent cookies can live longer; they are stored on disk and survive browser exits and computer restarts. Persistent cookies often are used to retain a configuration profile or login name for a site that a user visits periodically.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark1958"></a><span class="font24">The only difference between session cookies and persistent cookies is when they expire. As we will see later, a cookie is a session cookie if its Discard parameter is set, or if there is no Expires or Max-Age parameter indicating an extended expiration time.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1959"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1960"></a>How Cookies Work</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Cookies are like “Hello, My Name Is” stickers stuck onto users by servers. When a user visits a web site, the web site can read all the stickers attached to the user by that server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The first time the user visits a web site, the web server doesn’t know anything about the user (</span><a href="#bookmark1961"><span class="font24">Figure 11-3</span></a><span class="font24">a). The web server expects that this same user will return again, so it wants to “slap” a unique cookie onto the user so it can identify this user in the future. The cookie contains an arbitrary list of </span><span class="font24" style="font-style:italic;">name=value</span><span class="font24"> information, and it is attached to the user using the Set-Cookie or Set-Cookie2 HTTP response (extension) headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Cookies can contain any information, but they often contain just a unique identification number, generated by the server for tracking purposes. For example, in </span><a href="#bookmark1961"><span class="font24">Figure 11-3</span></a><span class="font24">b, the server slaps onto the user a cookie that says id=“34294”. The server can use this number to look up database information that the server accumulates for its visitors (purchase history, address information, etc.).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1962"></a><span class="font24">However, cookies are not restricted to just ID numbers. Many web servers choose to keep information directly in the cookies. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Cookie: name=&quot;Brian Totty&quot;; phone=&quot;555-1212&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The browser remembers the cookie contents sent back from the server in Set-Cookie or Set-Cookie2 headers, storing the set of cookies in a browser cookie database (think of it like a suitcase with stickers from various countries on it). When the user returns to the same site in the future (</span><a href="#bookmark1961"><span class="font24">Figure 11-3</span></a><span class="font24">c), the browser will select those cookies slapped onto the user by that server and pass them back in a Cookie request header.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1963"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1964"></a>Cookie Jar: Client-Side State</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The basic idea of cookies is to let the browser accumulate a set of server-specific information, and provide this information back to the server each time you visit.</span></p><img src="book_files/book-385.jpg" alt="" style="width:360pt;height:292pt;">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark1961"></a><span class="font24"><a name="bookmark1965"></a><a name="bookmark1966"></a><a name="bookmark1967"></a>Because the browser is responsible for storing the cookie information, this system is called </span><span class="font24" style="font-style:italic;">client-side state</span><span class="font24">. The official name for the cookie specification is the HTTP State Management Mechanism.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1968"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1969"></a>Netscape Navigator cookies</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Different browsers store cookies in different ways. Netscape Navigator stores cookies in a single text file called </span><span class="font24" style="font-style:italic;">cookies.txt</span><span class="font24">. For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:17pt;"><span class="font3"># Netscape HTTP Cookie File</span></p></li>
<li>
<p style="text-indent:17pt;"><span class="font3"># </span><a href="http://www.netscape.com/newsref/std/cookie_spec.html"><span class="font3">http://www.netscape.com/newsref/std/cookie_spec.html</span></a></p></li>
<li>
<p style="text-indent:17pt;"><span class="font3"># This is a generated file! Do not edit.</span></p></li>
<li>
<p style="text-indent:17pt;"><span class="font3">#</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font3"># domain</span></p></td><td style="vertical-align:top;">
<p><span class="font3">allh</span></p></td><td style="vertical-align:top;">
<p><span class="font3">path</span></p></td><td style="vertical-align:top;">
<p><span class="font3">secure</span></p></td><td style="vertical-align:top;">
<p><span class="font3">expires</span></p></td><td style="vertical-align:top;">
<p><span class="font3">name</span></p></td><td style="vertical-align:top;">
<p><span class="font3">value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a href="http://www.fedex.com"><span class="font3">www.fedex.com</span></a></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1136109676</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">cc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/us/</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">.bankofamericaonline.com</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">TRUE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1009789256</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">state</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">CA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">.cnn.com</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">TRUE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1035069235</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">SelEdition</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">www</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">secure.eepulse.net</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/eePulse</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1007162968</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">cid</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">%FE%FF%002</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a href="http://www.reformamt.org"><span class="font3">www.reformamt.org</span></a></p></td><td style="vertical-align:bottom;">
<p><span class="font3">TRUE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">/forum</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1033761379</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">LastVisit</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">1003520952</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a href="http://www.reformamt.org"><span class="font3">www.reformamt.org</span></a></p></td><td style="vertical-align:top;">
<p><span class="font3">TRUE</span></p></td><td style="vertical-align:top;">
<p><span class="font3">/forum</span></p></td><td style="vertical-align:top;">
<p><span class="font3">FALSE</span></p></td><td style="vertical-align:top;">
<p><span class="font3">1033761379</span></p></td><td style="vertical-align:top;">
<p><span class="font3">UserName</span></p></td><td style="vertical-align:top;">
<p><span class="font3">Guest</span></p></td></tr>
</table></li></ul>
<p><span class="font24">Each line of the text file represents a cookie. There are seven tab-separated fields: </span><span class="font24" style="font-style:italic;">domain</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The domain of the cookie</span></p>
<p><span class="font24" style="font-style:italic;">allh</span></p>
<p style="text-indent:19pt;"><span class="font24">Whether all hosts in a domain get the cookie, or only the specific host named </span><span class="font24" style="font-style:italic;">path</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The path prefix in the domain associated with the cookie</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark1970"></a><span class="font24" style="font-style:italic;">secure</span></p>
<p style="text-indent:19pt;"><span class="font24">Whether we should send this cookie only if we have an SSL connection </span><span class="font24" style="font-style:italic;">expiration</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The cookie expiration date in seconds since Jan 1, 1970 00:00:00 GMT</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24" style="font-style:italic;">name</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The name of the cookie variable</span></p>
<p><span class="font24" style="font-style:italic;">value</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 14pt 0pt;"><span class="font24">The value of the cookie variable</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1971"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1972"></a>Microsoft Internet Explorer cookies</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1973"></a><span class="font24">Microsoft Internet Explorer stores cookies in individual text files in the cache directory. You can browse this directory to view the cookies, as shown in </span><a href="#bookmark1974"><span class="font24">Figure 11-4</span></a><span class="font24">. The format of the Internet Explorer cookie files is proprietary, but many of the fields are easily understood. Each cookie is stored one after the other in the file, and each cookie consists of multiple lines.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The first line of each cookie in the file contains the cookie variable name. The next line is the variable value. The third line contains the domain and path. The remaining lines are proprietary data, presumably including dates and other flags.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1975"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1976"></a>Different Cookies for Different Sites</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A browser can have hundreds or thousands of cookies in its internal cookie jar, but browsers don’t send every cookie to every site. In fact, they typically send only two or three cookies to each site. Here’s why:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Moving all those cookie bytes would dramatically slow performance. Browsers would actually be moving more cookie bytes than real content bytes!</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Most of these cookies would just be unrecognizable gibberish for most sites, because they contain server-specific name/value pairs.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Sending all cookies to all sites would create a potential privacy concern, with sites you don’t trust getting information you intended only for another site.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font0">Can open MSIE cookies in a text viewer program</span></p></td></tr>
<tr><td><img src="book_files/book-386.jpg" alt="" style="width:156pt;height:158pt;"></td></tr>
<tr><td>
<p><a name="bookmark1977"></a><span class="font0">MSIE stores cookies in the same location as other cached objects</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-387.jpg" alt="" style="width:103pt;height:235pt;">
<p><span class="font1" style="font-weight:bold;">Cookie</span></p>
<p><span class="font1" style="font-weight:bold;">Cookie</span></p></td><td>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font0">Name = “session-id”</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font0">Value = “002-9351993-5692007”</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font0">Domain/path = “amazon.com”</span></p>
<p><span class="font0">Proprietary format for other attributes</span></p>
<p><span class="font0">Each cookie file has cookies for a particular site; the cookies are stored in text lines, one after the other</span></p></td></tr>
</table>
</div><br clear="all"></li></ul>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark1974"></a><span class="font23" style="font-style:italic;">Figure 11-4. Internet Explorer cookies are stored in individual text files in the cache directory</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In general, a browser sends to a server only those cookies that the server generated. Cookies generated by </span><span class="font24" style="font-style:italic;">joes-hardware.com</span><span class="font24"> are sent to </span><span class="font24" style="font-style:italic;">joes-hardware.com</span><span class="font24"> and not to </span><span class="font24" style="font-style:italic;">bobs-books.com</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">marys-movies.com</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark1978"></a><span class="font24">Many web sites contract with third-party vendors to manage advertisements. These advertisements are made to look like they are integral parts of the web site and do push persistent cookies. When the user goes to a different web site serviced by the same advertisement company, the persistent cookie set earlier is sent back again by the browser (because the domains match). A marketing company could use this technique, combined with the Referer header, to potentially build an exhaustive data set of user profiles and browsing habits. Modern browsers allow you to configure privacy settings to restrict third-party cookies.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1979"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1980"></a>Cookie Domain attribute</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A server generating a cookie can control which sites get to see that cookie by adding a Domain attribute to the Set-Cookie response header. For example, the following HTTP response header tells the browser to send the cookie user=“mary17” to any site in the domain </span><span class="font24" style="font-style:italic;">.airtravelbargains.com</span><span class="font24">:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 6pt 0pt;"><span class="font3">Set-cookie: user=&quot;mary17&quot;; domain=&quot;airtravelbargains.com&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1981"></a><span class="font24">If the user visits </span><a href="http://www.airtravelbargains.com"><span class="font24" style="font-style:italic;">www.airtravelbargains.com</span></a><span class="font24">, </span><span class="font24" style="font-style:italic;">specials.airtravelbargains.com</span><span class="font24">, or any site ending in </span><span class="font24" style="font-style:italic;">.airtravelbargains.com</span><span class="font24">, the following Cookie header will be issued:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 14pt 0pt;"><span class="font3">Cookie: user=&quot;mary17&quot;</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1982"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1983"></a>Cookie Path attribute</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The cookie specification even lets you associate cookies with </span><span class="font24" style="font-style:italic;">portions</span><span class="font24"> of web sites. This is done using the Path attribute, which indicates the URL path prefix where each cookie is valid.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, one web server might be shared between two organizations, each having separate cookies. The site </span><a href="http://www.airtravelbargains.com"><span class="font24" style="font-style:italic;">www.airtravelbargains.com</span></a><span class="font24"> might devote part of its web site to auto rentals—say, </span><a href="http://www.airtravelbargains.com/autos/%e2%80%94using"><span class="font24" style="font-style:italic;">http://www.airtravelbargains.com/autos/</span><span class="font24">—using</span></a><span class="font24"> a separate cookie to keep track of a user’s preferred car size. A special auto-rental cookie might be generated like this:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Set-cookie: pref=compact; domain=&quot;airtravelbargains.com&quot;; path=/autos/</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1984"></a><span class="font24">If the user goes to </span><a href="http://www.airtravelbargains.com/specials.html"><span class="font24" style="font-style:italic;">http://www.airtravelbargains.com/specials.html</span></a><span class="font24">, she will get only this cookie:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Cookie: user=&quot;mary17&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">But if she goes to </span><a href="http://www.airtravelbargains.com/autos/cheapo/index.html"><span class="font24" style="font-style:italic;">http://www.airtravelbargains.com/autos/cheapo/index.html</span></a><span class="font24">, she will get both of these cookies:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Cookie: user=&quot;mary17&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Cookie: pref=compact</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">So, cookies are pieces of state, slapped onto the client by the servers, maintained by the clients, and sent back to only those sites that are appropriate. Let’s look in more detail at the cookie technology and standards.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1985"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1986"></a>Cookie Ingredients</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are two different versions of cookie specifications in use: Version 0 cookies (sometimes called “Netscape cookies”), and Version 1 (“RFC 2965”) cookies. Version 1 cookies are a less widely used extension of Version 0 cookies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Neither the Version 0 or Version 1 cookie specification is documented as part of the HTTP/1.1 specification. There are two primary adjunct documents that best describe the use of cookies, summarized in </span><a href="#bookmark1987"><span class="font24">Table 11-2</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark1987"></a><span class="font23" style="font-style:italic;">Table 11-2. Cookie specifications</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Title &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Location</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">Persistent Client State: HTTP Cookies &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Original Netscape cookie standard &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://home.netscape.com/newsref/"><span class="font3" style="font-style:italic;">http://home.netscape.com/newsref/</span></a></p>
<p style="padding:0pt 0pt 5pt 247pt;"><span class="font3" style="font-style:italic;">std/cookie_spec html</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">RFC 2965: HTTP State Management &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;October 2000 cookie standard, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.ietf.org/rfc/rfc2965.txt"><span class="font3" style="font-style:italic;">http://www.ietf.org/rfc/rfc2965.txt</span></a></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Mechanism &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsoletes RFC 2109</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark1988"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1989"></a><a name="bookmark1990"></a>Version 0 (Netscape) Cookies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The initial cookie specification was defined by Netscape. These “Version 0” cookies defined the Set-Cookie response header, the Cookie request header, and the fields available for controlling cookies. Version 0 cookies look like this:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Set-Cookie: </span><span class="font3" style="font-style:italic;">name</span><span class="font3">=</span><span class="font3" style="font-style:italic;">value</span><span class="font3"> [; expires=</span><span class="font3" style="font-style:italic;">date</span><span class="font3">] [; path=</span><span class="font3" style="font-style:italic;">path</span><span class="font3">] [; domain=</span><span class="font3" style="font-style:italic;">domain</span><span class="font3">] [; secure]</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">Cookie: </span><span class="font3" style="font-style:italic;">name1</span><span class="font3">=</span><span class="font3" style="font-style:italic;">value1</span><span class="font3"> [; </span><span class="font3" style="font-style:italic;">name2</span><span class="font3">=</span><span class="font3" style="font-style:italic;">value2</span><span class="font3">] ...</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1991"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1992"></a>Version 0 Set-Cookie header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">The Set-Cookie header has a mandatory cookie name and cookie value. It can be followed by optional cookie attributes, separated by semicolons. The Set-Cookie fields are described in </span><a href="#bookmark1993"><span class="font24">Table 11-3</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark1993"></a><span class="font23" style="font-style:italic;">Table 11-3. Version 0 (Netscape) Set-Cookie attributes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Set-Cookie attribute</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description and examples</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NAME=VALUE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Mandatory. Both NAME and VALUE are sequences of characters, excluding the semicolon, comma, equals sign, and whitespace, unless quoted in double quotes. The web server can create any NAME=VALUE association, which will be sent back to the web server on subsequent visits to the site.</span></p>
<p style="text-indent:15pt;"><span class="font3">Set-Cookie: customer=Mary</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Expires</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Optional. This attribute specifies a date string that defines the valid lifetime of that cookie. Once the expiration date has been reached, the cookie will no longer be stored or given out. The date is formatted as:</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Weekday, DD-Mon-YY HH:MM:SS GMT</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The only legal time zone is GMT, and the separators between the elements of the date must be dashes. If Expires is not specified, the cookie will expire when the user’s session ends.</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Set-Cookie: foo=bar; expires=Wednesday, 09-Nov-99 23:12:40 GMT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Domain</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Optional. A browser sends the cookie only to server hostnames in the specified domain. This lets servers restrict cookies to only certain domains. A domain of “acme.com” would match hostnames “anvil. acme.com” and “shipping.crate.acme.com”, but not “www.cnn.com”.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Only hosts within the specified domain canseta cookie for a domain, and domains must have at least two or three periods in them to prevent domains of the form “.com”, “.edu”, and “va.us”. Any domain that falls within the fixed set of special top-level domains listed here requires only two periods. Any other domain requires at least three. The special top-level domains are: .com, .edu, .net, .org, .gov, .mil, .int, .biz, .info, .name, .museum, .coop, .aero, and .pro.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">If the domain is not specified, it defaults to the hostname of the server that generated the Set-Cookie response.</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Set-Cookie: SHIPPING=FEDEX; domain=&quot;joes-hardware.com&quot;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Path</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Optional. This attribute lets you assign cookies to particular documents on a server. If the Path attribute is a prefix of a URL path, a cookie can be attached. The path “/foo” matches “/foobar” and “/foo/bar.html”. The path “/” matches everything in the domain.</span></p>
<p><span class="font2">If the path is not specified, it is set to the path of the URL that generated the Set-Cookie response.</span></p>
<p style="text-indent:15pt;"><span class="font3">Set-Cookie: lastorder=00183; path=/orders</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Secure</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 15pt;"><span class="font2">Optional. If this attribute is included, a cookie will be sent only if HTTP is using an SSL secure connection. </span><span class="font3">Set-Cookie: private_id=519; secure</span></p></td></tr>
</table></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark741"></a><span class="font5" style="font-weight:bold;"><a name="bookmark1994"></a><a name="bookmark1995"></a><a name="bookmark1996"></a>Version 0 Cookie header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When a client sends requests, it includes all the unexpired cookies that match the domain, path, and secure filters to the site. All the cookies are combined into a Cookie header:</span></p>
<p style="text-align:justify;text-indent:18pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">Cookie: session-id=002-1145265-8016838; session-id-time=1007884800</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark1997"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1998"></a>Version 1 (RFC 2965) Cookies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">An extended version of cookies is defined in RFC 2965 (previously RFC 2109). This Version 1 standard introduces the Set-Cookie2 and Cookie2 headers, but it also interoperates with the Version 0 system.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The RFC 2965 cookie standard is a bit more complicated than the original Netscape standard and is not yet completely supported. The major changes of RFC 2965 cookies are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Associate descriptive text with each cookie to explain its purpose</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Support forced destruction of cookies on browser exit, regardless of expiration</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Max-Age aging of cookies in relative seconds, instead of absolute dates</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Ability to control cookies by the URL port number, not just domain and path</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The Cookie header carries back the domain, port, and path filters (if any)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Version number for interoperability</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">•</span><span class="font4"> $ </span><span class="font24">prefix in Cookie header to distinguish additional keywords from usernames</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The Version 1 cookie syntax is as follows:</span></p>
<table border="1">
<tr><td colspan="2" style="vertical-align:top;">
<p><span class="font3">set-cookie &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font3">&quot;Set-Cookie2:&quot; cookies</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">cookies</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">1#cookie</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">cookie</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">NAME &quot;=&quot; VALUE *(&quot;;&quot; set-cookie-av)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">NAME</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">attr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">VALUE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">value</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3">set-cookie-av</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font3">=<sub>| </sub>| | | | | | |</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">&quot;Comment&quot; &quot;=&quot; value</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;CommentURL&quot; &quot;=&quot; &lt;&quot;&gt;&nbsp;http_URL &lt;&quot;&gt;</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Discard&quot;</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Domain&quot; &quot;=&quot; value</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Max-Age&quot; &quot;=&quot; value</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Path&quot; &quot;=&quot; value</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Port&quot; [ &quot;=&quot; &lt;&quot;&gt;&nbsp;portlist &lt;&quot;&gt;&nbsp;]</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Secure&quot;</span></p>
<p style="text-indent:24pt;"><span class="font3">&quot;Version&quot; &quot;=&quot; 1*DIGIT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">portlist</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font3">1#portnum</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3">portnum</span></p></td><td style="vertical-align:top;">
<p><span class="font3">=</span></p></td><td style="vertical-align:top;">
<p style="text-indent:24pt;"><span class="font3">1*DIGIT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">cookie</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">&quot;Cookie:&quot; cookie-version 1*((&quot;;&quot; | &quot;,&quot;) cookie-value)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">cookie-value</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">NAME &quot;=&quot; VALUE [&quot;;&quot; path] [&quot;;&quot; domain] [&quot;;&quot; port]</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font3">cookie-version</span></p></td><td style="vertical-align:top;">
<p><span class="font3">=</span></p></td><td style="vertical-align:top;">
<p><span class="font3">&quot;$Version&quot; &quot;=&quot; value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">NAME</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">attr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font3">VALUE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">=</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3">value</span></p></td></tr>
</table>
<p style="text-align:justify;text-indent:19pt;"><a name="bookmark1999"></a><span class="font3">path &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$Path&quot; &quot;=&quot; value</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">domain &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$Domain&quot; &quot;=&quot; value</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">port &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$Port&quot; [ &quot;=&quot; &lt;&quot;&gt;&nbsp;value &lt;&quot;&gt;&nbsp;]</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">cookie2 = &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Cookie2:&quot; cookie-version</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2000"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2001"></a>Version 1 Set-Cookie2 header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">More attributes are available in the Version 1 cookie standard than in the Netscape standard. </span><a href="#bookmark2002"><span class="font24">Table 11-4</span></a><span class="font24"> provides a quick summary of the attributes. Refer to RFC 2965 for more detailed explanation.</span></p>
<table>
<tr><td>
<p><a name="bookmark2002"></a><span class="font23" style="font-style:italic;">Table 11-4. Version 1 (RFC 2965) Set-Cookie2 attributes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Set-Cookie2 attribute</span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2" style="font-weight:bold;">Description and examples</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NAME=VALUE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Mandatory. The web server can create any NAME=VALUE association, which will be sent back to the web server on subsequent visits to the site. The name must not begin with “$”, because that character is reserved.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Version</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Mandatory. The value of this attribute is an integer, corresponding to the version of the cookie specification. RFC 2965 is Version 1.</span></p>
<p style="text-indent:22pt;"><span class="font3">Set-Cookie2: Part=&quot;Rocket_Launcher_0001&quot;; Version=&quot;1&quot;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Comment</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. This attribute documents how a server intends to use the cookie. The user can inspectthis policy to decide whether to permit a session with this cookie. The value must be in UTF-8 encoding.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CommentURL</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. This attribute provides a URL pointer to detailed documentation about the purpose and policy for a cookie. The user can inspect this policy to decide whether to permit a session with this cookie.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Discard</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. If this attribute is present, it instructs the client to discard the cookie when the client program terminates.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Domain</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. A browser sends the cookie only to server hostnames in the specified domain. This lets servers restrict cookies to only certain domains. A domain of “acme.com” would match hostnames “anvil.acme.com” and “shipping.crate.acme.com”, but not “www.cnn.com”. The rules for domain matching are basically the same as in Netscape cookies, but there are a few additional rules. Refer to RFC 2965 for details.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Max-Age</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. The value of this attribute is an integer that sets the lifetime of the cookie in seconds. Clients should calculate the age of the cookie according to the HTTP/1.1 age-calculation rules. When a cookie’s age becomes greater than the Max-Age, the client should discard the cookie. A value of zero means the cookie with that name should be discarded immediately.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Path</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. This attribute lets you assign cookies to particular documents on a server. If the Path attribute is a prefix of a URL path, a cookie can be attached. The path “/foo” would match “/foobar” and “/foo/bar.html”. The path “/” matches everything in the domain. If the path is not specified, it is set to the path of the URL that generated the Set-Cookie response.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Port</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. This attribute can stand alone as a keyword, or it can include a comma-separated list of ports to which a cookie may be applied. Ifthereisa port list, the cookie can be served only to servers whose ports match a port in the list. If the Port keyword is provided in isolation, the cookie can be served only to the port number of the current responding server.</span></p>
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font3">Set-Cookie2: foo=&quot;bar&quot;; Version=&quot;1&quot;; Port=&quot;80,81,8080&quot; Set-Cookie2: foo=&quot;bar&quot;; Version=&quot;1&quot;; Port</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Secure</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">Optional. If this attribute is included, a cookie will be sent only if HTTP is using an SSL secure connection.</span></p></td></tr>
</table></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2003"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2004"></a><a name="bookmark2005"></a>Version 1 Cookie header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Version 1 cookies carry back additional information about each delivered cookie, describing the filters each cookie passed. Each matching cookie must include any Domain, Port, or Path attributes from the corresponding Set-Cookie2 headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, assume the client has received these five Set-Cookie2 responses in the past from the </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> web site:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Set-Cookie2: ID=&quot;29046&quot;; Domain=&quot;.joes-hardware.com&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Set-Cookie2: color=blue</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Set-Cookie2: support-pref=&quot;L2&quot;; Domain=&quot;customer-care.joes-hardware.com&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Set-Cookie2: Coupon=&quot;hammer027&quot;; Version=&quot;1&quot;; Path=&quot;/tools&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Set-Cookie2: Coupon=&quot;handvac103&quot;; Version=&quot;1&quot;; Path=&quot;/tools/cordless&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2006"></a><span class="font24">If the client makes another request for path </span><span class="font24" style="font-style:italic;">/tools/cordless/specials.html</span><span class="font24">, it will pass along a long Cookie2 header like this:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Cookie: $Version=&quot;1&quot;;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 51pt;"><span class="font3">ID=&quot;29046&quot;; $Domain=&quot;.joes-hardware.com&quot;;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 51pt;"><span class="font3">color=&quot;blue&quot;;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 51pt;"><span class="font3">Coupon=&quot;hammer027&quot;; $Path=&quot;/tools&quot;;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 51pt;"><span class="font3">Coupon=&quot;handvac103&quot;; $Path=&quot;/tools/cordless&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Notice that all the matching cookies are delivered with their Set-Cookie2 filters, and the reserved keywords begin with a dollar sign (</span><span class="font4">$</span><span class="font24">).</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2007"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2008"></a>Version 1 Cookie2 header and version negotiation</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Cookie2 request header is used to negotiate interoperability between clients and servers that understand different versions of the cookie specification. The Cookie2 header advises the server that the<a name="bookmark2009"></a> user agent understands new-style cookies and provides the version of the cookie standard supported (it would have made more sense to call it Cookie-Version):</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Cookie2: $Version=&quot;1&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2010"></a><span class="font24">If the server understands new-style cookies, it recognizes the Cookie2 header and should send Set-Cookie2 (rather than Set-Cookie) response headers. If a client gets both a Set-Cookie and a Set-Cookie2 header for the same cookie, it ignores the old Set-Cookie header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">If a client supports both Version 0 and Version 1 cookies but gets a Version 0 SetCookie header from the server, it should send cookies with the Version 0 Cookie header. However, the client also should send Cookie2: $Version=“1” to give the server indication that it can upgrade.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2011"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2012"></a>Cookies and Session Tracking</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Cookies can be used to track users as they make multiple transactions to a web site. E-commerce web sites use session cookies to keep track of users’ shopping carts as they browse. Let’s take the example of the popular shopping site Amazon.com.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">When you type </span><a href="http://www.amazon.com"><span class="font24" style="font-style:italic;">http://www.amazon.com</span></a><span class="font24"> into your browser, you start a chain of transactions where the web server attaches identification information through a series of redirects, URL rewrites, and cookie setting.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24"> shows a transaction sequence captured from an Amazon.com visit:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">a—Browser requests Amazon.com root page for the first time.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">b—Server redirects the client to a URL for the e-commerce software.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">c—Client makes a request to the redirected URL.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark2014"></a><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">d—Server slaps two session cookies on the response and redirects the user to another URL, so the client will request again with these cookies attached. This new URL is a fat URL, meaning that some state is embedded into the URL. If the client has cookies disabled, some basic identification can still be done as long as the user follows the Amazon.com-generated fat URL links and doesn’t leave the site.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">e—Client requests the new URL, but now passes the two attached cookies.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">f—Server redirects to the </span><span class="font24" style="font-style:italic;">home.html</span><span class="font24"> page and attaches two more cookies.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">g—Client fetches the </span><span class="font24" style="font-style:italic;">home.html</span><span class="font24"> page and passes all four cookies.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• </span><a href="#bookmark2013"><span class="font24">Figure 11-5</span></a><span class="font24">h—Server serves back the content.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark2015"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2016"></a>Cookies and Caching</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark2017"></a><span class="font24">You have to be careful when caching documents that are involved with cookie transactions. You don’t want to assign one user some past user’s cookie or, worse, show one user the contents of someone else’s personalized document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The rules for cookies and caching are not well established. Here are some guiding principles for dealing with caches:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Mark documents uncacheable if they are</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The document owner knows best if a document is uncacheable. Explicitly mark documents uncacheable if they are—specifically, use Cache-Control: no-cache=“Set-Cookie” if the document is cacheable except for the Set-Cookie header. The other, more general practice of using Cache-Control: public for documents that are cacheable promotes bandwidth savings in the Web.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Be cautious about caching Set-Cookie headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">If a response has a Set-Cookie header, you can cache the body (unless told otherwise), but you should be extra cautious about caching the Set-Cookie header. If you send the same Set-Cookie header to multiple users, you may be defeating user targeting.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Some caches delete the Set-Cookie header before storing a response in the cache, but that also can cause problems, because clients served from the cache will no</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-388.jpg" alt="" style="width:19pt;height:28pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-389.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a href="http://www.amazon.com"><span class="font1" style="font-weight:bold;">www.amazon.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2">GET / HTTP/1.0</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Host: </span><a href="http://www.amazon.com"><span class="font2">www.amazon.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">(b) </span><span class="font2">HTTP/1.1 302 Found</span></p>
<p><span class="font3" style="font-weight:bold;">() </span><span class="font2" style="text-decoration:underline;">Location: </span><a href="http://www.amazon.com:80/exec/obidos/subst/home/redirect.html"><span class="font2" style="text-decoration:underline;">http://www.amazon.com:80/exec/obidos/subst/home/redirect.html</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">GET /exec/obidos/subst/home/redirect.html HTTP/1.0 Host: </span><a href="http://www.amazon.com"><span class="font2">www.amazon.com</span></a></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">(c)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2">HTTP/1.1 302 Found</span></p>
<p><span class="font2">Date: Sun, 02 Dec 2001 03:20:47 GMT</span></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Set-cookie: session-id=002-1145265-8016838; path=/; domain=.amazon.com; expires=Sunday, 09-Dec-2001 08:00:00 GMT</span></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Set-cookie: session-id-time=1007884800; path=/; domain=.amazon.com; expires=Sunday, 09-Dec-2001 08:00:00 GMT</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3" style="font-weight:bold;">(d)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-390.jpg" alt="" style="width:346pt;height:120pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-391.jpg" alt="" style="width:166pt;height:129pt;">
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2013"></a><span class="font23" style="font-style:italic;">Figure 11-5. The Amazon.com web site uses session cookies to track users</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">longer get cookies slapped on them that they normally would without the cache. This situation can be improved by forcing the cache to revalidate every request with the origin server and merging any returned Set-Cookie headers with the client response. The origin server can dictate such revalidations by adding this header to the cached copy:</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 6pt 0pt;"><span class="font3">Cache-Control: must-revalidate, max-age=0</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">More conservative caches may refuse to cache any response that has a SetCookie header, even though the content may actually be cacheable. Some caches allow modes when Set-Cookied images are cached, but not text.</span></p>
<p><a name="bookmark2018"></a><span class="font24" style="font-style:italic;">Be cautious about requests with Cookie headers</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">When a request arrives with a Cookie header, it provides a hint that the resulting content might be personalized. Personalized content must be flagged uncacheable, but some servers may erroneously not mark this content as uncacheable.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">Conservative caches may choose not to cache any document that comes in response to a request with a Cookie header. And again, some caches allow modes when Cookied images are cached, but not text. The more accepted policy is to cache images with Cookie headers, with the expiration time set to zero, thus forcing a revalidate every time.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2019"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2020"></a>Cookies, Security, and Privacy</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Cookies themselves are not believed to be a tremendous security risk, because they can be disabled and because much of the tracking can be done through log analysis or other means. In fact, by providing a standardized, scrutinized method for retaining personal information in remote databases and using anonymous cookies as keys, the frequency of communication of sensitive data from client to server can be reduced.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Still, it is good to be cautious when dealing with privacy and user tracking, because there is always potential for abuse. The biggest misuse comes from third-party web sites using persistent cookies to track users. This practice, combined with IP addresses and information from the Referer header, has enabled these marketing companies to build fairly accurate user profiles and browsing patterns.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In spite of all the negative publicity, the conventional wisdom is that the session handling and transactional convenience of cookies outweighs most risks, if you use caution about who you provide personal information to and review sites’ privacy policies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Computer Incident Advisory Capability (part of the U.S. Department of Energy) wrote an assessment of the overrepresented dangers of cookies in 1998. Here’s an excerpt from that report:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">CIAC I-034: Internet Cookies</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(</span><a href="http://www.ciac.org/ciac/bulletins/i-034.shtml"><span class="font3">http://www.ciac.org/ciac/bulletins/i-034.shtml</span></a><span class="font3">)</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">PROBLEM:</span></p>
<p style="padding:0pt 0pt 5pt 19pt;"><span class="font3">Cookies are short pieces of data used by web servers to help identify web users. The popular concepts and rumors about what a cookie can do has reached almost mystical proportions, frightening users and worrying their managers.</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">VULNERABILITY ASSESSMENT:</span></p>
<p style="padding:0pt 0pt 14pt 19pt;"><a name="bookmark2021"></a><span class="font3">The vulnerability of systems to damage or snooping by using web browser cookies is essentially nonexistent. Cookies can only tell a web server if you have been there before and can pass short bits of information (such as a user number) from the web server back to itself the next time you visit. Most cookies last only until you quit your browser and then are destroyed. A second type of cookie known as a persistent cookie has an expiration date and is stored on your disk until that date. A persistent cookie can be used to track a user's browsing habits by identifying him whenever he returns to a site. Information about where you come from and what web pages you visit already exists in a web server's log files and could also be used to track users browsing habits, cookies just make it easier.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark2022"></a><span class="font9" style="font-weight:bold;"><a name="bookmark115"></a><a name="bookmark2023"></a>For More Information</span></h2>
<p style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark2024"></a><span class="font24">Here are a few more useful sources for additional information about cookies:</span></p>
<p><span class="font24" style="font-style:italic;">Cookies</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Simon St.Laurent, McGraw-Hill.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2965.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2965.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 2965, “HTTP State Management Mechanism” (obsoletes RFC 2109).</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2964.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2964.txt</span></a></p>
<p style="text-indent:19pt;"><span class="font24">RFC 2964, “Use of HTTP State Management.” </span><a href="http://home.netscape.com/newsref/std/cookie_spec.html"><span class="font24" style="font-style:italic;">http://home.netscape.com/newsref/std/cookie_spec.html</span></a></p>
<p style="padding:0pt 0pt 3pt 19pt;"><span class="font24">This classic Netscape document, “Persistent Client State: HTTP Cookies,” describes the original form of HTTP cookies that are still in common use today.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 12</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark236"></a><span class="font11" style="font-weight:bold;"><a name="bookmark116"></a><a name="bookmark2025"></a>Basic Authentication</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2026"></a><span class="font24"><a name="bookmark2027"></a><a name="bookmark2028"></a>Millions of people use the Web to perform private transactions and access private data. The Web makes it very easy to access this information, but easy isn’t good enough. We need assurances about who can look at our sensitive data and who can perform our privileged transactions. Not all information is intended for the general public.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We need to feel comfortable that unauthorized users can’t view our online travel profiles or publish documents onto our web sites without our consent. We need to make sure our most sensitive corporate-planning documents aren’t available to unauthorized and potentially unscrupulous members of our organization. And we need to feel at ease that our personal web communications with our children, our spouses, and our secret loves all occur with a modicum of privacy.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark691"></a><span class="font24"><a name="bookmark2029"></a>Servers need a way to know who a user is. Once a server knows who the user is, it can decide which transactions and resources the user can access. Authentication means proving who you are; usually, you authenticate by providing a username and a secret password. HTTP provides a native facility for HTTP authentication. While it’s certainly possible to “roll your own” authentication facility on top of HTTP forms and cookies, for many situations, HTTP’s native authentication fits the bill nicely.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This chapter explains HTTP authentication and delves into the most common form of HTTP authentication, </span><span class="font24" style="font-style:italic;">basic authentication</span><span class="font24">. The next chapter explains a more powerful technique called </span><span class="font24" style="font-style:italic;">digest authentication</span><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2030"></a><span class="font9" style="font-weight:bold;"><a name="bookmark117"></a><a name="bookmark2031"></a>Authentication</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Authentication means showing some proof of your identity. When you show a photo ID, like a passport or a driver’s license, you are showing some proof that you are who you claim to be. When you type a PIN number into an automatic teller machine, or type a secret password into a computer’s dialog box, you also are proving that you are who you claim to be.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2032"></a><span class="font24"><a name="bookmark2033"></a>Now, none of these schemes are foolproof. Passwords can be guessed or overheard, and ID cards can be stolen or forged. But each piece of supporting evidence helps to build a reasonable trust that you are who you say you are.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2034"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2035"></a>HTTP’s Challenge/Response Authentication Framework</span></h3>
<p><span class="font24">HTTP provides a native </span><span class="font24" style="font-style:italic;">challenge/response</span><span class="font24"> framework to make it easy to authenticate users. HTTP’s authentication model is sketched in</span><a href="#bookmark2036"><span class="font24"> Figure 12-1</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-392.jpg" alt="" style="width:29pt;height:32pt;"></td><td>
<p><span class="font0">Please give me the internal sales forecast.</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Request</span></p></td><td><img src="book_files/book-393.jpg" alt="" style="width:25pt;height:22pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">You requested a secret financial document. Please tell me your username and password.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Challenge</span></p></td><td><img src="book_files/book-394.jpg" alt="" style="width:40pt;height:22pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font1" style="font-style:italic;">(Ask user for password)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
<tr><td><img src="book_files/book-395.jpg" alt="" style="width:26pt;height:30pt;"></td><td>
<p><span class="font0">Please give me the internal sales forecast. Here is my username and password: “•••••”.</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;font-style:italic;">Authorization</span></p></td><td><img src="book_files/book-396.jpg" alt="" style="width:25pt;height:33pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-397.jpg" alt="" style="width:112pt;height:38pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-398.jpg" alt="" style="width:39pt;height:31pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-399.jpg" alt="" style="width:22pt;height:30pt;"></td><td>
<p><span class="font0">OK. You have access rights. Here is the document.</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;font-style:italic;">Success</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2036"></a><span class="font23" style="font-style:italic;"><a name="bookmark2037"></a>Figure 12-1. Simplified challenge/response authentication</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Whenever a web application receives an HTTP request message, instead of acting on the request, the server can respond with an “authentication challenge,” challenging the user to demonstrate who she is by providing some secret information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The user needs to attach the secret credentials (username and password) when she repeats the request. If the credentials don’t match, the server can challenge the client again or generate an error. If the credentials do match, the request completes normally.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2038"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2039"></a>Authentication Protocols and Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">HTTP provides an extensible framework for different authentication protocols, through a set of customizable control headers. The format and content of the headers listed in </span><a href="#bookmark2040"><span class="font24">Table 12-1 </span></a><span class="font24">vary depending on the authentication protocol. The authentication protocol also is specified in the HTTP authentication headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">HTTP defines two official authentication protocols: basic authentication and digest authentication. In the future, people are free to devise new protocols that use HTTP’s challenge/response framework. The rest of this chapter explains basic authentication. See</span><a href="#bookmark237"><span class="font24"> Chapter 13 </span></a><span class="font24">for details on digest authentication.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-400.jpg" alt="" style="width:22pt;height:30pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-401.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<table>
<tr><td>
<p><a name="bookmark2040"></a><span class="font23" style="font-style:italic;">Table 12-1. Four phases of authentication</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Phase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Headers</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Method/Status</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Request</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">The first request has no authentication.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">GET</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Challenge</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">WWW-Authenticate</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The server rejects the request with a 401 status, indicating that the user needs to provide his username and password. Because the server might have different areas, each with its own password, the server describes the protection area in the WWW-Authenticate header. Also, the authentication algorithm is specified in the WWW-Authenticate header.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">401 Unauthorized</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Authorization</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Authorization</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The client retries the request, but this time attaching an Authorization header specifying the authentication algorithm, username, and password.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">GET</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Success</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Authentication-Info</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">If the authorization credentials are correct, the server returns the document. Some authorization algorithms return some additional information about the authorization session in the optional Authentication-Info header.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">200 OK</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font24">To make this concrete, let’s take a look at</span><a href="#bookmark2041"><span class="font24"> Figure 12-2</span></a><span class="font24">.</span></p></td></tr>
</table>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font2" style="text-decoration:underline;">GET /family/jeff.jpg HTTP/1.0</span><span class="font2"> </span><span class="font3" style="font-weight:bold;">(a)</span></p></td></tr>
<tr><td><img src="book_files/book-402.jpg" alt="" style="width:170pt;height:72pt;"></td><td>
<p><span class="font3" style="font-weight:bold;">(b)</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;padding:0pt 0pt 54pt 0pt;"><span class="font2">HTTP/1.0 401 Authorization Required WWW-Authenticate: Basic realm=&quot;Family&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 264pt;"><span class="font2">HTTP/1.0 200 OK Content-type: image/jpeg ...&lt;image data included&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2041"></a><span class="font23" style="font-style:italic;">Figure 12-2. Basic authentication example</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">When a server challenges a user, it returns a 401 Unauthorized response and describes how and where to authenticate in the WWW-Authenticate header </span><a href="#bookmark2041"><span class="font24">(Figure 12-2</span></a><span class="font24">b).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2042"></a><span class="font24"><a name="bookmark2043"></a>When a client authorizes the server to proceed, it resends the request but attaches an encoded password and other authentication parameters in an Authorization header </span><a href="#bookmark2041"><span class="font24">(Figure 12-2</span></a><span class="font24">c).</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">When an authorized request is completed successfully, the server returns a normal status code (e.g., 200 OK) and, for advanced authentication algorithms, might attach additional information in an Authentication-Info header (</span><a href="#bookmark2041"><span class="font24">Figure 12-2</span></a><span class="font24">d).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2044"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2045"></a>Security Realms</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before we discuss the details of basic authentication, we need to explain how HTTP allows servers to associate different access rights to different resources. You might have noticed that the WWW-Authenticate challenge in</span><a href="#bookmark2041"><span class="font24"> Figure 12-2b</span></a><span class="font24"> included a </span><span class="font24" style="font-style:italic;">realm</span><span class="font24"> directive. Web servers group protected documents into </span><span class="font24" style="font-style:italic;">security realms</span><span class="font24">. Each security realm can have different sets of authorized users.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2046"></a><span class="font24">For example, suppose a web server has two security realms established: one for corporate financial information and another for personal family documents (see </span><a href="#bookmark2047"><span class="font24">Figure 12-3</span></a><span class="font24">). Different users will have different access to the realms. The CEO of your company probably should have access to the sales forecast, but you might not give her access to your family vacation photos!</span></p>
<table>
<tr><td><img src="book_files/book-403.jpg" alt="" style="width:360pt;height:173pt;"></td></tr>
<tr><td>
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2047"></a><span class="font24">Here’s a hypothetical basic authentication challenge, with a realm specified:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.0 401 Unauthorized</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">WWW-Authenticate: Basic realm=&quot;Corporate Financials&quot;</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A realm should have a descriptive string name, like “Corporate Financials,” to help the user understand which username and password to use. It may also be useful to list the server hostname in the realm name—for example, “executive-committee@big-company.com”.</span></p>
<h2 style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark2048"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2049"></a><a name="bookmark2050"></a><a name="bookmark118"></a><a name="bookmark2051"></a>Basic Authentication</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2052"></a><span class="font24">Basic authentication is the most prevalent HTTP authentication protocol. Almost every major client and server implements basic authentication. Basic authentication was originally described in the HTTP/1.0 specification, but it has since been relocated into RFC 2617, which details HTTP authentication.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In basic authentication, a web server can refuse a transaction, challenging the client for a valid username and password. The server initiates the authentication challenge by returning a 401 status code instead of 200 and specifies the security realm being accessed with the WWW-Authenticate response header. When the browser receives the challenge, it opens a dialog box requesting the username and password for this realm. The username and password are sent back to the server in a slightly scrambled format inside an Authorization request header.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2053"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2054"></a>Basic Authentication Example</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark2041"><span class="font24">Figure 12-2</span></a><span class="font24">, earlier in this chapter, showed a detailed example of basic authentication:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><a name="bookmark2055"></a><span class="font24"><a name="bookmark2056"></a>• In</span><a href="#bookmark2041"><span class="font24"> Figure 12-2</span></a><span class="font24">a, a user requests the personal family photo </span><span class="font24" style="font-style:italic;">/family/jeff.jpg</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• In</span><a href="#bookmark2041"><span class="font24"> Figure 12-2</span></a><span class="font24">b, the server sends back a 401 Authorization Required password challenge for the personal family photo, along with the WWW-Authenticate header. The header requests basic authentication for the realm named </span><span class="font24" style="font-style:italic;">Family</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• In</span><a href="#bookmark2041"><span class="font24"> Figure 12-2</span></a><span class="font24">c, the browser receives the 401 challenge and pops open a dialog box asking for the username and password for the </span><span class="font24" style="font-style:italic;">Family</span><span class="font24"> realm. When the user enters the username and password, the browser joins them with a colon, encodes them into a “scrambled” base-64 representation (discussed in the next section), and sends them back in the Authorization header.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• In</span><a href="#bookmark2041"><span class="font24"> Figure 12-2</span></a><span class="font24">d, the server decodes the username and password, verifies that they are correct, and returns the requested document in an HTTP 200 OK message.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">The HTTP basic authentication WWW-Authenticate and Authorization headers are summarized in </span><a href="#bookmark2057"><span class="font24">Table 12-2</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2057"></a><span class="font23" style="font-style:italic;">Table 12-2. Basic authentication headers</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2" style="font-weight:bold;">Challenge/Response &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Header syntax and description</span></p>
<p style="padding:0pt 0pt 2pt 93pt;"><span class="font2">Challenge (server to client) There may be different passwords for different parts of the site. The realm is a quoted string that names the set of documents being requested, so the user knows which password to use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 102pt;"><span class="font3">WWW-Authenticate: Basic realm=</span><span class="font3" style="font-style:italic;">quoted-realm</span></p>
<p style="text-indent:7pt;"><span class="font2">Response (client to server) &nbsp;&nbsp;&nbsp;The username and password are joined together by a colon (:) and then converted to base-64</span></p>
<p style="padding:0pt 0pt 2pt 93pt;"><span class="font2">encoding, making ita bit easier to include international characters in usernames and passwords and making it less likely that a cursory examination will yield usernames and passwords while watching network traffic.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 102pt;"><span class="font3">Authorization: Basic </span><span class="font3" style="font-style:italic;">base64-username-and-password</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2058"></a><span class="font24">Note that the basic authentication protocol does not make use of the AuthenticationInfo header we showed in </span><a href="#bookmark2040"><span class="font24">Table 12-1</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2059"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2060"></a>Base-64 Username/Password Encoding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP basic authentication packs the username and password together (separated by a colon), and encodes them using the base-64 encoding method. If you don’t know what base-64 encoding is, don’t worry. You don’t need to know much about it, and if you are curious, you can read all about it in </span><a href="#bookmark250"><span class="font24">Appendix E</span></a><span class="font24">. In a nutshell, base-64 encoding takes a sequence of 8-bit bytes and breaks the sequence of bits into 6-bit chunks. Each 6-bit piece is used to pick a character in a special 64-character alphabet, consisting mostly of letters and numbers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 19pt 0pt;"><a href="#bookmark2061"><span class="font24">Figure 12-4 </span></a><span class="font24">shows an example of using base-64 encoding for basic authentication. Here, the username is “brian-totty” and the password is “Ow!”. The browser joins the username and password with a colon, yielding the packed string “brian-totty:Ow!”. This string is then base 64–encoded into this mouthful: “YnJpYW4tdG90dHk6T3ch”.</span></p>
<p><span class="font3">brian-totty</span></p>
<p style="text-align:justify;text-indent:9pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Prompt for username and password</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font3">Ow!</span></p>
<p style="padding:0pt 0pt 0pt 121pt;"><span class="font3">brian-totty</span></p>
<p style="text-align:justify;text-indent:9pt;"><span class="font1" style="font-weight:bold;">(b ) </span><span class="font0">Pack username and password with colon &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">brian-totty:Ow!</span></p>
<p><span class="font3">Ow!</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Base 64 encode &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">BASE64ENC(brian-totty:Ow!) YnJpYW4tdG90dHk6T3ch</span></p></td></tr>
<tr><td><img src="book_files/book-404.jpg" alt="" style="width:222pt;height:28pt;"></td></tr>
<tr><td>
<p style="padding:0pt 0pt 2pt 137pt;"><span class="font1" style="font-weight:bold;text-decoration:underline;">Client</span><span class="font1" style="font-weight:bold;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p>
<p style="padding:0pt 0pt 0pt 133pt;"><span class="font3">GET /family/jeff.jpg HTTP/1.0</span></p>
<p style="padding:0pt 0pt 0pt 133pt;"><span class="font3">Authorization: Basic YnJpYW4tdG90dHk6T3ch</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-indent:9pt;"><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Send authorization</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2061"></a><span class="font23" style="font-style:italic;">Figure 12-4. Generating a basic Authorization header from username and password</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Base-64 encoding was invented to take strings of binary, text, and international character data (which caused problems on some systems) and convert them temporarily into a portable alphabet for transmission. The original strings could then be decoded on the remote end without fear of transmission corruption.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Base-64 encoding can be useful for usernames and passwords that contain international characters or other characters that are illegal in HTTP headers (such as quotation marks, colons, and carriage returns). Also, because base-64 encoding trivially scrambles the username and password, it can help prevent administrators <a name="bookmark2062"></a><a name="bookmark2063"></a>from accidentally viewing usernames and passwords while administering servers and networks.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2064"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2065"></a>Proxy <a name="bookmark2066"></a>Authentication</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Authentication also can be done by intermediary proxy servers. Some organizations use proxy servers to authenticate users before letting them access servers, LANs, or wireless networks. Proxy servers can be a convenient way to provide unified access control across an organization’s resources, because access policies can be centrally administered on the proxy server. The first step in this process is to establish the identity via </span><span class="font24" style="font-style:italic;">proxy authentication</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a name="bookmark2067"></a><span class="font24">The steps involved in proxy authentication are identical to that of web server identification. However, the headers and status codes are different.</span><a href="#bookmark2068"><span class="font24"> Table 12-3 </span></a><span class="font24">contrasts the status codes and headers used in web server and proxy authentication.</span></p>
<table>
<tr><td>
<p><a name="bookmark2068"></a><span class="font23" style="font-style:italic;">Table 12-3. Web server versus proxy authentication</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Web server</span></p></td><td style="vertical-align:top;">
<p style="text-indent:48pt;"><span class="font2" style="font-weight:bold;">Proxy server</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Unauthorized status code: 401</span></p></td><td style="vertical-align:top;">
<p style="text-indent:48pt;"><span class="font2">Unauthorized status code: 407</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">WWW-Authenticate</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:48pt;"><span class="font2">Proxy-Authenticate</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Authorization</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:48pt;"><span class="font2">Proxy-Authorization</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Authentication-Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:48pt;"><span class="font2">Proxy-Authentication-Info</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2069"></a><span class="font9" style="font-weight:bold;"><a name="bookmark119"></a><a name="bookmark2070"></a>The Security Flaws of Basic Authentication</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Basic authentication is simple and convenient, but it is not secure. It should only be used to prevent unintentional access from nonmalicious parties or used in combination with an encryption technology such as SSL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Consider the following security flaws:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">1. Basic authentication sends the username and password across the network in a form that can trivially be decoded. In effect, the secret password is sent in the clear, for anyone to read and capture. Base-64 encoding obscures the username and password, making it less likely that friendly parties will glean passwords by accidental network observation. However, given a base 64–encoded username and password, the decoding can be performed trivially by reversing the encoding process. Decoding can even be done in seconds, by hand, with pencil and paper! Base 64–encoded passwords are effectively sent “in the clear.” Assume that motivated third parties will intercept usernames and passwords sent by basic authentication. If this is a concern, send all your HTTP transactions over SSL encrypted channels, or use a more secure authentication protocol, such as digest authentication.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark2071"></a><span class="font24">2. Even if the secret password were encoded in a scheme that was more complicated to decode, a third party could still capture the garbled username and password and replay the garbled information to origin servers over and over again to gain access. No effort is made to prevent these replay attacks.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">3. Even if basic authentication is used for noncritical applications, such as corporate intranet access control or personalized content, social behavior makes this dangerous. Many users, overwhelmed by a multitude of password-protected services, share usernames and passwords. A clever, malicious party may capture a username and password in the clear from a free Internet email site, for example, and find that the same username and password allow access to critical online banking sites!</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">4. Basic authentication offers no protection against proxies or intermediaries that act as middlemen, leaving authentication headers intact but modifying the rest of the message to dramatically change the nature of the transaction.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">5. Basic authentication is vulnerable to spoofing by counterfeit servers. If a user can be led to believe that he is connecting to a valid host protected by basic authentication when, in fact, he is connecting to a hostile server or gateway, the attacker can request a password, store it for later use, and feign an error.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2072"></a><span class="font24">This all said, basic authentication still is useful for providing convenient personalization or access control to documents in a friendly environment, or where privacy is desired but not absolutely necessary. In this way, basic authentication is used to prevent accidental or casual access by curious users.<a name="footnote110"></a><sup><a href="#bookmark2073">110</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, inside a corporation, product management may password-protect future product plans to limit premature distribution. Basic authentication makes it sufficiently inconvenient for friendly parties to access this data.<a name="footnote111"></a><sup><a href="#bookmark2074">111</a></sup><sup></sup> Likewise, you might password-protect personal photos or private web sites that aren’t top-secret or don’t contain valuable information, but really aren’t anyone else’s business either.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Basic authentication can be made secure by combining it with encrypted data transmission (such as SSL) to conceal the username and password from malicious individuals. This is a common technique.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We discuss secure encryption in</span><a href="#bookmark238"><span class="font24"> Chapter 14</span></a><span class="font24">. The next chapter explains a more sophisticated HTTP authentication protocol, digest authentication, that has stronger security properties than basic authentication.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2075"></a><span class="font9" style="font-weight:bold;"><a name="bookmark120"></a><a name="bookmark2076"></a>For More Information</span></h2>
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2077"></a><span class="font24">For more information on basic authentication and LDAP, see:</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2617.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2617.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">RFC 2617, “HTTP Authentication: Basic and Digest Access Authentication.”</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2616.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">RFC 2616 “Hypertext Transfer Protocol—HTTP/1.1.”</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2078"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2079"></a><a name="bookmark237"></a><a name="bookmark2080"></a>CHAPTER 13</span></p></li></ul>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark2081"></a><span class="font11" style="font-weight:bold;"><a name="bookmark121"></a><a name="bookmark2082"></a>Digest Authentication</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2083"></a><span class="font24"><a name="bookmark2084"></a><a name="bookmark2085"></a>Basic authentication is convenient and flexible but completely insecure. Usernames and passwords are sent in the clear,<a name="footnote112"></a><sup><a href="#bookmark2086">112</a></sup><sup></sup> and there is no attempt to protect messages from tampering. The only way to use basic authentication securely is to use it in conjunction with SSL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Digest authentication was developed as a compatible, more secure alternative to basic authentication. We devote this chapter to the theory and practice of digest authentication. Even though digest authentication is not yet in wide use, the concepts still are important for anyone implementing secure transactions.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2087"></a><span class="font9" style="font-weight:bold;"><a name="bookmark122"></a><a name="bookmark2088"></a>The Improvements of Digest Authentication</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Digest authentication is an alternate HTTP authentication protocol that tries to fix the most serious flaws of basic authentication. In particular, digest authentication:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Never sends secret passwords across the network in the clear</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Prevents unscrupulous individuals from capturing and replaying authentication handshakes</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Optionally can guard against tampering with message contents</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Guards against several other common forms of attacks</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Digest authentication is not the most secure protocol possible.<a name="footnote113"></a><sup><a href="#bookmark2089">113</a></sup><sup></sup> Many needs for secure HTTP transactions cannot be met by digest authentication. For those needs, Transport Layer Security (TLS) and Secure HTTP (HTTPS) are more appropriate protocols.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2090"></a><span class="font24">However, digest authentication is significantly stronger than basic authentication, which it was designed to replace. Digest authentication also is stronger than many popular schemes proposed for other Internet services, such as CRAM-MD5, which has been proposed for use with LDAP, POP, and IMAP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2091"></a><span class="font24">To date, digest authentication has not been widely deployed. However, because of the security risks inherent to basic authentication, the HTTP architects counsel in RFC 2617 that “any service in present use that uses Basic should be switched to Digest as soon as practical.”<a name="footnote114"></a><sup><a href="#bookmark2092">114</a></sup><sup></sup> It is not yet clear how successful this standard will become.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2093"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2094"></a>Using Digests to Keep Passwords Secret</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The motto of digest authentication is “never send the password across the network.” Instead of sending the password, the client sends a “fingerprint” or “digest” of the password, which is an irreversible scrambling of the password. The client and the server both know the secret password, so the server can verify that the digest provided a correct match for the password. Given only the digest, a bad guy has no easy way to find what password it came from, other than going through every password in the universe, trying each one!<a name="footnote115"></a><sup><a href="#bookmark2095">115</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Let’s see how this works (this is a simplified version):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• In</span><a href="#bookmark2096"><span class="font24"> Figure 13-1</span></a><span class="font24">a, the client requests a protected document.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In </span><a href="#bookmark2096"><span class="font24">Figure 13-1</span></a><span class="font24">b, the server refuses to serve the document until the client authenticates its identity by proving it knows the password. The server issues a challenge to the client, asking for the username and a digested form of the password.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In</span><a href="#bookmark2096"><span class="font24"> Figure 13-1</span></a><span class="font24">c, the client proves that it knows the password by passing along the digest of the password. The server knows the passwords for all the users,<a name="footnote116"></a><sup><a href="#bookmark2097">116</a></sup><sup></sup> so it can verify that the user knows the password by comparing the client-supplied digest with the server’s own internally computed digest. Another party would not easily be able to make up the right digest if it didn’t know the password.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In </span><a href="#bookmark2096"><span class="font24">Figure 13-1</span></a><span class="font24">d, the server compares the client-provided digest with the server’s internally computed digest. If they match, it shows that the client knows the password (or made a really lucky guess!). The digest function can be set to generate so many digits that lucky guesses effectively are impossible. When the server verifies the match, the document is served to the client—all without ever sending the password over the network.</span></p></li></ul>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Request</span></p></td><td><img src="book_files/book-405.jpg" alt="" style="width:25pt;height:22pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-406.jpg" alt="" style="width:31pt;height:25pt;"></td><td>
<p><span class="font0">Please give me the internal sales forecast.</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Challenge</span></p></td><td><img src="book_files/book-407.jpg" alt="" style="width:33pt;height:23pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-408.jpg" alt="" style="width:41pt;height:27pt;"></td></tr>
<tr><td>
<p style="text-align:justify;"><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font0">You requested a secret financial document. Please tell me your username and password digest.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Ask user for username and password </span><span class="font1" style="font-weight:bold;">digest(”Ow!”)= A3F5</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:justify;"><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Authorization</span></p></td><td><img src="book_files/book-409.jpg" alt="" style="width:27pt;height:34pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-410.jpg" alt="" style="width:31pt;height:25pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 0pt 24pt;"><span class="font0">Please give me the internal sales forecast. My username is “bri”</span></p>
<p style="text-indent:24pt;padding:0pt 0pt 2pt 0pt;"><span class="font0">My digested password is “A3F5”</span></p>
<p><span class="font1" style="font-weight:bold;">Server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark2098"></a><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Success</span></p></td><td><img src="book_files/book-411.jpg" alt="" style="width:63pt;height:29pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-412.jpg" alt="" style="width:60pt;height:30pt;"></td></tr>
<tr><td>
<p><a name="bookmark2099"></a><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font1" style="font-weight:bold;">digest(”Ow!”)= A3F5</span></p>
<p style="text-align:justify;"><span class="font0">This is a match!</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 23pt;"><span class="font0">OK. The digest you sent me matches the digest of my internal password, so here is the document.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark2096"></a><span class="font23" style="font-style:italic;">Figure 13-1. Using digests for password-obscured authentication</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font24">We’ll discuss the particular headers used in digest authentication in more detail in </span><a href="#bookmark2100"><span class="font24">Table 13-8</span></a><span class="font24">.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2101"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2102"></a>One-Way Digests</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2103"></a><span class="font24">A digest is a “condensation of a body of information.”<sup>*</sup> Digests act as one-way functions, typically converting an infinite number of possible input values into a finite range of condensations.<sup>†</sup> One popular digest function, MD5,<sup>‡</sup> converts any arbitrary sequence of bytes, of any length, into a 128-bit digest.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">128 bits = 2<sup>128</sup>, or about 1,000,000,000,000,000,000,000,000,000,000,000,000,000 possible distinct condensations.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font20">* Merriam-Webster dictionary, 1998.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 7pt;"><span class="font20">† In theory, because we are converting an infinite number of input values into a finite number of output values, it is possible to have two distinct inputs map to the same digest. This is called a </span><span class="font20" style="font-style:italic;">collision</span><span class="font20">. In practice, the number of potential outputs is so large that the chance of a collision in real life is vanishingly small and, for the purpose of password matching, unimportant.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 7pt;"><span class="font20">‡ MD5 stands for “Message Digest #5,” one in a series of digest algorithms. The Secure Hash Algorithm (SHA) is another popular digest function.</span></p></li></ul>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">What is important about these digests is that if you don’t know the secret password, you’ll have an awfully hard time guessing the correct digest to send to the server. And likewise, if you have the digest, you’ll have an awfully hard time figuring out which of the effectively infinite number of input values generated it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The 128 bits of MD5 output often are written as 32 hexadecimal characters, each character representing 4 bits.</span><a href="#bookmark2104"><span class="font24"> Table 13-1 </span></a><span class="font24">shows a few examples of MD5 digests of sample inputs. Notice how MD5 takes arbitrary inputs and yields a fixed-length digest output.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2104"></a><span class="font23" style="font-style:italic;">Table 13-1. MD5 digest examples</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">Input</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">“Hi”</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">“bri:Ow!”</span></p>
<p><span class="font2">“3.1415<a name="bookmark2105"></a>926535897”</span></p>
</div>
<p style="text-align:justify;padding:0pt 0pt 4pt 153pt;"><span class="font2" style="font-weight:bold;">MD5 digest</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 153pt;"><span class="font3">C1A5298F939E87E8F962A5EDFC206918</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 153pt;"><span class="font3">BEAAA0E34EB<a name="bookmark2106"></a>DB072F8627C038AB211F8</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 153pt;"><span class="font3">475B977E19ECEE70835BC6DF46F4F6DE</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">“</span><a href="http://www.http-guide.com/index.htm%e2%80%9d"><span class="font2">http://www.http-guide.com/index.htm”</span></a></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font3">C617C0C7D1D05F66F595E22A4B0EAAA5</span></p>
<p><span class="font3">66C4EF58DA7CB956BD04233FBB64E0A4</span></p>
</div>
<p style="text-align:justify;padding:0pt 0pt 12pt 7pt;"><a name="bookmark2107"></a><span class="font2"><a name="bookmark2108"></a><a name="bookmark2109"></a>“WE hold these Truths to be self-evident, that all Men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the Pursuit of Happiness—That to secure these Rights, Governments are instituted among Men, deriving their just Powers from the Consent of the Governed, that whenever any Form of Government becomes destructive of these Ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its Foundation on such Principles, and organizing its Powers in such Form, as to them shall seem most likely to effect their Safety and Happiness.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2110"></a><span class="font24"><a name="bookmark2111"></a>Digest functions sometimes are called cryptographic checksums, one-way hash functions, or fingerprint functions.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2112"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2113"></a>Using Nonces to Prevent Replays</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">One-way digests save us from having to send passwords in the clear. We can just send a digest of the password instead, and rest assured that no malicious party can easily decode the original password from the digest.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Unfortunately, obscured passwords alone do not save us from danger, because a bad guy can capture the digest and replay it over and over again to the server, even though the bad guy doesn’t know the password. The digest is just as good as the password.</span></p>
<p style="text-align:justify;padding:0pt 0pt 27pt 0pt;"><span class="font24">To prevent such replay attacks, the server can pass along to the client a special token called a </span><span class="font24" style="font-style:italic;">nonce</span><span class="font24">,<sup>*</sup> which changes frequently (perhaps every millisecond, or for every</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 7pt;"><span class="font20">* The word nonce means “the present occasion” or “the time being.” In a computer-security sense, the nonce captures a particular point in time and figures that into the security calculations. </span><span class="font24">authentication). The client appends this nonce token to the password before computing the<a name="bookmark2114"></a> digest.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Mixing the nonce in with the password causes the digest to change each time the nonce changes. This prevents replay attacks, because the recorded password digest is valid only for a particular nonce value, and without the secret password, the attacker cannot compute the correct <a name="bookmark2115"></a>digest.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2116"></a><span class="font24">Digest authentication requires the use of nonces, because a trivial replay weakness would make un-nonced digest authentication effectively as weak as basic authentication. Nonces are passed from server to client in the WWW-Authenticate challenge.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">The Digest Authentication Handshake</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP digest authentication protocol is an enhanced version of authentication that uses headers similar to those used in basic authentication. Some new options are added to the traditional headers, and one new optional header, Authorization-Info, is added.</span></p>
<p style="text-align:justify;"><span class="font24">The simplified three-phase handshake of digest authentication is depicted in </span><a href="#bookmark2117"><span class="font24">Figure 13-2</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-413.jpg" alt="" style="width:27pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-414.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(1) </span><span class="font0">Server generates nonce</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">(3) </span><span class="font0">Choose algorithm from set [generate response digest] [generate client-nonce]</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 22pt 270pt;"><span class="font1" style="font-weight:bold;">(5) </span><span class="font0">Server verifies digest [generate rspauth digest] [generate next nonce]</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:24pt;padding:0pt 0pt 32pt 0pt;"><span class="font1" style="font-weight:bold;">(7)</span><span class="font0"> Client verifies rspauth digest</span></p></li></ul>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2117"></a><span class="font23" style="font-style:italic;">Figure 13-2. Digest authentication handshake</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s what’s happening in</span><a href="#bookmark2117"><span class="font24"> Figure 13-2</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 16pt 19pt;"><span class="font24">• In Step 1, the server computes a nonce value. In Step 2, the server sends the nonce to the client in a WWW-Authenticate challenge message, along with a list of algorithms that the server supports.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In Step 3, the client selects an algorithm and computes the digest of the secret password and the other data. In Step 4, it sends the digest back to the server in an Authorization message. If the client wants to authenticate the server, it can send a client nonce.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2118"></a><span class="font24"><a name="bookmark2119"></a>• In Step 5, the server receives the digest, chosen algorithm, and supporting data and computes the same digest that the client did. The server then compares the locally generated digest with the network-transmitted digest and validates that they match. If the client symmetrically challenged the server with a client nonce, a client digest is created. Additionally, the next nonce can be precomputed and handed to the client in advance, so the client can preemptively issue the right digest the next time.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Many of these pieces of information are optional and have defaults. To clarify things, </span><a href="#bookmark2120"><span class="font24">Figure 13-3</span></a><span class="font24"> compares the messages sent for basic authentication (</span><a href="#bookmark2120"><span class="font24">Figure 13-3</span></a><span class="font24">a–d) with a simple example of digest authentication (</span><a href="#bookmark2120"><span class="font24">Figure 13-3</span></a><span class="font24">e–h).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2121"></a><span class="font24"><a name="bookmark2122"></a>Now let’s look a bit more closely at the internal workings of digest authentication.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2123"></a><span class="font9" style="font-weight:bold;"><a name="bookmark123"></a><a name="bookmark2124"></a>Digest Calculations</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The heart of digest authentication is the one-way digest of the mix of public information, secret information, and a time-limited nonce value. Let’s look now at how the digests are computed. The digest calculations generally are straightforward.<a name="footnote117"></a><sup><a href="#bookmark2125">117</a></sup><sup></sup> Sample source code is provided in </span><a href="#bookmark251"><span class="font24">Appendix F</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2126"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2127"></a><a name="bookmark2128"></a>Digest Algorithm Input Data</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2129"></a><span class="font24">Digests are computed from three components:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• A pair of functions consisting of a one-way hash function H(</span><span class="font24" style="font-style:italic;">d</span><span class="font24">) and digest KD(</span><span class="font24" style="font-style:italic;">s,d</span><span class="font24">), where </span><span class="font24" style="font-style:italic;">s</span><span class="font24"> stands for secret and </span><span class="font24" style="font-style:italic;">d</span><span class="font24"> stands for data</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• A chunk of data containing security information, including the secret password, called A1</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• A chunk of data containing nonsecret attributes of the request message, called A2</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">The two pieces of data, A1 and A2, are processed by H and KD to yield a digest.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2130"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2131"></a>The Algorithms H(d) and KD(s,d)</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Digest authentication supports the selection of a variety of digest algorithms. The two algorithms suggested in RFC 2617 are MD5 and MD5-sess (where “sess” stands for session), and the algorithm defaults to MD5 if no other algorithm is specified.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-415.jpg" alt="" style="width:338pt;height:199pt;"></td></tr>
<tr><td>
<p><span class="font3" style="font-weight:bold;font-style:italic;">Digest authentication</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-416.jpg" alt="" style="width:26pt;height:29pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">(e) </span><span class="font0">Query</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-417.jpg" alt="" style="width:25pt;height:23pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font2">GET /cgi-bin/checkout?cart=17854 HTTP/1.1</span></p></td></tr>
<tr><td><img src="book_files/book-418.jpg" alt="" style="width:311pt;height:151pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-419.jpg" alt="" style="width:22pt;height:29pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">(h) </span><span class="font0">Success</span></p></td><td><img src="book_files/book-420.jpg" alt="" style="width:294pt;height:73pt;"></td></tr>
</table>
</div><br clear="all">
<p><a name="bookmark2120"></a><span class="font23" style="font-style:italic;">Figure 13-3. Basic versus digest authentication syntax</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2132"></a><span class="font24"><a name="bookmark2133"></a>If either MD5 or MD5-sess is used, the H function computes the MD5 of the data, and the KD digest function computes the MD5 of the colon-joined secret and nonsecret data. In other words:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">H(&lt;data&gt;) = MD5(&lt;data&gt;)</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 16pt 0pt;"><span class="font3">KD(&lt;secret&gt;,&lt;data&gt;) = H(concatenate(&lt;secret&gt;:&lt;data&gt;))</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2134"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2135"></a>T<a name="bookmark2136"></a>he Security-Related Data (A1)</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The chunk of data called A1 is a product of secret and protection information, such as the username, password, protection realm, and nonces. A1 pertains only to security information, not to the underlying message itself. A1 is used along with H, KD, and A2 to compute digests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">RFC 2617 defines two ways of computing A1, depending on the algorithm chosen:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">MD5</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">One-way hashes are run for every request; A1 is the colon-joined triple of username, realm, and secret password.</span></p>
<p><span class="font24" style="font-style:italic;">MD5-sess</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark2137"></a><span class="font24"><a name="bookmark2138"></a>The hash function is run only once, on the first WWW-Authenticate handshake; the CPU-intensive hash of username, realm, and secret password is done once and prepended to the current nonce and client nonce (cnonce) values.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">The definitions of A1 are shown in </span><a href="#bookmark2139"><span class="font24">Table 13-2</span></a><span class="font24">.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2139"></a><span class="font23" style="font-style:italic;">Table 13-2. Definitions for A1 by algorithm</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Algorithm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">MD5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">A1 = &lt;user&gt;:&lt;realm&gt;:&lt;password&gt;</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 16pt 0pt;"><span class="font2">MD5-sess &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">A1 = MD5(&lt;user&gt;:&lt;realm&gt;:&lt;password&gt;):&lt;nonce&gt;:&lt;cnonce&gt;</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2140"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2141"></a><a name="bookmark2142"></a>The Message-Related Data (A2)</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The chunk of data called A2 represents information about the message itself, such as the URL, request method, and message entity body. A2 is used to help protect against method, resource, or message tampering. A2 is used along with H, KD, and A1 to compute digests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">RFC 2617 defines two schemes for A2, depending on the quality of protection (qop) chosen:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• The first scheme involves only the HTTP request method and URL. This is used when qop=“auth”, which is the default case.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The second scheme adds in the message entity body to provide a degree of message integrity checking. This is used when qop=“auth-int”.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2143"></a><span class="font24"><a name="bookmark2144"></a><a name="bookmark2145"></a>The definitions of A2 are shown in </span><a href="#bookmark2146"><span class="font24">Table 13-3</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2146"></a><span class="font23" style="font-style:italic;">Table 13-3. Definitions for A2 by algorithm (request digests)</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">qop &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">undefined &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">auth &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 14pt 0pt;"><span class="font2">auth-int &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;:H(&lt;request-entity-body&gt;)</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The </span><span class="font24" style="font-style:italic;">request-method</span><span class="font24"> is the HTTP request method. The </span><span class="font24" style="font-style:italic;">uri-directive-value</span><span class="font24"> is the request URI from the request line. This may be “*,” an “absoluteURL,” or an “abs_ path,” but it must agree with the request URI. In particular, it must be an absolute URL if the request URI is an absoluteURL.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2147"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2148"></a>Overall Digest Algorithm</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">RFC 2617 defines two ways of computing digests, given H, KD, A1, and A2:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The first way is intended to be compatible with the older specification RFC 2069, used when the qop option is missing. It computes the digest using the hash of the secret information and the nonced message data.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The second way is the modern, preferred approach—it includes support for nonce counting and symmetric authentication. This approach is used whenever qop is “auth” or “auth-int”. It adds nonce count, qop, and cnonce data to the digest.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2149"></a><span class="font24">The definitions for the resulting digest function are shown in </span><a href="#bookmark2150"><span class="font24">Table 13-4</span></a><span class="font24">. Notice the resulting digests use H, KD, A1, and A2.</span></p>
<table>
<tr><td>
<p><a name="bookmark2150"></a><span class="font23" style="font-style:italic;">Table 13-4. Old and new digest algorithms</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">qop</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2" style="font-weight:bold;">Digest algorithm</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2" style="font-weight:bold;">Notes</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">undefined</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font3">KD(H(A1), &lt;nonce&gt;:H(A2))</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">Deprecated</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">auth or auth-int</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font3">KD(H(A1), &lt;nonce&gt;:&lt;nc&gt;:&lt;cnonce&gt;:&lt;qop&gt;:H(A2))</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">Preferred</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">It’s a bit easy to get lost in all the layers of derivational encapsulation. This is one of the reasons that some readers have difficulty with RFC 2617. To try to make it a bit easier,</span><a href="#bookmark2151"><span class="font24"> Table 13-5 </span></a><span class="font24">expands away the H and KD definitions, and leaves digests in terms of A1 and A2.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2151"></a><span class="font23" style="font-style:italic;">Table 13-5. Unfolded digest algorithm cheat sheet</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2" style="font-weight:bold;">qop</span></p>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">undefined</span></p>
</div>
<p style="text-indent:27pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">Algorithm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unfolded algorithm</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font3">MD5(MD5(A1):&lt;nonce&gt;:MD5(A2))</span></p>
</div>
<p style="text-indent:27pt;"><span class="font2">&lt;undefined&gt;</span></p>
<p style="padding:0pt 0pt 7pt 73pt;"><span class="font2">MD5 MD5-sess</span></p>
<table>
<tr><td>
<p><a name="bookmark2152"></a><span class="font23" style="font-style:italic;"><a name="bookmark2153"></a>Table 13-5. Unfolded digest algorithm cheat sheet (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">qop</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2" style="font-weight:bold;">Algorithm</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Unfolded algorithm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark2154"></a><span class="font2">auth</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">&lt;undefined&gt;</span></p>
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">MD5 MD5-sess</span></p></td><td style="vertical-align:top;">
<p style="text-indent:16pt;"><span class="font3">MD5(MD5(A1):&lt;nonce&gt;:&lt;nc&gt;:&lt;cnonce&gt;:&lt;qop&gt;:MD5(A2))</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">auth-int</span></p></td><td style="vertical-align:top;">
<p style="text-indent:22pt;"><span class="font2">&lt;undefined&gt;</span></p>
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">MD5 MD5-sess</span></p></td><td style="vertical-align:top;">
<p style="text-indent:16pt;"><span class="font3">MD5(MD5(A1):&lt;nonce&gt;:&lt;nc&gt;:&lt;cnonce&gt;:&lt;qop&gt;:MD5(A2))</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2155"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2156"></a>Digest Authentication Session</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The client response to a WWW-Authenticate challenge for a protection space starts an authentication session with that protection space (the realm combined with the canonic<a name="bookmark2157"></a>al root of the server being accessed defines a “protection space”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2158"></a><span class="font24">The authentication session lasts until the client receives another WWW-Authenti-cate challenge from any server in the protection space. A client should remember the username, password, nonce, nonce count, and opaque values associated with an authentication session to use to construct the Authorization header in future requests within that protection space.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2159"></a><span class="font24">When the nonce expires, the server can choose to accept the old Authorization header information, even though the nonce value included may not be fresh. Alternatively, the server may return a 401 response with a new nonce value, causing the client to retry the request; by specifying “stale=true” with this response, the server tells the client to retry with the new nonce without prompting for a new username and password.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2160"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2161"></a>Preemptive Authorization</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In normal authentication, each request requires a request/challenge cycle before the transaction can be completed. This is depicted in</span><a href="#bookmark2162"><span class="font24"> Figure 13-4</span></a><span class="font24">a.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This request/challenge cycle can be eliminated if the client knows in advance what the next nonce will be, so it can generate the correct Authorization header before the server asks for it. If the client can compute the Authorization header before it is requested, the client can preemptively issue the Authorization header to the server, without first going through a request/challenge. The performance impact is depicted in </span><a href="#bookmark2162"><span class="font24">Figure 13-4</span></a><span class="font24">b.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Preemptive authorization is trivial (and common) for basic authentication. Browsers commonly maintain client-side databases of usernames and passwords. Once a user authenticates with a site, the browser commonly sends the correct Authorization header for subsequent requests to that URL (see</span><a href="#bookmark236"><span class="font24"> Chapter 12</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> Normal request/challenge</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> Preemptive authorization</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-421.jpg" alt="" style="width:27pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-422.jpg" alt="" style="width:27pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-423.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-424.jpg" alt="" style="width:31pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-425.jpg" alt="" style="width:108pt;height:289pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-426.jpg" alt="" style="width:119pt;height:289pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark2162"></a><span class="font23" style="font-style:italic;">Figure 13-4. Preemptive authorization reduces message count</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2163"></a><span class="font24">Preemptive authorization is a bit more complicated for digest authentication, because of the nonce technology intended to foil replay attacks. Because the server generates arbitrary nonces, there isn’t always a way for the client to determine what Authorization header to send until it receives a challenge.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Digest authentication offers a few means for preemptive authorization while retaining many of the safety features. Here are three potential ways a client can obtain the correct nonce without waiting for a new WWW-Authenticate challenge:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Server pre-sends the next nonce in the Authentication-Info success header.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Server allows the same nonce to be reused for a small window of time.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Both the client and server use a synchronized, predictable nonce-generation algorithm.</span></p></li></ul>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2164"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2165"></a><a name="bookmark2166"></a>Next nonce pregeneration</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2167"></a><span class="font24">The next nonce value can be provided in advance to the client by the AuthenticationInfo success header. This header is sent along with the 200 OK response from a previous successful authentication.</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Authentication-Info: nextnonce=&quot;&lt;nonce-value&gt;&quot;</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Given the next nonce, the client can preemptively issue an Authorization header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">While this preemptive authorization avoids a request/challenge cycle (speeding up the transaction), it also effectively nullifies the ability to pipeline multiple requests to the same server, because the next nonce value must be received before the next request can be issued. Because pipelining is expected to be a fundamental technology for latency avoidance, the performance penalty may be large.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2168"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2169"></a>Limited nonce reuse</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Instead of pregenerating a sequence of nonces, another approach is to allow limited reuse of nonces. For example, a server may allow a nonce to be reused 5 times, or for 10 seconds.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In this case, the client can freely issue requests with the Authorization header, and it can pipeline them, because the nonce is known in advance. When the nonce finally expires, the server is expected to send the client a 401 Unauthorized challenge, with the WWW-Authenticate: stale=true directive set:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">WWW-Authenticate: Digest</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 35pt;"><span class="font3">realm=&quot;&lt;realm-value&gt;&quot; nonce=&quot;&lt;nonce-va<a name="bookmark2170"></a>lue&gt;&quot; stale=true</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Reusing nonces does reduce security, because it makes it easier for an attacker to succeed at replay attacks. Because the lifetime of nonce reuse is controllable, from strictly no reuse to potentially long reuse, trade-offs can be made between windows of vulnerability and performance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Additionally, other features can be employed to make replay attacks more difficult, including incrementing counters and IP address tests. However, while making attacks more inconvenient, these techniques do not eliminate the vulnerability.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2171"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2172"></a>Synchronized nonce generation</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">It is possible to employ time-synchronized nonce-generation algorithms, where both the client and the server can generate a sequence of identical nonces, based on a shared secret key, that a third party cannot easily predict (such as secure ID cards).</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">These algorithms are beyond the scope of the digest authentication specification.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2173"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2174"></a><a name="bookmark2175"></a>Nonce Selection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2176"></a><span class="font24">The contents of the nonce are opaque and implementation-dependent. However, the quality of performance, security, and convenience depends on a smart choice.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">RFC 2617 suggests this hypothetical nonce formulation:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">BASE64(time-stamp H(time-stamp &quot;:&quot; ETag &quot;:&quot; private-key))</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">where time-stamp is a server-generated time or other nonrepeating value, ETag is the value of the HTTP ETag header associated with the requested entity, and private-key is data known only to the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2177"></a><span class="font24">With a nonce of this form, a server will recalculate the hash portion after receiving the client authentication header and reject the request if it does not match the nonce from that header or if the time-stamp value is not recent enough. In this way, the server can limit the duration of the nonce’s validity.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2178"></a><span class="font24">The inclusion of the ETag prevents a replay request for an updated version of the resource. (Note that including the IP address of the client in the nonce would appear to offer the server the ability to limit the reuse of the nonce to the same client that originally got it. However, that would break proxy farms, in which requests from a single user often go through different proxies. Also, IP address spoofing is not that hard.)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">An implementation might choose not to accept a previously used nonce or digest, to protect against replay attacks. Or, an implementation might choose to use one-time nonces or digests for POST or PUT requests and time-stamps for GET requests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Refer to </span><a href="#bookmark2179"><span class="font24">“Security Considerations</span></a><span class="font24">” for practical security considerations that affect nonce selection.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2180"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2181"></a><a name="bookmark2182"></a>Symmetric Authentication</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">RFC 2617 extends digest authentication to allow the client to authenticate the server. It does this by providing a clien<a name="bookmark2183"></a>t nonce value, to which the server generates a correct response digest based on correct knowledge of the shared secret information. The server then returns this digest to the client in the Authorization-Info header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This symmetric authentication is standard as of RFC 2617. It is optional for backward compatibility with the older RFC 2069 standard, but, because it provides important security enhancements, all modern clients and servers are strongly recommended to implement all of RFC 2617’s features. In particular, symmetric authentication is required to be performed whenever a qop directive is present and required not to be performed when the qop directive is missing.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The response digest is calculated like the request digest, except that the message body information (A2) is different, because there is no method in a response, and the message entity data is different. The methods of computation of A2 for request and response digests are compared in Tables 13-6 and 13-7.</span></p>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 13-6. Definitions for A2 by algorithm (request digests)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 6pt 0pt;"><span class="font2" style="font-weight:bold;">qop</span></p>
<p style="text-indent:7pt;"><span class="font2">undefined</span></p></td><td style="vertical-align:top;">
<p style="text-indent:20pt;padding:0pt 0pt 5pt 0pt;"><span class="font2" style="font-weight:bold;">A2</span></p>
<p style="text-indent:20pt;"><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">auth</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:20pt;"><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">auth-int</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:20pt;"><span class="font3">&lt;request-method&gt;:&lt;uri-directive-value&gt;:H(&lt;request-entity-body&gt;)</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font23" style="font-style:italic;">Table 13-7. Definitions for A2 by algorithm (response digests)</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2184"></a><span class="font2" style="font-weight:bold;">qop &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">undefined &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">:&lt;uri-directive-value&gt;</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">auth &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">:&lt;uri-directive-value&gt;</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 14pt 0pt;"><span class="font2">auth-int &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font3">:&lt;uri-directive-value&gt;:H(&lt;response-entity-body&gt;)</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The cnonce value and nc value must be the ones for the client request to which this message is the response. The response auth, cnonce, and nonce count directives must be present if qop=“auth” or qop=“auth-int” is specified.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2185"></a><span class="font9" style="font-weight:bold;"><a name="bookmark124"></a><a name="bookmark2186"></a>Quality of Protection Enhancements</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The qop field may be present in all three digest headers: WWW-Authenticate, Authorization, and Authentication-Info.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The qop field lets clients and servers negotiate for different types and qualities of protection. For example, some transactions may want to sanity check the integrity of message bodies, even if that slows down transmission significantly.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2187"></a><span class="font24">The server first exports a comma-separated list of qop options in the WWW-Authen-ticate header. The client then selects one of the options that it supports and that meets its needs and passes it back to the server in its Authorization qop field.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Use of qop is optional, but only for backward compatibility with the older RFC 2069 specification. The qop option should be supported by all modern digest implementations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">RFC 2617 defines two initial quality of protection values: “auth,” indicating authentication, and “auth-int,” indicating authentication with message integrity protection. Other qop options are expected in the future.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2188"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2189"></a>Message Integrity Protection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If integrity protection is applied (qop=“auth-int”), H (the entity body) is the hash of the entity body, not the message body. It is computed before any transfer encoding is applied by the sender and after it has been removed by the recipient. Note that this includes multipart boundaries and embedded headers in each part of any multipart content type.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2190"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2191"></a><a name="bookmark2192"></a>Digest Authentication Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark2193"></a><span class="font24">Both the basic and digest authentication protocols contain an authorization challenge, carried by the WWW-Authenticate header, and an authorization response, carried by the Authorization header. Digest authentication adds an optional Authorization-Info header, which is sent after successful authentication, to complete a three-phase handshake and pass along the next nonce to use. The basic and digest authentication headers are shown in</span><a href="#bookmark2100"><span class="font24"> Table 13-8</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2100"></a><span class="font23" style="font-style:italic;">Table 13-8. HTTP authentication headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Phase</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Basic</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2" style="font-weight:bold;">Digest</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Challenge</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font3">WWW-Authenticate: Basic</span></p>
<p style="text-indent:29pt;"><span class="font3">realm=&quot;&lt;realm-value&gt;&quot;</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 34pt;"><span class="font3">WWW-Authenticate: Digest realm=&quot;&lt;realm-value&gt;&quot; nonce=&quot;&lt;nonce-value&gt;&quot; [domain=&quot;&lt;list-of-URIs&gt;&quot;] [opaque=&quot;&lt;opaque-token-value&gt;&quot;] [stale=&lt;true-or-false&gt;] [algorithm=&lt;digest-algorithm&gt;] [qop=&quot;&lt;list-of-qop-values&gt;&quot;] [&lt;extension-directive&gt;]</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Response</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font3">Authorization: Basic</span></p>
<p style="text-indent:29pt;"><span class="font3">&lt;base64(user:pass)&gt;</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 34pt;"><span class="font3">Authorization: Digest username=&quot;&lt;username&gt;&quot; realm=&quot;&lt;realm-value&gt;&quot; nonce=&quot;&lt;nonce-value&gt;&quot; uri=&lt;request-uri&gt;</span></p>
<p style="padding:0pt 0pt 0pt 34pt;"><span class="font3">response=&quot;&lt;32-hex-digit-digest&gt;&quot; [algorithm=&lt;digest-algorithm&gt;] [opaque=&quot;&lt;opaque-token-value&gt;&quot;] [cnonce=&quot;&lt;nonce-value&gt;&quot;]</span></p>
<p style="text-indent:34pt;"><span class="font3">[qop=&lt;qop-value&gt;]</span></p>
<p style="padding:0pt 0pt 0pt 34pt;"><span class="font3">[nc=&lt;8-hex-digit-nonce-count&gt;] [&lt;extension-directive&gt;]</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Info</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font3">n/a</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font3">Authentication-Info:</span></p>
<p style="padding:0pt 0pt 0pt 34pt;"><span class="font3">nextnonce=&quot;&lt;nonce-value&gt;&quot; [qop=&quot;&lt;list-of-qop-values&gt;&quot;] [rspauth=&quot;&lt;hex-digest&gt;&quot;] [cnonce=&quot;&lt;nonce-value&gt;&quot;]</span></p>
<p style="text-indent:34pt;"><span class="font3">[nc=&lt;8-hex-digit-nonce-count&gt;]</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The digest authentication headers are quite a bit more complicated. They are described in detail in </span><a href="#bookmark251"><span class="font24">Appendix F</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2194"></a><span class="font9" style="font-weight:bold;"><a name="bookmark125"></a><a name="bookmark2195"></a>Practical Considerations</span></h2>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">There are several things you need to consider when working with digest authentication. This section discusses some of these issues.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2196"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2197"></a><a name="bookmark2198"></a>Multiple Challenges</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A server can issue multiple challenges for a resource. For example, if a server does not know the capabilities of a client, it may provide both basic and digest authentication challenges. When faced with multiple challenges, the client must choose to answer with the strongest authentication mechanism that it supports.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2199"></a><span class="font24"><a name="bookmark2200"></a>User agents must take special care in parsing the WWW-Authenticate or Proxy-Authenticate header field value if it contains more than one challenge or if more than one WWW-Authenticate header field is provided, as a challenge may itself contain a comma-separated list of authentication parameters. Note that many browsers recognize only basic authentication and require that it be the first authentication mechanism presented.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There are obvious “weakest link” security concerns when providing a spectrum of authentication options. Servers should include basic authentication only if it is minimally acceptable, and administrators should caution users about the dangers of sharing the same password across systems when different levels of security are being employed.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2201"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2202"></a>Error Handling</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In digest authentication, if a directive or its value is improper, or if a required directive is missing, the proper response is 400 Bad Request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2203"></a><span class="font24">If a request’s digest does not match, a login failure should be logged. Repeated failures from a client may indicate an attacker attempting to guess passwords.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2204"></a><span class="font24">The authenticating server must assure that the resource designated by the “uri” directive is the same as the resource specified in the request line; if they are different, the server should return a 400 Bad Request error. (As this may be a symptom of an attack, server designers may want to consider logging such errors.) Duplicating information from the request URL in this field deals with the possibility that an intermediate proxy may alter the client’s request line. This altered (but, presumably, semantically equivalent) request would not result in the same digest as that calculated by the client.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2205"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2206"></a>Protection Spaces</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The realm value, in combination with the canonical root URL of the server being accessed, defines the protection space.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Realms allow the protected resources on a server to be partitioned into a set of protection spaces, each with its own authentication scheme and/or authorization database. The realm value is a string, generally assigned by the origin server, which may have additional semantics specific to the authentication scheme. Note that there may be multiple challenges with the same authorization scheme but different realms.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2207"></a><span class="font24">The <a name="bookmark2208"></a>protection space determines the domain over which credentials can be automatically applied. If a prior request has been authorized, the same credentials may be reused for all other requests within that protection space for a period of time determined by the authentication scheme, parameters, and/or user preference. Unless otherwise defined by the authentication scheme, a single protection space cannot extend outside the scope of its server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The specific calculation of protection space depends on the authentication mechanism:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark2209"></a><span class="font24"><a name="bookmark2210"></a>• In basic authentication, clients assume that all paths at or below the request URI are within the same protection space as the current challenge. A client can preemptively authorize for resources in this space without waiting for another challenge from the server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• In digest authentication, the challenge’s WWW-Authenticate: domain field more precisely defines the protection space. The domain field is a quoted, space-separated list of URIs. All the URIs in the domain list, and all URIs logically beneath these prefixes, are assumed to be in the same protection space. If the domain field is missing or empty, all URIs on the challenging server are in the protection space.</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2211"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2212"></a>Rewriting URIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2213"></a><span class="font24">Proxies may rewrite URIs in ways that change the URI syntax but not the actual resource being described. For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Hostnames may be normalized or replaced with IP addresses.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Embedded characters may be replaced with “%” escape forms.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Additional attributes of a type that doesn’t affect the resource fetched from the particular origin server may be appended or inserted into the URI.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Because URIs can be changed by proxies, and because digest authentication sanity checks the integrity of the URI value, the digest authentication will break if any of these changes are made. See</span><a href="#bookmark2140"><span class="font24"> “The Message-Related Data (A2)</span></a><span class="font24">” for more information.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2214"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2215"></a>Caches</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a shared cache receives a request containing an Authorization header and a response from relaying that request, it must not return that response as a reply to any other request, unless one of two Cache-Control directives was present in the response:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If the original response included the “must-revalidate” Cache-Control directive, the cache may use the entity of that response in replying to a subsequent request. However, it must first revalidate it with the origin server, using the request headers from the new request, so the origin server can authenticate the new request.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• If the original response included the “public” Cache-Control directive, the response entity may be returned in reply to any subsequent request.</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2179"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2216"></a><a name="bookmark2217"></a><a name="bookmark2218"></a><a name="bookmark126"></a><a name="bookmark2219"></a>Security Considerations</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">RFC 2617 does an admirable job of summarizing some of the security risks inherent i<a name="bookmark2220"></a>n HTTP authentication schemes. This section describes some of these risks.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2221"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2222"></a>Header Tampering</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">To provide a foolproof system against header tampering, you need either end-to-end encryption or a digital signature of the headers—preferably a combination of both! Digest authentication is focused on providing a tamper-proof authentication scheme, but it does not necessarily extend that protection to the data. The only headers that have some level of protection are WWW-Authenticate and Authorization.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2223"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2224"></a>Replay Attacks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A replay attack, in the current context, is when someone uses a set of snooped authentication credentials from a given transaction for another transaction. While this problem is an issue with GET requests, it is vital that a foolproof method for avoiding replay attacks be available for POST and PUT requests. The ability to successfully replay previously used credentials while transporting form data could cause security nightmares.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Thus, in order for a server to accept “replayed” credentials, the nonce values must be repeated. One of the ways to mitigate this problem is to have the server generate a nonce containing a digest of the client’s IP address, a time-stamp, the resource ETag, and a private server key (as recommended earlier). In such a scenario, the combination of an IP address and a short timeout value may provide a huge hurdle for the attacker.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2225"></a><span class="font24">However, this solution has a major drawback. As we discussed earlier, using the client’s IP address in creating a nonce breaks transmission through proxy farms, in which requests from a single user may go through different proxies. Also, IP spoofing is not too difficult.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One way to completely avoid replay attacks is to use a unique nonce value for every transaction. In this implementation, for each transaction, the server issues a unique nonce along with a timeout value. The issued nonce value is valid only for the given transaction, and only for the duration of the timeout value. This accounting may increase the load on servers; however, the increase should be miniscule.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2226"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2227"></a>Multiple Authentication Mechanisms</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a server supports multiple authentication schemes (such as basic and digest), it usually provides the choice in WWW-Authenticate headers. Because the client is <a name="bookmark2228"></a>not required to opt for the strongest authentication mechanism, the strength of the resulting authentication is only as good as that of the weakest of the authentication schemes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The obvious ways to avoid this problem is to have the clients always choose the strongest authentication scheme available. If this is not practical (as most of us do use commercially available clients), the only other option is to use a proxy server to retain only the strongest authentication scheme. However, such an approach is feasible only in a domain in which all of the clients are known to be able to support the chosen authentication scheme—e.g., a corporate network.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2229"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2230"></a>Dictionary Attacks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2231"></a><span class="font24"><a name="bookmark2232"></a>Dictionary attacks are typical password-guessing attacks. A malicious user can eavesdrop on a transaction and use a standard password-guessing program against nonce/ response pairs. If the users are using relatively simple passwords and the servers are using simplistic nonces, it is quite possible to find a match. If there is no password aging policy, given enough time and the one-time cost of cracking the passwords, it is easy to collect enough passwords to do some real damage.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There really is no good way to solve this problem, other than using relatively complex passwords that are hard to crack and a good password aging policy.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2233"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2234"></a>Hostile Proxies and Man-in-the-Middle Attacks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Much Internet traffic today goes through a proxy at one point or another. With the advent of redirection techniques and intercepting proxies, a user may not even realize that his request is going through a proxy. If one of those proxies is hostile or compromised, it could leave the client vulnerable to a man-in-the-middle attack.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Such an attack could be in the form of eavesdropping, or altering available authentication schemes by removing all of the offered choices and replacing them with the weakest authentication scheme (such as basic authentication).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">One of the ways to compromise a trusted proxy is though its extension interfaces. Proxies sometimes provide sophisticated programming interfaces, and with such proxies it may be feasible to write an extension (i.e., plug-in) to intercept and modify the traffic. However, the data-center security and security offered by proxies themselves make the possibility of man-in-the-middle attacks via rogue plug-ins quite remote.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There is no good way to fix this problem. Possible solutions include clients providing visual cues regarding the authentication strength, configuring clients to always use the strongest possible authentication, etc., but even when using the strongest possible authentication scheme, clients still are vulnerable to eavesdropping. The only foolproof way to guard against these attacks is by using SSL.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2235"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2236"></a><a name="bookmark2237"></a><a name="bookmark2238"></a>Chosen Plaintext Attacks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2239"></a><span class="font24">Clients using digest authentication use a nonce supplied by the server to generate the response. However, if there is a compromised or malicious proxy in the middle intercepting the traffic (or a malicious origin server), it can easily supply a nonce for response computation by the client. Using the known key for computing the response may make the cryptanalysis of the response easier. This is called a </span><span class="font24" style="font-style:italic;">chosen plaintext attack</span><span class="font24">. There are a few variants of chosen plaintext attacks:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Precomputed dictionary attacks</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">This is a combination of a dictionary attack and a chosen plaintext attack. First, the attacking server generates a set of responses, using a predetermined nonce and common password variations, and creates a dictionary. Once a sizeable dictionary is available, the attacking server/proxy can complete the interdiction of the traffic and start sending predetermined nonces to the clients. When it gets a response from a client, the attacker searches the generated dictionary for matches. If a there is a match, the attacker has the password for that particular user.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font24" style="font-style:italic;">Batched brute-force attacks</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark2240"></a><span class="font24">The difference in a batched brute-force attack is in the computation of the password. Instead of trying to match a precomputed digest, a set of machines goes to work on enumerating all of the possible passwords for a given space. As the machines get faster, the brute-force attack becomes more and more viable.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In general, the threat posed by these attacks is easily countered. One way to prevent them is to configure clients to use the optional cnonce directive, so that the response is generated at the client’s discretion, not using the nonce supplied by the server (which could be compromised by the attacker). This, combined with policies enforcing reasonably strong passwords and a good password aging mechanism, can mitigate the threat of chosen plaintext attacks completely.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2241"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2242"></a>Storing Passwords</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The digest authentication mechanism compares the user response to what is stored internally by the server—usually, usernames and H(A1) tuples, where H(A1) is derived from the digest of username, realm, and password.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unlike with a traditional password file on a Unix box, if a digest authentication password file is compromised, all of the documents in the realm immediately are available to the attacker; there is no need for a decrypting step.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some of the ways to mitigate this problem are to:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Protect the password file as though it contained clear-text passwords.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Make sure the realm name is unique among all the realms, so that if a password file is compromised, the damage is localized to a particular realm. A fully qualified realm name with host and domain included should satisfy this requirement.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2243"></a><span class="font24">While digest authentication provides a much more robust and secure solution than basic authentication, it still does not provide any protection for security of the con-tent—a truly secure transaction is feasible only through SSL, which we describe in the next chapter.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2244"></a><span class="font9" style="font-weight:bold;"><a name="bookmark127"></a><a name="bookmark2245"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For more information on authentication, see:</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2617.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2617.txt</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 6pt 0pt;"><span class="font24">RFC 2617, “HTTP Authentication: Basic and Digest Access Authentication.”</span></p>
<p style="text-align:right;padding:0pt 0pt 4pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 14</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark238"></a><span class="font11" style="font-weight:bold;"><a name="bookmark128"></a><a name="bookmark2246"></a>Secure HTTP</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2247"></a><span class="font24"><a name="bookmark2248"></a><a name="bookmark2249"></a>The previous three chapters reviewed features of HTTP that help identify and authenticate users. These techniques work well in a friendly community, but they aren’t strong enough to protect important transactions from a community of motivated and hostile adversaries.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This chapter presents a more complicated and aggressive technology to secure HTTP transactions from eavesdropping and tampering, using digital cryptography.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2250"></a><span class="font9" style="font-weight:bold;"><a name="bookmark129"></a><a name="bookmark2251"></a>Making HTTP Safe</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">People use web transactions for serious things. Without strong security, people wouldn’t feel comfortable doing online shopping and banking. Without being able to restrict access, companies couldn’t place important documents on web servers. The Web requires a secure form of HTTP.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The previous chapters talked about some lightweight ways of providing authentication (basic and digest authentication) and message integrity (digest qop=“auth-int”). These schemes are good for many purposes, but they may not be strong enough for large purchases, bank transactions, or access to confidential data. For these more serious transactions, we combine HTTP with digital encryption technology.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A secure version of HTTP needs to be efficient, portable, easy to administer, and adaptable to the changing world. It also has to meet societal and governmental requirements. We need a technology for HTTP security that provides:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Server authentication (clients know they’re talking to the real server, not a phony)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Client authentication (servers know they’re talking to the real user, not a phony)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Integrity (clients and servers are safe from their data being changed)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Encryption (clients and servers talk privately without fear of eavesdropping)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Efficiency (an algorithm fast enough for inexpensive clients and servers to use)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Ubiquity (protocols are supported by virtually all clients and servers)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2252"></a><span class="font24"><a name="bookmark2253"></a>• Administrative scalability (instant secure communication for anyone, anywhere)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Adaptability (supports the best known security methods of the day)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 16pt 0pt;"><span class="font24">• Social viability (meets the cultural and political needs of the society)</span></p></li></ul>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2254"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2255"></a>HTTPS</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTPS is the most popular secure form of HTTP. It was pioneered by Netscape Communications Corporation and is supported by all major browsers and servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 16pt 0pt;"><span class="font24">You can tell if a web page was accessed through HTTPS instead of HTTP, because the URL will start with the scheme </span><span class="font24" style="font-style:italic;">https://</span><span class="font24"> instead of </span><span class="font24" style="font-style:italic;">http://</span><span class="font24"> (some browsers also display iconic security cues, as shown in </span><a href="#bookmark2256"><span class="font24">Figure 14-1</span></a><span class="font24">).</span></p>
<table>
<tr><td>
<p><span class="font0">https scheme</span></p></td><td><img src="book_files/book-427.jpg" alt="" style="width:266pt;height:208pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font0">security icon</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2256"></a><span class="font23" style="font-style:italic;"><a name="bookmark2257"></a>Figure 14-1. Browsing secure web sites</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2258"></a><span class="font24">When using HTTPS, all the HTTP request and response data is encrypted before being sent across the network. HTTPS works by providing a transport-level cryptographic security layer—using either the Secure Sockets Layer (SSL) or its successor, Transport Layer Security (TLS)—underneath HTTP (</span><a href="#bookmark2259"><span class="font24">Figure 14-2</span></a><span class="font24">). Because SSL and TLS are so similar, in this book we use the term “SSL” loosely to represent both SSL and TLS.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Because most of the hard encoding and decoding work happens in the SSL libraries, web clients and servers don’t need to change much of their protocol processing logic</span></p>
<table>
<tr><td>
<table border="1">
<tr><td colspan="3" style="vertical-align:top;"></td><td rowspan="2" style="vertical-align:bottom;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td></tr>
<tr><td colspan="3" style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 229pt;"><span class="font2">HTTP</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><a name="bookmark2260"></a><span class="font2">HTTP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:31pt;"><span class="font2">SSL or TLS</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Security layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:39pt;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:39pt;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:18pt;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">HTTP</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-indent:31pt;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">HTTPS</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark2259"></a><span class="font23" style="font-style:italic;"><a name="bookmark2261"></a>Figure 14-2. HTTPS is HTTP layered over a security layer, layered over TCP</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">to use secure HTTP. For the most part, they simply need to replace TCP input/out-put calls with SSL calls and add a few other calls to configure and manage the security information.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2262"></a><span class="font9" style="font-weight:bold;"><a name="bookmark130"></a><a name="bookmark2263"></a>Digital Cryptography</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Before we talk in detail about HTTPS, we need to provide a little background about the cryptographic encoding techniques used by SSL and HTTPS. In the next few sections, we’ll give a speedy primer of the essentials of digital cryptography. If you already are familiar with the technology and terminology of digital cryptography, feel free to jump ahead to</span><a href="#bookmark2264"><span class="font24"> “HTTPS: The Details</span></a><span class="font24">.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In this digital cryptography primer, we’ll talk about:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Ciphers</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Algorithms for encoding text to make it unreadable to voyeurs</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Keys</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Numeric parameters that change the behavior of ciphers</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Symmetric-key cryptosystems</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Algorithms that use the same key for encoding and decoding</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Asymmetric-key cryptosystems</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Algorithms that use different keys for encoding and decoding</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Public-key cryptography</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">A system making it easy for millions of computers to send secret messages</span></p>
<p><span class="font24" style="font-style:italic;">Digital signatures</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Checksums that verify that a message has not been forged or tampered with</span></p>
<p><span class="font24" style="font-style:italic;">Digital certificates</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Identifying information, verified and signed by a trusted organization</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2265"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2266"></a><a name="bookmark2267"></a>The Art and Science of Secret Coding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2268"></a><span class="font24"><a name="bookmark2269"></a>Cryptography is the art and science of encoding and decodin<a name="bookmark2270"></a>g messages. People have used cryptographic methods to send secret messages for thousands of years. However, cryptography can do more than just encrypt messages to prevent reading by nosy folks; it also can be used to prevent tampering with messages. Cryptography even can be used to prove that you indeed authored a message or transaction, just like your handwritten signature on a check or an embossed wax seal on an envelope.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2271"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2272"></a>Ciphers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Cryptography is based on secret codes called </span><span class="font24" style="font-style:italic;">ciphers</span><span class="font24">. A cipher is a coding scheme—a particular way to encode a message and an accompanying way to decode the secret later. The original message, before it is encoded, often is called </span><span class="font24" style="font-style:italic;">plaintext</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">cleartext</span><span class="font24">. The coded message, after the cipher is applied, often is called </span><span class="font24" style="font-style:italic;">ciphertext</span><span class="font24">. </span><a href="#bookmark2273"><span class="font24">Figure 14-3</span></a><span class="font24"> shows a simple example.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font1" style="font-style:italic;">Plaintext</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 72pt;"><span class="font1" style="font-style:italic;">Ciphertext</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Plaintext</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">Meet me at the pier</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 75pt;"><span class="font2">Phhw ph dw wkh slhu</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 78pt;"><span class="font2">Meet me at the pier</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:14pt;"><span class="font2">at midnight</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 75pt;"><span class="font2">dw plgqljkw</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 78pt;"><span class="font2">at midnight</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-indent:21pt;"><span class="font1" style="font-style:italic;">Encoder</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:24pt;"><span class="font1" style="font-style:italic;">Decoder</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark2273"></a><span class="font23" style="font-style:italic;">Figure 14-3. Plaintext and ciphertext</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Ciphers have been used to generate secret messages for thousands of years. Legend has it that Julius Caesar used a three-character rotation cipher, where each character in the message is replaced with a character three alphabetic positions forward. In our modern alphabet, “A” would be replaced by “D,” “B” would be replaced by “E,” and so on.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">For example, in </span><a href="#bookmark2274"><span class="font24">Figure 14-4</span></a><span class="font24">, the message “meet me at the pier at midnight” encodes into the ciphertext “phhw ph dw wkh slhu dw plgqljkw” using the rot3 (rotate by 3 characters) cipher.<a name="footnote118"></a><sup><a href="#bookmark2275">118</a></sup><sup></sup> The ciphertext can be decrypted back to the original plaintext message by applying the inverse coding, rotating –3 characters in the alphabet.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 78pt;"><span class="font1" style="font-style:italic;">Cipher</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:24pt;"><span class="font4">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font4">ABCDEFGHIJKLMNOPQRSTUVWXYZABC</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 10pt 78pt;"><span class="font1" style="font-style:italic;">Plaintext</span></p>
<p style="padding:0pt 0pt 0pt 78pt;"><span class="font1" style="font-style:italic;">Ciphertext</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;padding:0pt 0pt 7pt 0pt;"><span class="font5">MEET ME AT THE AT PIER AT MIDNIGHT</span></p>
<p style="text-indent:7pt;"><span class="font5">PHHW PH DW WKH DW SLHU DW PLGQLJKW</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark2274"></a><span class="font23" style="font-style:italic;">Figure 14-4. Rotate-by-3 cipher example</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2276"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2277"></a><a name="bookmark2278"></a>Cipher Machines</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2279"></a><span class="font24">Ciphers began as relatively simple algorithms, because human beings needed to do the encoding and decoding themselves. Because the ciphers were simple, people could work the codes using pencil and paper and code books. However, it also was possible for clever people to “crack” the codes fairly easily.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2280"></a><span class="font24">As technology advanced, people started making machines that could quickly and accurately encode and decode messages using much more complicated ciphers. Instead of just doing simple rotations, these cipher machines could substitute characters, transpose the order of characters, and slice and dice messages to make codes much harder to crack.<a name="footnote119"></a><sup><a href="#bookmark2281">119</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2282"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2283"></a>Keyed Ciphers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because code algorithms and machines could fall into enemy hands, most machines had dials that could be set to a large number of different values that changed how the cipher worked. Even if the machine was stolen, without the right dial settings (key values) the decoder wouldn’t work.<a name="footnote120"></a><sup><a href="#bookmark2284">120</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2285"></a><span class="font24">These cipher parameters were called </span><span class="font24" style="font-style:italic;">keys</span><span class="font24">. You needed to enter the right key into the cipher machine to get the decoding process to work correctly. Cipher keys make a single cipher machine act like a set of many virtual cipher machines, each of which behaves differently because they have different key values.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a href="#bookmark2286"><span class="font24">Figure 14-5</span></a><span class="font24"> illustrates an example of keyed ciphers. The cipher algorithm is the trivial “rotate-by-N” cipher. The value of N is controlled by the key. The same input message, “meet me at the pier at midnight,” passed through the same encoding machine, generates different outputs depending on the value of the key. Today, virtually all cipher algorithms use keys.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2287"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2288"></a>Digital Ciphers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With the advent of digital computation, two major advances occurred:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Complicated encoding and decoding algorithms became possible, freed from the speed and function limitations of mechanical machinery.</span></p><img src="book_files/book-428.jpg" alt="" style="width:360pt;height:316pt;"></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark2286"></a><span class="font24"><a name="bookmark2289"></a>• It became possible to support very large keys, so that a single cipher algorithm could yield trillions of virtual cipher algorithms, each differing by the value of the key. The longer the key, the more combinations of encodings are possible, and the harder it is to crack the code by randomly guessing keys.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unlike physical metal keys or dial settings in mechanical devices, digital keys are just numbers. These digital key values are inputs to the encoding and decoding algorithms. The coding algorithms are functions that take a chunk of data and encode/ decode it based on the algorithm and the value of the key.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Given a plaintext message called P, an encoding function called E, and a digital encoding key called e, you can generate a coded ciphertext message C </span><a href="#bookmark2290"><span class="font24">(Figure 14-6</span></a><span class="font24">). You can decode the ciphertext C back into the original plaintext P by using the decoder function D and the decoding key d. Of course, the decoding and encoding functions are inverses of each other; the decoding of the encoding of P gives back the original message P.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">P</span><span class="font1" style="font-style:italic;text-decoration:underline;">laintext</span><span class="font1" style="font-style:italic;"> P</span></p></td></tr>
<tr><td><img src="book_files/book-429.jpg" alt="" style="width:61pt;height:41pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Encoder E</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-430.jpg" alt="" style="width:37pt;height:48pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Ciphertext C</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark2291"></a><span class="font6" style="font-weight:bold;">C = E(P, e)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Key= e</span></p></td></tr>
<tr><td><img src="book_files/book-431.jpg" alt="" style="width:22pt;height:12pt;"></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark2290"></a><span class="font23" style="font-style:italic;">Figure 14-6. Plaintext is encoded with encoding key e, and decoded using decoding key d</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2292"></a><span class="font9" style="font-weight:bold;"><a name="bookmark131"></a><a name="bookmark2293"></a>Symmetric-Key Cryptography</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s talk in more detail about how keys and ciphers work together. Many digital cipher algorithms are called </span><span class="font24" style="font-style:italic;">symmetric-key</span><span class="font24"> ciphers, because they use the same key value for encoding as they do for decoding (e = d). Let’s just call the key k.</span></p>
<p style="text-align:justify;"><a name="bookmark2294"></a><span class="font24">In a symmetric key cipher, both a sender and a receiver need to have the same shared secret key, k, to communicate. The sender uses the shared secret key to encrypt the message and sends the resulting ciphertext to the receiver. The receiver takes the ciphertext and applies the decrypting function, along with the same shared secret key, to recover the original plaintext (</span><a href="#bookmark2295"><span class="font24">Figure 14-7</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">P</span><span class="font1" style="font-style:italic;text-decoration:underline;">laintext</span><span class="font1" style="font-style:italic;"> P</span></p></td></tr>
<tr><td><img src="book_files/book-432.jpg" alt="" style="width:61pt;height:43pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Decoder D</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font6" style="font-weight:bold;">P = D(C, d)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Key= d</span></p></td></tr>
<tr><td><img src="book_files/book-433.jpg" alt="" style="width:22pt;height:12pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:right;"><span class="font1" style="font-style:italic;">Ciphertext C</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2295"></a><span class="font23" style="font-style:italic;"><a name="bookmark2296"></a>Figure 14-7. Symmetric-key cryptography algorithms use the same key for encoding and decoding</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some popular symmetric-key cipher algorithms are DES, Triple-DES, RC2, and RC4.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2297"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2298"></a>Key Length and Enumeration Attacks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">It’s very important that secret keys stay secret. In most cases, the encoding and decoding algorithms are public knowledge, so the key is the only thing that’s secret!</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">A good cipher algorithm forces the enemy to try every single possible key value in the universe to crack the code. Trying all key values by brute force is called an </span><span class="font24" style="font-style:italic;">enumeration attack</span><span class="font24">. If there are only a few possible key values, a bad guy can go through all of them by brute force and eventually crack the code. But if there are a lot of possible key values, it might take the bad guy days, years, or even the lifetime of the universe to go through all the keys, looking for one that breaks the cipher.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The number of possible key values depends on the number of bits in the key and how many of the possible keys are valid. For symmetric-key ciphers, usually all of the key values are valid.<a name="footnote121"></a><sup><a href="#bookmark2299">121</a></sup><sup></sup> An 8-bit key would have only 256 possible keys, a 40-bit key would have 2<sup>40</sup> possible keys (around one trillion keys), and a 128-bit key would generate around 340,000,000,000,000,000,000,000,000,000,000,000,000 possible keys.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For conventional symmetric-key ciphers, 40-bit keys are considered safe enough for small, noncritical transactions. However, they are breakable by today’s high-speed workstations, which can now do billions of calculations per second.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In contrast, 128-bit keys are considered very strong for symmetric-key cryptography. In fact, long keys have such an impact on cryptographic security that the U.S. government has put export controls on cryptographic software that uses long keys, to prevent potentially antagonistic organizations from creating secret codes that the U. S. National Security Agency (NSA) would itself be unable to crack.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark2300"></a><span class="font24">Bruce Schneier’s excellent book, </span><span class="font24" style="font-style:italic;">Applied Cryptography</span><span class="font24"> (John Wiley &amp;&nbsp;Sons), includes a table describing the time it would take to crack a DES cipher by guessing all keys, using 1995 technology and economics.<a name="footnote122"></a><sup><a href="#bookmark2301">122</a></sup><sup></sup> Excerpts of this table are shown in </span><a href="#bookmark2302"><span class="font24">Table 14-1</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2302"></a><span class="font23" style="font-style:italic;">Table 14-1. Longer keys take more effort to crack (1995 data, from “Applied Cryptography”)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Attack cost</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2" style="font-weight:bold;">40-bit key</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">56-bit key</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">64-bit key</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2" style="font-weight:bold;">80-bit key</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2" style="font-weight:bold;">128-bit key</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">$100,000</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">2 secs</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">35 hours</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">1 year</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">70,000 years</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">10<sup>19</sup> years</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">$1,000,000</span></p></td><td style="vertical-align:top;">
<p style="text-indent:14pt;"><span class="font2">200 msecs</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">3.5 hours</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">37 days</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">7,000 years</span></p></td><td style="vertical-align:top;">
<p style="text-indent:14pt;"><span class="font2">10<sup>18</sup> years</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">$10,000,000</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">20 msecs</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">21 mins</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">4 days</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">700 years</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">10<sup>17</sup> years</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">$100,000,000</span></p></td><td style="vertical-align:top;">
<p style="text-indent:14pt;"><span class="font2">2 msecs</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">2 mins</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">9 hours</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">70 years</span></p></td><td style="vertical-align:top;">
<p style="text-indent:14pt;"><span class="font2">10<sup>16</sup> years</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">$1,000,000,000</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">200 usecs</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">13 secs</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">1 hour</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:14pt;"><span class="font2">7 years</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font2">10<sup>15</sup> years</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Given the speed of 1995 microprocessors, an attacker willing to spend $100,000 in 1995 could break a 40-bit DES code in about 2 seconds. And computers in 2002 already are 20 times faster than they were in 1995. Unless the users change keys frequently, 40-bit keys are not safe against motivated opponents.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The DES standard key size of 56 bits is more secure. In 1995 economics, a $1 million assault still would take several hours to crack the code. But a person with access to supercomputers could crack the code by brute force in a matter of seconds. In <a name="bookmark2303"></a>contrast, 128-bit DES keys, similar in size to Triple-DES keys, are believed to be effectively unbreakable by anyone, at any cost, using a brute-force attack.<a name="footnote123"></a><sup><a href="#bookmark2304">123</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2305"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2306"></a>Establishing Shared Keys</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">One disadvantage of symmetric-key ciphers is that both the sender and receiver have to have a shared secret key before they can talk to each other.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2307"></a><span class="font24"><a name="bookmark2308"></a><a name="bookmark2309"></a>If you wanted to talk securely with Joe’s Hardware store, perhaps to order some woodworking tools after watching a home-improvement program on public television, you’d have to establish a private secret key between you and </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24" style="font-style:italic;"> </span><span class="font24">before you could order anything securely. You’d need a way to generate the secret key and to remember it. Both you and Joe’s Hardware, and every other Internet user, would have thousands of keys to generate and remember.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Say that Alice (A), Bob (B), and Chris (C) all wanted to talk to Joe’s Hardware (J). A, B, and C each would need to establish their own secret keys with J. A would need key k<sup>AJ</sup>, B would need key k<sup>BJ</sup>, and C would need key k<sup>CJ</sup>. Every pair of communicating parties needs its own private key. If there are N nodes, and each node has to talk securely with all the other N–1 nodes, there are roughly N<sup>2</sup> total secret keys: an administrative nightmare.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2310"></a><span class="font9" style="font-weight:bold;"><a name="bookmark132"></a><a name="bookmark2311"></a>Public-Key Cryptography</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Instead of a single encoding/decoding key for every pair of hosts, public-key cryptography uses two asymmetric keys: one for encoding messages for a host, and another for decoding the host’s messages. The encoding key is publicly known to the world (thus the name public-key cryptography), but only the host knows the private decoding key (see</span><a href="#bookmark2312"><span class="font24"> Figure 14-8</span></a><span class="font24">). This makes key establishment much easier, because everyone can find the public key for a particular host. But the decoding key is kept secret, so only the recipient can decode messages sent to it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Node X can take its encoding key e<sup>x</sup> and publish it publicly.<a name="footnote124"></a><sup><a href="#bookmark2313">124</a></sup><sup></sup> Now anyone wanting to send a message to node X can use the same, well-known public key. Because each host is assigned an encoding key, which everyone uses, public-key cryptography avoids the N<sup>2</sup> explosion of pairwise symmetric keys (see</span><a href="#bookmark2314"><span class="font24"> Figure 14-9)</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-434.jpg" alt="" style="width:31pt;height:27pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;text-decoration:underline;">Plaintext</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-435.jpg" alt="" style="width:82pt;height:40pt;"></td><td>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">Encrypted ciphertext</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-436.jpg" alt="" style="width:114pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Plaintext</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-437.jpg" alt="" style="width:82pt;height:32pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-438.jpg" alt="" style="width:27pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<p><a name="bookmark2312"></a><span class="font23" style="font-style:italic;">Figure 14-8. Public-key cryptography is asymmetric, using different keys for encoding and decoding</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-439.jpg" alt="" style="width:346pt;height:188pt;"></td></tr>
<tr><td>
<p><a name="bookmark2314"></a><span class="font23" style="font-style:italic;">Figure 14-9. Public-key cryptography assigns a single, public encoding key to each host</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Even though everyone can encode messages to X with the same key, no one other than X can decode the messages, because only X has the decoding private key d<sup>x</sup>. Splitting the keys lets anyone encode a message but restricts the ability to decode messages to only the owner. This makes it easier for nodes to securely send messages to servers, because they can just look up the server’s public key.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Public-key encryption technology makes it possible to deploy security protocols to every computer user around the world. Because of the great importance of making a <a name="bookmark2315"></a>standardized public-key technology suite, a massive Public-Key Infrastructure (PKI) standards initiative has been under way for well over a decade.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2316"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2317"></a>RSA</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The challenge of any public-key asymmetric cryptosystem is to make sure no bad guy can compute the secret, private key—even if he has all of the following clues:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The public key (which anyone can get, because it’s public)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• A piece of intercepted ciphertext (obtained by snooping the network)</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• A message and its associated ciphertext (obtained by running the encoder on any text)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2318"></a><span class="font24">One popular public-key cryptosystem that meets all these needs is the RSA algorithm, invented at MIT and subsequently commercialized by RSA Data Security. Given a public key, an arbitrary piece of plaintext, the associated ciphertext from encoding the plaintext with the public key, the RSA algorithm itself, and even the source code of the RSA implementation, cracking the code to find the corresponding private key is believed to be as hard a problem as computing huge prime numbers— believed to be one of the hardest problems in all of computer science. So, if you can fin<a name="bookmark2319"></a>d a fast way of factoring large numbers into primes, not only can you break into Swiss bank accounts, but you can also win a Turing Award.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2320"></a><span class="font24">The details of RSA cryptography involve some tricky mathematics, so we won’t go into them here. There are plenty of libraries available to let you perform the RSA algorithms without you needing a Ph.D. in number theory.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2321"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2322"></a>Hybrid Cryptosystems and Session Keys</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2323"></a><span class="font24">Asymmetric, public-key cryptography is nifty, because anyone can send secure messages to a public server, just by knowing its public key. Two nodes don’t first have to negotiate a private key in order to communicate securely.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">But public-key cryptography algorithms tend to be computationally slow. In practice, mixtures of both symmetric and asymmetric schemes are used. For example, it is common to use public-key cryptography to conveniently set up secure communication between nodes but then to use that secure channel to generate and communicate a temporary, random symmetric key to encrypt the rest of the data through faster, symmetric cryptography.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2324"></a><span class="font9" style="font-weight:bold;"><a name="bookmark133"></a><a name="bookmark2325"></a>Digital Signatures</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">So far, we’ve been talking about various kinds of keyed ciphers, using symmetric and asymmetric keys, to allow us to encrypt and decrypt secret messages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In addition to encrypting and decrypting messages, cryptosystems can be used to </span><span class="font24" style="font-style:italic;">sign</span><span class="font24"> messages, proving who wrote the message and proving the message hasn’t been tampered with. This technique, called </span><span class="font24" style="font-style:italic;">digital signing</span><span class="font24">, is important for Internet security certificates, which we discuss in the next section.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2326"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2327"></a>Signatures Are Cryptographic Checksums</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2328"></a><span class="font24"><a name="bookmark2329"></a>Digital signatures are special cryptographic checksums attached to a message. They have two benefits:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Signatures prove the author wrote the message. Because only the author has the author’s top-secret private key,<a name="footnote125"></a><sup><a href="#bookmark2330">125</a></sup><sup></sup> only the author can compute these checksums. The checksum acts as a personal “signature” from the author.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Signatures prevent message tampering. If a malicious assailant modified the message in-flight, the checksum would no longer match. And because the checksum involves the author’s secret, private key, the intruder will not be able to fabricate a correct checksum for the tampered-with message.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Digital signatures often are generated using asymmetric, public-key technology. The author’s private key is used as a kind of “thumbprint,” because the private key is known only by the owner.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark2331"><span class="font24">Figure 14-10 </span></a><span class="font24">shows an example of how node A can send a message to node B and sign it:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Node A distills the variable-length message into a fixed-sized digest.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Node A applies a “signature” function to the digest that uses the user’s private key as a parameter. Because only the user knows the private key, a correct signature function shows the signer is the owner. In</span><a href="#bookmark2331"><span class="font24"> Figure 14-10</span></a><span class="font24">, we use the decoder function D as the signature function, because it involves the user’s private key.<a name="footnote126"></a><sup><a href="#bookmark2332">126</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Once the signature is computed, node A appends it to the end of the message and sends both the message and the signature to node B.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• On receipt, if node B wants to make sure that node A really wrote the message, and that the message hasn’t been tampered with, node B can check the signature. Node B takes the private-key scrambled signature and applies the inverse function using the public key. If the unpacked digest doesn’t match node B’s own version of the digest, either the message was tampered with in-flight, or the sender did not have node A’s private key (and therefore was not node A).</span></p><img src="book_files/book-440.jpg" alt="" style="width:360pt;height:175pt;"></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2333"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2331"></a><a name="bookmark2334"></a><a name="bookmark134"></a><a name="bookmark2335"></a>Digital Certificates</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2336"></a><span class="font24">In this section, we talk about digital certificates, the “ID cards” of the Internet. Digital certificates (often called “certs,” like the breath mints) contain information about a user or firm that has been vouched for by a trusted organization.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We all carry many forms of identification. Some IDs, such as passports and drivers’ licenses, are trusted enough to prove one’s identity in many situations. For example, a U.S. driver’s license is sufficient proof of identity to let you board an airplane to New York for New Year’s Eve, and it’s sufficient proof of your age to let you drink intoxicating beverages with your friends when you get there.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">More trusted forms of identification, such as passports, are signed and stamped by a government on special paper. They are harder to forge, so they inherently carry a higher level of trust. Some corporate badges and smart cards include electronics to help strengthen the identity of the carrier. Some top-secret government organizations even need to match up your fingerprints or retinal capillary patterns with your ID before trusting it!</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Other forms of ID, such as business cards, are relatively easy to forge, so people trust this information less. They may be fine for professional interactions but probably are not enough proof of employment when you apply for a home loan.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2337"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2338"></a>The Guts of a Certificate</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Digital certificates also contain a set of information, all of which is digitally signed by an official “certificate authority.” Basic digital certificates commonly contain basic things common to printed IDs, such as:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Subject’s name (person, server, organization, etc.)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Expiration date</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2339"></a><span class="font24">• Certificate issuer (who is vouching for the certificate)</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Digital signature from the certificate issuer</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2340"></a><span class="font24">Additionally, digital certificates often contain the public key of the subject, as well as descriptive information about the subject and about the signature algorithm used. Anyone can create a digital certificate, but not everyone can get a well-respected signing authority to vouch for the certificate’s information and sign the certificate with its private key. A typical certificate structure is shown in </span><a href="#bookmark2341"><span class="font24">Figure 14-11</span></a><span class="font24">.</span></p><img src="book_files/book-441.jpg" alt="" style="width:360pt;height:179pt;">
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2341"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2342"></a><a name="bookmark2343"></a>X.509 v3 Certificates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Unfortunately, there is no single, universal standard for digital certificates. There are many, subtly different styles of digital certificates, just as not all printed ID cards contain the same information in the same place. The good news is that most certificates in use today store their information in a standard form, called X.509 v3. X.509 v3 certificates provide a standard way of structuring certificate information into parseable fields. Different kinds of certificates have different field values, but most follow the X.509 v3 structure. The fields of an X.509 certificate are described in </span><a href="#bookmark2344"><span class="font24">Table 14-2</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2344"></a><span class="font23" style="font-style:italic;">Table 14-2. X.509 certificate fields</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Version</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The X.509 certificate version number for this certificate. Usually version 3 today.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Serial Number</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font2">A unique integer generated by the certification authority. Each certificate from a CA must have a unique serial number.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Signature Algorithm ID</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font2">The cryptographic algorithm used for the signature. For example, “MD2 digest with RSA encryption”.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Certificate Issuer</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">The name for the organization that issued and signed this certificate, in X.500 format.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Validity Period</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:19pt;"><span class="font2">When this certificate is valid, defined by a start date and an end date.</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 14-2. X.509 certificate fields (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Subject’s Name</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The entity described in the certificate, such as a person or an organization. The subject name is in X.500 format.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Subject’s Public Key Information</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The public key for the certificate’s subject, the algorithm used for the public key, and any additional parameters.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Issuer Unique ID (optional)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">An optional unique identifier for the certificate issuer, to allow the potential reuse of the same issuer name.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Subject Unique ID (optional)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">An optional unique identifier for the certificate subject, to allow the potential reuse of the same subject name.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Extensions</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">An optional set of extension fields (in version 3 and higher). Each extension field is flagged as critical or noncritical. Critical extensions are important and must be understood by the certificate user. If a certificate user doesn’t recognize a critical extension field, it must reject the certificate. Common extension fields in use include:</span></p>
<p><span class="font3" style="font-style:italic;">Basic Constraints</span></p>
<p style="text-indent:16pt;"><span class="font2">Subject’s relationship to certification authority</span></p>
<p><span class="font3" style="font-style:italic;">Certificate Policy</span></p>
<p style="text-indent:16pt;"><span class="font2">The policy under which the certificate is granted</span></p>
<p><span class="font3" style="font-style:italic;">Key Usage</span></p>
<p style="text-indent:16pt;"><span class="font2">Restricts how the public key can be used</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark2345"></a><span class="font2">Certification Authority Signature</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The certification authority’s digital signature of all of the above fields, using the specified signing algorithm.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There are several flavors of X.509-based certificates, including (among others) web server certificates, client email certificates, software code-signing certificates, and certificate authority certificates.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2346"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2347"></a>Using Certificates to Authenticate Servers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When you establish a secure web transaction through HTTPS, modern browsers automatically fetch the digital certificate for the server being connected to. If the server does not have a certificate, the secure connection fails. The server certificate contains many fields, including:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Name and hostname of the web site</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Public key of the web site</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Name of the signing authority</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Signature from the signing authority</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">When the browser receives the certificate, it checks the signing authority.<a name="footnote127"></a><sup><a href="#bookmark2348">127</a></sup><sup></sup> If it is a public, well-respected signing authority, the browser will already know its public key (browsers ship with certificates of many signing authorities preinstalled), so it can verify the signature as we discussed in the previous section,</span><a href="#bookmark2324"><span class="font24"> “Digital Signatures</span></a><span class="font24">.” </span><a href="#bookmark2349"><span class="font24">Figure 14-12 </span></a><span class="font24">shows how a certificate’s integrity is verified using its digital signature.</span></p><img src="book_files/book-442.jpg" alt="" style="width:360pt;height:215pt;">
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2349"></a><span class="font24"><a name="bookmark2350"></a><a name="bookmark2351"></a>If the signing authority is unknown, the browser isn’t sure if it should trust the signing authority and usually displays a dialog box for the user to read and see if he trusts the signer. The signer might be the local IT department, or a software vendor.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark2264"></a><span class="font9" style="font-weight:bold;"><a name="bookmark135"></a><a name="bookmark2352"></a>HTTPS: The Details</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTPS is the most popular secure version of HTTP. It is widely implemented and available in all major commercial browsers and servers. HTTPS combines the HTTP protocol with a powerful set of symmetric, asymmetric, and certificate-based cryptographic techniques, making HTTPS very secure but also very flexible and easy to administer across the anarchy of the decentralized, global Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTPS has accelerated the growth of Internet applications and has been a major force in the rapid growth of web-based electronic commerce. HTTPS also has been critical in the wide-area, secure administration of distributed web applications.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2353"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2354"></a>HTTPS Overview</span></h3>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">HTTPS is just HTTP sent over a secure transport layer. Instead of sending HTTP messages unencrypted to TCP and across the world-wide Internet </span><a href="#bookmark2355"><span class="font24">(Figure 14-13</span></a><span class="font24">a), HTTPS sends the HTTP messages first to a security layer that encrypts them before sending them to TCP (</span><a href="#bookmark2355"><span class="font24">Figure 14-13</span></a><span class="font24">b).</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">HTTP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">HTTP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Application layer</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">SSL or TLS</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Security layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">TCP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Transport layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">IP</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Network layer</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Network interfaces</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Data link layer</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">HTTP</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">HTTPS</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark2355"></a><span class="font23" style="font-style:italic;"><a name="bookmark2356"></a>Figure 14-13. HTTP transport-level security</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Today, the HTTP security layer is implemented by SSL and its modern replacement, TLS. We follow the common practice of using the term “SSL” to mean either SSL or TLS.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2357"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2358"></a>HTTPS Schemes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2359"></a><span class="font24">Today, secure HTTP is optional. Thus, when making a request to a web server, we need a way to tell the web server to perform the secure protocol version of HTTP. This is done in the scheme of the URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In normal, nonsecure HTTP, the scheme prefix of the URL is </span><span class="font24" style="font-style:italic;">http</span><span class="font24">, as in:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><a href="http://www.joes-hardware.com/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/index.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In the <a name="bookmark2360"></a>secure HTTPS protocol, the scheme prefix of the URL is </span><span class="font24" style="font-style:italic;">https</span><span class="font24">, as in:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><a href="https://cajun-shop.securesites.com/Merchant2/merchant.mv?Store_Code=AGCGS"><span class="font24" style="font-style:italic;">https://cajun-shop.securesites.com/Merchant2/merchant.mv?Store_Code=AGCGS</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">When a client (such as a web browser) is asked to perform a transaction on a web resource, it examines the scheme of the URL:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the URL has an </span><span class="font24" style="font-style:italic;">http</span><span class="font24"> scheme, the client opens a connection to the server on port 80 (by default) and sends it plain-old HTTP commands (</span><a href="#bookmark2361"><span class="font24">Figure 14-14</span></a><span class="font24">a).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• If the URL has an </span><span class="font24" style="font-style:italic;">https</span><span class="font24"> scheme, the client opens a connection to the server on port 443 (by default) and then “handshakes” with the server, exchanging some SSL security parameters with the server in a binary format, followed by the encrypted HTTP commands (</span><a href="#bookmark2361"><span class="font24">Figure 14-14</span></a><span class="font24">b).</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because SSL traffic is a binary protocol, completely different from HTTP, the traffic is carried on different ports (SSL usually is carried over port 443). If both SSL and HTTP traffic arrived on port 80, most web servers would interpret binary SSL traffic as erroneous HTTP and close the connection. A more integrated layering of security services into HTTP would have eliminated the need for multiple destination ports, but this does not cause severe problems in practice.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Let’s look a bit more closely at how SSL sets up connections with secure servers.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-443.jpg" alt="" style="width:54pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-444.jpg" alt="" style="width:55pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-445.jpg" alt="" style="width:54pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Secure server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-446.jpg" alt="" style="width:58pt;height:37pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">HTTPS over HTTP tunnel</span></p></td></tr>
<tr><td><img src="book_files/book-447.jpg" alt="" style="width:145pt;height:36pt;"></td><td>
<p><span class="font0">HTTPS</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font0">HTTPS tunnel</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-448.jpg" alt="" style="width:46pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Secure server</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 14pt 0pt;"><a name="bookmark2361"></a><span class="font23" style="font-style:italic;"><a name="bookmark2362"></a>Figure 14-14. HTTP and HTTPS port numbers</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2363"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2364"></a>Secure Transport Setup</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2365"></a><span class="font24">In unencrypted HTTP, a client opens a TCP connection to port 80 on a web server, sends a request message, receives a response message, and closes the connection. This sequence is sketched in</span><a href="#bookmark2366"><span class="font24"> Figure 14-15</span></a><span class="font24">a.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The procedure is slightly more complicated in HTTPS, because of the SSL security layer. In HTTPS, the client first opens a connection to port 443 (the default port for secure HTTP) on the web server. Once the TCP connection is established, the client and server initialize the SSL layer, negotiating cryptography parameters and exchanging keys. When the handshake completes, the SSL initialization is done, and the client can send request messages to the security layer. These messages are encrypted before being sent to TCP. This procedure is depicted in </span><a href="#bookmark2366"><span class="font24">Figure 14-15</span></a><span class="font24">b.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2367"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2368"></a>SSL Handshake</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Before you can send encrypted HTTP messages, the client and server need to do an SSL handshake, where they:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Exchange protocol version numbers</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Select a cipher that each side knows</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Authenticate the identity of each side</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Generate temporary session keys to encrypt the channel</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> Unencrypted HTTP transaction</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<ul style="list-style:none;"><li>
<p><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> Encrypted HTTPS transaction</span></p></li></ul>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-449.jpg" alt="" style="width:196pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server Client &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-450.jpg" alt="" style="width:70pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Establish TCP connection to server port 80</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Establish TCP connection to server port 443</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-451.jpg" alt="" style="width:102pt;height:39pt;"></td></tr>
<tr><td>
<p><span class="font0">SSL security parameters handshake</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-452.jpg" alt="" style="width:59pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-453.jpg" alt="" style="width:96pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td><td><img src="book_files/book-454.jpg" alt="" style="width:56pt;height:29pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-455.jpg" alt="" style="width:87pt;height:26pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">HTTP request sent over TCP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">HTTP request sent over SSL/encrypted request sent over TCP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-456.jpg" alt="" style="width:100pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-457.jpg" alt="" style="width:95pt;height:26pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Server Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-458.jpg" alt="" style="width:55pt;height:28pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">HTTP response sent over TCP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">HTTP response sent over SSL/encrypted response sent over TCP</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-459.jpg" alt="" style="width:102pt;height:39pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Client</span></p>
<p><span class="font0">SSL close notification</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-460.jpg" alt="" style="width:55pt;height:96pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-461.jpg" alt="" style="width:100pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-462.jpg" alt="" style="width:48pt;height:39pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-463.jpg" alt="" style="width:50pt;height:26pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">TCP connection close</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font0">TCP connection close</span></p>
</div><br clear="all"></li></ul>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2366"></a><span class="font23" style="font-style:italic;">Figure 14-15. HTTP and HTTPS transactions</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Before any encrypted HTTP data flies across the network, SSL already has sent a bunch of handshake data to establish the communication. The essence of the SSL handshake is shown in </span><a href="#bookmark2369"><span class="font24">Figure 14-16</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">This is a simplified version of the SSL handshake. Depending on how SSL is being used, the handshake can be more complicated, but this is the general idea.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-464.jpg" alt="" style="width:178pt;height:163pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p><a name="bookmark2370"></a><span class="font1" style="font-weight:bold;">Internet</span></p>
<p><a name="bookmark2371"></a><span class="font0">SSL security parameters handshake</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-465.jpg" alt="" style="width:228pt;height:226pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-466.jpg" alt="" style="width:1pt;height:43pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-467.jpg" alt="" style="width:1pt;height:34pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-468.jpg" alt="" style="width:1pt;height:49pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-469.jpg" alt="" style="width:51pt;height:1pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark2369"></a><span class="font23" style="font-style:italic;">Figure 14-16. SSL handshake (simplified)</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2372"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2373"></a>Server Certificates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">SSL supports mutual authentication, carrying server certificates to clients and carrying client certificates back to servers. But today, client certificates are not commonly used for browsing. Most users don’t even possess personal client certificates.<a name="footnote128"></a><sup><a href="#bookmark2374">128</a></sup><sup></sup> A web server can demand a client certificate, but that seldom occurs in practice.<a name="footnote129"></a><sup><a href="#bookmark2375">129</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">On the other hand, secure HTTPS transactions always require server certificates. When you perform a secure transaction on a web server, such as posting your credit card information, you want to know that you are talking to the organization you think you are talking to. Server certificates, signed by a well-known authority, help you assess how much you trust the server before sending your credit card or personal information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The server certificate is an X.509 v3–derived certificate showing the organization’s name, address, server DNS domain name, and other information (see</span><a href="#bookmark2376"><span class="font24"> Figure 14-17</span></a><span class="font24">). You and your client software can examine the certificate to make sure everything seems to be on the up-and-up.</span></p>
<table>
<tr><td><img src="book_files/book-470.jpg" alt="" style="width:62pt;height:39pt;"></td><td>
<p><span class="font1" style="font-weight:bold;">Internet &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p>
<p style="text-align:center;"><span class="font1">Server certificate</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark2377"></a><span class="font2">Certificate serial number</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">35:DE:F4:CF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Certificate expiration date</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Wed, Sep 17, 2003</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Site’s organization name</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Joe’s Hardware Online</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Site’s DNS hostname</span></p></td><td style="vertical-align:top;">
<p><a href="http://www.joes-hardware.com"><span class="font2">www.joes-hardware.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Site’s public key</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Certificate issuer name</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RSA Data Security</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Certificate issuer signature</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<p style="padding:0pt 0pt 12pt 0pt;"><a name="bookmark2376"></a><span class="font23" style="font-style:italic;">Figure 14-17. HTTPS certificates are X.509 certificates with site information</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2378"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2379"></a><a name="bookmark2380"></a>Site Certificate Validation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2381"></a><span class="font24">SSL itself doesn’t require you to examine the web server certificate, but most modern browsers do some simple sanity checks on certificates and provide you with the means to do more thorough checks. One algorithm for web server certificate validation, proposed by Netscape, forms the basis of most browser’s validation techniques. The steps are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Date check</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">First, the browser checks the certificate’s start and end dates to ensure the certificate is still valid. If the certificate has expired or has not yet become active, the certificate validation fails and the browser displays an error.</span></p>
<p><span class="font24" style="font-style:italic;">Signer trust check</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 19pt;"><span class="font24">Every certificate is signed by some certificate authority (CA), who vouches for the server. There are different levels of certificate, each requiring different levels of background verification. For example, if you apply for an e-commerce server certificate, you usually need to provide legal proof of incorporation as a business. Anyone can generate certificates, but some CAs are well-known organizations with well-understood procedures for verifying the identity and good business behavior of certificate applicants. For this reason, browsers ship with a list of signing authorities that are trusted. If a browser receives a certificate signed by some unknown (and possibly malicious) authority, the browser usually displays a warning. Browsers also may choose to accept any certificates with a valid signing path to a trusted CA. In other words, if a trusted CA signs a certificate for “Sam’s Signing Shop” and Sam’s Signing Shop signs a site certificate, the browser may accept the certificate as deriving from a valid CA path.</span></p>
<p><span class="font24" style="font-style:italic;">Signature check</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Once the signing authority is judged as trustworthy, the browser checks the certificate’s integrity by applying the signing authority’s public key to the signature and comparing it to the checksum.</span></p>
<p><a name="bookmark2382"></a><span class="font24" style="font-style:italic;">Site identity check</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">To prevent a server from copying someone else’s certificate or intercepting their traffic, most browsers try to verify that the domain name in the certificate matches the domain name of the server they talked to. Server certificates usually contain a single domain name, but some CAs create certificates that contain lists of server names or wildcarded domain names, for clusters or farms of servers. If the hostname does not match the identity in the certificate, user-oriented clients must either notify the user or terminate the connection with a bad certificate error.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2383"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2384"></a>Virtual Hosting and Certificates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">It’s sometimes tricky to deal with secure traffic on sites that are virtually hosted (multiple hostnames on a single server). Some popular web server programs support only a single certificate. If a user arrives for a virtual hostname that does not strictly match the certificate name, a warning box is displayed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2385"></a><span class="font24">For example, consider the Louisiana-themed e-commerce site Cajun-Shop.com. The site’s hosting provider provided the official name </span><span class="font24" style="font-style:italic;">cajun-shop.securesites.com</span><span class="font24">. When users go to </span><a href="https://www.cajun-shop.com"><span class="font24" style="font-style:italic;">https://www.cajun-shop.com</span></a><span class="font24">, the official hostname listed in the server certificate (</span><span class="font24" style="font-style:italic;">*.securesites.com</span><span class="font24">) does not match the virtual hostname the user browsed to (</span><a href="http://www.cajun-shop.com"><span class="font24" style="font-style:italic;">www.cajun-shop.com</span></a><span class="font24" style="font-style:italic;">)</span><span class="font24">, and the warning in</span><a href="#bookmark2386"><span class="font24"> Figure 14-18 </span></a><span class="font24">appears.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2387"></a><span class="font24">To prevent this problem, the owners of Cajun-Shop.com redirect all users to </span><span class="font24" style="font-style:italic;">cajun-shop.securesites.com</span><span class="font24"> when they begin secure transactions. Cert management for virtually hosted sites can be a little tricky.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2388"></a><span class="font9" style="font-weight:bold;"><a name="bookmark136"></a><a name="bookmark2389"></a>A Real HTTPS Client</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">SSL is a complicated binary protocol. Unless you are a crypto expert, you shouldn’t send raw SSL traffic directly. Thankfully, several commercial and open source libraries exist to make it easier to program SSL clients and servers.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2390"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2391"></a>OpenSSL</span></h3>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">OpenSSL is the most popular open source implementation of SSL and TLS. The OpenSSL Project is a collaborative volunteer effort to develop a robust, commercialgrade, full-featured toolkit implementing the SSL and TLS protocols, as well as a fullstrength, general-purpose cryptography library. You can get information about OpenSSL, and download the software, from </span><a href="http://www.openssl.org"><span class="font24" style="font-style:italic;">http://www.openssl.org</span></a><span class="font24">.</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-471.jpg" alt="" style="width:173pt;height:92pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-472.jpg" alt="" style="width:112pt;height:88pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-473.jpg" alt="" style="width:119pt;height:108pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-474.jpg" alt="" style="width:173pt;height:104pt;">
</div>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 61pt 0pt;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> The hostname in this URL (</span><a href="http://www.cajun-shop.com"><span class="font1" style="font-style:italic;">www.cajun-shop.com</span></a><span class="font0">) does not match the name in the certificate, because the site is virtually hosted, and the certificate is made out to </span><span class="font1" style="font-style:italic;">*.securesites.com</span><span class="font0">.</span></p></li>
<li>
<p style="padding:0pt 0pt 69pt 0pt;"><span class="font1" style="font-weight:bold;">(b)</span><span class="font0"> A dialog box warns the user that the site’s certificate has a valid date and is from a valid certificate authority, but the name listed in the certificate does not match the site requested in the URL.</span></p></li>
<li>
<p style="padding:0pt 0pt 66pt 0pt;"><span class="font1" style="font-weight:bold;">(c)</span><span class="font0"> To get more details the user presses the “View Certificate” button, and sees that the certificate is a wildcard certificate made out to “*.securesites.com”. With this information, the user can decide whether to accept or decline the certificate.</span></p></li>
<li>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font1" style="font-weight:bold;">(d)</span><span class="font0"> Accepting the certificate loads the page through the secure HTTPS protocol.</span></p></li></ul>
<p style="padding:0pt 0pt 33pt 0pt;"><span class="font0">To avoid this kind of user error, this particular site directs all HTTPS traffic to the hostname alias </span><span class="font1" style="font-style:italic;">cajun-shop.securesites.com</span><span class="font0">. This virtual hostname matches the name on the certificate provided by the ISP as part of their commerce package.</span></p>
<p style="padding:0pt 0pt 8pt 0pt;"><a name="bookmark2386"></a><span class="font23" style="font-style:italic;"><a name="bookmark2392"></a><a name="bookmark2393"></a>Figure 14-18. Certificate name mismatches bring up certificate error dialog boxes</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">You might also hear of SSLeay (pronounced S-S-L-e-a-y). OpenSSL is the successor to the SSLeay library, and it has a very similar interface. SSLeay was originally developed by Eric A. Young (the “eay” of SSLeay).</span></p>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2394"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2395"></a>A Simple HTTPS Client</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">In this section, we’ll use the OpenSSL package to write an extremely primitive HTTPS client. This client establishes an SSL connection with a server, prints out some identification information from the site server, sends an HTTP GET request across the secure channel, receives an HTTP response, and prints the response.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The C program shown below is an OpenSSL implementation of the trivial HTTPS client. To keep the program simple, error-handling and certificate-processing logic has not been included.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Because error handling has been removed from this example program, you should use it only for explanatory value. The software will crash or otherwise misbehave in normal error conditions.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:23pt;"><span class="font3">* https_client.c --- very simple HTTPS client with no error checking</span></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:23pt;padding:0pt 0pt 21pt 0pt;"><span class="font3">* usage: https_client servername</span></p></li></ul>
<p style="text-indent:19pt;"><span class="font3">#include &lt;stdio.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;memory.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;errno.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;sys/types.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;sys/socket.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;netinet/in.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;arpa/inet.h&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">#include &lt;netdb.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;openssl/crypto.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;openssl/x509.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;openssl/pem.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">#include &lt;openssl/ssl.h&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">#include &lt;openssl/err.h&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">void main(int argc, char **argv)</span></p>
<p style="text-indent:19pt;"><span class="font3">{</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">SSL *ssl;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">SSL_CTX *ctx;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">SSL_METHOD *client_method;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">X509 *server_cert;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">int sd,err;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">char *str,*hostname,outbuf[4096],inbuf[4096],host_header[512];</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">struct hostent *host_entry;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">struct sockaddr_in server_socket_address;</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">struct in_addr ip;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">/*========================================*/</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">/* (1) initialize SSL library */</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">/*========================================*/</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">SSLeay_add_ssl_algorithms();</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">client_method = SSLv2_client_method();</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">SSL_load_error_strings();</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">ctx = SSL_CTX_new(client_method);</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot;(1) SSL context initialized\n\n&quot;);</span></p>
<p style="text-indent:35pt;"><span class="font3">/*=============================================*/</span></p>
<p style="text-indent:35pt;"><span class="font3">/* (2) convert server hostname into IP address */</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">/*=============================================*/</span></p>
<p style="text-indent:35pt;"><span class="font3">hostname = argv[1];</span></p>
<p style="text-indent:35pt;"><span class="font3">host_entry = gethostbyname(hostname);</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">bcopy(host_entry-&gt;h_addr, &amp;(ip.s_addr), host_entry-&gt;h_length);</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot;(2) '%s' has IP address '%s'\n\n&quot;, hostname, inet_ntoa(ip));</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">/*=================================================*/ /* (3) open a TCP connection to port 443 on server */ /*=================================================*/</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">sd = socket (AF_INET, SOCK_STREAM, 0);</span></p>
<p style="text-indent:35pt;"><span class="font3">memset(&amp;server_socket_address, '\0', sizeof(server_socket_address));</span></p>
<p style="text-indent:35pt;"><span class="font3">server_socket_address.sin_family = AF_INET;</span></p>
<p style="text-indent:35pt;"><span class="font3">server_socket_address.sin_port = htons(443);</span></p>
<p style="padding:0pt 0pt 10pt 63pt;"><span class="font3">memcpy(&amp;(server_socket_address.sin_addr.s_addr), host_entry-&gt;h_addr, host_entry-&gt;h_length);</span></p>
<p style="padding:0pt 0pt 0pt 91pt;"><span class="font3">err = connect(sd, (struct sockaddr*) &amp;server_socket_address, sizeof(server_socket_address));</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">if (err &lt;&nbsp;0) { perror(&quot;can't connect to server port&quot;); exit(1); }</span></p>
<p style="padding:0pt 0pt 10pt 63pt;"><span class="font3">printf(&quot;(3) TCP connection open to host '%s', port %d\n\n&quot;, hostname, server_socket_address.sin_port);</span></p>
<p style="padding:0pt 0pt 0pt 35pt;"><span class="font3">/*========================================================*/</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">/* (4) initiate the SSL handshake over the TCP connection */ /*========================================================*/</span></p>
<p style="padding:0pt 0pt 0pt 35pt;"><span class="font3">ssl = SSL_new(ctx); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* create SSL stack endpoint */</span></p>
<p style="padding:0pt 0pt 0pt 35pt;"><span class="font3">SSL_set_fd(ssl, sd); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* attach SSL stack to socket */</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">err = SSL_connect(ssl); /* initiate SSL handshake */</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">printf(&quot;(4) SSL endpoint created &amp;&nbsp;handshake completed\n\n&quot;);</span></p>
<p style="padding:0pt 0pt 0pt 35pt;"><span class="font3">/*============================================*/</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">/* (5) print out the negotiated cipher chosen */ /*============================================*/</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">printf(&quot;(5) SSL connected with cipher: %s\n\n&quot;, SSL_get_cipher(ssl));</span></p>
<p style="padding:0pt 0pt 0pt 35pt;"><span class="font3">/*========================================*/</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">/* (6) print out the server's certificate */ /*========================================*/</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">server_cert = SSL_get_peer_certificate(ssl);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot;(6) server's certificate was received:\n\n&quot;);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">str = X509_NAME_oneline(X509_get_subject_name(server_cert), 0, 0);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">printf(&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject: %s\n&quot;, str);</span></p>
<p style="padding:0pt 0pt 10pt 35pt;"><span class="font3">str = X509_NAME_oneline(X509_get_issuer_name(server_cert), 0, 0); printf(&quot; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;issuer: %s\n\n&quot;, str);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">/* certificate verification would happen here */</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">X509_free(server_cert);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">/* (7) handshake complete --- send HTTP request over SSL */</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">sprintf(host_header,&quot;Host: %s:443\r\n&quot;,hostname);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">strcpy(outbuf,&quot;GET / HTTP/1.0\r\n&quot;);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">strcat(outbuf,host_header);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">strcat(outbuf,&quot;Connection: close\r\n&quot;);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">strcat(outbuf,&quot;\r\n&quot;);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">err = SSL_write(ssl, outbuf, strlen(outbuf));</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">shutdown (sd, 1); /* send EOF to server */</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">printf(&quot;(7) sent HTTP request over encrypted channel:\n\n%s\n&quot;,outbuf);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">/* (8) read back HTTP response from the SSL stack */</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">err = SSL_read(ssl, inbuf, sizeof(inbuf) - 1);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">inbuf[err] = '\0';</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">printf (&quot;(8) got back %d bytes of HTTP response:\n\n%s\n&quot;,err,inbuf);</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 20pt 0pt;"><span class="font3">/* (9) all done, so close connection &amp;&nbsp;clean up */</span></p>
<p style="text-indent:35pt;"><span class="font3">SSL_shutdown(ssl);</span></p>
<p style="text-indent:35pt;"><span class="font3">close (sd);</span></p>
<p style="text-indent:35pt;"><span class="font3">SSL_free (ssl);</span></p>
<p style="text-align:justify;text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">SSL_CTX_free (ctx);</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">printf(&quot;(9) all done, cleaned up and closed connection\n\n&quot;);</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">}</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">This example compiles and runs on Sun Solaris, but it is illustrative of how SSL programs work on many OS platforms. This entire program, including all the encryption and key and certificate management, fits in a three-page C program, thanks to the powerful features provided by OpenSSL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s walk through the program section by section:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The top of the program includes support files needed to support TCP networking and SSL.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Section 1 creates the local context that keeps track of the handshake parameters and other state about the SSL connection, by calling </span><span class="font24" style="font-style:italic;">SSL_CTX_new</span><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Section 2 converts the input hostname (provided as a command-line argument) to an IP address, using the Unix </span><span class="font24" style="font-style:italic;">gethostbyname</span><span class="font24"> function. Other platforms may have other ways to provide this facility.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Section 3 opens a TCP connection to port 443 on the server by creating a local socket, setting up the remote address information, and connecting to the remote server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Once the TCP connection is established, we attach the SSL layer to the TCP connection using </span><span class="font24" style="font-style:italic;">SSL_new</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">SSL_set_fd</span><span class="font24"> and perform the SSL handshake with the server by calling </span><span class="font24" style="font-style:italic;">SSL_connect</span><span class="font24">. When section 4 is done, we have a functioning SSL channel established, with ciphers chosen and certificates exchanged.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Section 5 prints out the value of the chosen bulk-encryption cipher.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Section 6 prints out some of the information contained in the X.509 certificate sent back from the server, including information about the certificate holder and the organization that issued the certificate. The OpenSSL library doesn’t do anything special with the information in the server certificate. A real SSL application, such as a web browser, would do some sanity checks on the certificate to make sure it is signed properly and came from the right host. We discussed what browsers do with server certificates in</span><a href="#bookmark2378"><span class="font24"> “Site Certificate Validation</span></a><span class="font24">.”</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• At this point, our SSL connection is ready to use for secure data transfer. In section 7, we send the simple HTTP request “GET / HTTP/1.0” over the SSL channel using </span><span class="font24" style="font-style:italic;">SSL_write</span><span class="font24">, then close the outbound half of the connection.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• In section 8, we read the response back from the connection using </span><span class="font24" style="font-style:italic;">SSL_read</span><span class="font24">, and print it on the screen. Because the SSL layer takes care of all the encryption and decryption, we can just write and read normal HTTP commands.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Finally, we clean up in section 9.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Refer to </span><a href="http://www.openssl.org"><span class="font24" style="font-style:italic;">http://www.openssl.org</span></a><span class="font24"> for more information about the OpenSSL libraries.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2396"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2397"></a>Executing Our Simple OpenSSL Client</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following shows the output of our simple HTTP client when pointed at a secure server. In this case, we pointed the client at the home page of the Morgan Stanley Online brokerage. Online trading companies make extensive use of HTTPS.</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">% </span><span class="font3" style="font-weight:bold;">https_client clients1.online.msdw.com</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">(1) SSL context initialized</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(2) 'clients1.online.msdw.com' has IP address '63.151.15.11'</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(3) TCP connection open to host 'clients1.online.msdw.com', port 443</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(4) SSL endpoint created &amp;&nbsp;handshake completed</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(5) SSL connected with cipher: DES-CBC3-MD5</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(6) server's certificate was received:</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 0pt 51pt;"><span class="font3">subject: /C=US/ST=Utah/L=Salt Lake City/O=Morgan Stanley/OU=Online/CN= clients1.online.msdw.com</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 51pt;"><span class="font3">issuer: /C=US/O=RSA Data Security, Inc./OU=Secure Server Certification Authority</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">(7) sent HTTP request over encrypted channel:</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET / HTTP/1.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font3">Host: clients1.online.msdw.com:443 Connection: close</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font3">(8) got back 615 bytes of HTTP response:</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.1 302 Found</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Date: Sat, 09 Mar 2002 09:43:42 GMT</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Stronghold/3.0 Apache/1.3.14 RedHat/3013c (Unix) mod_ssl/2.7.1 OpenSSL/0.9.6</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">Location: </span><a href="https://clients.online.msdw.com/cgi-bin/ICenter/home"><span class="font3">https://clients.online.msdw.com/cgi-bin/ICenter/home</span></a><span class="font3"> Connection: close</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font3">Content-Type: text/html; charset=iso-8859-1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;HTML&gt;&lt;HEAD&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;TITLE&gt;302 Found&lt;/TITLE&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;/HEAD&gt;&lt;BODY&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;H1&gt;Found&lt;/H1&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">The document has moved &lt;A HREF=&quot;</span><a href="https://clients.online.msdw.com/cgi-bin/ICenter/"><span class="font3">https://clients.online.msdw.com/cgi-bin/ICenter/</span></a><span class="font3"> home&quot;&gt;here&lt;/A&gt;.&lt;P&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;HR&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">&lt;ADDRESS&gt;Stronghold/3.0Apache/1.3.14 RedHat/3013c Server at clients1.online.msdw.com Port 443&lt;/ADDRESS&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">&lt;/BODY&gt;&lt;/HTML&gt;</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">(9) all done, cleaned up and closed connection</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">As soon as the first four sections are completed, the client has an open SSL connection. It can then inquire about the state of the connection and chosen parameters and can examine server certificates.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">In this example, the client and server negotiated the DES-CBC3-MD5 bulk-encryption cipher. You also can see that the server site certificate belongs to the organization “Morgan Stanley” in “Salt Lake City, Utah, USA”. The certificate was granted by RSA Data Security, and the hostname is “clients1.online.msdw.com,” which matches our request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2398"></a><span class="font24"><a name="bookmark2399"></a><a name="bookmark2400"></a><a name="bookmark2401"></a>Once the SSL channel is established and the client feels comfortable about the site certificate, it sends its HTTP request over the secure channel. In our example, the client sends a simple “GET / HTTP/1.0” HTTP request and receives back a 302 Redirect response, requesting that the user fetch a different URL.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2402"></a><span class="font9" style="font-weight:bold;"><a name="bookmark137"></a><a name="bookmark2403"></a>Tunneling Secure Traffic Through Proxies</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Clients often use web proxy servers to access web servers on their behalf (proxies are discussed in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">). For example, many corporations place a proxy at the security perimeter of the corporate network and the public Internet (</span><a href="#bookmark2404"><span class="font24">Figure 14-19</span></a><span class="font24">). The proxy is the only device permitted by the firewall routers to exchange HTTP traffic, and it may employ virus checking or other content controls.</span></p><img src="book_files/book-475.jpg" alt="" style="width:360pt;height:172pt;">
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a name="bookmark2404"></a><span class="font24">But once the client starts encrypting the data to the server, using the server’s public key, the proxy no longer has the ability to read the HTTP header! And if the proxy cannot read the HTTP header, it won’t know where to forward the request (</span><a href="#bookmark2405"><span class="font24">Figure 14-20</span></a><span class="font24">).</span></p>
<table>
<tr><td><img src="book_files/book-476.jpg" alt="" style="width:317pt;height:48pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">client17.mycompany.com</span></p>
<p><a href="http://www.cajun-gifts.com"><span class="font1" style="font-weight:bold;">www.cajun-gifts.com</span></a></p>
<p><span class="font1" style="font-weight:bold;">proxy.mycompany.com</span></p>
<p><span class="font2">bdfwr73ytr6ouydoiw687eqidfjwvd76weti76fig287hdi9 8r82yr87pfdy72y87193836PDUyqe719eyty3gee98y8787</span></p>
<p><a name="bookmark2405"></a><span class="font23" style="font-style:italic;">Figure 14-20. Proxy can’t proxy an encrypted request</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">To make HTTPS work with proxies, a few modifications are needed to tell the proxy where to connect. One popular technique is the HTTPS SSL tunneling protocol.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2406"></a><span class="font24">Using the HTTPS tunneling protocol, the client first tells the proxy the secure host and port to which it wants to connect. It does this in plaintext, before encryption starts, so the proxy can read this information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP is used to send the plaintext endpoint information, using a new extension method called CONNECT. The CONNECT method tells the proxy to open a connection to the desired host and port number and, when that’s done, to tunnel data directly between the client and server. The CONNECT method is a one-line text command that provides the hostname and port of the secure origin server, separated by a colon. The host:port is followed by a space and an HTTP version string followed by a CRLF. After that there is a series of zero or more HTTP request header lines, followed by an empty line. After the empty line, if the handshake to establish the connection was successful, SSL data transfer can begin. Here is an example:</span></p>
<p style="text-align:justify;text-indent:19pt;"><a name="bookmark2407"></a><span class="font3">CONNECT home.netscape.com:443 HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">User-agent: Mozilla/1.1N</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;raw SSL-encrypted data would follow here...&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">After the empty line in the request, the client will wait for a response from the proxy. The proxy will evaluate the request and make sure that it is valid and that the user is authorized to request such a connection. If everything is in order, the proxy will make a connection to the destination server and, if successful, send a 200 Connection Established response to the client.</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.0 200 Connection established</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Proxy-agent: Netscape-Proxy/1.1</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2408"></a><span class="font24">For more information about secure tunnels and security proxies, refer back to</span><a href="#bookmark1615"><span class="font24"> “Tun</span></a><span class="font24"></span><a href="#bookmark1615"><span class="font24">nels” in Chapter 8</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2409"></a><span class="font9" style="font-weight:bold;">For More Information</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Security and cryptography are hugely important and hugely complicated topics. If you’d like to learn more about HTTP security, digital cryptography, digital certificates, and the Public-Key Infrastructure, here are a few starting points.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2410"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2411"></a>HTTP Security</span></h3>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Web Security, Privacy &amp;&nbsp;Commerce</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">Simson Garfinkel, O’Reilly &amp;&nbsp;Associates, Inc. This is one of the best, most readable introductions to web security and the use of SSL/TLS and digital certificates.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2818.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2818.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">RFC 2818, “HTTP Over TLS,” specifies how to implement secure HTTP over Transport Layer Security (TLS), the modern successor to SSL.</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2817.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2817.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 18pt;"><span class="font24">RFC 2817, “Upgrading to TLS Within HTTP/1.1,” explains how to use the Upgrade mechanism in HTTP/1.1 to initiate TLS over an existing TCP connection. This allows unsecured and secured HTTP traffic to share the same well-known port (in this case, http: at 80 rather than https: at 443). It also enables virtual hosting, so a single HTTP+TLS server can disambiguate traffic intended for several hostnames at a single IP address.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2412"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2413"></a>SSL and TLS</span></h3>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2246.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2246.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">RFC 2246, “The TLS Protocol Version 1.0,” specifies Version 1.0 of the TLS protocol (the successor to SSL). TLS provides communications privacy over the Internet. The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, and message forgery.</span></p>
<p style="text-align:justify;"><a href="http://developer.netscape.com/docs/manuals/security/sslin/contents.htm"><span class="font24" style="font-style:italic;">http://developer.netscape.com/docs/manuals/security/sslin/contents.htm</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">“Introduction to SSL” introduces the Secure Sockets Layer (SSL) protocol. Originally developed by Netscape, SSL has been universally accepted on the World Wide Web for authenticated and encrypted communication between clients and servers.</span></p>
<p style="text-align:justify;"><a href="http://www.netscape.com/eng/ssl3/draft302.txt"><span class="font24" style="font-style:italic;">http://www.netscape.com/eng/ssl3/draft302.txt</span></a></p>
<p style="text-align:justify;text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“The SSL Protocol Version 3.0” is Netscape’s 1996 specification for SSL.</span></p>
<p style="text-align:justify;"><a href="http://developer.netscape.com/tech/security/ssl/howitworks.html"><span class="font24" style="font-style:italic;">http://developer.netscape.com/tech/security/ssl/howitworks.html</span></a></p>
<p style="text-align:justify;text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“How SSL Works” is Netscape’s introduction to key cryptography.</span></p>
<p style="text-align:justify;"><a href="http://www.openssl.org"><span class="font24" style="font-style:italic;">http://www.openssl.org</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 18pt;"><span class="font24">The OpenSSL Project is a collaborative effort to develop a robust, commercialgrade, full-featured, and open source toolkit implementing the Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS v1) protocols, as well as a full-strength, general-purpose cryptography library. The project is managed by a worldwide community of volunteers that use the Internet to communicate, plan, and develop the OpenSSL toolkit and its related documentation. OpenSSL is based on the excellent SSLeay library developed by Eric A. Young and Tim J. Hudson. The OpenSSL toolkit is licensed under an Apache-style licence, which basically means that you are free to get and use it for commercial and noncommercial purposes, subject to some simple license conditions.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2414"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2415"></a>Public-Key Infrastructure</span></h3>
<p style="text-align:justify;"><a href="http://www.ietf.org/html.charters/pkix-charter.html"><span class="font24" style="font-style:italic;">http://www.ietf.org/html.charters/pkix-charter.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 18pt;"><span class="font24">The IETF PKIX Working Group was established in 1995 with the intent of developing Internet standards needed to support an X.509-based Public-Key Infrastructure. This is a nice summary of that group’s activities.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2459.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2459.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">RFC 2459, “Internet X.509 Public Key Infrastructure Certificate and CRL Profile,” contains details about X.509 v3 digital certificates.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2416"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2417"></a>Digital Cryptography</span></h3>
<p><span class="font24" style="font-style:italic;">Applied Cryptography</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Bruce Schneier, John Wiley &amp;&nbsp;Sons. This is a classic book on cryptography for implementors.</span></p>
<p style="padding:0pt 0pt 5pt 19pt;"><span class="font24" style="font-style:italic;">The Code Book: The Science of Secrecy from Ancient Egypt to Quantum Cryptography </span><span class="font24">Simon Singh, Anchor Books. This entertaining book is a cryptography primer. While it’s not intended for technology experts, it is a lively historical tour of secret coding.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2418"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2419"></a>PART IV</span></h1>
<p style="text-align:right;"><a name="bookmark139"></a><span class="font12" style="font-weight:bold;"><a name="bookmark140"></a><a name="bookmark220"></a>Entities, Encodings, and</span></p>
<p style="text-align:right;padding:0pt 0pt 84pt 0pt;"><span class="font12" style="font-weight:bold;">Internationalization</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Part IV is all about the entity bodies of HTTP messages and the content that the entity bodies ship around as cargo:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• </span><a href="#bookmark239"><span class="font24">Chapter 15, </span><span class="font24" style="font-style:italic;">Entities and Encodings</span></a><span class="font24">, describes the formats and syntax of HTTP content.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• </span><a href="#bookmark240"><span class="font24">Chapter 16, </span><span class="font24" style="font-style:italic;">Internationalization</span></a><span class="font24">, surveys the web standards that allow people to exchange content in different languages and different character sets, around the globe.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• </span><a href="#bookmark241"><span class="font24">Chapter 17, </span><span class="font24" style="font-style:italic;">Content Negotiation and Transcoding</span></a><span class="font24">, explains mechanisms for negotiating acceptable content.</span></p></li></ul>
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 15</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark239"></a><span class="font11" style="font-weight:bold;"><a name="bookmark141"></a><a name="bookmark2420"></a>Entities and Encodings</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark2421"></a><span class="font24"><a name="bookmark2422"></a><a name="bookmark2423"></a>HTTP ships billions of media objects of all kinds every day. Images, text, movies, software programs. .. you name it, HTTP ships it. HTTP also makes sure that its messages can be properly transported, identified, extracted, and processed. In particular, HTTP ensures that its cargo:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Can be identified correctly (using Content-Type media formats and ContentLanguage headers) so browsers and other clients can process the content properly</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Can be unpacked properly (using Content-Length and Content-Encoding headers)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Is fresh (using entity validators and cache-expiration controls)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Meets the user’s needs (based on content-negotiation Accept headers)</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Moves quickly and efficiently through the network (using range requests, delta encoding, and other data compression)</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Arrives complete and untampered with (using transfer encoding headers and Content-MD5 checksums)</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">To make all this happen, HTTP uses well-labeled entities to carry content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">This chapter discusses entities, their associated entity headers, and how they work to transport web cargo. We’ll show how HTTP provides the essentials of content size, type, and encodings. We’ll also explain some of the more complicated and powerful features of HTTP entities, including range requests, delta encoding, digests, and chunked encodings.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">This chapter covers:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The format and behavior of HTTP message entities as HTTP data containers</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• How HTTP describes the size of entity bodies, and what HTTP requires in the way of sizing</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The entity headers used to describe the format, alphabet, and language of content, so clients can process it properly</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Reversible content encodings, used by senders to transform the content data format before sending to make it take up less space or be more secure</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Transfer encoding, which modifies how HTTP ships data to enhance the communication of some kinds of content, and chunked encoding, a transfer encoding that chops data into multiple pieces to deliver content of unknown length safely</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The assortment of tags, labels, times, and checksums that help clients get the latest version of requested content</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The validators that act like version numbers on content, so web applications can e<a name="bookmark2424"></a>nsure they have fresh content, and the HTTP header fields designed to control object freshness</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Ranges, which are useful for continuing aborted downloads where they left off</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• HTTP delta encoding extensions, which allow clients to request just those parts of a web page that actually have changed since a previously viewed revision</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• Checksums of entity bodies, which are used to detect changes in entity content as it passes through proxies</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2425"></a><span class="font9" style="font-weight:bold;"><a name="bookmark142"></a><a name="bookmark2426"></a>Messages Are Crates, Entities Are Cargo</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark2427"></a><span class="font24">If you think of HTTP messages as the crates of the Internet shipping system, then HTTP entities are the actual cargo of the messages.</span><a href="#bookmark2428"><span class="font24"> Figure 15-1 </span></a><span class="font24">shows a simple entity, carried inside an HTTP response message.</span></p>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font5">HTTP/1.0 200 OK</span></p>
<p><span class="font5">Server: Netscape-Enterprise/3.6</span></p>
<p><span class="font5">Date: Sun, 17 Sep 2000 00:01:05 GMT</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font5">Content-type: text/plain &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font5" style="font-style:italic;"><sub>Entity headers</sub></span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font5">Content-length: 18</span></p>
<p><span class="font5">Hi! I'm a message! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font5" style="font-style:italic;"><sup>Entity body</sup></span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Entity</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark2428"></a><span class="font23" style="font-style:italic;">Figure 15-1. Message entity is made up of entity headers and entity body</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The entity headers indicate a plaintext document (Content-Type: text/plain) that is a mere 18 characters long (Content-Length: 18). As always, a blank line (CRLF) separates the header fields from the start of the body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP entity headers (covered in</span><a href="#bookmark225"><span class="font24"> Chapter 3</span></a><span class="font24">) describe the contents of an HTTP message. HTTP/1.1 defines 10 primary entity header fields:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Content-Type</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">The kind of object carried by the entity.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Content-Length</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">The length or size of the message being sent.</span></p>
<p><span class="font24" style="font-style:italic;">Content-Language</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The human language that best matches the object being sent.</span></p>
<p><span class="font24" style="font-style:italic;">Content-Encoding</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Any transformation (compression, etc.) performed on the object data.</span></p>
<p><span class="font24" style="font-style:italic;">Content-Location</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">An alternate location for the object at the time of the request.</span></p>
<p><span class="font24" style="font-style:italic;">Content-Range</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">If this is a partial entity, this header defines which pieces of the whole are included.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Content-MD5</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">A checksum of the contents of the entity body.</span></p>
<p><span class="font24" style="font-style:italic;">Last-Modified</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The date on which this particular content was created or modified at the server.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Expires</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">The date and time at which this entity data will become stale.</span></p>
<p><a name="bookmark2429"></a><span class="font24" style="font-style:italic;">Allow</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">What request methods are legal on this resource; e.g., GET and HEAD.</span></p>
<p><span class="font24" style="font-style:italic;">ETag</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">A unique validator for this particular instance<a name="footnote130"></a><sup><a href="#bookmark2430">130</a></sup><sup></sup> of the document. The ETag header is not defined formally as an entity header, but it is an important header for many operations involving entities.</span></p>
<p><span class="font24" style="font-style:italic;">Cache-Control</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark2431"></a><span class="font24">Directives on how this document can be cached. The Cache-Control header, like the ETag header, is not defined formally as an entity header.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2432"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2433"></a>Entity Bodies</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The entity body just contains the raw cargo.<a name="footnote131"></a><sup><a href="#bookmark2434">131</a></sup><sup></sup> Any other descriptive information is contained in the headers. Because the entity body cargo is just raw data, the entity headers are needed to describe the meaning of that data. For example, the ContentType entity header tells us how to interpret the data (image, text, etc.), and the Content-Encoding entity header tells us if the data was compressed or otherwise recoded. We talk about all of this and more in upcoming sections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The raw content begins immediately after the blank CRLF line that marks the end of the header fields. Whatever the content is—text or binary, document or image, compressed or uncompressed, English or French or Japanese—it is placed right after the CRLF.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark2435"><span class="font24">Figure 15-2</span></a><span class="font24"> shows two examples of real HTTP messages, one carrying a text entity, the other carrying an image entity. The hexadecimal values show the exact contents of the message:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• In </span><a href="#bookmark2435"><span class="font24">Figure 15-2</span></a><span class="font24">a, the entity body begins at byte number 65, right after the end-of-headers CRLF. The entity body contains the ASCII characters for “Hi! I’m a message!”</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 18pt 19pt;"><span class="font24">• In </span><a href="#bookmark2435"><span class="font24">Figure 15-2</span></a><span class="font24">b, the entity body begins at byte number 67. The entity body contains the binary contents of the GIF image. GIF files begin with 6-byte version signature, a 16-bit width, and a 16-bit height. You can see all three of these directly in the entity body.</span></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 6pt 0pt;"><span class="font1" style="font-weight:bold;">(a)</span><span class="font0"> Text/plain entity in HTTP response message</span></p></li></ul>
<p style="text-indent:12pt;"><span class="font3">HTTP/1.0 200 OK</span></p>
<p style="text-indent:12pt;"><span class="font3">Content-type: text/plain</span></p>
<p style="text-indent:12pt;padding:0pt 0pt 6pt 0pt;"><span class="font3">Content-length: 18</span></p>
<p style="text-indent:12pt;padding:0pt 0pt 9pt 0pt;"><span class="font3">Hi! I’m a message</span></p>
<p style="padding:0pt 0pt 14pt 72pt;"><span class="font0">final LF (0x0A= &lt;LF&gt;) start-of-content (0x48= “H”)</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;"><span class="font1" style="font-weight:bold;text-decoration:underline;">(b)</span><span class="font0" style="text-decoration:underline;"> Image/gif entity in HTTP response me</span><span class="font0">ssage</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font0">final LF</span></p></td><td colspan="3" style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font0">start-of-content</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font0">Width</span></p></td><td colspan="2" style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:13pt;"><span class="font0">Height</span></p></td></tr>
<tr><td colspan="3" style="vertical-align:top;">
<p style="text-align:center;"><span class="font0">(0x0A= &lt;LF&gt;)</span></p></td><td colspan="2" style="vertical-align:top;">
<p><span class="font0">(”GIF87a”)</span></p></td><td colspan="4" style="vertical-align:top;">
<p style="text-align:right;"><span class="font0">(0x0227= 551) (0x0206= 518)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark2436"></a><span class="font3">HTTP/1.0 200 OK</span></p>
<p><span class="font3">Content-Type: image/gif</span></p>
<p><span class="font3">Content-Length: 34867</span></p></td></tr>
<tr><td><img src="book_files/book-477.jpg" alt="" style="width:100pt;height:50pt;"></td></tr>
</table>
</div><br clear="all"></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark2435"></a><span class="font23" style="font-style:italic;">Figure 15-2. Hex dumps of real message content (raw message content follows blank CRLF)</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2437"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2438"></a><a name="bookmark143"></a><a name="bookmark2439"></a>Content-Length: The Entity’s Size</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-Length header indicates the size of the entity body in the message, in bytes. The size includes any content encodings (the Content-Length of a gzip-compressed text file will be the compressed size, not the original size).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The Content-Length header is mandatory for messages with entity bodies, unless the message is transported using chunked encoding. Content-Length is needed to detect premature message truncation when servers crash and to properly segment messages that share a persistent connection.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2440"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2441"></a>Detecting Truncation</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Older versions of HTTP used connection close to delimit the end of a message. But, without Content-Length, clients cannot distinguish between successful connection close at the end of a message and connection close due to a server crash in the middle of a message. Clients need Content-Length to detect message truncation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Message truncation is especially severe for caching proxy servers. If a cache receives a truncated message and doesn’t recognize the truncation, it may store the defective content and serve it many times. Caching proxy servers generally do not cache HTTP bodies that don’t have an explicit Content-Length header, to reduce the risk of caching truncated messages.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2442"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2443"></a><a name="bookmark2444"></a>Incorrect Content-Length</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2445"></a><span class="font24">An incorrect Content-Length can cause even more damage than a missing ContentLength. Because some early clients and servers had well-known bugs with respect to Content-Length calculations, some clients, servers, and proxies contain algorithms to try to detect and correct interactions with broken servers. HTTP/1.1 user agents officially are supposed to notify the user when an invalid length is received and detected.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2446"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2447"></a>Content-Length and Persistent Connections</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2448"></a><span class="font24">Content-Length is essential for persistent connections. If the response comes across a persistent connection, another HTTP response can immediately follow the current response. The Content-Length header lets the client know where one message ends and the next begins. Because the connection is persistent, the client cannot use connection close to identify the message’s end. Without a Content-Length header, HTTP applications won’t know where one entity body ends and the next message begins.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As we will see in</span><a href="#bookmark2449"><span class="font24"> “Transfer Encoding and Chunked Encoding</span></a><span class="font24">,” there is one situation where you can use persistent connections without having a Content-Length header: when you use </span><span class="font24" style="font-style:italic;">chunked encoding</span><span class="font24">. Chunked encoding sends the data in a series of chunks, each with a specified size. Even if the server does not know the size of the entire entity at the time the headers are generated (often because the entity is being generated dynamically), the server can use chunked encoding to transmit pieces of well-defined size.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2450"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2451"></a>Content Encoding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP lets you encode the contents of an entity body, perhaps to make it more secure or to compress it to take up less space (we explain compression in detail later in this chapter). If the body has been content-encoded, the Content-Length header specifies the length, in bytes, of the </span><span class="font24" style="font-style:italic;">encoded</span><span class="font24"> body, </span><span class="font24" style="font-style:italic;">not</span><span class="font24"> the length of the original, unencoded body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some HTTP applications have been known to get this wrong and to send the size of the data before the encoding, which causes serious errors, especially with persistent connections. Unfortunately, none of the headers described in the HTTP/1.1 <a name="bookmark2452"></a><a name="bookmark2453"></a>specification can be used to send the length of the original, unencoded body, which makes it difficult for clients to verify the integrity of their unencoding processes.<a name="footnote132"></a><sup><a href="#bookmark2454">132</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2455"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2456"></a>Rules for Determining Entity Body Length</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following rules describe how to correctly determine the length and end of an entity body in several different circumstances. The rules should be applied in order; the first match applies.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">1. If a particular HTTP message type is not allowed to have a body, ignore the Content-Length header for body calculations. The Content-Length headers are informational in this case and do not describe the actual body length. (Naïve HTTP applications can get in trouble if they assume Content-Length always means there is a body).</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">The most important example is the HEAD response. The HEAD method requests that a server send the headers that would have been returned by an equivalent GET request, but no body. Because a GET response would send back a Content-Length header, so will the HEAD response—but unlike the GET response, the HEAD response will not have a body. 1XX, 204, and 304 responses also can have informational Content-Length headers but no entity body. Messages that forbid entity bodies must terminate at the first empty line after the headers, regardless of which entity header fields are present.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">2. If a message contains a Transfer-Encoding header (other than the default HTTP “identity” encoding), the entity will be terminated by a special pattern called a “zero-byte chunk,” unless the message is terminated first by closing the connection. We’ll discuss transfer encodings and chunked encodings later in this chapter.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">3. If a message has a Content-Length header (and the message type allows entity bodies), the Content-Length value contains the body length, unless there is a non-identity Transfer-Encoding header. If a message is received with both a Content-Length header field and a non-identity Transfer-Encoding header field, you must ignore the Content-Length, because the transfer encoding will change the way entity bodies are represented and transferred (and probably the number of bytes transmitted).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">4. If the message uses the “multipart/byteranges” media type and the entity length is not otherwise specified (in the Content-Length header), each part of the multipart message will specify its own size. This multipart type is the only entity body type that self-delimits its own size, so this media type must not be sent unless the sender knows the recipient can parse it.<a name="footnote133"></a><sup><a href="#bookmark2457">133</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">5. If none of the above rules match, the entity ends when the connection closes. In practice, only servers can use connection close to indicate the end of a message. Clients can’t close the connection to signal the end of client messages, because that would leave no way for the server to send back a response.<a name="footnote134"></a><sup><a href="#bookmark2458">134</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark2459"></a><span class="font24">6. To be compatible with HTTP/1.0 applications, any HTTP/1.1 request that has an entity body also must include a valid Content-Length header field (unless the server is known to be HTTP/1.1-compliant). The HTTP/1.1 specification counsels that if a request contains a body and no Content-Length, the server should send a 400 Bad Request response if it cannot determine the length of the message, or a 411 Length Required response if it wants to insist on receiving a valid Content-Length.</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2460"></a><span class="font9" style="font-weight:bold;"><a name="bookmark144"></a><a name="bookmark2461"></a>Entity Digests</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Although HTTP typically is implemented over a reliable transport protocol such as TCP/IP, parts of messages may get modified in transit for a variety of reasons, such as noncompliant transcoding proxies or buggy intermediary proxies. To detect unintended (or undesired) modification of entity body data, the sender can generate a checksum of the data when the initial entity is generated, and the receiver can sanity check the checksum to catch any unintended entity modifica-tion.<a name="footnote135"></a><sup><a href="#bookmark2462">135</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-MD5 header is used by servers to send the result of running the MD5 algorithm on the entity body. Only the server where the response originates may compute and send the Content-MD5 header. Intermediate proxies and caches may not modify or add the header—that would violate the whole purpose of verifying end-to-end integrity. The Content-MD5 header contains the MD5 of the content after all content encodings have been applied to the entity body and before any transfer encodings have been applied to it. Clients seeking to verify the integrity of the message must first decode the transfer encodings, then compute the MD5 of the resulting unencoded entity body. As an example, if a document is compressed using the gzip algorithm, then sent with chunked encoding, the MD5 algorithm is run on the full gripped body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In addition to checking message integrity, the MD5 can be used as a key into a hash table to quickly locate documents and reduce duplicate storage of content. Despite these possible uses, the Content-MD5 header is not sent often.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2463"></a><span class="font24"><a name="bookmark2464"></a><a name="bookmark2465"></a>Extensions to HTTP have proposed other digest algorithms in IETF drafts. These extensions have proposed a new header, Want-Digest, that allows clie<a name="bookmark2466"></a>nts to specify the type of digest they expect with the response. Quality values can be used to suggest multiple digest algorithms and indicate preference.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2467"></a><span class="font9" style="font-weight:bold;"><a name="bookmark145"></a><a name="bookmark2468"></a>Media Type and Charset</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-Type header field describes the MIME type of the entity body.<a name="footnote136"></a><sup><a href="#bookmark2469">136</a></sup><sup></sup> The MIME type is a standardized name that describes the underlying type of media carried as cargo (HTML file, Microsoft Word document, MPEG video, etc.). Client applications use the MIME type to properly decipher and process the content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">The Content-Type values are standardized MIME types, registered with the Internet Assigned Numbers Authority (IANA). MIME types consist of a primary media type (e.g., text, image, audio), followed by a slash, followed by a subtype that further specifies the media type.</span><a href="#bookmark2470"><span class="font24"> Table 15-1 </span></a><span class="font24">lists a few common MIME types for the ContentType header. More MIME types are listed in </span><a href="#bookmark249"><span class="font24">Appendix D</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2470"></a><span class="font23" style="font-style:italic;">Table 15-1. Common media types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Media type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">text/html</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body is an HTML document</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">text/plain</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body is a document in plain text</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/gif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Entity body is an image of type GIF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">image/jpeg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body is an image of type JPEG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/x-wav</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Entity body contains WAV sound data</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">model/vrml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body is a three-dimensional VRML model</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.ms-powerpoint</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body is a Microsoft PowerPoint presentation</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/byteranges</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Entity body has multiple parts, each containing a different range (in bytes) of the full document</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">message/http</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Entity body contains a complete HTTP message (see TRACE)</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">It is important to note that the Content-Type header specifies the media type of the original entity body. If the entity has gone through content encoding, for example, the Content-Type header will still specify the entity body type </span><span class="font24" style="font-style:italic;">before</span><span class="font24"> the encoding.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2471"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2472"></a><a name="bookmark2473"></a><a name="bookmark2474"></a>Character Encodings for Text Media</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-Type header also supports optional parameters to further specify the content type. The “charset” parameter is the primary example, specifying the mechanism to convert bits from the entity into characters in a text file:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Type: text/html; charset=iso-8859-4</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">We talk about character sets in detail in</span><a href="#bookmark240"><span class="font24"> Chapter 16</span></a><span class="font24">.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2475"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2476"></a>Multipart Media Types</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">MIME “multipart” email messages contain multiple messages stuck together and sent as a single, complex message. Each component is self-contained, with its own set of headers describing its content; the different components are concatenated together and delimited by a string.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2477"></a><span class="font24">HTTP also supports multipart bodies; however, they typically are sent in only one of two situations: in fill-in form submissions and in range responses carrying pieces of a document.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2478"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2479"></a>Multipart Form Submissions</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2480"></a><span class="font24">When an HTTP fill-in form is submitted, variable-length text fields and uploaded objects are sent as separate parts of a multipart body, allowing forms to be filled out with values of different types and lengths. For example, you may choose to fill out a form that asks for your name and a description with your nickname and a small photo, while your friend may put down her full name and a long essay describing her passion for fixing Volkswagen buses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP sends such requests with a Content-Type: multipart/form-data header or a Content-Type: multipart/mixed header and a multipart body, like this:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Type: multipart/form-data; boundary=[abcdefghijklmnopqrstuvwxyz]</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">where the boundary specifies the delimiter string between the different parts of the body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following example illustrates multipart/form-data encoding. Suppose we have this form:</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 43pt;"><span class="font3">&lt;FORM action=&quot;</span><a href="http://server.com/cgi/handle"><span class="font3">http://server.com/cgi/handle</span></a><span class="font3">&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;P&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">What is your name? &lt;INPUT type=&quot;text&quot; name=&quot;submit-name&quot;&gt;&lt;BR&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">What files are you sending? &lt;INPUT type=&quot;file&quot; name=&quot;files&quot;&gt;&lt;BR&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;INPUT type=&quot;submit&quot; value=&quot;Send&quot;&gt; &lt;INPUT type=&quot;reset&quot;&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/FORM&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the user enters “Sally” in the text-input field and selects the text file “essayfile.txt,” the user agent might send back the following data:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: multipart/form-data; boundary=AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: form-data; name=&quot;submit-name&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Sally</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: form-data; name=&quot;files&quot;; filename=&quot;essayfile.txt&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: text/plain</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3" style="font-style:italic;">...contents of essayfile.txt...</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">--AaB03x--</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the user selected a second (image) file, “imagefile.gif,” the user agent might construct the parts as follows:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: multipart/form-data; boundary=AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: form-data; name=&quot;submit-name&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Sally</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--AaB03x</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: form-data; name=&quot;files&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: multipart/mixed; boundary=BbC04y</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--BbC04y</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: file; filename=&quot;essayfile.txt&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: text/plain</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3" style="font-style:italic;">...contents of essayfile.txt...</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">--BbC04y</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Disposition: file; filename=&quot;imagefile.gif&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: image/gif</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Transfer-Encoding: binary</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3" style="font-style:italic;">...contents of imagefile.gif...</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">- -BbC04y--</span></p></li>
<li>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 14pt 0pt;"><span class="font3">- -AaB03x--</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2481"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2482"></a>Multipart Range Responses</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP responses to range requests also can be multipart. Such responses come with a Content-Type: multipart/byteranges header and a multipart body with the different ranges. Here is an example of a multipart response to a request for different ranges of a document:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.0 206 Partial content</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Date: Sun, 10 Dec 2000 19:11:20 GMT</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Location: </span><a href="http://www.joes-hardware.com/gettysburg.txt"><span class="font3">http://www.joes-hardware.com/gettysburg.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font3">Content-Type: multipart/x-byteranges; boundary=--[abcdefghijklmnopqrstuvwxyz]--Last-Modified: Sat, 09 Dec 2000 00:38:47 GMT</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">- -[abcdefghijklmnopqrstuvwxyz]--</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: text/plain</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Range: bytes 0-174/1441</span></p>
<p style="padding:0pt 53pt 0pt 19pt;"><span class="font3">Fourscore and seven years ago our fathers brough forth on this continent a new nation, conceived in liberty and dedicated to the proposition that all men are created equal.</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:19pt;"><span class="font3">- -[abcdefghijklmnopqrstuvwxyz]--</span></p></li></ul>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/plain</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Range: bytes 552-761/1441</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><a name="bookmark2483"></a><span class="font3"><a name="bookmark2484"></a>But in a larger sense, we can not dedicate, we can not consecrate, we can not hallow this ground. The brave men, living and dead who struggled here have consecrated it far above our poor power to add or detract.</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:19pt;"><span class="font3">- -[abcdefghijklmnopqrstuvwxyz]--</span></p></li></ul>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/plain</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Range: bytes 1344-1441/1441</span></p>
<p style="padding:0pt 0pt 10pt 19pt;"><span class="font3">and that government of the people, by the people, for the people shall not perish from the earth.</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">- -[abcdefghijklmnopqrstuvwxyz]--</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">Range requests are discussed in more detail later in this chapter.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2485"></a><span class="font9" style="font-weight:bold;"><a name="bookmark146"></a><a name="bookmark2486"></a>Content Encoding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP applications sometimes want to encode content before sending it. For example, a server might compress a large HTML document before sending it to a client that is connected over a slow connection, to help lessen the time it takes to transmit the entity. A server might scramble or encrypt the contents in a way that prevents unauthorized third parties from viewing the contents of the document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">These types of encodings are applied to the content at the sender. Once the content is content-encoded, the encoded data is sent to the receiver in the entity body as usual.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2487"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2488"></a>The Content-Encoding Process</span></h3>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">The content-encoding process is:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">1. A web server generates an original response message, with original ContentType and Content-Length headers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">2. A content-encoding server (perhaps the origin server or a downstream proxy) creates an encoded message. The encoded message has the same Content-Type but (if, for example, the body is compressed) a different Content-Length. The content-encoding server adds a Content-Encoding header to the encoded message, so that a receiving application can decode it.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">3. A receiving program gets the encoded message, decodes it, and obtains the original.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><a href="#bookmark2489"><span class="font24">Figure 15-3</span></a><span class="font24"> sketches a content-encoding example.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Original content</span></p>
<p><span class="font3">Content-type: text/html Content-length: 12480</span></p></td></tr>
<tr><td><img src="book_files/book-478.jpg" alt="" style="width:116pt;height:94pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Gzip content decoder</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;font-style:italic;">Content-encoded content</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Original content</span></p>
<p><span class="font3">Content-type: text/html</span></p>
<p><span class="font3">Content-length: 12480</span></p></td></tr>
<tr><td><img src="book_files/book-479.jpg" alt="" style="width:104pt;height:45pt;"></td></tr>
</table>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-480.jpg" alt="" style="width:83pt;height:48pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Gzip content encoder</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-type: text/html Content-length: 3907 Content-</span><span class="font3" style="text-decoration:underline;">encodin</span><span class="font3">g: gzip</span></p>
<p><span class="font1" style="font-weight:bold;">01001011</span></p>
<p style="padding:0pt 0pt 95pt 0pt;"><span class="font1" style="font-weight:bold;">11000101</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2489"></a><span class="font23" style="font-style:italic;">Figure 15-3. Content-encoding example</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here, an HTML page is encoded by a gzip content-encoding function, to produce a smaller, compressed body. The compressed body is sent across the network, flagged with the gzip encoding. The receiving client decompresses the entity using the gzip decoder.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This response snippet shows another example of an encoded response (a compressed image):</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Date: Fri, 05 Nov 1999 22:35:15 GMT</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Apache/1.2.4</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Length: 6096</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Content-Type: image/gif</span></p>
<h3 style="text-align:justify;text-indent:19pt;"><a name="bookmark2490"></a><span class="font3"><a name="bookmark2491"></a>Content-Encoding: gzip</span></h3>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">[...]</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Note that the Content-Type header can and should still be present in the message. It describes the original format of the entity—information that may be necessary for displaying the entity once it has been decoded. Remember that the Content-Length header now represents the length of the </span><span class="font24" style="font-style:italic;">encoded</span><span class="font24"> body.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">Content-Encoding Types</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">HTTP defines a few standard content-encoding types and allows for additional encodings to be added as extension encodings. Encodings are standardized through the IANA, which assigns a unique token to each content-encoding algorithm. The Content-Encoding header uses these standardized token values to describe the algorithm used in the encoding.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Some of the common content-encoding tokens are listed in</span><a href="#bookmark2492"><span class="font24"> Table 15-2</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2492"></a><span class="font23" style="font-style:italic;">Table 15-2. Content-encoding tokens</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Content-encoding value</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">gzip</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates that the GNU zip encoding was applied to the entity.<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">compress</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates that the Unix file compression program has been run on the entity.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">deflate</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Indicates that the entity has been compressed into the zlib format.<sup>b</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">identity</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates that no encoding has been performed on the entity. When a Content-Encoding header is not present, this can be assumed.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> RFC 1952 describes the gzip encoding.</span></p>
<p><span class="font3"><sup>b</sup> RFCs 1950 and 1951 describe the zlib format and deflate compression.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The gzip, compress, and deflate encodings are lossless compression algorithms used to reduce the size of transmitted messages without loss of information. Of these, gzip typically is the most effective compression algorithm and is the most widely used.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2493"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2494"></a>Accept-Encoding Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Of course, we don’t want servers encoding content in ways that the client can’t decipher. To prevent servers from using encodings that the client doesn’t support, the client passes along a list of supported content encodings in the Accept-Encoding request header. If the HTTP request does not contain an Accept-Encoding header, a server can assume that the client will accept any encoding (equivalent to passing Accept-Encoding: *).</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark2495"><span class="font24">Figure 15-4</span></a><span class="font24"> shows an example of Accept-Encoding in an HTTP transaction.</span></p>
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request message</span></p></td></tr>
<tr><td><img src="book_files/book-481.jpg" alt="" style="width:292pt;height:148pt;"></td></tr>
<tr><td>
<p><span class="font0">The server compresses the image with gzip to transport a smaller file over the thin network connection between itself and the client. This saves network bandwidth and reduces the amount of time that the client waits for the transfer. Though, the client will have to spend time decompressing the image once the image is served.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2495"></a><span class="font23" style="font-style:italic;">Figure 15-4. Content encoding</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2496"></a><span class="font24">The Accept-Encoding field contains a comma-separated list of supported encodings. Here are a few examples:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept-Encoding: compress, gzip</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept-Encoding:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept-Encoding: *</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept-Encoding: compress;q=0.5, gzip;q=1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Accept-Encoding: gzip;q=1.0, identity; q=0.5, *;q=0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2497"></a><span class="font24">Clients can indicate preferred encodings by attaching Q (quality) values as parameters to each encoding. Q values can range from 0.0, indicating that the client does not want the associated encoding, to 1.0, indicating the preferred encoding. The token “*” means “anything else.” The process of selecting which content encoding to apply is part of a more general process of deciding which content to send back to a client in a response. This process and the Content-Encoding and Accept-Encoding headers are discussed in more detail in</span><a href="#bookmark241"><span class="font24"> Chapter 17</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The identity encoding token can be present only in the Accept-Encoding header and is used by clients to specify relative preference over other content-encoding algorithms.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2449"></a><span class="font9" style="font-weight:bold;"><a name="bookmark147"></a><a name="bookmark2498"></a>Transfer Encoding and Chunked Encoding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The previous section discussed </span><span class="font24" style="font-style:italic;">content</span><span class="font24"> encodings—reversible transformations applied to the body of the message. Content encodings are tightly associated with the details of the particular content format. For example, you might compress a text file with gzip, but not a JPEG file, because JPEGs don’t compress well with gzip.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This section discusses </span><span class="font24" style="font-style:italic;">transfer</span><span class="font24"> encodings. Transfer encodings also are reversible transformations performed on the entity body, but they are applied for architectural reasons and are independent of the format of the content. You apply a transfer encoding to a message to change the way message data is transferred across the network (</span><a href="#bookmark2499"><span class="font24">Figure 15-5</span></a><span class="font24">).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2500"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2501"></a>Safe Transport</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Historically, transfer encodings exist in other protocols to provide “safe transport” of messages across a network. The concept of safe transport has a different focus for HTTP, where the transport infrastructure is standardized and more forgiving. In HTTP, there are only a few reasons why transporting message bodies can cause trouble. Two of these are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Unknown size</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Some gateway applications and content encoders are unable to determine the final size of a message body without generating the content first. Often, these servers would like to start sending the data before the size is known. Because</span></p>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">Content-encoded response</span></p>
<p style="text-align:justify;text-indent:14pt;"><span class="font5">HTTP/1.0 200 OK</span></p>
<p style="text-align:justify;text-indent:14pt;"><span class="font5">Content-encoding: gzip &nbsp;&nbsp;</span><span class="font1" style="font-style:italic;">Normal header block</span></p>
<p style="text-align:justify;text-indent:14pt;"><span class="font5">Content-type: text/html</span></p>
<p style="text-align:justify;text-indent:14pt;"><span class="font5">[...]</span></p>
<p style="text-align:justify;text-indent:14pt;"><span class="font5">[encoded message] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font1" style="font-style:italic;">Normal entity</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font0">A Content-encoded message just encodes the entity section of the message. With Transfer-encoded messages the encoding is a function of the entire message, changing the structure of the message itself.</span></p>
</div>
<p style="padding:0pt 0pt 14pt 137pt;"><span class="font1" style="font-style:italic;">(just encoded)</span></p>
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Transfer-encoded response</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font5">HTTP/1.1 200 OK</span></p>
<p><span class="font5">Transfer-encoding: chunked</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Basic header</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font5">10</span></p>
<p><span class="font5">abcdefghijk</span></p></td><td style="vertical-align:middle;">
<p><span class="font1" style="font-style:italic;">Encoded blocks</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font5">1 a</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark731"></a><span class="font23" style="font-style:italic;"><a name="bookmark2499"></a>Figure 15-5. Content encodings versus transfer encodings</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">HTTP requires the Content-Length header to precede the data, some servers apply a transfer encoding to send the data with a special terminating footer that indicates the end of data.<a name="footnote137"></a><sup><a href="#bookmark2502">137</a></sup><sup></sup></span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Security</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 19pt;"><span class="font24">You might use a transfer encoding to scramble the message content before sending it across a shared transport network. However, because of the popularity of transport layer security schemes like SSL, transfer-encoding security isn’t very common.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2503"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2504"></a>Transfer-Encoding Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">There are just two defined headers to describe and control transfer encoding:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Transfer-Encoding</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Tells the receiver what encoding has been performed on the message in order for it to be safely transported</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">TE</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Used in the request header to tell the server what extension transfer encodings are okay to use<a name="footnote138"></a><sup><a href="#bookmark2505">138</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In the following example, the request uses the TE header to tell the server that it accepts the chunked encoding (which it must if it’s an HTTP 1.1 application) and is willing to accept trailers on the end of chunk-encoded messages:</span></p>
<p style="text-indent:19pt;"><span class="font3">GET /new_products.html HTTP/1.1</span></p>
<p style="text-indent:19pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="text-indent:19pt;"><span class="font3">User-Agent: Mozilla/4.61 [en] (WinNT; I)</span></p>
<p style="padding:0pt 0pt 5pt 19pt;"><span class="font3">TE: trailers, chunked ...</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The response includes a Transfer-Encoding header to tell the receiver that the message has been transfer-encoded with the chunked encoding:</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="padding:0pt 0pt 5pt 19pt;"><span class="font3">Transfer-Encoding: chunked Server: Apache/3.0 ...</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">After this initial header, the structure of the message will change.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">All transfer-encoding values are case-insensitive. HTTP/1.1 uses transfer-encoding values in the TE header field and in the Transfer-Encoding header field. The latest HTTP specification defines only one transfer encoding, chunked encoding.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The TE header, like the Accept-Encoding header, can have Q values to describe preferred forms of transfer encoding. The HTTP/1.1 specification, however, forbids the association of a Q value of 0.0 to chunked encoding.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark717"></a><span class="font24">Future extensions to HTTP may drive the need for additional transfer encodings. If and when this happens, the chunked transfer encoding should always be applied on top of the extension transfer encodings. This guarantees that the data will get “tunneled” through HTTP/1.1 applications that understand chunked encoding but not other transfer encodings.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2506"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2507"></a>Chunked Encoding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Chunked encoding breaks messages into chunks of known size. Each chunk is sent one after another, eliminating the need for the size of the full message to be known before it is sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Note that chunked encoding is a form of transfer encoding and therefore is an attribute of the message, not the body. Multipart encoding, described earlier in this chapter, is an attribute of the body and is completely separate from chunked encoding.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2508"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2509"></a>Chunking and persistent connections</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When the connection between the client and server is not persistent, clients do not need to know the size of the body they are reading—they expect to read the body until the server closes the connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With persistent connections, the size of the body must be known and sent in the Content-Length header before the body can be written. When content is dynamically created at a server, it may not be possible to know the length of the body before sending it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Chunked encoding provides a solution for this dilemma, by allowing servers to send the body in chunks, specifying only the size of each chunk. As the body is dynamically generated, a server can buffer up a portion of it, send its size and the chunk, and then repeat the process until the full body has been sent. The server can signal the end of the body with a chunk of size 0 and still keep the connection open and ready for the next response.</span></p>
<p style="text-align:justify;padding:0pt 0pt 21pt 0pt;"><span class="font24">Chunked encoding is fairly simple.</span><a href="#bookmark2510"><span class="font24"> Figure 15-6 </span></a><span class="font24">shows the basic anatomy of a chunked message. It begins with an initial HTTP response header block, followed by a stream of chunks. Each chunk contains a length value and the data for that chunk. The length value is in hexadecimal form and is separated from the chunk data with a CRLF. The size of the chunk data is measured in bytes and includes neither the CRLF sequence between the length value and the data nor the CRLF sequence at the end of the chunk. The last chunk is special—it has a length of zero, which signifies “end of body.”</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:right;"><span class="font3" style="font-weight:bold;font-style:italic;">HTTP response</span></p></td></tr>
<tr><td><img src="book_files/book-482.jpg" alt="" style="width:75pt;height:53pt;"></td></tr>
</table>
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font3" style="font-weight:bold;font-style:italic;">Response stream</span></p>
</div>
<p><span class="font3">HTTP/1.1 200 OK&lt;CR&gt;&lt;LF&gt;</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-type: text/plain&lt;CR&gt;&lt;LF&gt; Transfer-encoding: chunked&lt;CR&gt;&lt;LF&gt; Trailer: Content-MD5&lt;CR&gt;&lt;LF&gt; &lt;CR&gt;&lt;LF&gt;</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-483.jpg" alt="" style="width:69pt;height:103pt;">
</div>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3" style="font-style:italic;">Hexadecimal chunk size (27 hex=&gt; 39 characters)</span></p>
<p><span class="font3">27&lt;CR&gt;&lt;LF&gt;</span></p>
<p><span class="font3">We hold these truths to be self-evident&lt;CR&gt;&lt;LF&gt; 26&lt;CR&gt;&lt;LF&gt;</span></p>
<p><span class="font3">, that all men are created equal, that&lt;CR&gt;&lt;LF&gt; 84&lt;CR&gt;&lt;LF&gt;</span></p>
<p style="text-indent:9pt;padding:0pt 0pt 64pt 0pt;"><span class="font3">they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness.&lt;CR&gt;&lt;LF&gt;</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-484.jpg" alt="" style="width:69pt;height:70pt;"></td><td>
<p><span class="font3">0&lt;CR&gt;&lt;LF&gt;</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-MD5:gjqei54p26tjisgj3p4utjgrj53&lt;CR&gt;&lt;LF&gt;</span></p>
<p style="padding:0pt 0pt 21pt 0pt;"><span class="font3" style="font-style:italic;">*Optional–only present if there is a Trailer header in the message headers.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2510"></a><span class="font23" style="font-style:italic;">Figure 15-6. Anatomy of a chunked message</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">A client also may send chunked data to a server. Because the client does not know beforehand whether the server accepts chunked encoding (servers do not send TE headers in responses to clients), it must be prepared for the server to reject the chunked request with a 411 Length Required response.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2511"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2512"></a>Trailers in chunked messages</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A trailer can be added to a chunked message if the client’s TE header indicates that it accepts trailers, or if the trailer is added by the server that created the original response and the contents of the trailer are optional metadata that it is not necessary for the client to understand and use (it is okay for the client to ignore and discard the contents of the trailer).<a name="footnote139"></a><sup><a href="#bookmark2513">139</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The trailer can contain additional header fields whose values might not have been known at the start of the message (e.g., because the contents of the body had to be generated first). An example of a header that can be sent in the trailer is the Content-MD5 header—it would be difficult to calculate the MD5 of a document before the document has been generated.</span><a href="#bookmark2510"><span class="font24"> Figure 15-6 </span></a><span class="font24">illustrates the use of trailers. The message headers contain a Trailer header listing the headers that will follow the chunked message. The last chunk is followed by the headers listed in the Trailer header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Any of the HTTP headers can be sent as trailers, except for the Transfer-Encoding, Trailer, and Content-Length headers.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2514"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2515"></a>Combining Content and Transfer Encodings</span></h3>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Content encoding and transfer encoding can be used simultaneously. For example, </span><a href="#bookmark2516"><span class="font24">Figure 15-7</span></a><span class="font24"> illustrates how a sender can compress an HTML file using a content encoding and send the data chunked using a transfer encoding. The process to “reconstruct” the body is reversed on the receiver.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2517"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2518"></a>Transfer-Encoding Rules</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a transfer encoding is applied to a message body, a few rules must be followed:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The set of transfer encodings must include “chunked.” The only exception is if the message is terminated by closing the connection.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• When the chunked transfer encoding is used, it is required to be the last transfer encoding applied to the message body.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The chunked transfer encoding must not be applied to a message body more than once.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">Content-type: text/html</span></p></td><td><img src="book_files/book-485.jpg" alt="" style="width:108pt;height:55pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-486.jpg" alt="" style="width:108pt;height:55pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Content encoding</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-487.jpg" alt="" style="width:36pt;height:24pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-488.jpg" alt="" style="width:88pt;height:90pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Content-type: text/html Content-encoding: gzip</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">9BF2578EA4 2670CD</span></p></td></tr>
<tr><td><img src="book_files/book-489.jpg" alt="" style="width:40pt;height:25pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a name="bookmark2519"></a><span class="font3">Content-type: text/html Content-encoding: gzip Transfer-encoding: chunked</span></p></td><td><img src="book_files/book-490.jpg" alt="" style="width:119pt;height:38pt;"></td></tr>
</table>
</div><br clear="all"></li></ul>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2516"></a><span class="font23" style="font-style:italic;">Figure 15-7. Combining content encoding with transfer encoding</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">These rules allow the recipient to determine the transfer length of the message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Transfer encodings are a relatively new feature of HTTP, introduced in Version 1.1. Servers that implement transfer encodings need to take special care not to send transfer-encoded messages to non-HTTP/1.1 applications. Likewise, if a server receives a transfer-encoded message that it can not understand, it should respond with the 501 Unimplemented status code. However, all HTTP/1.1 applications must at least support chunked encoding.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2520"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2521"></a><a name="bookmark148"></a><a name="bookmark2522"></a>Time-Varying Instances</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web objects are not static. The same URL can, over ti<a name="bookmark2523"></a>me, point to different versions of an object. Take the CNN home page as an example—going to “http://www.cnn.com” several times in a day is likely to result in a slightly different page being returned each time.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Think of the CNN home page as being an object and its different versions as being different </span><span class="font24" style="font-style:italic;">instances</span><span class="font24"> of the object (see </span><a href="#bookmark2524"><span class="font24">Figure 15-8</span></a><span class="font24">). The client in the figure requests the same resource (URL) multiple times, but it gets different instances of the resource as it changes over time. At time (a) and (b) it has the same instance; at time (c) it has a different instance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP protocol specifies operations for a class of requests and responses, called </span><span class="font24" style="font-style:italic;">instance manipulations</span><span class="font24">, that operate on instances of an object. The two main instance-manipulation methods are range requests and delta encoding. Both of these methods require clients to be able to identify the exact copy of the resource that they have (if any) and request new instances conditionally. These mechanisms are discussed later in this chapter.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-491.jpg" alt="" style="width:339pt;height:88pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Version 3</span></p>
<p><span class="font1" style="font-style:italic;">Version 4</span></p>
<p><a href="http://www.cnn.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.cnn.com</span></a></p>
<p style="text-align:center;"><span class="font0">Mar 3 11:21 a.m.</span></p>
<p><span class="font1" style="font-style:italic;">Time</span><span class="font0"> Feb 17</span></p>
<p style="text-indent:25pt;"><span class="font0">4:30 p.m.</span></p>
<p><a name="bookmark2524"></a><span class="font23" style="font-style:italic;">Figure 15-8. Instances are “snapshots” of a resource in time</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">Apr 2 9:07 a.m.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">Apr 12 1:48 p.m.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-492.jpg" alt="" style="width:17pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Version 1</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-493.jpg" alt="" style="width:17pt;height:20pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Version 2</span></p></td></tr>
</table>
</div><br clear="all">
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark2525"></a><span class="font9" style="font-weight:bold;"><a name="bookmark149"></a><a name="bookmark2526"></a>Validators and Freshness</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Look back at </span><a href="#bookmark2524"><span class="font24">Figure 15-8</span></a><span class="font24">. The client does not initially have a copy of the resource, so it sends a request to the server asking for it. The server responds with Version 1 of the resource. The client can now cache this copy, but for how long?</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Once the document has “expired” at the client (i.e., once the client can no longer consider its copy a valid copy), it must request a fresh copy from the server. If the document has not changed at the server, however, the client does not need to receive it again—it can just continue to use its cached copy.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This special request, called a </span><span class="font24" style="font-style:italic;">conditional request</span><span class="font24">, requires that the client tell the server which version it currently has, using a </span><span class="font24" style="font-style:italic;">validator</span><span class="font24">, and ask for a copy to be sent only if its current copy is no longer valid. Let’s look at the three key concepts—freshness, validators, and conditionals—in more detail.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2527"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2528"></a>Freshness</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Servers are expected to give clients information about how long clients can cache their content and consider it fresh. Servers can provide this information using one of two headers: Expires and Cache-Control.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Expires header specifies the exact date and time when the document “expires”—when it can no longer be considered fresh. The syntax for the Expires header is:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Expires: Sun Mar 18 23:59:59 GMT 2001</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For a client and server to use the Expires header correctly, their clocks must be synchronized. This is not always easy, because neither may run a clock synchronization protocol such as the Network Time Protocol (NTP). A mechanism that defines expiration using relative time is more useful. The Cache-Control header can be used to specify the maximum age for a document in seconds—the total amount of time since the document left the server. Age is not dependent on clock synchronization and therefore is likely to yield more accurate results.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark2529"></a><span class="font24">The Cache-Control header actually is very powerful. It can be used by both servers and clients to describe freshness using more directives than just specifying an age or expiration time. </span><a href="#bookmark2530"><span class="font24">Table 15-3 </span></a><span class="font24">lists some of the directives that can accompany the Cache-Control header.</span></p>
<table>
<tr><td>
<p><a name="bookmark2530"></a><span class="font23" style="font-style:italic;">Table 15-3. Cache-Control header directives</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">Message type</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">no-cache</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Do not return a cached copy of the document without first revalidating it with the server.</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">no-store</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Do not return a cached copy of the document. Do not store the response from the server.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">max-age</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The document in the cache must not be older than the specified age.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">max-stale</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The document may be stale based on the server-specified expiration information, but it must not have been expired for longer than the value in this directive.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">min-fresh</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The document’s age must not be more than its age plus the specified amount. In other words, the response must be fresh for at least the specified amount of time.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">no-transform</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The document must not be transformed before being sent.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">only-if-cached</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Request</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Send the document only if it is in the cache, without contacting the origin server.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">public</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Response may be cached by any cache.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">private</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Response may be cached such that it can be accessed only by a single client.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">no-cache</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">If the directive is accompanied by a list of header fields, the content may be cached and served to clients, but the listed header fields must first be removed. If no header fields are specified, the cached copy must not be served without revalidation with the server.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">no-store</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Response must not be cached.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">no-transform</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Response must not be modified in any way before being served.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">must-revalidate</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Response must be revalidated with the server before being served.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">proxy-revalidate</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Shared caches must revalidate the response with the origin server before serving. This directive can be ignored by private caches.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">max-age</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Specifies the maximum length of time the document can be cached and still considered fresh.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">s-max-age</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">Response</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Specifies the maximum age of the document as it applies to shared caches (overriding the max-age directive, if one is present). This directive can be ignored by private caches.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Caching and freshness were discussed in more detail in Chapter 7.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2531"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2532"></a>Conditionals and Validators</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a cache’s copy is requested, and it is no longer fresh, the cache needs to make sure it has a fresh copy. The cache can fetch the current copy from the origin server, but in many cases, the document on the server is still the same as the stale copy in the cache. We saw this in</span><a href="#bookmark2524"><span class="font24"> Figure 15-8</span></a><span class="font24">b; the cached copy may have expired, but the <a name="bookmark2533"></a>server content still is the same as the cache content. If a cache always fetches a server’s document, even if it’s the same as the expired cache copy, the cache wastes network bandwidth, places unnecessary load on the cache and server, and slows everything down.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To fix this, HTTP provides a way for clients to request a copy </span><span class="font24" style="font-style:italic;">only if the resource has changed</span><span class="font24">, using special requests calle<a name="bookmark2534"></a>d </span><span class="font24" style="font-style:italic;">conditional requests</span><span class="font24">. Conditional requests are normal HTTP request messages, but they are performed only if a particular condition is true. For example, a cache might send the following conditional GET message to a server, asking it to send the file </span><span class="font24" style="font-style:italic;">/announce.html</span><span class="font24"> only if the file has been modified since June 29, 2002 (the date the cached document was last changed by the author):</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET /announce.html HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">If-Modified-Since: Sat, 29 Jun 2002, 14:30:00 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Conditional requests are implemented by conditional headers that start with “If-”. In the example above, the conditional header is If-Modified-Since. A conditional header allows a method to execute only if the condition is true. If the condition is not true, the server sends an HTTP error code back.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each conditional works on a particular </span><span class="font24" style="font-style:italic;">validator</span><span class="font24">. A validator is a particular attribute of the document instance that is tested. Conceptually, you can think of the validator like the serial number, version number, or last change date of a document. A wise client in </span><a href="#bookmark2524"><span class="font24">Figure 15-8</span></a><span class="font24">b would send a conditional validation request to the server saying, “send me the resource only if it is no longer Version 1; I have Version 1.” We discussed conditional cache revalidation in</span><a href="#bookmark231"><span class="font24"> Chapter 7</span></a><span class="font24">, but we’ll study the details of entity validators more carefully in this chapter.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">The If-Modified-Since conditional header tests the last-modified date of a document instance, so we say that the last-modified date is the validator. The If-None-Match conditional header tests the ETag value of a document, which is a special keyword or version-identifying tag associated with the entity. Last-Modified and ETag are the two primary validators used by HTTP. </span><a href="#bookmark2535"><span class="font24">Table 15-4</span></a><span class="font24"> lists four of the HTTP headers used for conditional requests. Next to each conditional header is the type of validator used with the header.</span></p>
<table>
<tr><td>
<p><a name="bookmark2535"></a><span class="font23" style="font-style:italic;">Table 15-4. Conditional request types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Request type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Validator</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">If-Modified-Since</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Last-Modified</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Send a copy of the resource if the version that was last modified at the time in your previous Last-Modified response header is no longer the latest one.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">If-Unmodified-Since</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Last-Modified</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Send a copy of the resource only if it is the same as the version that was last modified at the time in your previous Last-Modified response header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">If-Match</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ETag</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Send a copy of the resource if its entity tag is the same as that of the one in your previous ETag response header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">If-None-Match</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ETag</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">Send a copy of the resource if its entity tag is different from that of the one in your previous ETag response header.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2536"></a><span class="font24"><a name="bookmark2537"></a><a name="bookmark2538"></a>HTTP groups validators into two classes: </span><span class="font24" style="font-style:italic;">weak validators</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">strong validators</span><span class="font24">. Weak validators may not always uniquely identify an instance of a resource; strong validators must. An example of a weak validator is the size of the object in bytes. The resource content might change even thought the size remains the same, so a hypothetical byte-count validator only weakly indicates a change. A cryptographic checksum of the contents of the resource (such as MD5), however, is a strong validator; it changes when the document changes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The last-modified time is considered a weak validator because, although it specifies the time at which the resource was last modified, it specifies that time to an accuracy of at most one second. Because a resource can change multiple times in a second, and because servers can serve thousands of requests per second, the last-modified date might not always reflect changes. The ETag header is considered a strong validator, because the server can place a distinct value in the ETag header every time a value changes. Version numbers and digest checksums are good candidates for the ETag header, but they can contain any arbitrary text. ETag headers are flexible; they take arbitrary text values (“tags”), and can be used to devise a variety of client and server validation strategies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Clients and servers may sometimes want to adopt a looser version of entity-tag validation. For example, a server may want to make cosmetic changes to a large, popular cached document without triggering a mass transfer when caches revalidate. In this case, the server might advertise a “weak” entity tag by prefixing the tag with “W/”. A weak entity tag should change only when the associated entity changes in a semantically significant way. A strong entity tag must change whenever the associated entity value changes in any way.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark677"></a><span class="font24">The following example shows how a client might revalidate with a server using a weak entity tag. The server would return a body only if the content changed in a meaningful way from Version 4.0 of the document:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET /announce.html HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">If-None-Match: W/&quot;v4.0&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2539"></a><span class="font24">In summary, when clients access the same resource more than once, they first need to determine whether their current copy still is fresh. If it is not, they must get the latest version from the server. To avoid receiving an identical copy in the event that the resource has not changed, clients can send conditional requests to the server, specifying validators that uniquely identify their current copies. Servers will then send a copy of the resource only if it is different from the client’s copy. For more details on cache revalidation, please refer back to</span><a href="#bookmark1387"><span class="font24"> “Cache Processing Steps” in Chapter 7</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2540"></a><span class="font9" style="font-weight:bold;"><a name="bookmark150"></a><a name="bookmark2541"></a>Range Requests</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We now understand how a client can ask a server to send it a resource only if the client’s copy of the resource is no longer valid. HTTP goes further: it allows clients to actually request just part or a range of a document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Imagine if you were three-fourths of the way through downloading the latest hot software across a slow modem link, and a network glitch interrupted your connection. You would have been waiting for a while for the download to complete, and now you would have to start all over again, hoping the same thing does not happen again.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">With range requests, an HTTP client can resume downloading an entity by asking for the range or part of the entity it failed to get (provided that the object did not change at the origin server between the time the client first requested it and its subsequent range request). For example:</span></p>
<p style="text-indent:19pt;"><span class="font3">GET /bigfile.html HTTP/1.1</span></p>
<p style="text-indent:19pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="text-indent:19pt;"><span class="font3">Range: bytes=4000-</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font3">User-Agent: Mozilla/4.61 [en] (WinNT; I) ...</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In this example, the client is requesting the remainder of the document after the first 4,000 bytes (the end bytes do not have to be specified, because the size of the document may not be known to the requestor). Range requests of this form can be used for a failed request where the client received the first 4,000 bytes before the failure. The Range header also can be used to request multiple ranges (the ranges can be specified in any order and may overlap)—for example, imagine a client connecting to multiple servers simultaneously, requesting different ranges of the same document from different servers in order to speed up overall download time for the document. In the case where clients request multiple ranges in a single request, responses come back as a single entity, with a multipart body and a Content-Type: multipart/byteranges header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2542"></a><span class="font24">Not all servers accept range requests, but many do. Servers can advertise to clients that they accept ranges by including the header Accept-Ranges in their responses. The value of this header is the unit of measure, usually bytes.<a name="footnote140"></a><sup><a href="#bookmark2543">140</a></sup><sup></sup> For example:</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">Date: Fri, 05 Nov 1999 22:35:15 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">Server: Apache/1.2.4</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font3">Accept-Ranges: bytes ...</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark2544"><span class="font24">Figure 15-9</span></a><span class="font24"> shows an example of a set of HTTP transactions involving ranges.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Range headers are used extensively by popular peer-to-peer file-sharing client software to download different parts of multimedia files simultaneously, from different peers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that range requests are a class of instance manipulations, because they are exchanges between a client and a server for a particular instance of an object. That is, a client’s range request makes sense only if the client and server have the same version of a document.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-494.jpg" alt="" style="width:39pt;height:34pt;"></td><td>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<p><span class="font3">GET /bigfile.html HTTP/1.1</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-495.jpg" alt="" style="width:42pt;height:48pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Content-type: text/html Content-length: 65537 Accept-ranges: bytes</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">110001</span></p>
<p><span class="font3">111011</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 2pt 14pt;"><span class="font3">010111 000101</span></p>
<p style="text-align:center;"><span class="font0">Client received only the first 20224 bytes of the resource</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Range request message</span></p>
<p><span class="font3">GET /bigfile.html HTTP.1.1 Range: bytes=20224-</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-496.jpg" alt="" style="width:86pt;height:46pt;"></td></tr>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Range response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Range: bytes=20224-Accept-ranges: bytes</span></p>
<p><span class="font3">[...]</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark2545"></a><span class="font0">The client’s original request was interrupted, but a second request for the part of the message that was not received allows the client to resume from the point of the interruption</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark2544"></a><span class="font23" style="font-style:italic;">Figure 15-9. Entity range request example</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2546"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2547"></a><a name="bookmark151"></a><a name="bookmark2548"></a>Delta Encoding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We have described different versions of a web page as different instances of a page. If a client has an expired copy of a page, it requests the latest instance of the page. If the server has a newer instance of the page, it will send it to the client, and it will send the full new instance of the page even if only a small portion of the page actually has changed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Rather than sending it the entire new page, the client would get the page faster if the server sent just the changes to the client’s copy of the page (provided that the number of changes is small). Delta encoding is an extension to the HTTP protocol that optimizes transfers by communicating changes instead of entire objects. Delta encoding is a type of instance manipulation, because it relies on clients and servers exchanging information about particular instances of an object. RFC 3229 describes delta encoding.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark2549"><span class="font24">Figure 15-10 </span></a><span class="font24">illustrates more clearly the mechanism of requesting, generating, receiving, and applying a delta-encoded document. The client has to tell the server which version of the page it has, that it is willing to accept a </span><span class="font24" style="font-style:italic;">delta</span><span class="font24"> from the latest version of page, and which algorithms it knows for applying those deltas to its current version.</span></p>
<p style="text-align:justify;"><span class="font24">The server has to check if it has the client’s version of the page and how to compute deltas from the latest version and the client’s version (there are several algorithms for computing the difference between two objects). It then has to compute the delta, send it to the client, let the client know that it’s sending a delta, and specify the new identifier for the latest version of the page (because this is the version that the client will end up with after it applies the delta to its old version).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-497.jpg" alt="" style="width:41pt;height:29pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Request message</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET /bigfile.html HTTP/1.1</span></p>
<p><span class="font3">Date: Mon, 01 Feb 2001 12:03:00 GMT</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Page on Monday Feb 1, 2001 at 12:03 pm.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-498.jpg" alt="" style="width:104pt;height:42pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font0">Hello, welcome to Joe’s Hardware store. Today’s special is on hammers.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Content-type: text/html</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Client receives this response and caches it. The next day, the client</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Expires: Mon, 01 Feb 2001 12:00:00 GMT</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">tries to access the same page and </span><span class="font3">E</span></p>
<p><span class="font0">sees its cached copy has expired, </span><span class="font3">Etag: abcdefghi09876AF </span><span class="font0">so it sends a request to the server </span><span class="font3">...</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">requesting the latest copy. Since it has a cached copy, it tells the server which copy it has and indicates its willingness to accept a delta.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Delta request message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET /bigfile.html HTTP.1.1 If-None-Match: abcdefghi09876AF A-IM: diffe</span></p>
<p><span class="font3">Date: Tue, 02 Feb 2001 03:03:00 GMT</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">Page on Tuesday Feb 2, 2001 at 03:03 am.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">5c. chisels.</span></p></td><td><img src="book_files/book-499.jpg" alt="" style="width:45pt;height:64pt;"></td><td>
<p style="text-align:center;"><span class="font0">Hello, welcome to Joe’s Hardware store. Today’s special is on chisels.</span></p></td></tr>
<tr><td colspan="3">
<p><span class="font1" style="font-style:italic;">Delta generator</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Delta</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Delta response message</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 226 IM Used IM: diffe</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Client receives the delta and applies </span><span class="font3">Etag: zywxtuv123456BG</span></p>
<p><span class="font0">it to its cached version of the </span><span class="font3">Delta-base: abcdefghi09876AF</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">page, generating the latest version </span><span class="font3">... </span><span class="font0">of the page. The client also updates its ETag to that of the new version of the page.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-500.jpg" alt="" style="width:33pt;height:29pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Delta applier</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font0">Hello, welcome to Joe’s Hardware store. Today’s special is on chisels.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2549"></a><span class="font23" style="font-style:italic;">Figure 15-10. Mechanics of delta-encoding</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">The client uses the unique identifier for its version of the page (sent by the server in its previous response to the client in the ETag header) in an If-None-Match header. This is the client’s way of telling the server, “if the latest version of the page you have <a name="bookmark2550"></a>does not have this same ETag, send me the latest version of the page.” Just the If-None-Match header, then, would cause the server to send the client the full latest version of the page (if it was different from the client’s version).</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2551"></a><span class="font24">The client can tell the server, however, that it is willing to accept a delta of the page by also sending an A-IM header. A-IM is short for Accept-Instance-Manipulation (“Oh, by the way, I do accept some forms of instance manipulation, so if you apply one of those you will not have to send me the full document.”). In the A-IM header, the client specifies the algorithms it knows how to apply in order to generate the latest version of a page given an old version and a delta. The server sends back the following: a special response code (226 IM Used) telling the client that it is sending it an instance manipulation of the requested object, not the full object itself; an IM (short for Instance-Manipulation) header, which specifies the algorithm used to compute the delta; the new ETag header; and a Delta-Base header, which specifies the ETag of the document used as the base for computing the delta (ideally, the same as the ETag in the client’s If-None-Match request!). The headers used in delta encoding are summarized in</span><a href="#bookmark2552"><span class="font24"> Table 15-5</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2552"></a><span class="font23" style="font-style:italic;">Table 15-5. Delta-encoding headers</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header Description</span></p>
<p style="text-indent:7pt;"><span class="font2">ETag &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unique identifier for each instance of a document. Sent by the server in the response; used by clients in sub</span></p>
<p style="padding:0pt 0pt 4pt 61pt;"><span class="font2">sequent requests in If-Match and If-None-Match headers.</span></p>
<p style="text-align:justify;text-indent:7pt;"><a name="bookmark2553"></a><span class="font2">If-None-Match &nbsp;&nbsp;&nbsp;Request header sent by the client, asking the server for a document if and only if the client’s version of the</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 61pt;"><span class="font2">document is different from the server’s.</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">A-IM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Client request header indicating types of instance ma<a name="bookmark2554"></a>nipulations accepted.</span></p>
<p style="text-indent:7pt;"><span class="font2">IM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server response header specifying the type of instance manipulation applied to the response. This header is</span></p>
<p style="padding:0pt 0pt 4pt 61pt;"><span class="font2">sent when the response code is 226 IM Used.</span></p>
<p style="text-indent:7pt;"><span class="font2">Delta-Base &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server response header that specifies the ETag of the base document used for generating the delta (should</span></p>
<p style="padding:0pt 0pt 17pt 61pt;"><span class="font2">be the same as the ETag in the client request’s If-None-Match header).</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2555"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2556"></a>Instance Manipulations, Delta Generators, and Delta Appliers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Clients can specify the types of instance manipulation they accept using the A-IM header. Servers specify the type of instance manipulation used in the IM header. Just what are the types of instance manipulation that are accepted, and what do they do? </span><a href="#bookmark2557"><span class="font24">Table 15-6</span></a><span class="font24"> lists some of the IANA registered types of instance manipulations.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2557"></a><span class="font23" style="font-style:italic;">Table 15-6. IANA registered types of instance manipulations</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">vcdiff &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delta using the vcdiff algorithm<sup>a</sup></span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">diffe &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delta using the Unix </span><span class="font3" style="font-style:italic;">diff -e</span><span class="font2"> command</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">gdiff &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delta using the gdiff algorithm<sup>b</sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark2558"></a><span class="font23" style="font-style:italic;">Table 15-6. IANA registered types of instance manipulations (continued)</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">gzip &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression using the gzip algorithm</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">deflate &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression using the deflate algorithm</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">range &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used in a server response to indicate that the response is partial content as the result of a range selection</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">identity &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used in a client request’s A-IM header to indicate that the client is willing to accept an identity instance</span></p>
<p style="padding:0pt 0pt 4pt 61pt;"><span class="font2">manipulation</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font3"><sup>a</sup> Internet draft </span><span class="font3" style="font-style:italic;">draft-korn-vcdiff-01</span><span class="font3"> describes the vcdiff algorithm. This specification was approved by the IESG in early 2002 and should be released in RFC form shortly.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font3"><sup>b</sup> </span><a href="http://www.w3org/TR/NOTE-gdiff-19970901.html"><span class="font3" style="font-style:italic;">http://www.w3org/TR/NOTE-gdiff-19970901.html</span></a><span class="font3"> describes the GDIFF algorithm.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2559"></a><span class="font24">A “delta generator” at the server, as in </span><a href="#bookmark2549"><span class="font24">Figure 15-10</span></a><span class="font24">, takes the base document and the latest instance of the document and computes the delta between the two using the algorithm specified by the client in the A-IM header. At the client side, a “delta applier” takes the delta and applies it to the base document to generate the latest instance of the document. For example, if the algorithm used to generate the delta is the Unix </span><span class="font24" style="font-style:italic;">diff -e</span><span class="font24"> command, the client can apply the delta using the functionality of the Unix </span><span class="font24" style="font-style:italic;">ed</span><span class="font24"> text editor, because </span><span class="font24" style="font-style:italic;">diff -e &lt;file1&gt; &lt;file2&gt;</span><span class="font24"> generates the set of </span><span class="font24" style="font-style:italic;">ed</span><span class="font24"> commands that will convert </span><span class="font24" style="font-style:italic;">&lt;file1&gt;</span><span class="font24"> into </span><span class="font24" style="font-style:italic;">&lt;file2&gt;</span><span class="font24">. </span><span class="font24" style="font-style:italic;">ed</span><span class="font24"> is a very simple editor with a few supported commands. In the example in </span><a href="#bookmark2549"><span class="font24">Figure 15-10</span></a><span class="font24">, </span><span class="font24" style="font-style:italic;">5c</span><span class="font24"> says delete line 5 in the base document, and </span><span class="font24" style="font-style:italic;">chisels.&lt;cr&gt;.</span><span class="font24"> says add “chisels.”. That’s it. More complicated instructions can be generated for bigger changes. The Unix </span><span class="font24" style="font-style:italic;">diff -e</span><span class="font24"> algorithm does a line-by-line comparison of files. This obviously is okay for text files but breaks down for binary files. The vcdiff algorithm is more powerful, working even for non-text files and generally producing smaller deltas than </span><span class="font24" style="font-style:italic;">diff -e</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The delta encoding specification defines the format of the A-IM and IM headers in detail. Suffice it to say that multiple instance manipulations can be specified in these headers (along with corresponding quality values). Documents can go through multiple instance manipulations before being returned to clients, in order to maximize compression. For example, deltas generated by the vcdiff algorithm may in turn be compressed using the gzip algorithm. The server response would then contain the header IM: vcdiff, gzip. The client would first gunzip the content, then apply the results of the delta to its base page in order to generate the final document.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Delta encoding can reduce transfer times, but it can be tricky to implement. Imagine a page that changes frequently and is accessed by many different people. A server supporting delta encoding must keep all the different copies of that page as it changes over time, in order to figure out what’s changed between any requesting client’s copy and the latest copy. (If the document changes frequently, as different clients request the document, they will get different instances of the document. When they make subsequent requests to the server, they will be requesting changes between their instance of the document and the latest instance of the document. To be able to send them just the changes, the server must keep copies of all the previous <a name="bookmark2560"></a>instances that the clients have.) In exchange for reduced latency in serving documents, servers need to increase disk space to keep old instances of documents around. The extra disk space necessary to do so may quickly negate the benefits from the smaller transfer amounts.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2561"></a><span class="font9" style="font-weight:bold;"><a name="bookmark152"></a><a name="bookmark2562"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information on entities and encodings, see:</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The HTTP/1.1 specification, RFC 2616, is the primary reference for entity body management and encodings.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc3229.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc3229.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 3229, “Delta Encoding in HTTP,” describes how delta encoding can be supported as an extension to HTTP/1.1.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Introduction to Data Compression</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">Khalid Sayood, Morgan Kaufmann Publishers. This book explains some of the compression algorithms supported by HTTP content encodings.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc1521.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1521.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 1521, “Multipurpose Internet Mail Extensions, Part One: Mechanisms for Specifying and Describing the Format of Internet Message Bodies,” describes the format of MIME bodies. This reference material is useful because HTTP borrows heavily from MIME. In particular, this document is designed to provide facilities to include multiple objects in a single message, to represent body text in character sets other than US-ASCII, to represent formatted multi-font text messages, and to represent nontextual material such as images and audio fragments.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2045.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2045.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 2045, “Multipurpose Internet Mail Extensions, Part One: Format of Internet Message Bodies,” specifies the various headers used to describe the structure of MIME messages, many of which are similar or identical to HTTP.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc1864.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc1864.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 1864, “The Content-MD5 Header Field,” provides some historical detail about the behavior and intended use of the Content-MD5 header field in MIME content as a message integrity check.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc3230.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc3230.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 3230, “Instance Digests in HTTP,” describes improvements to HTTP entitydigest handling that fix weaknesses present in the Content-MD5 formulation.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2563"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2564"></a><a name="bookmark240"></a>CHAPTER 16</span></p></li></ul>
<h1 style="text-align:justify;padding:0pt 0pt 115pt 0pt;"><a name="bookmark2565"></a><span class="font11" style="font-weight:bold;"><a name="bookmark153"></a><a name="bookmark2566"></a>Internationalization</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2567"></a><span class="font24">Every day, billions of people write documents in hundreds of languages. To live up to the vision of a truly world-wide Web, HTTP needs to support the transport and processing of international documents, in many languages and alphabets.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This chapter covers two primary internationalization issues for the Web: </span><span class="font24" style="font-style:italic;">character set encodings</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">language tags</span><span class="font24">. HTTP applications use character set encodings to request and display text in different alphabets, and they use language tags to describe and restrict content to languages the user understands. We finish with a brief chat about multilingual URIs and dates.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This chapter:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Explains how HTTP interacts with schemes and standards for multilingual alphabets</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2568"></a><span class="font24">• Gives a rapid overview of the terminology, technology, and standards to help HTTP programmers do things right (readers familiar with character encodings can skip this section)</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Explains the standard naming system for languages, and how standardized language tags describe and select content</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Outlines rules and cautions for international URIs</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• Briefly discusses rules for dates and other internationalization issues</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2569"></a><span class="font9" style="font-weight:bold;"><a name="bookmark154"></a><a name="bookmark2570"></a>HTTP Support for International Content</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">HTTP messages can carry content in any language, just as it can carry images, movies, or any other kind of media. To HTTP, the entity body is just a box of bits.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To support international content, servers need to tell clients about the alphabet and languages of each document, so the client can properly unpack the document bits into characters and properly process and present the content to the user.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2571"></a><span class="font24"><a name="bookmark2572"></a><a name="bookmark2573"></a>Servers tell clients about a document’s alphabet and language with the HTTP Content-Type charset parameter and Content-Language headers. These headers describe what’s in the entity body’s “box of bits,” how to convert the contents into the proper characters that can be displayed onscreen, and what spoken language the words represent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">At the same time, the clie<a name="bookmark2574"></a>nt needs to tell the server which languages the user understands and which alphabetic coding algorithms the browser has installed. The client sends Accept-Charset and Accept-Language headers to tell the server which character set encoding algorithms and languages the client understands, and which of them are preferred.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2575"></a><span class="font24">The following HTTP Accept headers might be sent by a French speaker who prefers his native language (but speaks some English in a pinch) and who uses a browser that supports the iso-8859-1 West European charset encoding and the UTF-8 Unicode charset encoding:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept-Language: fr, en;q=0.8</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Accept-Charset: iso-8859-1, utf-8</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The parameter “q=0.8” is a </span><span class="font24" style="font-style:italic;">quality factor</span><span class="font24">, giving lower priority to English (0.8) than to French (1.0 by default).</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2576"></a><span class="font9" style="font-weight:bold;"><a name="bookmark155"></a><a name="bookmark2577"></a>Character Sets and HTTP</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2578"></a><span class="font24"><a name="bookmark2579"></a>So, let’s jump right into the most important (and confusing) aspects of web internationalization—international alphabetic scripts and their character set encodings.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Web character set standards can be pretty confusing. Lots of people get frustrated when they first try to write international web software, because of complex and inconsistent terminology, standards documents that you have to pay to read, and unfamiliarity with foreign languages. This section and the next section should make it easier for you to use character sets with HTTP.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2580"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2581"></a>Charset Is a Character-to-Bits Encoding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP charset values tell you how to convert from entity content bits into characters in a particular alphabet. Each charset tag names an algorithm to translate bits to characters (and vice versa). The charset tags are standardized in the MIME character set registry, maintained by the IANA (see </span><a href="http://www.iana.org/assignments/"><span class="font24" style="font-style:italic;">http://www.iana.org/assignments/</span></a><span class="font24" style="font-style:italic;"> character-sets</span><span class="font24">).</span><a href="#bookmark253"><span class="font24"> Appendix H</span></a><span class="font24"> summarizes many of them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The following Content-Type header tells the receiver that the content is an HTML file, and the charset parameter tells the receiver to use the iso-8859-6 Arabic character set decoding scheme to decode the content bits into characters:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Type: text/html; charset=iso-8859-6</span></p>
<p style="text-align:justify;padding:0pt 0pt 21pt 0pt;"><a name="bookmark2582"></a><span class="font24">The iso-8859-6 encoding scheme maps 8-bit values into both the Latin and Arabic alphabets, including numerals, punctuation and other symbols.<a name="footnote141"></a><sup><a href="#bookmark2583">141</a></sup><sup></sup> For example, in </span><a href="#bookmark2584"><span class="font24">Figure 16-1</span></a><span class="font24">, the highlighted bit pattern has code value 225, which (under iso-8859-6) maps into the Arabic letter “FEH” (a sound like the English letter “F”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 65pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">iso-8859-6 decoding of code 11100001 (decimal 225)</span></p>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-501.jpg" alt="" style="width:24pt;height:20pt;"></td></tr>
<tr><td>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">Arabic letter Feh</span></p>
<p><span class="font0">Character</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;padding:0pt 0pt 0pt 65pt;"><span class="font2">Content-type: text/html; charset=iso-8859-6</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 65pt;"><span class="font2">Content-length: 18572</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 65pt;"><span class="font2">Content-language: ar</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 89pt;"><a name="bookmark2585"></a><span class="font2">00100101110100100101001001111101 01010010100111101001111110000110 01010101011100000101010001010011 01011111001000010101111101010...</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font1" style="font-style:italic;">Entity body</span></p>
<p style="padding:0pt 0pt 10pt 113pt;"><span class="font0">Code bits in HTTP response</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2584"></a><span class="font23" style="font-style:italic;">Figure 16-1. The charset parameter tells the client how to go from bits to characters</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some character encodings (e.g., UTF-8 and iso-2022-jp) are more complicated, </span><span class="font24" style="font-style:italic;">variable-length</span><span class="font24"> codes, where the number of bits per character varies. This type of coding lets you use extra bits to support alphabets with large numbers of characters (such as Chinese and Japanese), while using fewer bits to support standard Latin characters.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2586"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2587"></a>How Character Sets and Encodings Work</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Let’s see what character sets and encodings really do.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">We want to convert from bits in a document into characters that we can display onscreen. But because there are many different alphabets, and many different ways of encoding characters into bits (each with advantages and disadvantages), we need a standard way to describe and apply the bits-to-character decoding algorithm.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Bits-to-character conversions happen in two steps, as shown in </span><a href="#bookmark2588"><span class="font24">Figure 16-2</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In</span><a href="#bookmark2588"><span class="font24"> Figure 16-2</span></a><span class="font24">a, bits from a document are converted into a character code that identifies a particular numbered character in a particular coded character set. In the example, the decoded character code is numbered 225.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• In</span><a href="#bookmark2588"><span class="font24"> Figure 16-2</span></a><span class="font24">b, the character code is used to select a particular element of the coded character set. In iso-8859-6, the value 225 corresponds to “ARABIC LETTER FEH.” The algorithms used in Steps a and b are determined from the MIME charset tag.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A key goal of internationalized character systems is the isolation of the semantics (letters) from the presentation (graphical presentation forms). HTTP concerns itself</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">(iso-8859-6 coded character set)</span></p></td></tr>
<tr><td>
<p style="text-align:center;padding:0pt 0pt 7pt 0pt;"><span class="font2" style="font-weight:bold;font-style:italic;">Data bits</span></p>
<p style="text-align:center;"><span class="font2">...11100001</span></p></td><td><img src="book_files/book-502.jpg" alt="" style="width:246pt;height:147pt;"></td></tr>
<tr><td colspan="2">
<p style="text-align:justify;text-indent:15pt;"><span class="font1" style="font-style:italic;">encoding scheme &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coded character set</span></p>
<p><span class="font1" style="font-style:italic;">(using iso-8859-6’s encoding)</span></p>
<p><span class="font1" style="font-style:italic;">Fonts and presentation logic</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Decode using encoding scheme </span><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">Find character using coded </span><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Find display shape using fonts and character set &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatting software</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Glyph</span></p></td></tr>
<tr><td><img src="book_files/book-503.jpg" alt="" style="width:24pt;height:19pt;"></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font0">MIME charset tag describes the combination of character encoding scheme and coded character set mapping</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2588"></a><span class="font23" style="font-style:italic;">Figure 16-2. HTTP “charset” combines a character encoding scheme and a coded character set</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">only with transporting the character data and the associated language and charset labels. The presentation of the character shapes is handled by the user’s graphics display software (browser, operating system, fonts), as shown in</span><a href="#bookmark2588"><span class="font24"> Figure 16-2</span></a><span class="font24">c.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2589"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2590"></a>The Wrong Charset Gives the Wrong Characters</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the client uses the wrong charset parameter, the client will display strange, bogus characters. Let’s say a browser got the value 225 (binary 11100001) from the body:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 41pt 19pt;"><span class="font24">• If the browser thinks the body is encoded with iso-8859-1 Western European character codes, it will show a lowercase Latin “a” with acute accent:</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;"><span class="font24">• If the browser is using iso-8859-6 Arabic codes, it will show “FEH”:</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-504.png" alt="" style="width:27pt;height:21pt;">
</div><br clear="all"></li></ul>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;"><span class="font24">• If the browser is using iso-8859-7 Greek, it will show a small “Alpha”:</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 51pt 0pt;"><a name="bookmark2591"></a><span class="font24"><a name="bookmark2592"></a>If the browser is using iso-8859-8 Hebrew codes, it will show “BET”:</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2593"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2594"></a>Standardized MIME Charset Values</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The combination of a particular character encoding and a particular coded character set is called a </span><span class="font24" style="font-style:italic;">MIME charset</span><span class="font24">. HTTP uses standardized MIME charset tags in the Content-Type and Accept-Charset headers. MIME charset values are registered with the IANA.<a name="footnote142"></a><sup><a href="#bookmark2595">142</a></sup><sup></sup> </span><a href="#bookmark2596"><span class="font24">Table 16-1 </span></a><span class="font24">lists a few MIME charset encoding schemes used by documents and browsers. A more complete list is provided in </span><a href="#bookmark253"><span class="font24">Appendix H</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2596"></a><span class="font23" style="font-style:italic;">Table 16-1. MIME charset encoding tags</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">MIME charset value</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">us-ascii</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The famous character encoding standardized in 1968 as ANSI_X3.4-1968. It is also named ASCII, but the “US” prefix is preferred because of several international variants in ISO 646 that modify selected characters. US-ASCII maps 7-bit values into 128 characters. The high bit is unused.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-8859-1</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">iso-8859-1 is an 8-bit extension to ASCII to support Western European languages. It uses the high bit to include many West European characters, while leaving the ASCII codes (0–127) intact. Also called iso-latin-1, or nicknamed “Latin1.”</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-8859-2</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Extends ASCII to include characters for Central and Eastern European languages, including Czech, Polish, and Romanian. Also called iso-latin-2.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">iso-8859-5</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Extends ASCII to include Cyrillic characters, for languages including Russian, Serbian, and Bulgarian.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-8859-6</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Extends ASCII to include Arabic characters. Because the shapes of Arabic characters change depending on their position in a word, Arabic requires a display engine that analyzes the context and generates the correct shape for each character.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">iso-8859-7</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Extends ASCII to include modern Greek characters. Formerly known as ELOT-928 or ECMA-118:1986.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">iso-8859-8</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Extends ASCII to include Hebrew and Yiddish characters.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-8859-15</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Updates iso-8859-1, replacing some less-needed punctuation and fraction symbols with forgotten French and Finnish letters and replacing the international currency sign with the symbol for the new Euro currency. This character set is nicknamed “Latin0” and may one day replace iso-8859-1 as the preferred default character set in Europe.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-2022-jp</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">iso-2022-jp is a widely used encoding for Japanese email and web content. It is a variable-length encoding scheme that supports ASCII characters with single bytes but uses three-character modal escape sequences to shift into three different Japanese character sets.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">euc-jp</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">euc-jp is an ISO 2022–compliant variable-length encoding that uses explicit bit patterns to identify each character, without requiring modes and escape sequences. It uses 1-byte, 2-byte, and 3-byte sequences of characters to identify characters in multiple Japanese character sets.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Shift_JIS</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">This encoding was originally developed by Microsoft and sometimes is called SJIS or MS Kanji. It is a bit complicated, for reasons of historic compatibility, and it cannot map all characters, but it still is common.</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 16-1. MIME charset encoding tags (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME charset value</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">koi8-r</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark2597"></a><span class="font2">KOI8-R is a popular 8-bit Internet character set encoding for Russian, defined in IETF RFC 1489. The initials are transliterations of the acronym for “Code for Information Exchange, 8 bit, Russian.”</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">utf-8</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">UTF-8 is a common variable-length character encoding scheme for representing UCS (Unicode), which is the Universal Character Set of the world’s characters. UTF-8 uses a variable-length encoding for character code values, representing each character by from one to six bytes. One of the primary features of UTF-8 is backward compatibility with ordinary 7-bit ASCII text.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1252</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Microsoft calls its coded character sets “code pages.” Windows code page 1252 (a.k.a. “CP1252” or “WinLatin1”) is an extension of iso-8859-1.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2598"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2599"></a>Content-Type Charset Header and META Tags</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web servers send the client the MIME charset tag in the Content-Type header, using the charset parameter:</span></p>
<p style="text-align:justify;text-indent:17pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Type: text/html; charset=iso-2022-jp</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If no charset is explicitly listed, the receiver may try to infer the character set from the document contents. For HTML content, character sets might be found in &lt;META HTTP-EQUIV=&quot;Content-Type&quot;&gt; tags that describe the charset.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark2600"><span class="font24">Example 16-1 </span></a><span class="font24">shows how HTML META tags set the charset to the Japanese encoding iso-2022-jp. If the document is not HTML, or there is no META Content-Type tag, software may attempt to infer the character encoding by scanning the actual text for common patterns indicative of languages and encodings.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2600"></a><span class="font23" style="font-style:italic;">Example 16-1. Character encoding can be specified in HTML META tags</span></p>
<p style="text-align:justify;"><span class="font3">&lt;HEAD&gt;</span></p>
<p style="text-align:justify;text-indent:17pt;"><span class="font3">&lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=</span><span class="font3" style="font-weight:bold;">iso-2022-jp</span><span class="font3">&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:17pt;"><a name="bookmark2601"></a><span class="font3">&lt;META LANG=&quot;jp&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:17pt;"><a name="bookmark2602"></a><span class="font3">&lt;TITLE&gt;A Japanese Document&lt;/TITLE&gt;</span></p>
<p><span class="font3">&lt;/HEAD&gt;</span></p>
<p style="padding:0pt 0pt 20pt 0pt;"><span class="font3">&lt;BODY&gt;</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">If a client cannot infer a character encoding, it assumes iso-8859-1.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2603"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2604"></a>The Accept-Charset Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are thousands of defined character encoding and decoding methods, developed over the past several decades. Most clients do not support all the various character coding and mapping systems.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">HTTP clients can tell servers precisely which character systems they support, using the Accept-Charset request header. The Accept-Charset header value provides a list of character encoding schemes that the client supports. For example, the following HTTP request header indicates that a client accepts the Western European iso-8859-1 <a name="bookmark2605"></a>character system as well as the UTF-8 variable-length Unicode compatibility system. A server is free to return content in either of these character encoding schemes.</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Accept-Charset: iso-8859-1, utf-8</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Note that there is no Content-Charset response header to match the Accept-Charset request header. The response character set is carried back from the server by the charset parameter of the Content-Type response header, to be compatible with MIME. It’s too bad this isn’t symmetric, but all the information still is there.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2606"></a><span class="font9" style="font-weight:bold;"><a name="bookmark156"></a><a name="bookmark2607"></a>Multilingual Character Encoding Primer</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The previous section described how the HTTP Accept-Charset header and the Content-Type charset parameter carry character-encoding information from the client and server. HTTP programmers who do a lot of work with international applications and content need to have a deeper understanding of multilingual character systems to understand technical specifications and properly implement software.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">It isn’t easy to learn multilingual character systems—the terminology is complex and inconsistent, you often have to pay to read the standards documents, and you may be unfamiliar with the other languages with which you’re working. This section is an overview of character systems and standards. If you are already comfortable with character encodings, or are not interested in this detail, feel free to jump ahead to </span><a href="#bookmark2608"><span class="font24">“Language Tags and HTTP</span></a><span class="font24">.”</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2609"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2610"></a>Character Set Terminology</span></h3>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">H<a name="bookmark2611"></a>ere are eight terms about electronic character systems that you should know:</span></p>
<p><span class="font24" style="font-style:italic;">Character</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2612"></a><span class="font24">An alphabetic letter, numeral, punctuation mark, ideogram (as in Chinese), symbol, or other textual “atom” of writing. The Universal Character Set (UCS) initiative, known informally as Unicode,<a name="footnote143"></a><sup><a href="#bookmark2613">143</a></sup><sup></sup> has developed a standardized set of textual names for many characters in many languages, which often are used to conveniently and uniquely name characters.<sup>†</sup></span></p>
<p><span class="font24" style="font-style:italic;">Glyph</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">A stroke pattern or unique graphical shape that describes a character. A character may have multiple glyphs if it can be written different ways (see</span><a href="#bookmark2614"><span class="font24"> Figure 16-3</span></a><span class="font24">).</span></p>
<p><span class="font24" style="font-style:italic;">Coded character</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">A unique number assigned to a character so that we can work with it.</span></p>
<p><span class="font24" style="font-style:italic;">Coding space</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">A range of integers that we plan to use as character code values.</span></p>
<p><a name="bookmark2615"></a><span class="font24" style="font-style:italic;"><a name="bookmark2616"></a>Code width</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">The number of bits in each (fixed-size) character code.</span></p>
<p><span class="font24" style="font-style:italic;">Character repertoire</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">A particular working set of characters (a subset of all the characters in the world).</span></p>
<p><span class="font24" style="font-style:italic;">Coded character set</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2617"></a><span class="font24"><a name="bookmark2618"></a>A set of coded characters that takes a character repertoire (a selection of characters from around the world) and assigns each character a code from a coding space. In other words, it maps numeric character codes to real characters.</span></p>
<p><span class="font24" style="font-style:italic;">Character encoding scheme</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">An algorithm to encode numeric character codes into a sequence of content bits (and to decode them back). Character encoding schemes can be used to reduce the amount of data required to identify characters (compression), work around transmission restrictions, and unify overlapping coded character sets.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2619"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2620"></a>Charset Is Poorly Named</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Technically, the MIME charset tag (used in the Content-Type charset parameter and the Accept-Charset header) doesn’t specify a character set at all. The MIME charset value names a total algorithm for mapping data bits to codes to unique characters. It combines the two separate concepts of </span><span class="font24" style="font-style:italic;">character encoding scheme</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">coded character set</span><span class="font24"> (see</span><a href="#bookmark2588"><span class="font24"> Figure 16-2)</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This terminology is sloppy and confusing, because there already are published standards for character encoding schemes and for coded character sets.<a name="footnote144"></a><sup><a href="#bookmark2621">144</a></sup><sup></sup> Here’s what the HTTP/1.1 authors say about their use of terminology (in RFC 2616):</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font23">The term “character set” is used in this document to refer to a method ... to convert a sequence of octets into a sequence of characters... Note: This use of the term “character set” is more commonly referred to as a “character encoding.” However, since HTTP and MIME share the same registry, it’s important that the terminology also be shared.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">The IETF also adopts nonstandard terminology in RFC 2277:</span></p>
<p style="padding:0pt 0pt 4pt 19pt;"><span class="font23">This document uses the term “charset” to mean a set of rules for mapping from a sequence of octets to a sequence of characters, such as the combination of a coded character set and a character encoding scheme; this is also what is used as an identifier in MIME “charset=” parameters, and registered in the IANA charset registry. (Note that this is NOT a term used by other standards bodies, such as ISO).</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">So, be careful when reading standards documents, so you know exactly what’s being defined. Now that we’ve got the terminology sorted out, let’s look a bit more closely at characters, glyphs, character sets, and character encodings.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2622"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2623"></a><a name="bookmark2624"></a>Characters</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Characters are the most basic building blocks of writing. A character represents an alphabetic letter, numeral, punctuation mark, ideogram (as in Chinese), mathematical symbol, or other basic unit of writing.</span></p>
<p style="text-align:justify;padding:0pt 0pt 46pt 0pt;"><span class="font24">Characters are independent of font and style.</span><a href="#bookmark2614"><span class="font24"> Figure 16-3 </span></a><span class="font24">shows several variants of the same character, called “LATIN SMALL LETTER A.” A native reader of Western European languages would immediately recognize all five of these shapes as the same character, even though the stroke patterns and styles are quite different.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2614"></a><span class="font23" style="font-style:italic;">Figure 16-3. One character can have many different written forms</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a name="bookmark2625"></a><span class="font24">Many writing systems also have different stroke shapes for a single character, depending on the position of the character in the word. For example, the four strokes in </span><a href="#bookmark2626"><span class="font24">Figure 16-4</span></a><span class="font24"> all represent the character “ARABIC LETTER AIN.”<a name="footnote145"></a><sup><a href="#bookmark2627">145</a></sup><sup> </sup></span><a href="#bookmark2626"><span class="font24">Figure 16-4</span></a><span class="font24">a shows how “AIN” is written as a standalone character.</span><a href="#bookmark2626"><span class="font24"> Figure 16-4</span></a><span class="font24">d shows “AIN” at the beginning of a word,</span><a href="#bookmark2626"><span class="font24"> Figure 16-4</span></a><span class="font24">c shows “AIN” in the middle of a word, and</span><a href="#bookmark2626"><span class="font24"> Figure 16-4</span></a><span class="font24">b shows “AIN” at the end of a word.<a name="footnote146"></a><sup><a href="#bookmark2628">146</a></sup><sup></sup></span></p>
<table>
<tr><td>
<p><a name="bookmark2629"></a><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Standalone </span><span class="font1" style="font-weight:bold;">(b)</span><span class="font0">Final position </span><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Medial position </span><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">Initial postion</span></p></td></tr>
<tr><td><img src="book_files/book-505.png" alt="" style="width:169pt;height:38pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">(These different glyphs represent the same character, “ARABIC LETTER AIN”)</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2626"></a><span class="font23" style="font-style:italic;"><a name="bookmark2630"></a>Figure 16-4. Four positional forms of the single character “ARABIC LETTER AIN”</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2631"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2632"></a>Glyphs, Ligatures, and Presentation Forms</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Don’t confuse characters with glyphs. Characters are the unique, abstract “atoms” of language. Glyphs are the particular ways you draw each character. Each character has many different glyphs, depending on the artistic style and script.<a name="footnote147"></a><sup><a href="#bookmark2633">147</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">Also, don’t confuse characters with presentation forms. To make writing look nicer, many handwritten scripts and typefaces let you join adjacent characters into pretty </span><span class="font24" style="font-style:italic;">ligatures</span><span class="font24">, in which the two characters smoothly connect. English-speaking <a name="bookmark2634"></a>typesetters often join “F” and “I” into an “FI ligature” (see </span><a href="#bookmark2635"><span class="font24">Figure 16-5</span></a><span class="font24">a–b), and Arabic writers often join the “LAM” and “ALIF” characters into an attractive ligature (</span><a href="#bookmark2635"><span class="font24">Figure 16-5</span></a><span class="font24">c–d).</span></p>
<p style="text-indent:42pt;padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-weight:bold;">(a) </span><span class="font0">Without FI ligature </span><span class="font1" style="font-weight:bold;">(b) </span><span class="font0">With FI ligature </span><span class="font1" style="font-weight:bold;">(c) </span><span class="font0">Without LA ligature </span><span class="font1" style="font-weight:bold;">(d) </span><span class="font0">With LA ligature</span></p>
<p style="padding:0pt 0pt 32pt 189pt;"><span class="font1" style="font-style:italic;">ALIF LAM &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAM and ALIF</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2635"></a><span class="font23" style="font-style:italic;">Figure 16-5. Ligatures are stylistic presentation forms of adjacent characters, not new characters</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Here’s the general rule: if the meaning of the text changes when you replace one glyph with another, the glyphs are different characters. Otherwise, they are the same characters, with a different stylistic presentation.<a name="footnote148"></a><sup><a href="#bookmark2636">148</a></sup><sup></sup></span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2637"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2638"></a>Coded Character Sets</span></h3>
<p style="text-align:justify;"><span class="font24">Coded character sets, defined in RFCs 2277 and 2130, map integers to characters. Coded character sets often are implemented as arrays,<a name="footnote149"></a><sup><a href="#bookmark2639">149</a></sup><sup></sup> indexed by code number (see </span><a href="#bookmark2640"><span class="font24">Figure 16-6</span></a><span class="font24">). The array elements are characters.<a name="footnote150"></a><sup><a href="#bookmark2641">150</a></sup><sup></sup></span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-506.jpg" alt="" style="width:278pt;height:69pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2642"></a><span class="font5">68</span></p>
<p><span class="font1" style="font-style:italic;">Code 68 (0x44)</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2640"></a><span class="font23" style="font-style:italic;">Figure 16-6. Coded character sets can be thought of as arrays that map numeric codes to characters</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Let’s look at a few important coded character set standards, including the historic US-ASCII character set, the iso-8859 extensions to ASCII, the Japanese JIS X 0201 character set, and the Universal Character Set (Unicode).</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2643"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2644"></a>US-ASCII: The mother of all character sets</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">ASCII is the most famous coded character set, standardized back in 1968 as ANSI standard X3.4 “American Standard Code for Information Interchange.” ASCII uses only the code values 0–127, so only 7 bits are required to cover the code space. The preferred name for ASCII is “US-ASCII,” to distinguish it from international variants of the 7-bit character set.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">HTTP messages (headers, URIs, etc.) use US-ASCII.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2645"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2646"></a>iso-8859</span></h4>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2647"></a><span class="font24">The iso-8859 character set standards are 8-bit supersets of US-ASCII that use the high bit to add characters for international writing. The additional space provided by the extra bit (128 extra codes) isn’t large enough to hold even all of the European characters (not to mention Asian characters), so iso-8859 provides customized character sets for different regions:</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2">iso-8859-1 iso-8859-2</span></p>
<p><span class="font2">iso-8859-3 iso-8859-4</span></p>
<p><span class="font2">iso-8859-5 iso-8859-6</span></p>
<p><span class="font2">iso-8859-7 iso-8859-8</span></p>
<p><a name="bookmark2648"></a><span class="font2">iso-8859-9 iso-8859-10 iso-8859-15</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Western European languages (e.g., English, French)</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Central and Eastern European languages (e.g., Czech, Polish)</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Southern European languages</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Northern European languages (e.g., Latvian, Lithuanian, Greenlandic)</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Cyrillic (e.g., Bulgarian, Russian, Serbian)</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Arabic</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Greek</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Hebrew</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Turkish</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Nordic languages (e.g., Icelandic, Inuit)</span></p>
<p style="text-align:justify;text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">Modification to iso-8859-1 that includes the new Euro currency character</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">iso-8859-1, also known as Latin1, is the default character set for HTML. It can be used to represent text in most Western European languages. There has been some discussion of replacing iso-8859-1 with iso-8859-15 as the default HTTP coded character set, because it includes the new Euro currency symbol. However, because of the widespread adoption of iso-8859-1, it’s unlikely that a widespread change to iso-8859-15 will be adopted for quite some time.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2649"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2650"></a>JIS X 0201</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">JIS X 0201 is an extremely minimal character set that extends ASCII with Japanese half width katakana characters. The half-width katakana characters were originally used in the Japanese telegraph system. JIS X 0201 is often called “JIS Roman.” JIS is an acronym for “Japanese Industrial Standard.”</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2651"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2652"></a>JIS X 0208 and JIS X 0212</span></h4>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Japanese includes thousands of characters from several writing systems. While it is possible to limp by (painfully) using the 63 basic phonetic katakana characters in JIS X 0201, a much more complete character set is required for practical use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2653"></a><span class="font24"><a name="bookmark2654"></a>The JIS X 0208 character set was the first multi-byte Japanese character set; it defined 6,879 coded characters, most of which are Chinese-based kanji. The JIS X 0212 character set adds an additional 6,067 characters.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2655"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2656"></a>UCS</span></h4>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2657"></a><span class="font24"><a name="bookmark2658"></a>The Universal Character Set (UCS) is a worldwide standards effort to combine all of the world’s characters into a single coded character set. UCS is defined by ISO 10646. Unicode is a commercial consortium that tracks the UCS standards. UCS has coding space for millions of characters, although the basic set consists of only about 50,000 characters.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2659"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2660"></a>Character Encoding Schemes</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Character encoding schemes pack character code numbers into content bits and un<a name="bookmark2661"></a>pack them back into character codes at the other end (</span><a href="#bookmark2662"><span class="font24">Figure 16-7</span></a><span class="font24">). There are three broad classes of character encoding schemes:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Fixed width</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Fixed-width encodings represent each coded character with a fixed number of bits. They are fast to process but can waste space.</span></p>
<p><span class="font24" style="font-style:italic;">Variable width (nonmodal)</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Variable-width encodings use different numbers of bits for different character code numbers. They can reduce the number of bits required for common characters, and they retain compatibility with legacy 8-bit character sets while allowing the use of multiple bytes for international characters.</span></p>
<p><span class="font24" style="font-style:italic;">Variable width (modal)</span></p>
<p style="text-align:justify;padding:0pt 0pt 24pt 19pt;"><span class="font24">Modal encodings use special “escape” patterns to shift between different modes. For example, a modal encoding can be used to switch between multiple, overlapping character sets in the middle of text. Modal encodings are complicated to process, but they can efficiently support complicated writing systems.</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-507.jpg" alt="" style="width:50pt;height:24pt;">
</div>
<div style="float:right;writing-mode:horizontal-tb;"><img src="book_files/book-508.jpg" alt="" style="width:50pt;height:24pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-509.jpg" alt="" style="width:46pt;height:50pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Character encoder</span></p></td></tr>
</table>
</div>
<p><span class="font2">HTTP/1.1 200 OK</span></p>
<p><span class="font2">Content-type: text/html; charset=iso-2022-jp</span></p>
<p><span class="font2">Content-length: 4198</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2">00100101110100100101001001111101 01010010100111101001010011010010 01010101011100000101010001010011 01011111001000010101111101010...</span></p></td><td><img src="book_files/book-510.jpg" alt="" style="width:81pt;height:53pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-style:italic;">Character decoder</span></p></td></tr>
</table>
</div>
<p style="padding:0pt 0pt 42pt 0pt;"><span class="font2">Content-lanuage: jp</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font1" style="font-style:italic;">Entity body</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2662"></a><span class="font23" style="font-style:italic;">Figure 16-7. Character encoding scheme encodes character codes into bits and back again</span></p>
<p style="padding:0pt 0pt 7pt 0pt;"><span class="font24">Let’s look at a few common encoding schemes.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2663"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2664"></a><a name="bookmark2665"></a>8-bit</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">The 8-bit fixed-width identity encoding simply encodes each character code with its corresponding 8-bit value. It supports only character sets with a code range of 256 characters. The iso-8859 family of character sets uses the 8-bit identity encoding.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2666"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2667"></a>UTF-8</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">UTF-8 is a popular character encoding scheme designed for UCS (UTF stands for “UCS Transformation Format”). UTF-8 uses a nonmodal, variable-length encoding for the character code values, where the leading bits of the first byte tell the length of the encoded character in bytes, and any subsequent byte contains six bits of code value (see </span><a href="#bookmark2668"><span class="font24">Table 16-2</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">If the first encoded byte has a high bit of 0, the length is just 1 byte, and the remaining 7 bits contain the character code. This has the nice result of ASCII compatibility (but not iso-8859 compatibility, because iso-8859 uses the high bit).</span></p>
<table>
<tr><td>
<p><a name="bookmark2668"></a><span class="font23" style="font-style:italic;">Table 16-2. UTF-8 variable-width, nonmodal encoding</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Character code bits</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2" style="font-weight:bold;">Byte 1</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Byte 2</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Byte 3</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Byte 4</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Byte 5</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Byte 6</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">0–7</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font2">0ccccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><a name="bookmark2669"></a><span class="font2">8–11</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font2">110ccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">12–16</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font2">1110cccc</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">17–21</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font2">11110ccc</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">22–26</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">111110cc</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">27–31</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">1111110c</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">10cccccc</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">For example, character code 90 (ASCII “Z”) would be encoded as 1 byte (01011010), while code 5073 (13-bit binary value 1001111010001) would be encoded into 3 bytes: </span><span class="font3">1110000</span><span class="font3" style="font-weight:bold;">1 </span><span class="font3">10</span><span class="font3" style="font-weight:bold;">001111 </span><span class="font3">10</span><span class="font3" style="font-weight:bold;">010001</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2670"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2671"></a>iso-2022-jp</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">iso-2022-jp is a widely used encoding for Japanese Internet documents. iso-2022-jp is a variable-length, modal encoding, with all values less than 128 to prevent problems with non–8-bit-clean software.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">The encoding context always is set to one of four predefined character sets.<a name="footnote151"></a><sup><a href="#bookmark2672">151</a></sup><sup></sup> Special “escape sequences” shift from one set to another. iso-2022-jp initially uses the US-ASCII character set, but it can switch to the JIS X 0201 (JIS-Roman) character set or the much larger JIS X 0208-1978 and JIS X 0208-1983 character sets using 3-byte escape sequences.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">The escape sequences are shown in</span><a href="#bookmark2673"><span class="font24"> Table 16-3</span></a><span class="font24">. In practice, Japanese text begins with “ESC $ @” or “ESC $ B” and ends with “ESC ( B” or “ESC ( J”.</span></p>
<table>
<tr><td>
<p><a name="bookmark2673"></a><span class="font23" style="font-style:italic;">Table 16-3. iso-2022-jp character set switching escape sequences</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark2674"></a><span class="font2" style="font-weight:bold;">Escape sequence</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:31pt;"><span class="font2" style="font-weight:bold;">Resulting coded character set</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2" style="font-weight:bold;">Bytes per code</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ESC ( B</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:31pt;"><span class="font2">US-ASCII</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2">1</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ESC ( J</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:31pt;"><span class="font2">JIS X 0201-1976 (JIS Roman)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2">1</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ESC $ @</span></p></td><td style="vertical-align:top;">
<p style="text-indent:31pt;"><span class="font2">JIS X 0208-1978</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2">2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ESC $ B</span></p></td><td style="vertical-align:top;">
<p style="text-indent:31pt;"><span class="font2">JIS X 0208-1983</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2">2</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">When in the US-ASCII or JIS-Roman modes, a single byte is used per character. When using the larger JIS X 0208 character set, two bytes are used per character code. The encoding restricts the bytes sent to be between 33 and 126.<a name="footnote152"></a><sup><a href="#bookmark2675">152</a></sup><sup></sup></span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2676"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2677"></a>euc-jp</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">euc-jp is another popular Japanese encoding. EUC stands for “Extended Unix Code,” first developed to support Asian characters on Unix operating systems.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Like iso-2022-jp, the euc-jp encoding is a variable-length encoding that allows the use of several standard Japanese character sets. But unlike iso-2022-jp, the euc-jp encoding is not modal. There are no escape sequences to shift between modes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">euc-jp supports four coded character sets: JIS X 0201 (JIS-Roman, ASCII with a few Japanese substitutions), JIS X 0208, half-width katakana (63 characters used in the original Japanese telegraph system), and JIS X 0212.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">One byte is used to encode JIS Roman (ASCII compatible), two bytes are used for JIS X 0208 and half-width katakana, and three bytes are used for JIS X 0212. The coding is a bit wasteful but is simple to process.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">The encoding patterns are outlined in</span><a href="#bookmark2678"><span class="font24"> Table 16-4</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2678"></a><span class="font23" style="font-style:italic;">Table 16-4. euc-jp encoding values</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Which byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2" style="font-weight:bold;">Encoding values</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">JIS X 0201 (94 coded characters) 1st byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font2">33–126</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">JIS X 0208 (6879 coded characters)</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">1st byte</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">2nd byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">161–254</span></p>
<p style="text-indent:24pt;"><span class="font2">161–254</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 16-4. euc-jp encoding values (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Which byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:13pt;"><span class="font2" style="font-weight:bold;">Encoding values</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Half-width katakana (63 coded characters)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark2679"></a><span class="font2">1st byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">142</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">2nd byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">161–223</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark2680"></a><span class="font2">JIS X 0212 (6067 coded characters)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">1st byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">143</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">2nd byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">161–254</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">3rd byte</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">161–254</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This wraps up our survey of character sets and encodings. The next section explains language tags and how HTTP uses language tags to target content to audiences. Please refer to</span><a href="#bookmark253"><span class="font24"> Appendix H</span></a><span class="font24"> for a detailed listing of standardized character sets.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2608"></a><span class="font9" style="font-weight:bold;"><a name="bookmark157"></a><a name="bookmark2681"></a>Language Tags and HTTP</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">La<a name="bookmark2682"></a>nguage tags are short, standardized strings that name spoken languages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We need standardized names, or some people will tag French documents as “French,” others will use “Français,” others still might use “France,” and lazy people might just use “Fra” or “F.” Standardized language tags avoid this confusion.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There are language tags for English (en), German (de), Korean (ko), and many other languages. Language tags can describe regional variants and dialects of languages, such as Brazilian Portuguese (pt-BR), U.S. English (en-US), and Hunan Chinese (zh-xiang). There is even a standard language tag for Klingon (i-klingon)!</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2683"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2684"></a>The Content-Language Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-Language entity header field describes the target audience languages for the entity. If the content is intended primarily for a French audience, the ContentLanguage header field would contain:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Language: fr</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Content-Language header isn’t limited to text documents. Audio clips, movies, and applications might all be intended for a particular language audience. Any media type that is targeted to particular language audiences can have a Content-Language header. In</span><a href="#bookmark2685"><span class="font24"> Figure 16-8</span></a><span class="font24">, the audio file is tagged for a Navajo audience.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the content is intended for multiple audiences, you can list multiple languages. As suggested in the HTTP specification, a rendition of the “Treaty of Waitangi,” presented simultaneously in the original Maori and English versions, would call for:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Language: mi, en</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 150pt;"><span class="font1" style="font-style:italic;">ht</span><span class="font1" style="font-style:italic;text-decoration:underline;">tp://</span><a href="http://www.canyonrecords.com/wav/534.wav"><span class="font1" style="font-style:italic;text-decoration:underline;">www.canyonrecords.com/wav/534.wav</span></a></p>
<p style="padding:0pt 0pt 0pt 160pt;"><span class="font2">HTTP/1.1 200 OK</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 160pt;"><span class="font2">Content-type: audio/x-wav</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 160pt;"><span class="font2">Content-length: 289772</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 160pt;"><span class="font2">Content-language: i-navajo</span></p>
<div style="float:right;writing-mode:horizontal-tb;"><img src="book_files/book-511.jpg" alt="" style="width:27pt;height:33pt;">
</div>
<p style="text-align:justify;padding:0pt 0pt 19pt 171pt;"><span class="font2">00100101110100100101 01010010100111101001 01010101011100000101 01011111001000011...</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark2685"></a><span class="font23" style="font-style:italic;"><a name="bookmark2686"></a>Figure 16-8. Content-Language header marks a “Rain Song” audio clip for Navajo speakers</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">However, just because multiple languages are present within an entity does not mean that it is intended for multiple linguistic audiences. A beginner’s language primer, such as “A First Lesson in Latin,” which clearly is intended to be used by an English-literate audience, would properly include only “en”.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2687"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2688"></a>The Accept-Language Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Most of us know at least one language. HTTP lets us pass our language restrictions and preferences along to web servers. If the web server has multiple versions of a resource, in different languages, it can give us content in our preferred language.<a name="footnote153"></a><sup><a href="#bookmark2689">153</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2690"></a><span class="font24">Here, a client requests Spanish content:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Accept-Language: es</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">You can place multiple language tags in the Accept-Language header to enumerate all supported languages and the order of preference (left to right). Here, the client prefers English but will accept Swiss German (de-CH) or other variants of German (de):</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Accept-Language: en, de-CH, de</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Clients use Accept-Language and Accept-Charset to request content they can understand. We’ll see how this works in more detail in </span><a href="#bookmark241"><span class="font24">Chapter 17</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2691"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2692"></a>Types of Language Tags</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Language tags have a standardized syntax, documented in RFC 3066, “Tags for the Identification of Languages.” Language tags can be used to represent:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• General language classes (as in “es” for Spanish)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Country-specific languages (as in “en-GB” for English in Great Britain)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Dialects of languages (as in “no-bok” for Norwegian “Book Language”)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><a name="bookmark2693"></a><span class="font24"><a name="bookmark2694"></a>• Regional languages (as in “sgn-US-MA” for Martha’s Vineyard sign language)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Standardized nonvariant languages (e.g., “i-navajo”)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• Nonstandard languages (e.g., “x-snowboarder-slang”<a name="footnote154"></a><sup><a href="#bookmark2695">154</a></sup><sup></sup>)</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2696"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2697"></a>Subtags</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Language tags have one or more parts, separated by hyphens, called </span><span class="font24" style="font-style:italic;">subtags</span><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• The first subtag called the </span><span class="font24" style="font-style:italic;">primary subtag</span><span class="font24">. The values are standardized.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• The second subtag is optional and follows its own naming standard.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Any trailing subtags are unregistered.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a name="bookmark2698"></a><span class="font24">The primary subtag contains only letters (A–Z). Subsequent subtags can contain letters or numbers, up to eight characters in length. An example is shown in </span><a href="#bookmark2699"><span class="font24">Figure 16-9</span></a><span class="font24">.</span></p>
<p><span class="font1" style="font-weight:bold;">Martha’s Vineyard sign language</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font22">sgn-US-MA</span></p>
<p><span class="font1" style="font-style:italic;">First subtag Second subtag Third subtag</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font1" style="font-style:italic;">(sign language) (America) (Massachusetts regional variant)</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2699"></a><span class="font23" style="font-style:italic;"><a name="bookmark2700"></a>Figure 16-9. Language tags are separated into subtags</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2701"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2702"></a>Capitalization</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">All tags are case-insensitive—the tags “en” and “eN” are equivalent. However, lowercasing conventionally is used to represent general languages, while uppercasing is used to signify particular countries. For example, “fr” means all languages classified as French, while “FR” signifies the country France.<a name="footnote155"></a><sup><a href="#bookmark2703">155</a></sup><sup></sup></span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2704"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2705"></a>IANA Language Tag Registrations</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The values of the first and second language subtags are defined by various standards documents and their maintaining organizations. The IANA<a name="footnote156"></a><sup><a href="#bookmark2706">156</a></sup><sup></sup> administers the list of standard language tags, using the rules outlined in RFC 3066.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If a language tag is composed of standard country and language values, the tag doesn’t have to be specially registered. Only those language tags that can’t be composed out of the standard country and language values need to be registered specially with the <a name="bookmark2707"></a>IANA.<sup>*</sup> The following sections outline the RFC 3066 standards for the first and second subtags.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2708"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2709"></a>First Subtag: Namespace</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The first subtag usually is a standardized </span><span class="font24" style="font-style:italic;">language</span><span class="font24"> token, chosen from the ISO 639 set of language standards. But it also can be the letter “i” to identify IANA-registered names, or “x” for private, extension names. Here are the rules:</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the first subtag has:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Two characters, it is a language code from the ISO 639<a name="footnote157"></a><sup><a href="#bookmark2710">157</a></sup><sup></sup> and 639-1 standards</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• Three characters, it is a language code listed in the ISO 639-2<a name="footnote158"></a><sup><a href="#bookmark2711">158</a></sup><sup></sup> standard and extensions</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• The letter “i,” the language tag is explicitly IANA-registered</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• The letter “x,” the language tag is a private, nonstandard, extension subtag</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The ISO 639 and 639-2 names are summarized in</span><a href="#bookmark252"><span class="font24"> Appendix G</span></a><span class="font24">. A few examples are shown here in </span><a href="#bookmark2712"><span class="font24">Table 16-5</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2712"></a><span class="font23" style="font-style:italic;">Table 16-5. Sample ISO 639 and 639-2 language codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Arabic</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">ar</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">ara</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Chinese</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">zh</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">chi/zho</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Dutch</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">nl</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">dut/nla</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">English</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">en</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">eng</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">French</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">fr</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">fra/fre</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">German</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">de</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">deu/ger</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Greek (Modern)</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">el</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">ell/gre</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Hebrew</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">he</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">heb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Italian</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">it</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">ita</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Japanese</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">ja</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">jpn</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Korean</span></p></td><td style="vertical-align:top;">
<p style="text-indent:38pt;"><span class="font2">ko</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">kor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Norwegian</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">no</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">nor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Russian</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">ru</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">rus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Spanish</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:38pt;"><span class="font2">es</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:49pt;"><span class="font2">esl/spa</span></p></td></tr>
</table></td></tr>
<tr><td>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20">* At the time of writing, only 21 language tags have been explicitly registered with the IANA, including Cantonese (“zh-yue”), New Norwegian (“no-nyn”), Luxembourgish (“i-lux”), and Klingon (“i-klingon”). The hundreds of remaining spoken languages in use on the Internet have been composed from standard components.</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:45pt;"><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:49pt;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Swedish</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:45pt;"><span class="font2">sv</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:49pt;"><span class="font2">sve/swe</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">Turkish</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:45pt;"><span class="font2">tr</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:49pt;"><span class="font2">tur</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2713"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2714"></a><a name="bookmark2715"></a>Second Subtag: Namespace</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The second subtag usually is a standardized </span><span class="font24" style="font-style:italic;">country</span><span class="font24"> token, chosen from the ISO 3166 set of country code and region standards. But it may also be another string, which you may register with the IANA. Here are the rules:</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the second subtag has:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Two characters, it’s a country/region defined by ISO 3166<a name="footnote159"></a><sup><a href="#bookmark2716">159</a></sup><sup></sup></span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Three to eight characters, it may be registered with the IANA</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• One character, it is illegal</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Some of the ISO 3166 country codes are shown in </span><a href="#bookmark2717"><span class="font24">Table 16-6</span></a><span class="font24">. The complete list of country codes can be found in </span><a href="#bookmark252"><span class="font24">Appendix G</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2717"></a><span class="font23" style="font-style:italic;">Table 16-6. Sample ISO 3166 country codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Brazil</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">BR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Canada</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">CA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">China</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">CN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">France</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">FR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Germany</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">DE</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Holy See (Vatican City State)</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">VA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Hong Kong</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">HK</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">India</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">IN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Italy</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">IT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Japan</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">JP</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Lebanon</span></p></td><td style="vertical-align:top;">
<p style="text-indent:18pt;"><span class="font2">LB</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mexico</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">MX</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Pakistan</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">PK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Russian Federation</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">RU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">United Kingdom</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">GB</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">United States</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:18pt;"><span class="font2">US</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2718"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2719"></a><a name="bookmark2720"></a><a name="bookmark2721"></a><a name="bookmark2722"></a><a name="bookmark2723"></a>Remaining Subtags: Namespace</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2724"></a><span class="font24"><a name="bookmark2725"></a>There are no rules for the third and following subtags, apart from being up to eight characters (letters and digits).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2726"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2727"></a>Configuring Language Preferences</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You can configure language preferences in your browser profile.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2728"></a><span class="font24">Netscape Navigator lets you set language preferences through Edit </span><span class="font14">➝ </span><span class="font24">Preferences. . . </span><span class="font14">➝ </span><span class="font24">Languages..., and Microsoft Internet Explorer lets you set languages through Tools </span><span class="font14">➝ </span><span class="font24">Internet Options. . . </span><span class="font14">➝ </span><span class="font24">Languages.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2729"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2730"></a>Language Tag Reference Tables</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><a href="#bookmark252"><span class="font24">Appendix G </span></a><span class="font24">contains convenient reference tables for language tags:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• IANA-registered language tags are shown in </span><a href="#bookmark2731"><span class="font24">Table G-1</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• ISO 639 language codes are shown in</span><a href="#bookmark2732"><span class="font24"> Table G-2</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• ISO 3166 country codes are shown in </span><a href="#bookmark2733"><span class="font24">Table G-3</span></a><span class="font24">.</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark2734"></a><span class="font9" style="font-weight:bold;"><a name="bookmark158"></a><a name="bookmark2735"></a>Internationalized URIs</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Today, URIs don’t provide much support for internationalization. With a few (poorly defined) exceptions, today’s URIs are comprised of a subset of US-ASCII characters. There are efforts underway that might let us include a richer set of characters in the hostnames and paths of URLs, but right now, these standards have not been widely accepted or deployed. Let’s review today’s practice.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2736"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2737"></a>Global Transcribability Versus Meaningful Characters</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The URI designers wanted everyone around the world to be able to share URIs with each other—by email, by phone, by billboard, even over the radio. And they wanted URIs to be easy to use and remember. These two goals are in conflict.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To make it easy for folks around the globe to enter, manipulate, and share URIs, the designers chose a very limited set of common characters for URIs (basic Latin alphabet letters, digits, and a few special characters). This small repertoire of characters is supported by most software and keyboards around the world.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Unfortunately, by restricting the character set, the URI designers made it much harder for people around the globe to create URIs that are easy to use and remember. The majority of world citizens don’t even recognize the Latin alphabet, making it nearly impossible to remember URIs as abstract patterns.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The URI authors felt it was more important to ensure transcribability and sharability of resource identifiers than to have them consist of the most meaningful characters. So we have URIs that (today) essentially consist of a restricted subset of ASCII characters.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2738"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2739"></a>URI Character Repertoire</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The subset of US-ASCII characters permitted in URIs can be divided into </span><span class="font24" style="font-style:italic;">reserved</span><span class="font24">, </span><span class="font24" style="font-style:italic;">unreserved</span><span class="font24">, and </span><span class="font24" style="font-style:italic;">escape</span><span class="font24"> character classes. The unreserved character classes can be used generally within any component of URIs that allow them. The reserved characters have special meanings in many URIs, so they shouldn’t be used in general. See </span><a href="#bookmark2740"><span class="font24">Table 16-7</span></a><span class="font24"> for a list of the unreserved, reserved, and escape characters.</span></p>
<table>
<tr><td>
<p><a name="bookmark2740"></a><span class="font23" style="font-style:italic;">Table 16-7. URI character syntax</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Character class</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font2" style="font-weight:bold;">Character repertoire</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Unreserved</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">[A-Za-z0-9] | “-” | “_” | “.” | “!” | “~” | “*” | “'” | “(” | “)”</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Reserved</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">“;” | “/” | “?” | “:” | “@” | “&amp;” | “=” | “+” | “$” | “,”</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Escape</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font2">“%” &lt;HEX&gt; &lt;HEX&gt;</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2741"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2742"></a>Escaping and Unescaping</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">URI “escapes” provide a way to safely insert reserved characters and other unsupported characters (such as spaces) inside URIs. An escape is a three-character sequence, consisting of a percent character (%) followed by two hexadecimal digit characters. The two hex digits represent the code for a US-ASCII character.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, to insert a space (ASCII 32) in a URL, you could use the escape “%20”, because 20 is the hexadecimal representation of 32. Similarly, if you wanted to include a percent sign and have it not be treated as an escape, you could enter “%25”, where 25 is the hexadecimal value of the ASCII code for percent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a href="#bookmark2743"><span class="font24">Figure 16-10 </span></a><span class="font24">shows how the conceptual characters for a URI are turned into code bytes for the characters, in the current character set. When the URI is needed for processing, the escapes are undone, yielding the underlying ASCII code bytes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Internally, HTTP applications should transport and forward URIs with the escapes in place. HTTP applications should unescape the URIs only when the data is needed. And, more importantly, the applications should ensure that no URI ever is unescaped twice, because percent signs that might have been encoded in an escape will themselves be unescaped, leading to loss of data.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2744"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2745"></a>Escaping International Characters</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that escape values should be in the range of US-ASCII codes (0–127). Some applications attempt to use escape values to represent iso-8859-1 extended characters (128–255)—for example, web servers might erroneously use escapes to code</span></p>
<table border="1">
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:24pt;"><span class="font1" style="font-weight:bold;">Conceptual characters</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:14pt;"><span class="font1" style="font-weight:bold;">URI code bytes</span></p></td><td colspan="3" style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font1" style="font-weight:bold;">Unescaped ASCII code byte</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><a href="http://www.joes-hardware.com/big%20sale.txt"><span class="font1">http://www.joes-hardware.com/big%20sale.txt</span></a></p></td><td style="vertical-align:top;">
<p style="text-indent:25pt;"><span class="font2">...</span></p>
<p style="padding:0pt 0pt 0pt 25pt;"><span class="font2">o=111 m=109 /=47 b=98 i=105 g=103 %=37</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 29pt;"><span class="font2">... 111 109 47 98 105 103</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 25pt;"><span class="font2">0=48 s=115</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font2">...</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 29pt;"><span class="font2">115 ...</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">External form (email, web, billboard, radio)</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">What you enter and send (in current character set)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font1" style="font-style:italic;">What you process (in US-ASCII character set)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td colspan="6" style="vertical-align:bottom;">
<p><a name="bookmark2743"></a><span class="font23" style="font-style:italic;">Figure 16-10. URI characters are transported as escaped code bytes but processed unescaped</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">filenames that contain international characters. This is incorrect and may cause problems with some applications.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">For example, the filename </span><span class="font24" style="font-style:italic;">Sven Ölssen.html</span><span class="font24"> (containing an umlaut) might be encoded by a web server as </span><span class="font24" style="font-style:italic;">Sven%20%D6lssen.html</span><span class="font24">. It’s fine to encode the space with %20, but is technically illegal to encode the Ö with %D6, because the code D6 (decimal 214) falls outside the range of ASCII. ASCII defines only codes up to 0x7F (decimal 127).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2746"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2747"></a>Modal Switches in URIs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Some URIs also use sequences of ASCII characters to represent characters in other character sets. For example, iso-2022-jp encoding might be used to insert “ESC ( J” to shift into JIS-Roman and “ESC ( B” to shift back to ASCII. This works in some local circumstances, but the behavior is not well defined, and there is no standardized scheme to identify the particular encoding used for the URL. As the authors of RFC 2396 say:</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2748"></a><span class="font23">For original character sequences that contain non-ASCII characters, however, the situation is more difficult. Internet protocols that transmit octet sequences intended to represent character sequences are expected to provide some way of identifying the charset used, if there might be more than one [RFC2277].</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font23">However, there is currently no provision within the generic URI syntax to accomplish this identification. An individual URI scheme may require a single charset, define a default charset, or provide a way to indicate the charset used. It is expected that a systematic treatment of character encoding within URI will be developed as a future modification of this specification.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Currently, URIs are not very international-friendly. The goal of URI portability outweighed the goal of language flexibility. There are efforts currently underway to internationalize URIs, but in the near term, HTTP applications should stick with ASCII. It’s been around since 1968, so it can’t be all that bad.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2749"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2750"></a><a name="bookmark159"></a><a name="bookmark2751"></a>Other Considerations</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This section discusses a few other things you should keep in mind when writing international HTTP applications.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2752"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2753"></a>Headers and Out-of-Spec Data</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2754"></a><span class="font24">HTTP headers must consist of characters from the US-ASCII character set. However, not all clients and servers implement this correctly, so you may on occasion receive illegal characters with code values larger than 127.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many HTTP applications use operating-system and library routines for processing characters (for example, the Unix ctype character classification library). Not all of these libraries support character codes outside of the ASCII range (0–127).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In some circumstances (generally, with older implementations), these libraries may return improper results or crash the application when given non-ASCII characters. Carefully read the documentation for your character classification libraries before using them to process HTTP messages, in case the messages contain illegal data.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2755"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2756"></a><a name="bookmark2757"></a>Dates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP specification clearly defines the legal GMT date formats, but be aware that not all web servers and clients follow the rules. For example, we have seen web servers send invalid HTTP Date headers with months expressed in local languages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">HTTP applications should attempt to be tolerant of out-of-spec dates, and not crash on receipt, but they may not always be able to interpret all dates sent. If the date is not parseable, servers should treat it conservatively.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2758"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2759"></a>Domain Names</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">DNS doesn’t currently support international characters in domain names. There are standards efforts under way to support multilingual domain names, but they have not yet been widely deployed.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2760"></a><span class="font9" style="font-weight:bold;"><a name="bookmark160"></a><a name="bookmark2761"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The very success of the World Wide Web means that HTTP applications will continue to exchange more and more content in different languages and character sets. For more information on the important but slightly complex topic of multilingual multimedia, please refer to the following sources.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2762"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2763"></a>Appendixes</span></h3>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• IANA-registered charset tags are listed in</span><a href="#bookmark2764"><span class="font24"> Table H-1</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• IANA-registered language tags are shown in </span><a href="#bookmark2731"><span class="font24">Table G-1</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• ISO 639 language codes are shown in</span><a href="#bookmark2732"><span class="font24"> Table G-2</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• ISO 3166 country codes are shown in </span><a href="#bookmark2733"><span class="font24">Table G-3</span></a><span class="font24">.</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2765"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2766"></a>Internet Internationalization</span></h3>
<p><a href="http://www.w3.org/International/"><span class="font24" style="font-style:italic;">http://www.w3.org/International/</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">“Making the WWW Truly World Wide”—the W3C Internationalization and Localization web site.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2396.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2396.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">RFC 2396, “Uniform Resource Identifiers (URI): Generic Syntax,” is the defining document of URIs. This document includes sections describing character set restrictions for international URIs.</span></p>
<p><span class="font24" style="font-style:italic;">CJKV Information Processing</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Ken Lunde, O’Reilly &amp;&nbsp;Associates, Inc. CJKV is the bible of Asian electronic character processing. Asian character sets are varied and complex, but this book provides an excellent introduction to the standards technologies for large character sets.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2277.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2277.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">RFC 2277, “IETF Policy on Character Sets and Languages,” documents the current policies being applied by the Internet Engineering Steering Group (IESG) toward the standardization efforts in the Internet Engineering Task Force (IETF) in order to help Internet protocols interchange data in multiple languages and characters.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2767"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2768"></a>International Standards</span></h3>
<p><a href="http://www.iana.org/numbers.htm"><span class="font24" style="font-style:italic;">http://www.iana.org/numbers.htm</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">The Internet Assigned Numbers Authority (IANA) contains repositories of registered names and numbers. The “Protocol Numbers and Assignments Directory” contains records of registered character sets for use on the Internet. Because much work on international communications falls under the domain of the ISO, and not the Internet community, the IANA listings are not exhaustive.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc3066.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc3066.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">RFC 3066, “Tags for the Identification of Languages,” describes language tags, their values, and how to construct them.</span></p>
<p><span class="font24" style="font-style:italic;">Codes for the representation of names of languages”</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 13pt;"><span class="font24">ISO 639:1988 (E/F), The International Organization for Standardization, first edition.</span></p>
<p><span class="font24" style="font-style:italic;">Codes for the representation of names of languages—Part 2: Alpha-3 code”</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 13pt;"><span class="font24">ISO 639-2:1998, Joint Working Group of ISO TC46/SC4 and ISO TC37/SC2, first edition.</span></p>
<p><span class="font24" style="font-style:italic;">Codes for the representation of names of countries”</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 13pt;"><span class="font24">ISO 3166:1988 (E/F), The International Organization for Standardization, third edition.</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 17</span></p>
<h1 style="text-align:justify;text-indent:38pt;padding:0pt 0pt 114pt 0pt;"><a name="bookmark2769"></a><span class="font11" style="font-weight:bold;"><a name="bookmark2770"></a><a name="bookmark241"></a><a name="bookmark161"></a><a name="bookmark2771"></a>Content Negotiation and Transcoding</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2772"></a><span class="font24"><a name="bookmark2773"></a>Often, a single URL may need to correspond to different resources. Take the case of a web site that wants to offer its content in multiple languages. If a site such as Joe’s Hardware has both French- and English-speaking users, it might want to offer its web site in both languages. However, if this is the case, when one of Joe’s customers requests “http://www.joes-hardware.com,” which version should the server send? Fren<a name="bookmark2774"></a>ch or English?</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Ideally, the server will send the English version to an English speaker and the French version to a French speaker—a user could go to Joe’s Hardware’s home page and get content in the language he speaks. Fortunately, HTTP provides </span><span class="font24" style="font-style:italic;">content-negotiation </span><span class="font24">methods that allow clients and servers to make just such determinations. Using these methods, a single URL can correspond to different resources (e.g., a French and English version of the same web page). These different versions are called </span><span class="font24" style="font-style:italic;">variants</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2775"></a><span class="font24">Servers also can make other types of decisions about what content is best to send to a client for a particular URL. In some cases, servers even can automatically generate customized pages—for instance, a server can convert an HTML page into a WML page for your handheld device. These kinds of dynamic content transformations are called </span><span class="font24" style="font-style:italic;">transcodings</span><span class="font24">. They are done in response to content negotiation between HTTP clients and servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In this chapter, we will discuss content negotiation and how web applications go about their content-negotiation duties.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2776"></a><span class="font9" style="font-weight:bold;"><a name="bookmark162"></a><a name="bookmark2777"></a>Content-Negotiation Techniques</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are three distinct methods for deciding which page at a server is the right one for a client: present the choice to the client, decide automatically at the server, or ask an intermediary to select. These three techniques are called client-driven negotiation, server-driven negotiation, and transparent negotiation, respectively (see</span><a href="#bookmark2778"><span class="font24"> Table 17-1</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">In this chapter, we will look at the mechanics of each technique as well as their advantages and disadvantages.</span></p>
<table>
<tr><td>
<p><a name="bookmark2778"></a><span class="font23" style="font-style:italic;">Table 17-1. Summary of content-negotiation techniques</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Technique</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">How it works</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:8pt;"><span class="font2" style="font-weight:bold;">Advantages</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Drawbacks</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Client-driven</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Client makes a request, server sends list of choices to client, client chooses.</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font2">Easiest to implement at server side. Client can make best choice.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Adds latency: at least two requests are needed to get the correct content.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark2779"></a><span class="font2">Server-driven</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Server examines client’s request headers and decides what version to serve.</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font2">Quicker than client-driven negotiation. HTTP provides a q-value mechanism to allow servers to make approximate matches and a Vary header for servers to tell downstream devices how t<a name="bookmark2780"></a>o evaluate requests.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">If the decision is not obvious (headers don’t match up), the server must guess.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Transparent</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">An intermediate device (usually a proxy cache) does the request negotiation on the client’s behalf.</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font2">Offloads the negotiation from the web server. Quicker than client-driven negotiation.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">No formal specifications for how to do transparent negotiation.</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2781"></a><span class="font9" style="font-weight:bold;"><a name="bookmark163"></a><a name="bookmark2782"></a>Client-Driven Negotiation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The easiest thing for a server to do when it receives a client request is to send back a response listing the available pages and let the client decide which one it wants to see. This, of course, is the easiest to implement at the server and is likely to result in the best copy being selected (provided that the list has enough information to allow the client to pick the right copy). The disadvantage is that two requests are needed for each page—one to get the list and a second to get the selected copy. This is a slow and tedious process, and it’s likely to become annoying to the client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Mechanically, there are actually two ways for servers to present the choices to the client for selection: by sending back an HTML document with links to the different versions of the page and descriptions of each of the versions, or by sending back an HTTP/1.1 response with the 300 Multiple Choices response code. The client browser may receive this response and display a page with the links, as in the first method, or it may pop up a dialog window asking the user to make a selection. In any case, the decision is made manually at the client side by the browser user.</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">In addition to the increased latency and annoyance of multiple requests per page, this method has another drawback: it requires multiple URLs—one for the main page and one for each specific page. So, if the original request was for </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, Joe’s server may respond with a page that has links to </span><a href="http://www.joes-hardware.com/english"><span class="font24" style="font-style:italic;">www.joes-hardware.com/english</span></a><span class="font24"> and </span><a href="http://www.joes-hardware.com/french"><span class="font24" style="font-style:italic;">www.joes-hardware.com/french</span></a><span class="font24">. Should clients now bookmark the original main page or the selected ones? Should they tell their friends about the great web site at </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> or tell only their English-speaking friends about the web site at </span><a href="http://www.joes-hardware.com/english"><span class="font24" style="font-style:italic;">www.joes-hardware.com/english</span></a><span class="font24">?</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2783"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2784"></a><a name="bookmark164"></a><a name="bookmark2785"></a>Server-Driven Negotiation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2786"></a><span class="font24">Client-driven negotiation has several drawbacks, as discussed in the previous section. Most of these drawbacks center around the increased communication between the client and server to decide on the best page in response to a request. One way to reduce this extra communication is to let the server decide which page to send back—but to do this, the client must send enough information about its preferences to allow the server to make an informed decision. The server gets this information from the client’s request headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2787"></a><span class="font24">There are two mechanisms that HTTP servers use to evaluate the proper response to send to a client:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Examining the set of content-negotiation headers. The server looks at the client’s Accept headers and tries to match them with corresponding response headers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Varying on other (non–content-negotiation) headers. For example, the server could send responses based on the client’s User-Agent header.</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">These two mechanisms are explained in more detail in the following sections.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2788"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2789"></a>Content-Negotiation Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Clients may send their preference information using the set of HTTP headers listed in </span><a href="#bookmark2790"><span class="font24">Table 17-2</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p style="text-align:justify;"><a name="bookmark2790"></a><span class="font23" style="font-style:italic;">Table 17-2. Accept headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:39pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:39pt;"><span class="font2">Used to tell the server what media types are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Language</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:39pt;"><span class="font2">Used to tell the server what languages are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Charset</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:39pt;"><span class="font2">Used to tell the server what charsets are okay to send</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Encoding</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:39pt;"><span class="font2">Used to tell the server what encodings are okay to send</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Notice how similar these headers are to the entity headers discussed in </span><a href="#bookmark239"><span class="font24">Chapter 15</span></a><span class="font24">. However, there is a clear distinction between the purposes of the two types of headers. As mentioned in</span><a href="#bookmark239"><span class="font24"> Chapter 15</span></a><span class="font24">, entity headers are like shipping labels—they specify attributes of the message body that are necessary during the transfer of messages from the server to the client. Content-negotiation headers, on the other hand, are used by clients and servers to exchange preference information and to help choose between different versions of a document, so that the one most closely matching the client’s preferences is served.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Servers match clients’ Accept headers with the corresponding entity headers, listed in </span><a href="#bookmark2791"><span class="font24">Table 17-3</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark2791"></a><span class="font23" style="font-style:italic;">Table 17-3. Accept and matching document headers</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Accept header</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2" style="font-weight:bold;">Entity header</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">Content-Type</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Language</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">Content-Language</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Charset</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">Content-Type</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Accept-Encoding</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">Content-Encoding</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that because HTTP is a stateless protocol (meaning that servers do not keep track of client preferences across requests), clients must send their preference information with every request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If both clients sent Accept-Language header information specifying the language in which they were interested, the server could decide which copy of </span><a href="http://www.joes-hard-ware.com"><span class="font24" style="font-style:italic;">www.joes-hard-ware.com</span></a><span class="font24"> to send back to each client. Letti<a name="bookmark2792"></a>ng the server automatically pick which document to send back reduces the latency associated with the back-and-forth communication required by the client-driven model.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2793"></a><span class="font24">However, say that one of the clients prefers Spanish. Which version of the page should the server send back? English or French? The server has just two choices: either guess, or fall back on the client-driven model and ask the client to choose. However, if the Spaniard happens to understand some English, he might choose the English page—it wouldn’t be ideal, but it would do. In this case, the Spaniard needs the ability to pass on more information about his preferences, conveying that he does have minimal knowledge of English and that, in a pinch, English will suffice.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Fortunately, HTTP does provide a mechanism for letting clients like our Spaniard give richer descriptions of their preferences, using </span><span class="font24" style="font-style:italic;">quality values</span><span class="font24"> (“q values” for short).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2794"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2795"></a>Content-Negotiation Header Quality Values</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP protocol defines quality values to allow clients to list multiple choices for each category of preference and associate an order of preference with each choice. For example, clients can send an Accept-Language header of the form:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Accept-Language: en;q=0.5, fr;q=0.0, nl;q=1.0, tr;q=0.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Where the q values can range from 0.0 to 1.0 (with 0.0 being the lowest preference and 1.0 being the highest). The header above, then, says that the client prefers to receive a Dutch (nl) version of the document, but an English (en) version will do. Under no circumstances does the client want a French (fr) or Turkish (tr) version, though. Note that the order in which the preferences are listed is not important; only the q values associated with them are.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Occasionally, the server may not have any documents that match any of the client’s preferences. In this case, the server may change or transcode the document to match the client’s preferences. This mechanism is discussed later in this chapter.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2796"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2797"></a>Varying on Other Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Servers also can attempt to match up responses with other client request headers, such as User-Agent. Servers may know that old versions of a browser do not support JavaScript, for example, and may therefore send back a version of the page that does not contain JavaScript.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2798"></a><span class="font24">In this case, there is no q-value mechanism to look for approximate “best” matches. The server either looks for an exact match or simply serves whatever it has (depending on the implementation of the server).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Because caches must attempt to serve correct “best” versions of cached documents, the HTTP protocol defines a Vary header that the server sends in responses; the Vary header tells caches (and clients, and any downstream proxies) which headers the server is using to determine the best version of the response to send. The Vary header is discussed in more detail later in this chapter.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2799"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2800"></a>Content Negotiation on Apache</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2801"></a><span class="font24">Here is an overview of how the Apache web server supports content negotiation. It is up to the web site content provider—Joe, for example—to provide different versions of Joe’s index page. Joe must put all his index page files in the appropriate directory on the Apache server corresponding to his web site. There are two ways to enable content negotiation:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• In the web site directory, create a </span><span class="font24" style="font-style:italic;">type-map file</span><span class="font24"> for each URI in the web site that has variants. The type-map file lists all the variants and the content-negotiation headers to which they correspond.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><span class="font24">• Enable the MultiViews directive, which causes Apache to create type-map files for the directory automatically.</span></p></li></ul>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2802"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2803"></a>Using type-map files</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Apache server needs to know what type-map files look like. To configure this, set a handler in the server configuration file that specifies the file suffix for type-map files. For example:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">AddHandler type-map .var</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">This line indicates that files with the extension </span><span class="font24" style="font-style:italic;">.var</span><span class="font24"> are type-map files.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here is a sample type-map file:</span></p>
<p style="text-indent:27pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">URI: joes-hardware.html</span></p>
<p style="text-indent:27pt;"><span class="font3">URI: joes-hardware.en.html</span></p>
<p style="text-indent:27pt;"><span class="font3">Content-type: text/html</span></p>
<p style="text-indent:27pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-language: en</span></p>
<p style="text-align:justify;text-indent:28pt;"><a name="bookmark2804"></a><span class="font3">URI: joes-hardware.fr.de.html</span></p>
<p style="text-align:justify;text-indent:28pt;"><span class="font3">Content-type: text/html;charset=iso-8859-2</span></p>
<p style="text-align:justify;text-indent:28pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-language: fr, de</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">From this type-map file, the Apache server knows to send </span><span class="font24" style="font-style:italic;">joes-hardware.en.html</span><span class="font24"> to clients requesting English and </span><span class="font24" style="font-style:italic;">joes-hardware.fr.de.html</span><span class="font24"> to clients requesting French. Quality values also are supported; see the Apache server documentation.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2805"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2806"></a>Using MultiViews</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2807"></a><span class="font24"><a name="bookmark2808"></a>To use MultiViews, you must enable it for the directory containing the web site, using an Options directive in the appropriate section of the </span><span class="font24" style="font-style:italic;">access.conf</span><span class="font24"> file (</span><span class="font24" style="font-style:italic;">&lt;Directory&gt;</span><span class="font24">, </span><span class="font24" style="font-style:italic;">&lt;Location&gt;</span><span class="font24">, or </span><span class="font24" style="font-style:italic;">&lt;Files&gt;</span><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2809"></a><span class="font24"><a name="bookmark2810"></a>If MultiViews is enabled and a browser requests a resource named </span><span class="font24" style="font-style:italic;">joes-hardware</span><span class="font24">, the server looks for all files with “joes-hardware” in the name and creates a type-map file for them. Based on the names, the server guesses the appropriate content-negotiation headers to which the files correspond. For example, a French-language version of </span><span class="font24" style="font-style:italic;">joes-hardware</span><span class="font24"> should contain </span><span class="font24" style="font-style:italic;">.fr</span><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2811"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2812"></a>Server-Side Extensions</span></h3>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Another way to implement content negotiation at the server is by server-side extensions, such as Microsoft’s Active Server Pages (ASP). See </span><a href="#bookmark232"><span class="font24">Chapter 8 </span></a><span class="font24">for an overview of server-side extensions.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2813"></a><span class="font9" style="font-weight:bold;"><a name="bookmark165"></a><a name="bookmark2814"></a>Transparent Negotiation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Transparent negotiation seeks to move the load of server-driven negotiation away from the server, while minimizing message exchanges with the client by having an intermediary proxy negotiate on behalf of the client. The proxy is assumed to have knowledge of the client’s expectations and be capable of performing the negotiations on its behalf (the proxy has received the client’s expectations in the request for content). To support transparent content negotiation, the server must be able to tell proxies what request headers the server examines to determine the best match for the client’s request. The HTTP/1.1 specification does not define any mechanisms for transparent negotiation, but it does define the Vary header. Servers send Vary headers in their responses to tell intermediaries what request headers they use for content negotiation.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Caching proxies can store different copies of documents accessed via a single URL. If servers communicate their decision-making processes to caches, the caches can negotiate with clients on behalf of the servers. Caches also are great places to transcode content, because a general-purpose transcoder deployed in a cache can transcode content from any server, not just one. Transcoding of content at a cache is illustrated in</span><a href="#bookmark2815"><span class="font24"> Figure 17-3 </span></a><span class="font24">and discussed in more detail later in the chapter.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2816"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2817"></a><a name="bookmark2818"></a>Caching and Alternates</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Caching of content assumes that the content can be reused later. However, caches must employ much of the decision-making logic that servers do when sending back a response, to ensure that they send back the correct cached response to a client request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The previous section described the Accept headers sent by clients and the corresponding entity headers that servers match them up against in order to choose the best response to each request. Caches must use these same headers to decide which cached response to send back.</span></p>
<p style="text-align:justify;"><a href="#bookmark2819"><span class="font24">Figure 17-1 </span></a><span class="font24">illustrates both a correct and incorrect sequence of operations involving a cache. The first request results in the cache forwarding the request to the server and storing the response. The second response is looked up by the cache, and a document matching the URL is found. This document, however, is in French, and the requestor wants a Spanish document. If the cache just sends back the French document to the requestor, it will be behaving incorrectly.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET / HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">User-agent: spiffy multimedia browser</span></p>
<p><span class="font3">Accept-language: fr;q=1.0</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-512.jpg" alt="" style="width:44pt;height:83pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">French-speaking</span></p>
<p><span class="font1" style="font-weight:bold;">user</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Hi! Welcome to Joe's Hardware Store.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-513.jpg" alt="" style="width:37pt;height:46pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Hola! Bienvenido a Joe's Hardware Store.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Bonjour</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Bonjour!</span></p>
<p><span class="font3">Bienvenue a Joe's Hardware Store</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 70pt;"><span class="font3">GET / HTTP/1.1</span></p>
<div style="float:left;writing-mode:horizontal-tb;"><img src="book_files/book-514.jpg" alt="" style="width:24pt;height:65pt;">
</div>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Spanish-speaking user</span></p>
</div>
<p style="padding:0pt 0pt 0pt 70pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">User-agent: spiffy multimedia browser</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Accept-language: es;q=1.0</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">Bonjour</span></p></td><td><img src="book_files/book-515.jpg" alt="" style="width:64pt;height:48pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="border-left:solid;display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Hola! Bienvenido a Joe's Hardware Store.</span></p>
</div><br clear="all">
<p style="padding:2pt 0pt 17pt 70pt;"><span class="font3">Bienvenido</span></p>
<p style="padding:0pt 0pt 11pt 144pt;"><span class="font1" style="font-weight:bold;">Cache</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark2819"></a><span class="font23" style="font-style:italic;">Figure 17-1. Caches use content-negotiation headers to send back correct responses to clients</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The cache must therefore forward the second request to the server as well, and store both the response and an “alternate” response for that URL. The cache now has two <a name="bookmark2820"></a>different documents for the same URL, just as the server does. These different versions are called </span><span class="font24" style="font-style:italic;">variants</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">alternates</span><span class="font24">. Content negotiation can be thought of as the process of selecting, from the variants, the best match for a client request.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2821"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2822"></a>The Vary Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s a typical set of request and response headers from a browser and server:</span></p>
<p style="padding:0pt 0pt 0pt 27pt;"><span class="font3">GET </span><a href="http://www.joes-hardware.com/"><span class="font3">http://www.joes-hardware.com/</span></a><span class="font3"> HTTP/1.0 Proxy-Connection: Keep-Alive</span></p>
<p style="text-indent:27pt;"><span class="font3">User-Agent: Mozilla/4.73 [en] (WinNT; U)</span></p>
<p style="text-indent:27pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="padding:0pt 0pt 0pt 27pt;"><span class="font3">Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */* Accept-Encoding: gzip</span></p>
<p style="text-indent:27pt;"><span class="font3">Accept-Language: en, pdf</span></p>
<p style="text-indent:27pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Accept-Charset: iso-8859-1, *, utf-8</span></p>
<p style="text-indent:27pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-indent:27pt;"><span class="font3">Date: Sun, 10 Dec 2000 22:13:40 GMT</span></p>
<p style="text-indent:27pt;"><span class="font3">Server: Apache/1.3.12 OpenSSL/0.9.5a (Unix) FrontPage/4.0.4.3</span></p>
<p style="text-indent:27pt;"><span class="font3">Last-Modified: Fri, 05 May 2000 04:42:52 GMT</span></p>
<p style="text-indent:27pt;"><span class="font3">Etag: &quot;1b7ddf-48-3912514c&quot;</span></p>
<p style="text-indent:27pt;"><span class="font3">Accept-Ranges: Bytes</span></p>
<p style="padding:0pt 0pt 5pt 27pt;"><span class="font3">Content-Length: 72 Connection: close Content-Type: text/html</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">What happens, however, if the server’s decision was based on headers other than the Accept headers, such as the User-Agent header? This is not as radical as it may sound. Servers may know that old versions of a browser do not support JavaScript, for example, and may therefore send back a version of the page that does not have JavaScript in it. If servers are using other headers to make their decisions about which pages to send back, caches must know what those headers are, so that they can perform parallel logic in choosing which cached page to send back.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP Vary response header lists all of the client request headers that the server considers to select the document or generate custom content (in addition to the regular content-negotiation headers). For example, if the served document depends on the User-Agent header, the Vary header must include “User-Agent”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font24">When a new request arrives, the cache finds the best match using the content-negotiation headers. Before it can serve this document to the client, however, it must see whether the server sent a Vary header in the cached response. If a Vary header is present, the header values for the headers in the new request must match the header values in the old, cached request. Because servers may vary their responses based on client request headers, caches must store both the client request headers and the corresponding server response headers with each cached varaint, in order to implement transparent negotiation. This is illustrated in </span><a href="#bookmark2823"><span class="font24">Figure 17-2</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET / HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">User-agent: spiffy multimedia browser</span></p>
<p><span class="font3">Accept-language: fr;q=1.0</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">I need to send her a French document. Since she has such a cool browser, I'll send her a media-rich version of the page.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-516.jpg" alt="" style="width:163pt;height:84pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">French-speaking user 1</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-517.jpg" alt="" style="width:40pt;height:55pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK Content-language: fr</span></p>
<p><span class="font3">Vary: User-agent</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Bonjour</span></p>
<p><span class="font3">[...media-rich content]</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">He wants a French copy of the document and I have it in my cache, but I’d better not send it to him. The server said my cached copy was for a spiffy browser. This guy has a wimpy wireless one. I had better ask the server for a French version for the wireless browser.</span></p></td><td><img src="book_files/book-518.jpg" alt="" style="width:38pt;height:96pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Web server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET / HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a><span class="font3"> User-agent: wimpy wireless device</span></p>
<p><span class="font3">Accept-language: fr;q=1.0</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-519.jpg" alt="" style="width:100pt;height:111pt;"></td><td>
<p><span class="font3">Bonjour</span></p></td></tr>
<tr><td colspan="2">
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">French-speaking user 2</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-520.jpg" alt="" style="width:36pt;height:23pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-521.jpg" alt="" style="width:19pt;height:24pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2824"></a><span class="font3">HTTP/1.1 200 OK Content-language: fr Vary: User-agent</span></p>
<p><span class="font3">Bonjour</span></p>
<p><span class="font3">[...simple text content]</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-522.jpg" alt="" style="width:18pt;height:24pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2823"></a><span class="font23" style="font-style:italic;"><a name="bookmark2825"></a>Figure 17-2. If servers vary on specific request headers, caches must match those request headers in addition to the regular content-negotiation headers before sending back cached responses</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font24">If a server’s Vary header looked like this, the huge number of different User-Agent and Cookie values could generate many variants:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 6pt 0pt;"><span class="font3">Vary: User-Agent, Cookie</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">A cache would have to store each document version corresponding to each variant. When the cache does a lookup, it first does content matching with the content-negotiation headers, then matches the request’s variant with cached variants. If there is no match, the cache fetches the document from the origin server.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark2826"></a><span class="font9" style="font-weight:bold;"><a name="bookmark166"></a><a name="bookmark2827"></a>Transcoding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We have discussed in some detail the mechanism by which clients and servers can choose between a set of documents for a URL and send the one that best matches the client’s needs. These mechanisms rely on the presence of documents that match the client’s needs—whether they match the needs perfectly or not so well.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">What happens, however, when a server does not have a document that matches the client’s needs at all? The server may have to respond with an error, but theoretically, the server may be able to transform one of its existing documents into something that the client can use. This option is called </span><span class="font24" style="font-style:italic;">transcoding</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark2828"><span class="font24">Table 17-4</span></a><span class="font24"> lists some hypot<a name="bookmark2829"></a>hetical transcodings.</span></p>
<table>
<tr><td>
<p><a name="bookmark2828"></a><span class="font23" style="font-style:italic;">Table 17-4. Hypothetical transcodings</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Before</span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2" style="font-weight:bold;">After</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">HTML document</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">WML document</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark2830"></a><span class="font2">High-resolution image Image in 64K colors Complex page with frames HTML page with Java applets Page with ads</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Low-resolution image</span></p>
<p style="text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Black-and-white image</span></p>
<p style="text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Simple text page without frames or images</span></p>
<p style="text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">HTML page without Java applets</span></p>
<p style="text-indent:9pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Page with ads removed</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">There are three categories of transcoding: format conversion, information synthesis, and content injection.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2831"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2832"></a>Format Conversion</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2833"></a><span class="font24" style="font-style:italic;">Format conversion</span><span class="font24"> is the transformation of data from one format to another to make it viewable by a client. A wireless device seeking to access a document typically viewed by a desktop client may be able do so with an HTML-to-WML conversion. A client accessing a web page over a slow link that is not very interested in high-resolution images may be able to view an image-rich page more easily if the images are reduced in size and resolution by converting them from color to black and white and shrinking them.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Format conversion is driven by the content-negotiation headers listed in </span><a href="#bookmark2790"><span class="font24">Table 17-2</span></a><span class="font24">, although it may also be driven by the User-Agent header. Note that content transformation or transcoding is different from content encoding or transfer encoding, in that the latter two typically are used for more efficient or safe transport of content, whereas the former is used to make content viewable on the access device.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2834"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2835"></a>Information Synthesis</span></h3>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">The extraction of key pieces of information from a document—known as </span><span class="font24" style="font-style:italic;">information synthesis</span><span class="font24">—can be a useful transcoding process. A simple example of this is the generation of an outline of a document based on section headings, or the removal of advertisements and logos from a page.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2836"></a><span class="font24"><a name="bookmark2837"></a>More sophisticated technologies that categorize pages based on keywords in content also are useful in summarizing the essence of a document. This technology often is used by automatic web page–classification systems, such as web-page directories at portal sites.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2838"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2839"></a>Content Injection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2840"></a><span class="font24">The two categories of transcodings described so far typically reduce the amount of content in web documents, but there is another category of transformations that increases the amount of content: </span><span class="font24" style="font-style:italic;">content-injection</span><span class="font24"> transcodings. Examples of contentinjection transcodings are automatic ad generators and user-tracking systems.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Imagine the appeal (and offence) of an ad-insertion transcoder that automatically adds advertisements to each HTML page as it goes by. Transcoding of this type has to be dynamic—it must be done on the fly in order to be effective in adding ads that currently are relevant or somehow have been targeted for a particular user. User-tracking systems also can be built to add content to pages dynamically, for the purpose of collecting statistics about how the page is viewed and how clients surf the Web.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2841"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2842"></a>Transcoding Versus Static Pregeneration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">An alternative to transcodings is to build different copies of web pages at the web server—for example, one with HTML, one with WML, one with high-resolution images, one with low-resolution images, one with multimedia content, and one without. This, however, is not a very practical technique, for many reasons: any small change in a page requires multiple pages to be modified, more space is necessary to store all the different versions of each page, and it’s harder to catalog pages and program web servers to serve the right ones. Some transcodings, such as ad insertion (especially targeted ad insertion), cannot be done statically—the ad inserted will de<a name="bookmark2843"></a>pend upon the user requesting the page.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">An on-the-fly transformation of a single root page can be an easier solution than static pregeneration. It can come, however, at the cost of increased latency in serving the content. Some of this computation can, however, be done by a third party, thereby offloading the computation from the web server—the transformation can be done by an external agent at a proxy or cache.</span><a href="#bookmark2815"><span class="font24"> Figure 17-3 </span></a><span class="font24">illustrates transcoding at a proxy cache.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2844"></a><span class="font9" style="font-weight:bold;"><a name="bookmark167"></a><a name="bookmark2845"></a>Next Steps</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The story of content negotiation does not end with the Accept and Content headers, for a couple of reasons:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Content negotiation in HTTP incurs some performance limits. Searching through many variants for appropriate content, or trying to “guess” the best match, can</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font3">GET / HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a><span class="font3"> User-agent: wimpy wireless device</span></p>
<p><span class="font3">Accept-language: fr;q=1.0</span></p></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">French-speaking user</span></p></td><td><img src="book_files/book-523.jpg" alt="" style="width:174pt;height:130pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font3">Bonjour</span></p>
<p><span class="font1" style="font-weight:bold;">Cache</span></p>
<p><span class="font1" style="font-style:italic;">Since I have transformed this document for a wireless device, I will store the transformed copy as an alternate in case someone else wants it as well.</span></p>
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Content-language: fr</span></p>
<p><span class="font3">Vary: User-agent</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">I have a French copy of the document that he wants, but my copy is very mediarich and he has a wimpy wireless browser. I will strip out all of the multimedia content and send it to him.</span></p></td><td><img src="book_files/book-524.jpg" alt="" style="width:37pt;height:48pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-525.jpg" alt="" style="width:32pt;height:31pt;"></td><td>
<p style="text-align:justify;text-indent:17pt;"><span class="font1" style="font-weight:bold;">Web server Transmogrifier</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Bonjour</span></p>
<p><span class="font3">[...simple text content]</span></p>
</div><br clear="all"></li></ul>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2815"></a><span class="font23" style="font-style:italic;"><a name="bookmark2846"></a>Figure 17-3. Content transformation or transcoding at a proxy cache</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">be costly. Are there ways to streamline and focus the content-negotiation protocol? RFCs 2295 and 2296 attempt to address this question for transparent HTTP content negotiation.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• HTTP is not the only protocol that needs to do content negotiation. Streaming media and fax are two other examples where client and server need to discuss the best answer to the client’s request. Can a general content-negotiation protocol be developed on top of TCP/IP application protocols? The Content Negotiation Working Group was formed to tackle this question. The group is now closed, but it contributed several RFCs. See the next section for a link to the group’s web site.</span></p></li></ul>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark2847"></a><span class="font9" style="font-weight:bold;"><a name="bookmark168"></a><a name="bookmark2848"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The following Internet drafts and online documentation can give you more details about content negotiation:</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2616.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 19pt;"><span class="font24">RFC 2616, “Hypertext Transfer Protocol—HTTP/1.1,” is the official specification for HTTP/1.1, the current version of the HTTP protocol. The specification is a well-written, well-organized, detailed reference for HTTP, but it isn’t ideal for readers who want to learn the underlying concepts and motivations of HTTP or the differences between theory and practice. We hope that this book fills in the underlying concepts, so you can make better use of the specification.</span></p>
<p style="text-align:justify;"><a href="http://search.ietf.org/rfc/rfc2295.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc2295.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 18pt;"><span class="font24">RFC 2295, “Transparent Content Negotiation in HTTP,” is a memo describing a transparent content-negotiation protocol on top of HTTP. The status of this memo remains experimental.</span></p>
<p style="text-align:justify;"><a href="http://search.ietf.org/rfc/rfc2296.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc2296.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 18pt;"><span class="font24">RFC 2296, “HTTP Remote Variant Selection Algorithm—RVSA 1.0,” is a memo describing an algorithm for the transparent selection of the “best” content for a particular HTTP request. The status of this memo remains experimental.</span></p>
<p style="text-align:justify;"><a href="http://search.ietf.org/rfc/rfc2936.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/rfc/rfc2936.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 18pt;"><span class="font24">RFC 2936, “HTTP MIME Type Handler Detection,” is a memo describing an approach for determining the actual MIME type handlers that a browser supports. This approach can help if the Accept header is not specific enough.</span></p>
<p style="text-align:justify;"><a href="http://www.imc.org/ietf-medfree/index.htm"><span class="font24" style="font-style:italic;">http://www.imc.org/ietf-medfree/index.htm</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 18pt;"><span class="font24">This is a link to the Content Negotiation (CONNEG) Working Group, which looked into transparent content negotiation for HTTP, fax, and print. This group is now closed.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 3pt 0pt;"><a name="bookmark2849"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2850"></a>PART V</span></h1>
<p style="text-align:right;padding:0pt 0pt 82pt 173pt;"><a name="bookmark221"></a><span class="font12" style="font-weight:bold;">Content Publishing and Distribution</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark169"></a><span class="font24"><a name="bookmark170"></a>Part V talks all about the technology for publishing and disseminating web content:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark242"><span class="font24">Chapter 18, </span><span class="font24" style="font-style:italic;">Web Hosting</span></a><span class="font24">, discusses the ways people deploy servers in modern web hosting environments, HTTP support for virtual web hosting, and how to replicate content across geographically distant servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark243"><span class="font24">Chapter 19, </span><span class="font24" style="font-style:italic;">Publishing Systems</span></a><span class="font24">, discusses the technologies for creating web content and installing it onto web servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark244"><span class="font24">Chapter 20, </span><span class="font24" style="font-style:italic;">Redirection and Load Balancing</span></a><span class="font24">, surveys the tools and techniques for distributing incoming web traffic among a collection of servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• </span><a href="#bookmark245"><span class="font24">Chapter 21, </span><span class="font24" style="font-style:italic;">Logging and Usage Tracking</span></a><span class="font24">, covers log formats and common questions.</span></p></li></ul>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 18</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark242"></a><span class="font11" style="font-weight:bold;"><a name="bookmark171"></a><a name="bookmark2851"></a>Web Hosting</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2852"></a><span class="font24"><a name="bookmark2853"></a><a name="bookmark2854"></a>When you place resources on a public web server, you make them available to the Internet community. These resources can be as simple as text files or images, or as complicated as real-time driving maps or e-commerce shopping gateways. It’s critical that this rich variety of resources, owned by different organizations, can be conveniently published to web sites and placed on web servers that offer good performance at a fair price.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2855"></a><span class="font24">The collective duties of storing, brokering, and administering content resources is called </span><span class="font24" style="font-style:italic;">web hosting</span><span class="font24">. Hosting is one of the primary functions of a web server. You need a server to hold, serve, log access to, and administer your content. If you don’t want to manage the required hardware and software yourself, you need a hosting service, or </span><span class="font24" style="font-style:italic;">hoster</span><span class="font24">. Hosters rent you serving and web-site administration services and provide various degrees of security, reporting, and ease of use. Hosters typically pool web sites on heavy-duty web servers for cost-efficiency, reliability, and performance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">This chapter explains some of the most important features of web hosting services and how they interact with HTTP applications. In particular, this chapter covers:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• How different web sites can be “virtually hosted” on the same server, and how this affects HTTP</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• How to make web sites more reliable under heavy traffic</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• How to make web sites load faster</span></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2856"></a><span class="font9" style="font-weight:bold;"><a name="bookmark172"></a><a name="bookmark2857"></a>Hosting Services</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In the early days of the World Wide Web, individual organizations purchased their own computer hardware, built their own computer rooms, acquired their own network connections, and managed their own web server software.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As the Web quickly became mainstream, everyone wanted a web site, but few people had the skills or time to build air-conditioned server rooms, register domain names, or purchase network bandwidth. To save the day, many new businesses emerged, offering professionally managed web hosting services. Many levels of service are available, from physical facilities management (providing space, air conditioning, and wiring) to full-service web hosting, where all the customer does is provide the content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2858"></a><span class="font24">This chapter focuses on what the hosting web server provides. Much of what makes a web site work—as well as, for example, its ability to support different languages and its ability to do secure e-commerce transactions—depends on what capabilities the hosting web server supports.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2859"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2860"></a>A Simple Example: Dedicated Hosting</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Suppose that Joe’s Hardware Online and Mary’s Antique Auction both want fairly high-volume web sites. Irene’s ISP has racks and racks full of identical, high-performance web servers that it can lease to Joe and Mary, instead of having Joe and Mary purchase their own servers and maintain the server software.</span></p>
<p style="text-align:justify;"><span class="font24">In</span><a href="#bookmark2861"><span class="font24"> Figure 18-1</span></a><span class="font24">, both Joe and Mary sign up for the </span><span class="font24" style="font-style:italic;">dedicated web hosting</span><span class="font24"> service offered by Irene’s ISP. Joe leases a dedicated web server that is purchased and maintained by Irene’s ISP. Mary gets a different dedicated server from Irene’s ISP. Irene’s ISP gets to buy server hardware in volume and can select hardware that is reliable, time-tested, and low-cost. If either Joe’s Hardware Online or Mary’s Antique Auction grows in popularity, Irene’s ISP can offer Joe or Mary additional servers immediately.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-526.jpg" alt="" style="width:169pt;height:139pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-527.jpg" alt="" style="width:51pt;height:71pt;">
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2861"></a><span class="font23" style="font-style:italic;">Figure 18-1. Outsourced dedicated hosting</span></p>
<p style="text-align:justify;"><span class="font24">In this example, browsers send HTTP requests for </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> to the IP address of Joe’s server and requests for </span><a href="http://www.marys-antiques.com"><span class="font24" style="font-style:italic;">www.marys-antiques.com</span></a><span class="font24"> to the (different) IP address of Mary’s server.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2862"></a><span class="font9" style="font-weight:bold;"><a name="bookmark1052"></a><a name="bookmark173"></a><a name="bookmark2863"></a>Virtual Hosting</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2864"></a><span class="font24">Many folks want to have a web presence <a name="bookmark2865"></a>but don’t have high-traffic web sites. For these people, providing a dedicated web server may be a waste, because they’re paying many hundreds of dollars a month to lease a server that is mostly idle!</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many web hosters offer lower-cost web hosting services by sharing one computer between several customers. This is called </span><span class="font24" style="font-style:italic;">shared hosting</span><span class="font24"> or </span><span class="font24" style="font-style:italic;">virtual hosting</span><span class="font24">. Each web site appears to be hosted by a different server, but they really are hosted on the same physical server. From the end user’s perspective, virtually hosted web sites should be indistinguishable from sites hosted on separate dedicated servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For cost efficiency, space, and management reasons, a virtual hosting company wants to host tens, hundreds, or thousands of web sites on the same server—but this does not necessarily mean that 1,000 web sites are served from only one PC. Hosters can create banks of replicated servers (called </span><span class="font24" style="font-style:italic;">server farms</span><span class="font24">) and spread the load across the farm of servers. Because each server in the farm is a clone of the others, and hosts many virtual web sites, administration is much easier. (We’ll talk more about server farms in</span><a href="#bookmark244"><span class="font24"> Chapter 20</span></a><span class="font24">.)</span></p>
<p style="text-align:justify;"><span class="font24">When Joe and Mary started their businesses, they might have chosen virtual hosting to save money until their traffic levels made a dedicated server worthwhile (see </span><a href="#bookmark2866"><span class="font24">Figure 18-2</span></a><span class="font24">).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-528.jpg" alt="" style="width:174pt;height:159pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-529.jpg" alt="" style="width:50pt;height:71pt;">
<p><a name="bookmark2867"></a><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><a name="bookmark2868"></a><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark2866"></a><span class="font23" style="font-style:italic;">Figure 18-2. Outsourced virtual hosting</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2869"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2870"></a>Virtual Server Request Lacks Host Information</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Unfortunately, there is a design flaw in HTTP/1.0 that makes virtual hosters pull their hair out. The HTTP/1.0 specification didn’t give any means for shared web servers to identify which of the virtual web sites they’re hosting is being accessed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2871"></a><span class="font24">Recall that HTTP/1.0 requests send only the path component of the URL in the request message. If you try to get </span><a href="http://www.joes-hardware.com/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/index.html</span></a><span class="font24">, the browser connects to the server </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, but the HTTP/1.0 request says “GET /index.html”, with no further mention of the hostname. If the server is virtually hosting multiple sites, this isn’t enough information to figure out what virtual web site is being accessed. For example, in </span><a href="#bookmark2872"><span class="font24">Figure 18-3</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If client A tries to access </span><a href="http://www.joes-hardware.com/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/index.html</span></a><span class="font24">, the request “GET /index.html” will be sent to the shared web server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• If client B tries to access </span><a href="http://www.marys-antiques.com/index.html"><span class="font24" style="font-style:italic;">http://www.marys-antiques.com/index.html</span></a><span class="font24">, the identical request “GET /index.html” will be sent to the shared web server.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">(A getting </span><a href="http://w"><span class="font1" style="font-style:italic;">http://w</span></a><span class="font1" style="font-style:italic;text-decoration:underline;">ww.joes-hardware.com/index.html)</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><a href="http://www.voting-info.govwww.joes-hardware.com"><span class="font0">www.voting-info.govwww.joes-hardware.com</span></a><span class="font0"> </span><a href="http://www.marys-antiques.com"><span class="font0">www.marys-antiques.com</span></a></p></td></tr>
<tr><td><img src="book_files/book-530.jpg" alt="" style="width:154pt;height:79pt;"></td></tr>
<tr><td>
<p><span class="font0">HTTP/1.0 requests do not contain hostname information, so they do not support web servers that host multiple web sites.</span></p>
<p><span class="font0">(HTTP/1.1 supports a Host header to fix this problem.)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">GET /index.html HTTP/1.0</span></p>
<p><span class="font3">User-agent: SuperBrowser v1.3</span></p></td></tr>
<tr><td><img src="book_files/book-531.jpg" alt="" style="width:124pt;height:75pt;"></td></tr>
<tr><td>
<p><span class="font3">GET /index.html HTTP/1.0 User-agent: WebSurfer 2000</span></p>
<p><span class="font1" style="font-style:italic;">(B getting </span><a href="http://www.marys-antiques.com/index.html"><span class="font1" style="font-style:italic;">http://www.marys-antiques.com/index.html</span></a><span class="font1" style="font-style:italic;">)</span></p>
<p><span class="font3">GET /index.html HTTP/1.0 User-agent: WebSurfer 2000</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-532.jpg" alt="" style="width:35pt;height:30pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client A</span></p></td></tr>
</table>
</div><br clear="all"></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2872"></a><span class="font23" style="font-style:italic;">Figure 18-3. HTTP/1.0 server requests don’t contain hostname information</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As far as the web server is concerned, there is not enough information to determine which web site is being accessed! The two requests look the same, even though they are for totally different documents (from different web sites). The problem is that the web site host information has been stripped from the request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As we saw in</span><a href="#bookmark230"><span class="font24"> Chapter 6</span></a><span class="font24">, HTTP surrogates (reverse proxies) and intercepting proxies also need site-specifying information.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2873"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2874"></a>Making Virtual Hosting Work</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The missing host information was an oversight in the original HTTP specification, which mistakenly assumed that each web server would host exactly one web site. HTTP’s designers didn’t provide support for virtually hosted, shared servers. For this reason, the hostname information in the URL was viewed as redundant and stripped away; only the path component was required to be sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because the early specifications did not make provisions for virtual hosting, web hosters needed to develop workarounds and conventions to support shared virtual hosting. The problem could have been solved simply by requiring all HTTP request <a name="bookmark2875"></a>messages to send the full URL instead of just the path component. HTTP/1.1 does require servers to handle full URLs in the request lines of HTTP messages, but it will be a long time before all legacy applications are upgraded to this specification. In the meantime, four techniques have emerged:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Virtual hosting by URL path</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Adding a special path component to the URL so the server can determine the site.</span></p>
<p><span class="font24" style="font-style:italic;">Virtual hosting by port number</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Assigning a different port number to each site, so requests are handled by separate instances of the web server.</span></p>
<p><a name="bookmark2876"></a><span class="font24" style="font-style:italic;">Virtual hosting by IP address</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Dedicating different IP addresses for different virtual sites and binding all the IP addresses to a single machine. This allows the web server to identify the site name by IP address.</span></p>
<p><span class="font24" style="font-style:italic;">Virtual hosting by Host header</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Many web hosters pressured the HTTP designers to solve this problem. Enhanced versions of HTTP/1.0 and the official version of HTTP/1.1 define a Host request header that carries the site name. The web server can identify the virtual site from the Host header.</span></p>
<p style="padding:0pt 0pt 13pt 0pt;"><span class="font24">Let’s take a closer look at each technique.</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2877"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2878"></a>Virtual hosting by URL path</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">You can use brute force to isolate virtual sites on a shared server by assigning them different URL paths. For example, you could give each logical web site a special path prefix:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Joe’s Hardware store could be </span><a href="http://www.joes-hardware.com/joe/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/joe/index.html</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Mary’s Antiques store could be </span><a href="http://www.marys-antiques.com/mary/index.html"><span class="font24" style="font-style:italic;">http://www.marys-antiques.com/mary/index.html</span></a><span class="font24">.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2879"></a><span class="font24">When the requests arrive at the server, the hostname information is not present in the request, but the server can tell them apart based on the path:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The request for Joe’s hardware is “GET /joe/index.html”.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• The request for Mary’s antiques is “GET /mary/index.html”.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This is not a good solution. The “/joe” and “/mary” prefixes are redundant and confusing (we already mentioned “joe” in the hostname). Worse, the common convention of specifying </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com</span></a><span class="font24"> or </span><a href="http://www.joes-hardware.com/"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/</span></a><span class="font24" style="font-style:italic;"> index.html</span><span class="font24"> for the home page won’t work.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">In general, URL-based virtual hosting is a poor solution and seldom is used.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2880"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2881"></a>Virtual hosting by port number</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Instead of changing the pathname, Joe and Mary could each be assigned a different port number on the web server. Instead of port 80, for example, Joe could get 82 and <a name="bookmark2882"></a>Mary could have 83. But this solution has the same problem: an end user would expect to find the resources without having to specify a nonstandard port in the URL.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark2883"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2884"></a>Virtual hosting by IP address</span></h4>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">A much better approach (in common use) is virtual IP addressing. Here, each virtual web site gets one or more unique IP addresses. The IP addresses for all of the virtual web sites are attached to the same shared server. The server can look up the destination IP address of the HTTP connection and use that to determine what web site the client thinks it is connected to.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Say a hoster assigned the IP address 209.172.34.3 to </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, assigned 209.172.34.4 to </span><a href="http://www.marys-antiques.com"><span class="font24" style="font-style:italic;">www.marys-antiques.com</span></a><span class="font24">, and tied both IP addresses to the same physical server machine. The web server could then use the destination IP address to identify which virtual site is being requested, as shown in</span><a href="#bookmark2885"><span class="font24"> Figure 18-4</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client A fetches </span><a href="http://www.joes-hardware.com/index.html"><span class="font24" style="font-style:italic;">http://www.joes-hardware.com/index.html</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client A finds the IP address for </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, getting 209.172.34.3.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client A opens a TCP connection to the shared web server at 209.172.34.3.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client A sends the request “GET /index.html HTTP/1.0”.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 26pt 19pt;"><span class="font24">• Before the web server serves a response, it notes the actual destination IP address (209.172.34.3), determines that this is a virtual IP address for Joe’s web site, and fulfills the request from the </span><span class="font24" style="font-style:italic;">/joe</span><span class="font24"> subdirectory. The page </span><span class="font24" style="font-style:italic;">/joe/index.html</span><span class="font24"> is returned.</span></p>
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Dest IP address</span></p>
<p><span class="font0">209.172.34.2</span></p>
<p><span class="font0">209.172.34.3</span></p>
<p><span class="font0">209.172.34.4</span></p>
<p><span class="font1" style="font-weight:bold;">Directory </span><span class="font0">/voting /joe /mary</span></p>
<p><span class="font1" style="font-style:italic;">www.voting-info.gov= 209.172.34.2</span></p>
<p><span class="font1" style="font-style:italic;">www.joes-hardware.com= 209.172.34.3</span></p>
<p><span class="font1" style="font-style:italic;">www marys-antiques.com= 209.172.34.4</span></p></td></tr>
<tr><td><img src="book_files/book-533.jpg" alt="" style="width:302pt;height:94pt;">
<p><span class="font0">209.172.34.3</span></p>
<p><span class="font1" style="font-weight:bold;">Client A</span></p>
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
<p><span class="font0">/voting /mary</span></p>
<p><span class="font0">/joe</span></p></td></tr>
<tr><td>
<p><span class="font0">209.172.34.4</span></p>
<p><span class="font1" style="font-weight:bold;">Client B</span></p></td></tr>
</table></li></ul>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2885"></a><span class="font23" style="font-style:italic;">Figure 18-4. Virtual IP hosting</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Similarly, if client B asks for </span><a href="http://www.marys-antiques.com/index.html"><span class="font24" style="font-style:italic;">http://www.marys-antiques.com/index.html</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client B finds the IP address for </span><a href="http://www.marys-antiques.com"><span class="font24" style="font-style:italic;">www.marys-antiques.com</span></a><span class="font24">, getting 209.172.34.4.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client B opens a TCP connection to the web server at 209.172.34.4.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Client B sends the request “GET /index.html HTTP/1.0”.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The web server determines that 209.172.34.4 is Mary’s web site and fulfills the request from the </span><span class="font24" style="font-style:italic;">/mary</span><span class="font24"> subdirectory, returning the document </span><span class="font24" style="font-style:italic;">/mary/index.html</span><span class="font24">.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2886"></a><span class="font24">Virtual IP hosting works, but it causes some difficulties, especially for large hosters:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2887"></a><span class="font24">• Computer systems usually have a limit on how many virtual IP addresses can be bound to a machine. Hosters that want hundreds or thousands of virtual sites to be hosted on a shared server may be out of luck.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• IP addresses are a scarce commodity. Hosters with many virtual sites might not be able to obtain enough virtual IP addresses for the hosted web sites.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2888"></a><span class="font24">• The IP address shortage is made worse when hosters replicate their servers for additional capacity. Different virtual IP addresses may be needed on each replicated server, depending on the load-balancing architecture, so the number of IP addresses needed can multiply by the number of replicated servers.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Despite the address consumption problems with virtual IP hosting, it is used widely.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2889"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2890"></a>Virtual hosting by Host header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To avoid excessive address consumption and virtual IP limits, we’d like to share the same IP address among virtual sites, but still be able to tell the sites apart. But as we’ve seen, because most browsers send just the path component of the URL to servers, the critical virtual hostname information is lost.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To solve this problem, browser and server implementors extended HTTP to provide the original hostname to servers. But browsers couldn’t just send a full URL, because that would break many servers that expected to receive only a path component. Instead, the hostname (and port) is passed in a Host extension header in all requests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">In</span><a href="#bookmark2891"><span class="font24"> Figure 18-5</span></a><span class="font24">, client A and client B both send Host headers that carry the original hostname being accessed. When the server gets the request for </span><span class="font24" style="font-style:italic;">/index.html</span><span class="font24">, it can use the Host header to decide which resources to use.</span></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font1" style="font-style:italic;">(A getting </span><a href="http://w"><span class="font1" style="font-style:italic;">http://w</span></a><span class="font1" style="font-style:italic;text-decoration:underline;">ww.joes-hardware.com/index.html)</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:center;"><a href="http://www.voting-info.govwww.joes-hardware.com"><span class="font0">www.voting-info.govwww.joes-hardware.com</span></a><span class="font0"> </span><a href="http://www.marys-antiques.com"><span class="font0">www.marys-antiques.com</span></a></p>
<p><span class="font3">GET /index.html HTTP/1.1 User-agent: SuperBrowser v1.3 Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p></td></tr>
<tr><td><img src="book_files/book-534.jpg" alt="" style="width:316pt;height:79pt;">
<p><span class="font1" style="font-weight:bold;">Client A</span></p>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client B</span></p>
<p><span class="font0">The HTTP Host header carries the hostname information that would otherwise be lost in normal server requests, allowing name-based virtual hosting.</span></p>
<p><span class="font3">GET /index.html HTTP/1.1 User-agent: WebSurfer 2000 Host: marys-antiques.com</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-535.jpg" alt="" style="width:80pt;height:61pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-536.jpg" alt="" style="width:1pt;height:34pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">(B getting </span><a href="http://www.marys-antiques.com/index.html"><span class="font1" style="font-style:italic;">http://www.marys-antiques.com/index.html</span></a><span class="font1" style="font-style:italic;">)</span></p>
</div><br clear="all">
<p style="text-align:justify;"><a name="bookmark2891"></a><span class="font23" style="font-style:italic;">Figure 18-5. Host headers distinguish virtual host requests</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2892"></a><span class="font24"><a name="bookmark2893"></a>Host headers were first introduced with HTTP/1.0+, a vendor-extended superset of HTTP/1.0. Host headers are required for HTTP/1.1 compliance. Host headers are supported by most modern browsers and servers, but there are still a few clients and servers (and robots) that don’t support them.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2894"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2895"></a>HTTP/1.1 Host Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The Host header is an HTTP/1.1 request header, defined in RFC 2068. Virtual servers are so common that most HTTP clients, even if they are not HTTP/1.1-compliant, implement the Host header.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2896"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2897"></a>Syntax and usage</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Host header specifies the Internet host and port number for the resource being requested, as obtained from the original URL:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Host = &quot;Host&quot; &quot;:&quot; host [ &quot;:&quot; port ]</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In particular:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark2898"></a><span class="font24">• If the Host header does not contain a port, the default port for the scheme is assumed.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If the URL contains an IP address, the Host header should contain the same address.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If the URL contains a hostname, the Host header must contain the same name.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If t<a name="bookmark2899"></a>he URL contains a hostname, the Host header should </span><span class="font24" style="font-style:italic;">not</span><span class="font24"> contain the IP address equivalent to the URL’s hostname, because this will break virtually hosted servers, which layer multiple virtual sites over a single IP address.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If the URL contains a hostname, the Host header should not contain another alias for this hostname, because this also will break virtually hosted servers.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• If the client is using an explicit proxy server, the client must include the name and port of the </span><span class="font24" style="font-style:italic;">origin</span><span class="font24"> server in the Host header, </span><span class="font24" style="font-style:italic;">not</span><span class="font24"> the proxy server. In the past, several web clients had bugs where the outgoing Host header was set to the hostname of the proxy, when the client’s proxy setting was enabled. This incorrect behavior causes proxies and origin servers to misbehave.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Web clients must include a Host header field in all request messages.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">• Web proxies must add Host headers to request messages before forwarding them.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• HTTP/1.1 web servers must respond with a 400 status code to any HTTP/1.1 request message that lacks a Host header field.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here is a sample HTTP request message used to fetch the home page of </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">, along with the required Host header field:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">GET </span><a href="http://www.joes-hardware.com/index.html"><span class="font3">http://www.joes-hardware.com/index.html</span></a><span class="font3"> HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Connection: Keep-Alive</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">User-Agent: Mozilla/4.51 [en] (X11; U; IRIX 6.2 IP22)</span></p>
<p style="padding:0pt 41pt 0pt 19pt;"><a name="bookmark2900"></a><span class="font3"><a name="bookmark2901"></a>Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */* Accept-Encoding: gzip Accept-Language: en</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2902"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2903"></a>Missing Host headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">A small percentage of old browsers in use do not send Host headers. If a virtual hosting server is using Host headers to determine which web site to serve, and no Host header is present, it probably will either direct the user to a default web page (such as the web page of the ISP) or return an error page suggesting that the user upgrade her browser.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2904"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2905"></a>Interpreting Host headers</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2906"></a><span class="font24">An origin server that isn’t virtually hosted, and doesn’t allow resources to differ by the requested host, may ignore the Host header field value. But any origin server that does differentiate resources based on the host must use the following rules for determining the requested resource on an HTTP/1.1 request:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">1. If the URL in the HT<a name="bookmark2907"></a>TP request message is absolute (i.e., contains a scheme and host component), the value in the Host header is ignored in favor of the URL.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">2. If the URL in the HTTP request message doesn’t have a host, and the request contains a Host header, the value of the host/port is obtained from the Host header.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><a name="bookmark2908"></a><span class="font24">3. If no valid host can be determined through Steps 1 or 2, a 400 Bad Response response is returned to the client.</span></p></li></ul>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2909"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2910"></a>Host headers and proxies</span></h4>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Some browser versions send incorrect Host headers, especially when configured to use proxies. For example, when configured to use a proxy, some older versions of Apple and PointCast clients mistakenly sent the name of the proxy instead of the origin server in the Host header.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark2911"></a><span class="font9" style="font-weight:bold;"><a name="bookmark174"></a><a name="bookmark2912"></a>Making Web Sites Reliable</span></h2>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">There are several times during which web sites commonly break:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Server downtime</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Traffic spikes: suddenly everyone wants to see a particular news broadcast or rush to a sale. Sudden spikes can overload a web server, slowing it down or stopping it completely.</span></p></li>
<li>
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Network outages or losses</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">This section presents some ways of anticipating and dealing with these common problems.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2913"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2914"></a><a name="bookmark2915"></a><a name="bookmark2916"></a>Mirrored Server Farms</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2917"></a><span class="font24"><a name="bookmark2918"></a>A server farm is a bank of identically configured web servers that can cover for each other. The content on each server in the farm can be mirrored, so that if one has a problem, another can fill in.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Often, mirrored servers follow a hierarchical relationship. One server might act as the “content authority”—the server that contains the original content (perhaps a server to which the content authors post). This server is called the </span><span class="font24" style="font-style:italic;">master origin server</span><span class="font24">. The mirrored servers that receive content from the master origin server are called </span><span class="font24" style="font-style:italic;">replica origin servers</span><span class="font24">. One simple way to deploy a server farm is to use a network switch to distribute requests to the servers. The IP address for each of the web sites hosted on the servers is the IP address of the switch.</span></p>
<p style="text-align:justify;"><span class="font24">In the mirrored server farm shown in</span><a href="#bookmark2919"><span class="font24"> Figure 18-6</span></a><span class="font24">, the master origin server is responsible for sending content to the replica origin servers. To the outside world, the IP address for this content is the IP address of the switch. The switch is responsible for sending requests to the servers.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-537.jpg" alt="" style="width:20pt;height:18pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-538.jpg" alt="" style="width:46pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font0">Replica origin server</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-539.jpg" alt="" style="width:20pt;height:18pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-540.jpg" alt="" style="width:20pt;height:18pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-541.jpg" alt="" style="width:18pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Switch</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-542.jpg" alt="" style="width:20pt;height:18pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font0">Master origin server</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-543.jpg" alt="" style="width:20pt;height:18pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-544.jpg" alt="" style="width:45pt;height:36pt;"></td></tr>
<tr><td>
<p><span class="font0">Replica origin servers</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark2919"></a><span class="font23" style="font-style:italic;">Figure 18-6. Mirrored server farm</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Mirrored web servers can contain copies of the exact same content at different locations.</span><a href="#bookmark2920"><span class="font24"> Figure 18-7 </span></a><span class="font24">illustrates four mirrored servers, with a master server in Chicago and replicas in New York, Miami, and Little Rock. The master server serves clients in the Chicago area and also has the job of propagating its content to the replica servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In the</span><a href="#bookmark2920"><span class="font24"> Figure 18-7 </span></a><span class="font24">scenario, there are a couple of ways that client requests would be directed to a particular server:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">HTTP redirection</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 19pt;"><span class="font24">The URL for the content could resolve to the IP address of the master server, which could then send redirects to replica servers.</span></p><img src="book_files/book-545.jpg" alt="" style="width:208pt;height:106pt;">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark2920"></a><span class="font23" style="font-style:italic;"><a name="bookmark2921"></a>Figure 18-7. Dispersed mirrored servers</span></p>
<p style="text-align:justify;"><a name="bookmark2922"></a><span class="font24" style="font-style:italic;">DNS redirection</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">The URL for the content could resolve to four IP addresses, and the DNS server could choose the IP address that it sends to clients.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">See</span><a href="#bookmark244"><span class="font24"> Chapter 20 </span></a><span class="font24">for more details.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2923"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2924"></a>Content Distribution Networks</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">A </span><span class="font24" style="font-style:italic;">content distribution network</span><span class="font24"> (CDN) is simply a network whose purpose is the distribution of specific content. The nodes of the network can be web servers, surrogates, or proxy caches.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2925"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2926"></a>Surrogate Caches in CDNs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Surrogate caches can be used in place of replica origin servers in Figures 18-6 and 18-7. Surrogates, also known as reverse proxies, receive server requests for content just as mirrored web servers do. They receive server requests on behalf of a specific set of origin servers (this is possible because of the way IP addresses for content are advertised; there usually is a working relationship between origin server and surrogate, and surrogates expect to receive requests aimed at specific origin servers).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The difference between a surrogate and a mirrored server is that surrogates typically are demand-driven. They do not store entire copies of the origin server content; they store whatever content their clients request. The way content is distributed in their caches depends on the requests that they receive; the origin server does not have the responsibility to update their content. For easy access to “hot” content (content that is in high demand), some surrogates have “prefetching” features that enable them to pull content in advance of user requests.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">An added complexity in CDNs with surrogates is the possibility of cache hierarchies.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2927"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2928"></a>Proxy Caches in CDNs</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Proxy caches also can be deployed in configurations similar to those in Figures 18-6 and 18-7. Unlike surrogates, traditional proxy caches can receive requests aimed at any web servers (there need not be any working relationship or IP address agreement between a proxy cache and an origin server). As with surrogates, however, proxy cache content typically is demand-driven and is not expected to be an exact duplicate of the origin server content. Some proxy caches also can be preloaded with hot content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark2929"></a><span class="font24">Demand-driven proxy caches can be deployed in other kinds of configurations—in particular, interception configurations, where a layer-2 or -3 device (switch or router) intercepts web traffic and sends it to a proxy cache (see</span><a href="#bookmark2930"><span class="font24"> Figure 18-8</span></a><span class="font24">).</span></p>
<table>
<tr><td><img src="book_files/book-546.jpg" alt="" style="width:360pt;height:137pt;"></td></tr>
<tr><td>
<p><a name="bookmark2930"></a><span class="font23" style="font-style:italic;"><a name="bookmark2931"></a>Figure 18-8. Client requests intercepted by a switch and sent to a proxy</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2932"></a><span class="font24">An interception configuration depends on being able to set up the network between clients and servers so that all of the appropriate HTTP requests are physically channeled to the cache. (See</span><a href="#bookmark244"><span class="font24"> Chapter 20</span></a><span class="font24">). The content is distributed in the cache according to the requests it receives.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2933"></a><span class="font9" style="font-weight:bold;"><a name="bookmark175"></a><a name="bookmark2934"></a>Making Web Sites Fast</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Many of the technologies mentioned in the previous section also help web sites load faster. Server farms and distributed proxy caches or surrogate servers distribute network traffic, avoiding congestion. Distributing the content brings it closer to end users, so that the travel time from server to client is lower. The key to speed of resource access is how requests and responses are directed from client to server and back across the Internet. See</span><a href="#bookmark244"><span class="font24"> Chapter 20 </span></a><span class="font24">for details on redirection methods.</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Another approach to speeding up web sites is encoding the content for fast transportation. This can mean, for example, compressing the content, assuming that the receiving client can uncompress it. See </span><a href="#bookmark239"><span class="font24">Chapter 15 </span></a><span class="font24">for details.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark2935"></a><span class="font9" style="font-weight:bold;"><a name="bookmark176"></a><a name="bookmark2936"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">See </span><a href="#bookmark219"><span class="font24">Part III, </span><span class="font24" style="font-style:italic;">Identification, Authorization, and Security</span></a><span class="font24">, for details on how to make web sites secure. The following Internet drafts and documentation can give you more details about web hosting and content distribution:</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc3040.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc3040.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">RFC 3040, “Internet Web Replication and Caching Taxonomy,” is a reference for the vocabulary of web replication and caching applications.</span></p>
<p style="padding:0pt 0pt 3pt 19pt;"><a href="http://search.ietf.org/internet-drafts/draft-ietf-cdi-request-routing-reqs-00.txt"><span class="font24" style="font-style:italic;">http://search.ietf.org/internet-drafts/draft-ietf-cdi-request-routing-reqs-00.txt</span></a><span class="font24" style="font-style:italic;"> </span><span class="font24">“Request-Routing Requirements for Content Internetworking.”</span></p>
<p><span class="font24" style="font-style:italic;">Apache: The Definitive Guide</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Ben Laurie and Peter Laurie, O’Reilly &amp;&nbsp;Associates, Inc. This book describes how to run the open source Apache web server.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2937"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2938"></a><a name="bookmark243"></a>CHAPTER 19</span></p>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark2939"></a><span class="font11" style="font-weight:bold;"><a name="bookmark177"></a><a name="bookmark2940"></a>Publishing Systems</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1608"></a><span class="font24">How do you create web pages and get them onto a web server? In the dark ages of the Web (let’s say, 1995), you might have hand-crafted your HTML in a text editor and manually uploaded the content to the web server using FTP. This procedure was painful, difficult to coordinate with coworkers, and not particularly secure.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2941"></a><span class="font24"><a name="bookmark2942"></a>Modern-day publishing tools make it much more convenient to create, publish, and manage web content. Today, you can interactively edit web content as you’ll see it on the screen and publish that content to servers with a single click, while being notified of any files that have changed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Many of the tools that support remote publishing of content use extensions to the HTTP protocol. In this chapter, we explain two important technologies for webcontent publishing based on HTTP: FrontPage and DAV.</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2943"></a><span class="font9" style="font-weight:bold;"><a name="bookmark2944"></a><a name="bookmark178"></a><a name="bookmark2945"></a>FrontPage Server Extensions for Publishing Support</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">FrontPage (commonly referred to as FP) is a versatile web authoring and publishing toolkit provided by Microsoft Corp. The original idea for FrontPage (FrontPage 1.0) was conceived in 1994, at Vermeer Technologies, Inc., and was dubbed the first product to combine web site management and creation into a single, unified tool. Microsoft purchased Vermeer and shipped FrontPage 1.1 in 1996. The latest version, FrontPage Version 2002, is the sixth version in the line and a core part of the Microsoft Office suite.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2946"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2947"></a>FrontPage Server Extensions</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">As part of the “publish anywhere” strategy, Microsoft released a set of server-side software called FrontPage Server Extensions (FPSE). These server-side components integrate with the web server and provide the necessary translation between the web site and the client running FrontPage (and other clients that support these extensions).</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2948"></a><span class="font24">Our primary interest lies in the publishing protocol between the FP clients and FPSE. This protocol provides an example of designing extensions to the core services available in HTTP without changing HTTP semantics.</span></p>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><span class="font24">The FrontPage publishing protocol implements an RPC layer on top of the HTTP POST request. This allows the FrontPage client to send commands to the server to update documents on the web site, perform searches, collaborate amongst the web authors, etc.</span><a href="#bookmark2949"><span class="font24"> Figure 19-1 </span></a><span class="font24">gives an overview of the communication.</span></p>
<table>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p>
<p><span class="font1" style="font-weight:bold;">HTTP</span></p>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">HTTP request message contains the command and the URL</span></p></td></tr>
<tr><td><img src="book_files/book-547.jpg" alt="" style="width:323pt;height:93pt;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-style:italic;">FrontPage clients: FrontPage, MS Word, Excel, etc.</span></p>
<p><span class="font1" style="font-weight:bold;">FrontPage Server Extensions (FPSE)</span></p>
<p><a name="bookmark2949"></a><span class="font23" style="font-style:italic;">Fig<a name="bookmark2950"></a>ure 19-1. FrontPage publishing architecture</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark2951"></a><span class="font24">The web server sees POST requests addressed to the FPSE (implemented as a set of CGI programs, in the case of a non-Microsoft IIS server) and directs those requests accordingly. As long as intervening firewalls and proxy servers are configured to allow the POST method, FrontPage can continue communicating with the server.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2952"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2953"></a>FrontPage Vocabulary</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Be<a name="bookmark2954"></a>fore we dive deeper into the RPC layer defined by FPSE, it may help to establish the common vocabulary:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Virtual server</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">One of the multiple web sites running on the same server, each with a unique domain name and IP address. In essence, a virtual server allows a single web server to host multiple web sites, each of which appears to a browser as being hosted by its own web server. A web server that supports virtual servers is called a </span><span class="font24" style="font-style:italic;">multi-hosting</span><span class="font24"> web server. A machine that is configured with multiple IP addresses is called a </span><span class="font24" style="font-style:italic;">multi-homed</span><span class="font24"> server (for more details, please refer to</span><a href="#bookmark1052"><span class="font24"> “Vir</span></a><span class="font24"></span><a href="#bookmark1052"><span class="font24">tual Hosting” in Chapter 18</span></a><span class="font24">).</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Root web</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 19pt;"><span class="font24">The default, top-level content directory of a web server, or, in a multi-hosting environment, the top-level content directory of a virtual web server. To access the root web, it is enough to specify the URL of the server without specifying a page name. There can be only one root web per web server.</span></p>
<p><a name="bookmark2955"></a><span class="font24" style="font-style:italic;"><a name="bookmark2956"></a>Subweb</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><a name="bookmark2957"></a><span class="font24">A named subdirectory of the root web or another subweb that is a complete FPSE extended web. A subweb can be a complete independent entity with the ability to specify its own administration and authoring permissions. In addition, subwebs may provide scoping for methods such as searches.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2958"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2959"></a>The FrontPage RPC Protocol</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The FrontPage client and FPSE communicate using a proprietary RPC protocol. This protocol is layered on top of HTTP POST by embedding the RPC methods and their associated variables in the body of the POST request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">To start the process, the client needs to determine the location and the name of the target programs on the server (the part of the FPSE package that can execute the POST request). It then issues a special GET request (see</span><a href="#bookmark2960"><span class="font24"> Figure 19-2</span></a><span class="font24">).</span></p>
<p style="padding:0pt 0pt 4pt 23pt;"><span class="font1" style="font-style:italic;">HTTP request message contains the command and the URL</span></p>
<p style="text-indent:23pt;"><span class="font2">GET /_vti_inf.html HTTP/1.1</span></p>
<p style="text-indent:23pt;"><span class="font2">Date: Sat, 12 Aug 2000 20:31:24 GMT</span></p>
<p style="text-indent:23pt;"><span class="font2">User-agent: Mozilla/2.0 (compatible;MS FrontPage 4.0)</span></p>
<p style="text-indent:23pt;"><span class="font2">Host: taskserver:80</span></p>
<p style="text-indent:23pt;"><span class="font2">Accept: auth/sicily</span></p>
<p style="text-indent:23pt;"><span class="font2">Content-length: 0</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><a href="http://www.joes-hardware.com"><span class="font2" style="font-weight:bold;font-style:italic;">www.joes-hardware.com</span></a></p></td></tr>
<tr><td><img src="book_files/book-548.jpg" alt="" style="width:106pt;height:46pt;"></td></tr>
</table>
</div>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-549.jpg" alt="" style="width:42pt;height:37pt;"></td></tr>
<tr><td>
<p style="text-align:justify;"><a name="bookmark2961"></a><span class="font1" style="font-style:italic;">FrontPage clients</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">CGI ISAPI</span></p></td></tr>
<tr><td><img src="book_files/book-550.jpg" alt="" style="width:51pt;height:12pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">FrontPage Server Extensions (FPSE)</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark2960"></a><span class="font23" style="font-style:italic;"><a name="bookmark2962"></a>Figure 19-2. Initial request</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2963"></a><span class="font24">When the file is returned, the FrontPage client reads the response and finds the values associated with </span><span class="font4">FPShtmlScriptUrl</span><span class="font24">, </span><span class="font4">FPAuthorScriptUrl</span><span class="font24">, and </span><span class="font4">FPAdminScriptUrl</span><span class="font24">. Typically, this may look like:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">FPShtmlScriptUrl=&quot;_vti_bin/_vti_rpc/shtml.dll&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">FPAuthorScriptUrl=&quot;_vti_bin/_vti_aut/author.dll&quot;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">FPAdminScriptUrl=&quot;_vti_bin/_vti_adm/admin.dll&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font4">FPShtmlScriptUrl </span><span class="font24">tells the client where to POST requests for “browse time” commands (e.g., getting the version of FPSE) to be executed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font4">FPAuthorScriptUrl </span><span class="font24">tells the client where to POST requests for “authoring time” commands to be executed. Similarly, </span><span class="font4">FPAdminScriptUrl </span><span class="font24">tells FrontPage where to POST requests for administrative actions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Now that we know where the various programs are located, we are ready to send a request.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2964"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2965"></a>Request</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The body of the POST request contains the RPC command, in the form of “method=&lt;command&gt;” and any required parameters. For example, consider the RPC message requesting a list of documents, as follows:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">POST /_vti_bin/_vti_aut/author.dll HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Date: Sat, 12 Aug 2000 20:32:54 GMT</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 21pt 0pt;"><span class="font3">User-Agent: MSFrontPage/4.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;BODY&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font3">method=list+documents%3a4%2e0%2e2%2e3717&amp;service%5fname=&amp;listHiddenDocs=false&amp;listExp lorerDocs=false&amp;listRecurse=false&amp;listFiles=true&amp;listFolders=true&amp;listLinkInfo=true&amp;l istIncludeParent=true&amp;listDerived=false</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font3">&amp;listBorders=false&amp;listChildWebs=true&amp;initialUrl=&amp;folderList=%5b%3bTW%7c12+Aug+2000+2 0%3a33%3a04+%2d0000%5d</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2966"></a><span class="font24"><a name="bookmark2967"></a>The body of the POST command contains the RPC command being sent to the FPSE. As with CGI programs, the spaces in the method are encoded as plus sign (</span><span class="font4">+</span><span class="font24">) characters. All other nonalphanumeric characters in the method are encoded using </span><span class="font4">%</span><span class="font4" style="font-style:italic;">XX</span><span class="font24"> format, where the </span><span class="font4" style="font-style:italic;">XX</span><span class="font24"> stands for the ASCII representation of the character. Using this notation, a more readable version of the body would look like the following:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">method=list+documents:4.0.1.3717</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&amp;service_name=</span></p>
<p style="text-align:justify;text-indent:19pt;"><a name="bookmark2968"></a><span class="font3">&amp;listHiddenDocs=false</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">&amp;listExplorerDocs=false</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">Some of the elements listed are:</span></p>
<p><span class="font24" style="font-style:italic;">service_name</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The URL of the web site on which the method should act. Must be an existing folder or one level below an existing folder.</span></p>
<p><span class="font24" style="font-style:italic;">listHiddenDocs</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Shows the hidden documents in a web if its value is “true”. The “hidden” documents are designated by URLs with path components starting with “_”.</span></p>
<p><span class="font24" style="font-style:italic;">listExploreDocs</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font24">If the value is “true”, lists the task lists.</span></p>
<h4 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2969"></a><span class="font5" style="font-weight:bold;"><a name="bookmark2970"></a>Response</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Most RPC protocol methods have return values. Most common return values are for successful methods and errors. Some methods also have a third subsection, “Sample Return Code.” FrontPage properly interprets the codes to provide accurate feedback to the user.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Continuing with our example, the FPSE processes the “list+documents” request and returns the necessary information. A sample response follows:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">Date: Sat, 12 Aug 2000 22:49:50 GMT</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-type: application/x-vermeer-rpc</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">X-FrontPage-User-Name: IUSER_MINSTAR</span></p>
<p style="text-indent:19pt;"><a name="bookmark2971"></a><span class="font3">&lt;html&gt;&lt;head&gt;&lt;title&gt;RPC packet&lt;/title&gt;&lt;/head&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;body&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;p&gt;method=list documents: 4.0.2.3717</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;p&gt;document_list=</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;ul&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;li&gt;document_name=help.gif</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;\ul&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">As you can see from the response, a formatted list of documents available on the web server is returned to the FP client. You can find the complete list of commands and responses at the Microsoft web site.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2972"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2973"></a>FrontPage Security Model</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Any pub<a name="bookmark2974"></a>lishing system directly accessing web server content needs to be very conscious of the security implications of its actions. For the most part, FPSE depends on the web server to provide the security.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2975"></a><span class="font24">The FPSE security model defines three kinds of users: administrators, authors, and brow<a name="bookmark2976"></a>sers, with administrators having complete control. All permissions are cumulative; i.e., all administrators may author and browse the FrontPage web. Similarly, all authors have browsing permissions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The list of administrators, authors, and browsers is defined for a given FPSE extended web. All of the subwebs may inherit the permissions from the root web or set their own. For non-IIS web servers, all the FPSE programs are required to be stored in directories marked “executable” (the same restriction as for any other CGI program). </span><span class="font24" style="font-style:italic;">Fpsrvadm</span><span class="font24">, the FrontPage server administrator utility, may be used for this purpose. On IIS servers, the integrated Windows security model prevails.</span></p>
<p style="text-align:justify;"><span class="font24">On non-IIS servers, web server access-control mechanisms specify the users who are allowed to access a given program. On Apache and NCSA web servers, the file is named </span><span class="font24" style="font-style:italic;">.htaccess</span><span class="font24">; on Netscape servers, it is named </span><span class="font24" style="font-style:italic;">.nsconfig</span><span class="font24">. The access file associates users, groups, and IP addresses with various levels of permissions: GET (read), POST (execute), etc. For example, for a user to be an author on an Apache web server, the </span><span class="font24" style="font-style:italic;">.htaccess</span><span class="font24"> file should permit that user to POST to </span><span class="font24" style="font-style:italic;">author.exe</span><span class="font24">. These accessspecification files often are defined on a per-directory basis, providing greater flexibility in defining the permissions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark1614"></a><span class="font24"><a name="bookmark2977"></a><a name="bookmark2978"></a><a name="bookmark2979"></a>On IIS servers, the permissions are checked against the ACLs for a given root or subroot. When IIS gets a request, it first logs on and impersonates the user, then sends the request to one of the three extension dynamic link libraries (DLLs). The DLL checks the impersonation credentials against the ACL defined for the destination folder. If the check is successful, the requested operation is executed by the extension DLL. Otherwise, a “permission denied” message is sent back to the client. Given the tight integration of Windows security with IIS, the User Manager may be used to define fine-grained control.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In spite of this elaborate security model, enabling FPSE has gained notoriety as a nontrivial security risk. In most cases, this is due to sloppy practices adopted by web site administrators. However, the earlier versions of FPSE did have severe security loopholes and thus contributed to the general perception of security risk. This problem also was exacerbated by the arcane practices needed to fully implement a tight security model.</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark2980"></a><span class="font9" style="font-weight:bold;"><a name="bookmark179"></a><a name="bookmark2981"></a>WebDAV and Collaborative Authoring</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2982"></a><span class="font24">Web Distributed Authoring and Versioning (WebDAV) adds an extra dimension to web publishing—collaboration. Currently, the most common practice of collaboration is decidedly low-tech: predominantly email, sometimes combined with distributed fileshares. This practice has proven to be very inconvenient and error-prone, with little or no control over the process. Consider an example of launching a multinational, multilingual web site for an automobile manufacturer. It’s easy to see the need for a robust system with secure, reliable publishing primitives, along with collaboration primitives such as locking and versioning.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">WebDAV (published as RFC 2518) is focused on extending HTTP to provide a suitable platform for collaborative authoring. It currently is an IETF effort with support from various vendors, including Adobe, Apple, IBM, Microsoft, Netscape, Novell, Oracle, and Xerox.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2983"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2984"></a>WebDAV Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">WebDAV defines a set of new HTTP methods and modifies the operational scope of a few other HTTP methods. The new methods added by WebDAV are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">PROPFIND</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Retrieves the properties of a resource.</span></p>
<p><span class="font24" style="font-style:italic;">PROPPATCH</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Sets one or more properties on one or many resources.</span></p>
<p><span class="font24" style="font-style:italic;">MKCOL</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Creates collections.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">COPY</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Copies a resource or a collection of resources from a given source to a given destination. The destination need not be on the same machine.</span></p>
<p style="text-align:justify;"><a name="bookmark2985"></a><span class="font24" style="font-style:italic;">MOVE</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Moves a resource or a collection of resources from a given source to a given destination. The destination need not be on the same machine.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">LOCK</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Locks a resource or multiple resources.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">UNLOCK</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">Unlocks a previously locked resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark2986"></a><span class="font24">HTTP methods modified by WebDAV are DELETE, PUT, and OPTIONS. Both the new and the modified methods are discussed in detail later in this chapter.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2987"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2988"></a>WebDAV and XML</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2989"></a><span class="font24">WebDAV’s methods generally require a great deal of information to be associated with both requests and responses. HTTP usually communicates this information in message headers. However, transporting necessary information in headers alone imposes some limitations, including the difficulties of selective application of header information to multiple resources in a request, to represent hierarchy, etc.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">To solve this problem, WebDAV embraces the Extensible Markup Language (XML), a meta-markup language that provides a format for describing structured data. XML provides WebDAV with:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A method of formatting instructions describing how data is to be handled</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A method o<a name="bookmark2990"></a>f formatting complex responses from the server</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2991"></a><span class="font24">• A method of communicating customized information about the collections and resources handled</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A flexible vehicle for the data itself</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• A robust solution for most of the internationalization issues</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Traditionally, the schema definition for XML documents is kept in a Document Type Definition (DTD) file that is referenced within the XML document itself. Therefore, when trying to interpret an XML document, the DOCTYPE definition entity gives the name of the DTD file associated with the XML document in question.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">WebDAV defines an explicit XML namespace, “DAV:”. Without going into many details, an XML namespace is a collection of names of elements or attributes. The namespace qualifies the embedded names uniquely across the domain, thus avoiding any name collisions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The complete XML schema is defined in the WebDAV specification, RFC 2518. The presence of a predefined schema allows the parsing software to make assumptions on the XML schema without having to read in DTD files and interpret them correctly.</span></p>
<h3 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark2992"></a><span class="font7" style="font-weight:bold;"><a name="bookmark2993"></a><a name="bookmark2994"></a><a name="bookmark2995"></a><a name="bookmark2996"></a>WebDAV Headers</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">WebDAV does introduce several HTTP headers to augment the functionality of the new methods. This section provides a brief overview; see RFC 2518 for more information. The new headers are:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">DAV</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Used to communicate the WebDAV capabilities of the server. All resources supported by WebDAV are required to return this header in the response to the OPTIONS request. See</span><a href="#bookmark2997"><span class="font24"> “The OPTIONS method</span></a><span class="font24">” for more details.</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">DAV = &quot;DAV&quot; &quot;:&quot; &quot;1&quot; [&quot;,&quot; &quot;2&quot;] [&quot;,&quot; 1#extend]</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font24" style="font-style:italic;">Depth</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark2998"></a><span class="font24">The crucial element for extending WebDAV to grouped resources with multiple levels of hierarchy (for more detailed explanation about collections, please refer to</span><a href="#bookmark2999"><span class="font24"> “Collections and Namespace Management</span></a><span class="font24">”).</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Depth = &quot;Depth&quot; &quot;:&quot; (&quot;0&quot; | &quot;1&quot; | &quot;infinity&quot;)</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark3000"></a><span class="font24">Let’s look at a simple example. Consider a directory </span><span class="font24" style="font-style:italic;">DIR_A</span><span class="font24"> with files </span><span class="font24" style="font-style:italic;">file_1.html </span><span class="font24">and </span><span class="font24" style="font-style:italic;">file_2.html</span><span class="font24">. If a method uses Depth: 0, the method applies to the </span><span class="font24" style="font-style:italic;">DIR_A</span><span class="font24"> directory alone, and Depth: 1 applies to the </span><span class="font24" style="font-style:italic;">DIR_A</span><span class="font24"> directory and its files, </span><span class="font24" style="font-style:italic;">file_1.html </span><span class="font24">and </span><span class="font24" style="font-style:italic;">file_2.html</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">The Depth header modifies many WebDAV-defined methods. Some of the methods that use the Depth header are LOCK, COPY, and MOVE.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Destination</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Defined to assist the COPY or MOVE methods in identifying the destination URI.</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Destination = &quot;Destination&quot; &quot;:&quot; absoluteURI</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">If</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark3001"></a><span class="font24">The only defined state token is a lock token (see</span><a href="#bookmark3002"><span class="font24"> “The LOCK Method</span></a><span class="font24">”). The If header defines a set of conditionals; if they all evaluate to false, the request will fail. Methods such as COPY and PUT conditionalize the applicability by specifying preconditions in the If header. In practice, the most common precondition to be satisfied is the prior acquisition of a lock.</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font3">If = &quot;If&quot; &quot;:&quot; (1*No-tag-list | 1*Tagged-list)</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">No-tag-list = List</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Tagged-list = Resource 1*List</span></p>
<p style="text-align:justify;text-indent:49pt;"><span class="font3">Resource = Coded-URL</span></p>
<p style="text-align:justify;padding:0pt 71pt 2pt 49pt;"><span class="font3">List = &quot;(&quot; 1*([&quot;Not&quot;](State-token | &quot;[&quot; entity-tag &quot;]&quot;)) &quot;)&quot; State-token = Coded-URL</span></p>
<p style="text-align:justify;text-indent:49pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Coded-URL = &quot;&lt;&quot;&nbsp;absoluteURI &quot;&gt;&quot;</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Lock-Token</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Used by the UNLOCK method to specify the lock that needs to be removed. A response to a LOCK method also has a Lock-Token header, carrying the necessary information about the lock taken.</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Lock-Token = &quot;Lock-Token&quot; &quot;:&quot; Coded-URL</span></p>
<p style="text-align:justify;"><a name="bookmark3003"></a><span class="font24" style="font-style:italic;"><a name="bookmark3004"></a>Overwrite</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Used by the COPY and MOVE methods to designate whether the destination should be overwritten. See the discussion of the COPY and MOVE methods later in this chapter for more details.</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Overwrite = &quot;Overwrite&quot; &quot;:&quot; (&quot;T&quot; | &quot;F&quot;)</span></p>
<p style="text-align:justify;"><a name="bookmark3005"></a><span class="font24" style="font-style:italic;">Timeout</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">A request header used by a client to specify a desired lock timeout value. For more information, refer to the section</span><a href="#bookmark3006"><span class="font24"> “Lock refreshes and the Timeout header</span></a><span class="font24">.”</span></p>
<p style="text-indent:37pt;"><span class="font3">TimeOut = &quot;Timeout&quot; &quot;:&quot; 1#TimeType</span></p>
<p style="text-indent:37pt;"><span class="font3">TimeType = (&quot;Second-&quot; DAVTimeOutVal | &quot;Infinite&quot; | Other)</span></p>
<p style="text-indent:37pt;"><span class="font3">DAVTimeOutVal = 1*digit</span></p>
<p style="text-indent:37pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Other = &quot;Extend&quot; field-value</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Now that we have sketched the intent and implementation of WebDAV, let’s look more closely at the functions provided.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3007"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3008"></a>WebDAV Locking and Overwrite Prevention</span></h3>
<p style="text-align:justify;"><span class="font24">By definition, collaboration requires more than one person working on a given document. The inherent problem associated with collaboration is illustrated in</span><a href="#bookmark3009"><span class="font24"> Figure 19-3</span></a><span class="font24">.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-551.jpg" alt="" style="width:75pt;height:50pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">B’s copy</span></p></td></tr>
<tr><td><img src="book_files/book-552.jpg" alt="" style="width:62pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author B</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-553.jpg" alt="" style="width:65pt;height:37pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author A &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shared file repository</span></p></td></tr>
<tr><td><img src="book_files/book-554.jpg" alt="" style="width:175pt;height:50pt;"></td></tr>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author A &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shared file repository</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">B’s copy</span></p></td></tr>
<tr><td><img src="book_files/book-555.jpg" alt="" style="width:62pt;height:35pt;"></td></tr>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author B</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-556.jpg" alt="" style="width:172pt;height:47pt;"></td><td>
<p><span class="font1" style="font-style:italic;">“B” also publishes and overwrites “A”’s changes</span></p></td></tr>
<tr><td colspan="2">
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author A &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shared file repository</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-557.jpg" alt="" style="width:39pt;height:13pt;"></td></tr>
<tr><td>
<p><span class="font2" style="font-weight:bold;font-style:italic;">Author B</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3009"></a><span class="font23" style="font-style:italic;">Figure 19-3. Lost update problem</span></p>
<p style="text-align:justify;"><span class="font24">In this example, authors A and B are jointly writing a specification. A and B independently make a set of changes to the document. A pushes the updated document to the repository, and at a later point, B posts her own version of the document into the repository. Unfortunately, because B never knew about A’s changes, she never merged her version with A’s version, resulting in A’s work being lost.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3010"></a><span class="font24">To ameliorate the problem, WebDAV supports the concept of locking. Locking alone will not fully solve the problem. Versioning and messaging support are needed to complete the solution.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">WebDAV supports two types of locks:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;"><span class="font24">• Exclusive write locking of a resource or a collection</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Shared write locking of a resource or a collection</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3011"></a><span class="font24">An </span><span class="font24" style="font-style:italic;">exclusive</span><span class="font24"> write lock guarantees write privileges only to the lock owner. This type of locking completely eliminates potential conflicts. A </span><span class="font24" style="font-style:italic;">shared</span><span class="font24"> write lock allows a group of people to work on a given document. This type of locking works well in an environment where all the authors are aware of each other’s activities. WebDAV provides a property discovery mechanism, via PROPFIND, to determine the support for locking and the types of locks supported.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">WebDAV has two new methods to support locking: LOCK and UNLOCK.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3012"></a><span class="font24">To accomplish locking, there needs to be a mechanism for identifying the author. WebDAV requires digest authentication (discussed in</span><a href="#bookmark2083"><span class="font24"> Chapter 13</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">When a lock is granted, the server returns a token that is unique across the domain to the client. The specification refers to this as the </span><span class="font4">opaquelocktoken </span><span class="font24">lock token URI scheme. When the client subsequently wants to perform a write, it connects to the server and completes the digest authentication sequence. Once the authentication is complete, the WebDAV client presents the lock token, along with the PUT request. Thus, the combination of the correct user and the lock token is required to complete the write.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3002"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3013"></a><a name="bookmark3014"></a>The LOCK Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A powerful feature of WebDAV is its ability to lock multiple resources with a single LOCK request. WebDAV locking does not require the client to stay connected to the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, here’s a simple LOCK request:</span></p>
<p style="text-indent:19pt;"><span class="font3">LOCK /ch-publish.fm HTTP/1.1</span></p>
<p style="text-indent:19pt;"><span class="font3">Host: minstar</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/xml</span></p>
<p style="text-indent:19pt;"><span class="font3">User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT)</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Content-Length: 201</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;?xml version=&quot;1.0&quot;?&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:lockinfo xmlns:a=&quot;DAV:&quot;&gt;</span></p>
<p style="text-indent:39pt;"><span class="font3">&lt;a:lockscope&gt;&lt;a:exclusive/&gt;&lt;/a:lockscope&gt;</span></p>
<p style="text-indent:39pt;"><span class="font3">&lt;a:locktype&gt;&lt;a:write/&gt;&lt;/a:locktype&gt;</span></p>
<p style="text-indent:39pt;"><span class="font3">&lt;a:owner&gt;&lt;a:href&gt;AuthorA&lt;/a:href&gt;&lt;/a:owner&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/a:lockinfo&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3015"></a><span class="font24">The XML being submitted has the &lt;lockinfo&gt; element as its base element. Within the &lt;lockinfo&gt; structure, there are three subelements:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;locktype&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">Indicates the type of lock. Currently there is only one, “write.”</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;lockscope&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">Indicates whether this is an exclusive lock or a shared lock.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;owner&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Field is set with the person who holds the current lock.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s a successful response to our LOCK request:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">Date: Fri, 10 May 2002 20:56:18 GMT</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/xml</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">Content-Length: 419</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;?xml version=&quot;1.0&quot;?&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:prop xmlns:a=&quot;DAV:&quot;&gt;</span></p>
<p style="text-indent:19pt;"><a name="bookmark3016"></a><span class="font3">&lt;a:lockdiscovery&gt;&lt;a:activelock&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:locktype&gt;&lt;a:write/&gt;&lt;/a:locktype&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:lockscope&gt;&lt;a:exclusive/&gt;&lt;/a:lockscope&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:owner xmlns:a=&quot;DAV:&quot;&gt;&lt;a:href&gt;AutherA&lt;/a:href&gt;&lt;/a:owner&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:locktoken&gt;&lt;a:href&gt;opaquelocktoken:*****&lt;/a:href&gt;&lt;/a:locktoken&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:depth&gt;0&lt;/a:depth&gt;</span></p>
<p style="text-indent:19pt;"><a name="bookmark3017"></a><span class="font3">&lt;a:timeout&gt;Second-180&lt;/a:timeout&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;/a:activelock&gt;&lt;/a:lockdiscovery&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/a:prop&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3018"></a><span class="font24">The &lt;lockdiscovery&gt; element acts as a container for information about the lock. Embedded in the &lt;lockdiscovery&gt; element is an &lt;activelock&gt; subelement that holds the information sent with the request (&lt;locktype&gt;, &lt;lockscope&gt;, and &lt;owner&gt;). In addition, &lt;activelock&gt; has the following subelements:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;l<a name="bookmark3019"></a>ocktoken&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">Uniquely identifies the lock in a URI scheme called </span><span class="font4">opaquelocktoken</span><span class="font24">. Given the stateless nature of HTTP, this token is used to identify the ownership of the lock in future requests.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;depth&gt;</span></p>
<p style="text-indent:19pt;"><span class="font24">Mirrors the value of the Depth header.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;timeout&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><span class="font24">Indicates the timeout associated with the lock. In the above response </span><a href="#bookmark3009"><span class="font24">(Figure 19-3</span></a><span class="font24">), the timeout value is 180 seconds.</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3020"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3021"></a>The opaquelocktoken scheme</span></h4>
<p style="text-align:justify;"><span class="font24">The </span><span class="font4">opaquelocktoken </span><span class="font24">scheme is designed to provide a unique token across all resources for all times. To guarantee uniqueness, the WebDAV specification mandates the use of the universal unique identifier (UUID) mechanism, as described in ISO-11578.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark3022"></a><span class="font24"><a name="bookmark3023"></a>When it comes to actual implementation, there is some leeway. The server has the choice of generating a UUID for each LOCK request, or generating a single UUID and maintaining the uniqueness by appending extra characters at the end. For performance considerations, the latter choice is better. However, if the server chooses to implement the latter choice, it is required to guarantee that none of the added extensions will ever be reused.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3024"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3025"></a>The &lt;lockdiscovery&gt; XML element</span></h4>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><a name="bookmark3026"></a><span class="font24">The &lt;lockdiscovery&gt; XML element provides a mechanism for active lock discovery. If others try to lock the file while a lock is in place, they will receive a &lt;lockdiscovery&gt; XML element that indicates the current owner. The &lt;lockdiscovery&gt; element lists all outstanding locks along with their properties.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3006"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3027"></a><a name="bookmark3028"></a>Lock refreshes and the Timeout header</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To refresh a lock, a client needs to resubmit a lock request with the lock token in the If header. The timeout value returned may be different from the earlier timeout values.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Instead of accepting the timeout value given by the server, a client may indicate the timeout value required in the LOCK request. This is done through the Timeout header. The syntax of the Timeout header allows the client to specify a few options in a comma-separated list. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Timeout : Infinite, Second-86400</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3029"></a><span class="font24">The server is not obligated to honor either of the options. However, it is required to provide the lock expiration time in the &lt;timeout&gt; XML element. In all cases, lock timeout is only a guideline and is not necessarily binding on the server. The administrator may do a manual reset, or some other extraordinary event may cause the server to reset the lock. The clients should avoid taking lengthy locks.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">In spite of these primitives, we may not completely solve the “lost update problem” illustrated in </span><a href="#bookmark3009"><span class="font24">Figure 19-3</span></a><span class="font24">. To completely solve it, a cooperative event system with a versioning control is needed.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3030"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3031"></a>The UNLOCK Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The UNLOCK method removes a lock on a resource, as follows:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">UNLOCK /ch-publish.fm HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Host: minstar.inktomi.com</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT)</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Lock-Token:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">opaquelocktoken:*********</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.1 204 OK</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Date: Fri, 10 May 2002 20:56:18 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3032"></a><span class="font24">As with most resource management requests, WebDAV has two requirements for UNLOCK to succeed: prior completion of a successful digest authentication sequence, and matching the lock token that is sent in the Lock-Token header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">If the unlock is successful, a 204 No Content status code is returned to client. </span><a href="#bookmark3033"><span class="font24">Table 19-1 </span></a><span class="font24">summarizes the possible status codes with the LOCK and UNLOCK methods.</span></p>
<table>
<tr><td>
<p><a name="bookmark3033"></a><span class="font23" style="font-style:italic;">Table 19-1. Status codes for LOCK and UNLOCK methods</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Defined by</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Method</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Effect</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">200 OK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates successful locking.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">201 Created</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates that a lock on a nonexistent resource succeeded by creating the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">204 No Content</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UNLOCK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Indicates successful unlocking.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">207 Multi-Status</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The request was for locking multiple resources. Not all status codes returned were the same. Hence, they are all encapsulated in a 207 response.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">403 Forbidden</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Indicates that the client does not have permission to lock the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3034"></a><span class="font2">412 Precondition Failed</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Either the XML sent with the LOCK command indicated a condition to be satisfied and the server failed to complete the required condition, or the lock token could not be enforced.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">422 Unprocessable Property</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Inapplicable semantics—an example may be specifying a nonzero Depth for a resource that is not a collection.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">423 Locked</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Already locked.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">424 Failed Dependency</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UNLOCK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">UNLOCK specifies other actions and their success as a condition for the unlocking. This error is returned if the dependency fails to complete.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3035"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3036"></a>Properties and META Data</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Properties describe information about the resource, including the author’s name, modification date, content rating, etc. META tags in HTML do provide a mechanism to embed this information as part of the content; however, many resources (such as any binary data) have no capability for embedding META data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A distributed collaborative system such as WebDAV adds more complexity to the property requirement. For example, consider an author property: when a document gets edited, this property needs to be updated to reflect the new authors. WebDAV terms such dynamically modifiable properties “live” properties. The more permanent, static properties, such as Content-Type, are termed “dead” properties.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">To support discovery and modification of properties, WebDAV extends HTTP to include two new methods, PROPFIND and PROPPATCH. Examples and corresponding XML elements are described in the following sections.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3037"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3038"></a><a name="bookmark3039"></a>The PROPFIND Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The PROPFIND (property find) method is used for retrieving the properties of a given file or a group of files (also known as a “collection”). PROPFIND supports three types of operations:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;"><span class="font24">• Request all properties and their values.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;"><span class="font24">• Re<a name="bookmark3040"></a>quest a selected set of properties and values.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3041"></a><span class="font24">• Request all property names.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s the scenario where all the properties and their values are requested:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">PROPFIND /ch-publish.fm HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Host: minstar.inktomi.com</span></p>
<p style="text-align:justify;text-indent:19pt;"><a name="bookmark3042"></a><span class="font3">User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT)</span></p>
<p style="text-indent:19pt;"><span class="font3">Depth: 0</span></p>
<p style="text-indent:19pt;"><span class="font3">Cache-Control: no-cache</span></p>
<p style="text-indent:19pt;"><a name="bookmark3043"></a><span class="font3">Connection: Keep-Alive</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Length: 0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The &lt;propfind&gt; request element specifies the properties to be returned from a PROPFIND method. The following list summarizes a few XML elements that are used with PROPFIND requests:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;allprop&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">Requires all property names and values to be returned. To request all properties and their values, a WebDAV client may either send an &lt;allprop&gt; XML subelement as part of the &lt;propfind&gt; element, or submit a request with no body.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;propname&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">Specifies the set of property names to be returned.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;prop&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">A subelement of the &lt;propfind&gt; element. Specifies a specific property whose value is to be returned. For example: “&lt;a:prop&gt; &lt;a:owner /&gt;.....&lt;/a:prop&gt;”.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s a response to a sample PROPFIND request:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.1 207 Multi-Status</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 21pt 0pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;?xml version=&quot;1.0&quot;?&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;a:multistatusxmlns:b=&quot;urn:uuid:********/&quot; xmlns:c=&quot;xml:&quot; xmlns:a=&quot;DAV:&quot;&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">&lt;a:response&gt;</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font3">&lt;a:href&gt;</span><a href="http://minstar/ch-publish.fm"><span class="font3">http://minstar/ch-publish.fm</span></a><span class="font3"> &lt;/a:href&gt;</span></p>
<p style="text-align:justify;text-indent:27pt;"><span class="font3">&lt;a:propstat&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">&lt;a:status&gt;HTTP/1.1 200OK&lt;/a:status&gt;</span></p>
<p style="text-align:justify;text-indent:35pt;"><span class="font3">&lt;a:prop&gt;</span></p>
<p style="text-align:justify;text-indent:43pt;"><span class="font3">&lt;a:getcontentlength b:dt=&quot;int&quot;&gt;1155&lt;/a:getcontentlength&gt;</span></p>
<p style="text-indent:43pt;"><a name="bookmark3044"></a><span class="font3"><a name="bookmark3045"></a>&lt;a:ishidden b:dt=&quot;boolean&quot;&gt;0&lt;/a:ishidden&gt;</span></p>
<p style="text-indent:43pt;"><a name="bookmark3046"></a><span class="font3">&lt;a:iscollection b:dt=&quot;boolean&quot;&gt;0&lt;/a:iscollection&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;/a:prop&gt;</span></p>
<p style="text-indent:27pt;"><span class="font3">&lt;/a:propstat&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/a:response&gt;&lt;/a:multistatus&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3047"></a><span class="font24"><a name="bookmark3048"></a>In this example, the server responds with a 207 Multi-Status code. WebDAV uses the 207 response for PROPFIND and a few other WebDAV methods that act simultaneously on multiple resources and potentially have different responses for each resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A few XML elements in the response need to be defined:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;multistatus&gt;</span></p>
<p style="text-indent:19pt;"><span class="font24">A container for multiple responses.</span></p>
<p><span class="font24" style="font-style:italic;">&lt;href&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">Identifies the resource’s URI.</span></p>
<p><span class="font24" style="font-style:italic;">&lt;status&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24">Contains the HTTP status code for the particular request.</span></p>
<p><span class="font24" style="font-style:italic;">&lt;propstat&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Groups one &lt;status&gt; element and one &lt;prop&gt; element. The &lt;prop&gt; element may contain one or more property name/value pairs for the given resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3049"></a><span class="font24">In the sample response listed above, the response is for one URI, </span><a href="http://minstar/ch-publish.fm"><span class="font24" style="font-style:italic;">http://minstar/ch-publish.fm</span></a><span class="font24">. The &lt;propstat&gt; element embeds one &lt;status&gt; element and one &lt;prop&gt; element. For this URI, the server returned a 200 OK response, as defined by the &lt;status&gt; element. The &lt;prop&gt; el<a name="bookmark3050"></a>ement has several subele<a name="bookmark3051"></a>ments; only some are listed in the example.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3052"></a><span class="font24">One instant application of PROPFIND is the support for directory listing. Given the expressability of a PROPFIND request, one single call can retrieve the entire hierarchy of the collection with all the properties of individual entities.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3053"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3054"></a>The PROPPATCH Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The PROPPATCH method provides an atomic mechanism to set or remove multiple properties on a given resource. The atomicity will guarantee that either all of the requests are successful or none of them made it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The base XML element for the PROPPATCH method is &lt;propertyupdate&gt;. It acts as a container for all the properties that need updating. The XML elements &lt;set&gt; and &lt;remove&gt; are used to specify the operation:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">&lt;set&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Specifies the property values to be set. The &lt;set&gt; contains one or more &lt;prop&gt; subelements, which in turn contains the name/value pairs of the properties to be set for the resource. If the property already exists, the value is replaced.</span></p>
<p><a name="bookmark3055"></a><span class="font24" style="font-style:italic;">&lt;remove&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Specifies the properties that are to be removed. Unlike with &lt;set&gt;, only the names of the properties are listed in the &lt;prop&gt; container.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">This trivial example sets and removes the “owner” property:</span></p>
<p style="text-indent:23pt;"><span class="font3">&lt;d:propertyupdate xmlns:d=&quot;DAV:&quot; xmlns:o=&quot;</span><a href="http://name-space/scheme/"><span class="font3">http://name-space/scheme/</span></a><span class="font3">&quot;&gt;</span></p>
<p style="text-indent:27pt;"><span class="font3">&lt;d:set&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;d:prop&gt;</span></p>
<p style="text-indent:43pt;"><span class="font3">&lt;o:owner&gt;Author A&lt;/o:owner&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;/d:prop&gt;</span></p>
<p style="text-indent:27pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">&lt;/d:set&gt;</span></p>
<p style="text-indent:27pt;"><span class="font3">&lt;d:remove&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;d:prop&gt;</span></p>
<p style="text-indent:43pt;"><span class="font3">&lt;o:owner/&gt;</span></p>
<p style="text-indent:35pt;"><span class="font3">&lt;/d:prop&gt;</span></p>
<p style="text-indent:27pt;"><span class="font3">&lt;/d:remove&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/d:propertyupdate&gt;</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The response to PROPPATCH requests is very similar to that for PROPFIND requests. For more information, refer to RFC 2518.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3056"><span class="font24">Table 19-2 </span></a><span class="font24">summarizes the status codes for the PROPFIND and PROPPATCH methods.</span></p>
<table>
<tr><td>
<p><a name="bookmark3056"></a><span class="font23" style="font-style:italic;">Table 19-2. Status codes for PROPFIND and PROPPATCH methods</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Defined by</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Methods</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Effect</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">200 OK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPFIND, PROPPATCH</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Command success.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">207 Multi-Status</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WEBDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPFIND, PROPPATCH</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3057"></a><span class="font2">When acting on one or more resources (or a collection), the status for each object is encapsulated into one 207 response. This is a typical success response.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark3058"></a><span class="font2">401 Unauthorized</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPATCH</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Requires authorization to complete the property modification operation.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">403 Forbidden</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPFIND, PROPPATCH</span></p></td><td style="vertical-align:top;">
<p><span class="font2">For PROPFIND, the client is not allowed to access the property. For PROPPATCH, the client may not change the property.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">404 Not Found</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PROPFIND</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">No such property.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">409 Conflict</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPPATCH</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Conflict of update semantics—for example, trying to update a read-only property.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">423 Locked</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PROPPATCH</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Destination resource is locked and there is no lock token or the lock token does not match.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">507 Insufficient Storage</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PROPPATCH</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Not enough space for registering the modified property.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark2999"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3059"></a><a name="bookmark3060"></a>Collections and Namespace Management</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A collection refers to a logical or physical grouping of resources in a predefined hier-achy. A classic example of a collection is a directory. Like directories in a filesystem, <a name="bookmark3061"></a>col<a name="bookmark3062"></a>lections act as containers of other resources, including other collections (equivalent to directories on the filesystem).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">WebDAV uses the XML namespace mechanism. Unlike traditional namespaces, XML namespace partitions allow for precise structural control while preventing any namespace collisions.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">WebDAV provides five methods for manipulating the namespace: DELETE, MKCOL, COPY, MOVE, and PROPFIND. PROPFIND was discussed previously in this chapter, but let’s talk about the other methods.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3063"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3064"></a>The MKCOL Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The MKCOL method allows clients to create a collection at the indicated URL on the server. At first sight, it may seem rather redundant to define an entire new method just for creating a collection. Overlaying on top of a PUT or POST method seems like a perfect alternative. The designers of the WebDAV protocol did consider these alternatives and still chose to define a new method. Some of the reasons behind that decision are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• To have a PUT or a POST create a collection, the client needs to send some extra “semantic glue” along with the request. While this certainly is feasible, defining an ad hoc protocol may become tedious and error-prone.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• Most of the access-control mechanisms are based on the type of methods—only a few are allowed to create and delete resources in the repository. If we overload other methods, these access-control mechanisms will not work.</span></p></li></ul>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">For example, a request might be:</span></p>
<p style="text-indent:19pt;"><span class="font3">MKCOL /publishing HTTP/1.1</span></p>
<p style="text-indent:19pt;"><span class="font3">Host: minstar</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-Length: 0</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Connection: Keep-Alive</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">And the response might be:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 201 Created</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">Date: Fri, 10 May 2002 23:20:36 GMT</span></p>
<p style="text-indent:19pt;"><span class="font3">Location: </span><a href="http://minstar/publishing/"><span class="font3">http://minstar/publishing/</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Length: 0</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Let us examine a few pathological cases:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• Suppose the collection already exists. If a MKCOL /colA request is made and colA already exists (i.e., namespace conflict), the request will fail with a 405 Method Not Allowed status code.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">• If there are no write permissions, the MKCOL request will fail with a 403 Forbidden status code.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark3065"></a><span class="font24">• If a request such as MKCOL /colA/colB is made and colA does not exist, the request will fail with a 409 Conflict status code.</span></p></li></ul>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">Once the file or collection is created, we can delete it with the DELETE method.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3066"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3067"></a>The DELETE Method</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We already saw the DELETE method in</span><a href="#bookmark524"><span class="font24"> Chapter 3</span></a><span class="font24">. WebDAV extends the semantics to cover collections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If we need to delete a directory, the Depth header is needed. If the Depth header is not specified, the DELETE method assumes the Depth header to be set to infinity— that is, all the files in the directory and any subdirectories thereof are deleted. The response also has a Content-Location header identifying the collection that just got deleted. The request might read:</span></p>
<p style="text-indent:19pt;"><span class="font3">DELETE /publishing HTTP/1.0</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Host: minstar</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">And the response might read:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">Date: Tue, 14 May 2002 16:41:44 GMT</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-Location: </span><a href="http://minstar/publishing/"><span class="font3">http://minstar/publishing/</span></a></p>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/xml</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Length: 0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When removing collections, there always is a chance that a file in the collection is locked by someone else and can’t be deleted. In such a case, the collection itself can’t be deleted, and the server replies with a 207 Multi-Status status code. The request might read:</span></p>
<p style="text-indent:19pt;"><span class="font3">DELETE /publishing HTTP/1.0</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Host: minstar</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">And the response might read:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 207 Multi-Status</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Location: </span><a href="http://minstar/publishing/"><span class="font3">http://minstar/publishing/</span></a></p>
<p style="text-indent:19pt;"><span class="font3">&lt;?xml version=&quot;1.0&quot;?&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:multistatus xmlns:a=&quot;DAV:&quot;&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:response&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:href&gt;</span><a href="http://minstar/index3/ch-publish.fm%3c/a:href"><span class="font3">http://minstar/index3/ch-publish.fm&lt;/a:href</span></a><span class="font3">&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;a:status&gt; HTTP/1.1 423 Locked &lt;/a:status&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">&lt;/a:response&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">&lt;/a:multistatus&gt;</span></p>
<p style="text-align:justify;"><span class="font24">In this transaction, the &lt;status&gt; XML element contains the status code 403 Locked, indicating that the resource </span><span class="font24" style="font-style:italic;">ch-publish.fm</span><span class="font24"> is locked by another user.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3068"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3069"></a>The COPY and MOVE Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3070"></a><span class="font24">As with MKCOL, there are alternatives to defining new methods for COPY and MOVE operations. One such alternative for the COPY method is to do a GET request on the source, thus downloading the resource, and then to upload it back to the server with a PUT request. A similar scenario could be envisioned for MOVE (with the additional DELETE operation). However, this process does not scale well—consider all the issues involved in managing a COPY or MOVE operation on a multilevel collection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Both the COPY and MOVE methods use the request URL as the source and the contents of the Destination HTTP header as the target. The MOVE method performs some additional work beyond that of the COPY method: it copies the source URL to the destination, checks the integrity of the newly created URI, and then deletes the source. The request might read:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">{COPY,MOVE} /publishing HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Destination: </span><a href="http://minstar/pub-new"><span class="font3">http://minstar/pub-new</span></a></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Depth: infinity</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Overwrite: T</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Host: minstar</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">And the response might read:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 201 Created</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">Date: Wed, 15 May 2002 18:29:53 GMT</span></p>
<p style="text-indent:19pt;"><span class="font3">Location: </span><a href="http://minstar.inktomi.com/pub-new/"><span class="font3">http://minstar.inktomi.com/pub-new/</span></a></p>
<p style="text-indent:19pt;"><span class="font3">Content-Type: text/xml</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Content-Length: 0</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When acting on a collection, the behavior of <a name="bookmark3071"></a>COPY or MOVE is affected by the Depth header. In the absence of the Depth header, infinity is assumed (i.e., by default, the entire structure of the source directory will be copied or moved). If the Depth is set to zero, the method is applied just to the resource. Ifwe are doing a copy or a move of a collection, only a collection with properties identical to those of the source is created at the destination—no internal members of the collection are copied or moved.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">For obvious reasons, only a Depth value of infinity is allowed with the MOVE method.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3072"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3073"></a>Overwrite header effect</span></h4>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The COPY and MOVE methods also may use the Overwrite header. The Overwrite header can be set to either </span><span class="font4">T </span><span class="font24">or </span><span class="font4">F</span><span class="font24">. If it’s set to </span><span class="font4">T </span><span class="font24">and the destination exists, a DELETE with a Depth value of infinity is performed on the destination resource before a COPY or MOVE operation. If the Overwrite flag is set to </span><span class="font4">F </span><span class="font24">and the destination resource exists, the operation will fail.</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3074"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3075"></a>COPY/MOVE of properties</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When a collection or an element is copied, all of its properties are copied by default. However, a request may contain an optional XML body that supplies additional information for the operation. You can specify that all properties must be copied successfully for the operation to succeed, or define which properties must be copied for the operation to succeed.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">A couple of pathological cases to consider are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">• Suppose COPY or MOVE is applied to the output of a CGI program or other script that generates content. To preserve the semantics, if a file generated by a CGI script is to be copied or moved, WebDAV provides “src” and “link” XML elements that point to the location of the program that generated the page.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 12pt 19pt;"><span class="font24">• The COPY and MOVE methods may not be able to completely duplicate all of the live properties. For example, consider a CGI program. If it is copied away from the </span><span class="font24" style="font-style:italic;">cgi-bin</span><span class="font24"> directory, it may no longer be executed. The current specification of WebDAV makes COPY and MOVE a “best effort” solution, copying all the static properties and the appropriate live properties.</span></p></li></ul>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3076"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3077"></a>Locked resources and COPY/MOVE</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If a resource currently is locked, both COPY and MOVE are prohibited from moving or duplicating the lock at the destination. In both cases, if the destination is to be created under an existing collection with its own lock, the duplicated or moved resource<a name="bookmark3078"></a> is added to the lock. Consider the following example:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">COPY /publishing HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Destination: </span><a href="http://minstar/archived/publishing-old"><span class="font3">http://minstar/archived/publishing-old</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Let’s assume that </span><span class="font24" style="font-style:italic;">/publishing</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">/archived</span><span class="font24"> already are under two different locks, lock1 and lock2. When the COPY operation completes, </span><span class="font24" style="font-style:italic;">/publishing</span><span class="font24"> continues to be under the scope of lock1, while, by virtue of moving into a collection that’s already locked by lock2, </span><span class="font24" style="font-style:italic;">publishing-old</span><span class="font24"> gets added to lock2. If the operation was a MOVE, just </span><span class="font24" style="font-style:italic;">publishing-old</span><span class="font24"> gets added to lock2.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3079"><span class="font24">Table 19-3</span></a><span class="font24"> lists most of the possible status codes for the MKCOL, DELETE, COPY, and MOVE methods.</span></p>
<table>
<tr><td>
<p><a name="bookmark3079"></a><span class="font23" style="font-style:italic;">Table 19-3. Status codes for the MKCOL, DELETE, COPY, and MOVE methods</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:26pt;"><span class="font2" style="font-weight:bold;">Defined by</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Methods</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Effect</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">102 Processing</span></p></td><td style="vertical-align:top;">
<p style="text-indent:26pt;"><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MOVE, COPY</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">If the request takes longer than 20 seconds, the server sends this status code to keep clients from timing out. This usually is seen with a COPY or MOVE of a large collection.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">201 Created</span></p></td><td style="vertical-align:top;">
<p style="text-indent:26pt;"><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MKCOL, COPY, MOVE</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">For MKCOL, a collection has been created. For COPY and MOVE, a resource/collection was copied or moved successfully.</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 19-3. Status codes for the MKCOL, DELETE, COPY, and MOVE methods (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Defined by</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Methods</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Effect</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">204 No Content</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">DELETE, COPY, MOVE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">For DELETE, a standard success response. For COPY and MOVE, the resource was copied over successfully or moved to replace an existing entity.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">207 Multi-Status</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">MKCOL, COPY, MOVE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">For MKCOL, a typical success response. For COPY and MOVE, if an error is associated with a resource other than the request URI, the server returns a 207 response with the XML body detailing the error.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">403 Forbidden</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">MKCOL, COPY, MOVE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">For MKCOL, the server does not allow creation of a collection at the specified location. For COPY and MOVE, the source and destination are the same.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">409 Conflict</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">MKCOL, COPY, MOVE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">In all cases, the methods are trying to create a collection or a resource when an intermediate collection does not exist—for example, trying to create colA/colB when colA does not exist.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">412 Precondition Failed</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">COPY, MOVE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark3080"></a><span class="font2">Either the Overwrite header is set to F and the destination exists, or the XML body specifies a certain requirement (such as keeping the “liveness” property) and the COPY or MOVE methods are not able to retain the property.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">415 Unsupported Media Type</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">MKCOL</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The server does not support or understand the creation of the request entity type.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3081"></a><span class="font2"><a name="bookmark3082"></a>422 Unprocessable Entity</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">MKCOL</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The server does not understand the XML body sent with the request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">423 Locked</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">DELETE, COPY, MOVE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The source or the destination resource is locked, or the lock token supplied with the method does not match.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">502 Bad Gateway</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">COPY, MOVE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">The destination is on a different server and permissions are missing.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3083"></a><span class="font2"><a name="bookmark3084"></a>507 Insufficient Storage</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebDAV</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">MKCOL COPY</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">There is not enough free space to create the resource.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3085"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3086"></a>Enhanced HTTP/1.1 Methods</span></h3>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">WebDAV modifies the semantics of the HTTP methods DELETE, PUT, and OPTIONS. Semantics for the GET and HEAD methods remain unchanged. Operations performed by POST always are defined by the specific server implementation, and WebDAV does not modify any of the POST semantics. We already covered the DELETE method, in</span><a href="#bookmark2999"><span class="font24"> “Collections and Namespace Management</span></a><span class="font24">.” We’ll discuss the PUT and OPTIONS methods here.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3087"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3088"></a>The PUT method</span></h4>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Though PUT is not defined by WebDAV, it is the only way for an author to transport the content to a shared site. We discussed the general functionality of PUT in Chapter 3. WebDAV modifies its behavior to support locking.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Consider the following example:</span></p>
<p style="text-indent:19pt;"><span class="font3">PUT /ch-publish.fm HTTP/1.1</span></p>
<p style="text-indent:19pt;"><span class="font3">Accept: */*</span></p>
<p style="text-indent:19pt;"><span class="font3">If:&lt;</span><a href="http://minstar/index.htm"><span class="font3">http://minstar/index.htm</span></a><span class="font3">&gt;(&lt;opaquelocktoken:********&gt;)</span></p>
<p style="text-indent:19pt;"><a name="bookmark3089"></a><span class="font3">User-Agent: DAV Client (C)</span></p>
<p style="text-indent:19pt;"><span class="font3">Host: minstar.inktomi.com</span></p>
<p style="text-indent:19pt;"><span class="font3">Connection: Keep-Alive</span></p>
<p style="text-indent:19pt;"><span class="font3">Cache-Control: no-cache</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Content-Length: 1155</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">To support locking, WebDAV adds an If header to the PUT request. In the above transaction, the semantics of the If header state that if the lock token specified with the If header matches the lock on the resource (in this case, </span><span class="font24" style="font-style:italic;">ch-publish.fm</span><span class="font24">), the PUT operation should be performed. The If header also is used with a few other methods, such as PROPPATCH, DELETE, MOVE, LOCK, UNLOCK, etc.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark2997"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3090"></a><a name="bookmark3091"></a>The OPTIONS method</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3092"></a><span class="font24">We discussed OPTIONS in</span><a href="#bookmark609"><span class="font24"> Chapter 3</span></a><span class="font24">. This usually is the first request a WebDAV-enabled client makes. Using the OPTIONS method, the client tries to establish the capability of the WebDAV server. Consider a transaction in which the request reads:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">OPTIONS /ch-publish.fm HTTP/1.1</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Accept: */*</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 4pt 0pt;"><span class="font3">Host: minstar.inktomi.com</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3093"></a><span class="font24">And the response reads:</span></p>
<p style="text-indent:19pt;"><span class="font3">HTTP/1.1 200 OK</span></p>
<p style="text-indent:19pt;"><span class="font3">Server: Microsoft-IIS/5.0</span></p>
<p style="text-indent:19pt;"><span class="font3">MS-Author-Via: DAV</span></p>
<p style="text-indent:19pt;"><span class="font3">DASL: &lt;DAV:sql&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">DAV: 1, 2</span></p>
<p style="padding:0pt 0pt 0pt 19pt;"><span class="font3">Public: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL,PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span></p>
<p style="padding:0pt 0pt 4pt 19pt;"><span class="font3">Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND,PROPPATCH, SEARCH, LOCK, UNLOCK</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">There are several interesting headers in the response to the OPTIONS method. A slightly out-of-order examination follows:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The DAV header carries the information about DAV compliance classes. There are two classes of compliance:</span></p></li></ul>
<p style="text-align:justify;text-indent:19pt;"><span class="font24" style="font-style:italic;">Class 1 compliance</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 37pt;"><span class="font24">Requires the server to comply with all MUST requirements in all sections of RFC 2518. If the resource complies only at the Class 1 level, it will send 1 with the DAV header.</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font24" style="font-style:italic;">Class 2 compliance</span></p>
<p style="text-align:justify;text-indent:37pt;"><span class="font24">Meets all the Class 1 requirements and adds support for the LOCK method.</span></p>
<p style="text-align:justify;text-indent:37pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Along with LOCK, Class 2 compliance requires support for the Timeout and Lock-Token headers and the &lt;supportedlock&gt; and &lt;lockdiscovery&gt; XML elements. A value of 2 in the DAV header indicates Class 2 compliance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark3094"></a><span class="font24">In the above example, the DAV header indicates both Class 1 and Class 2 compliance.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Public header lists all methods supported by this particular server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The Allow header usually contains a subset of the Public header methods. It lists only those methods that are allowed on this particular resource (</span><span class="font24" style="font-style:italic;">ch-publish.fm</span><span class="font24">).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• The DASL header provides the type of query grammar used in the SEARCH method. In this case, it is sql. More details about the DASL header are provided at </span><a href="http://www.webdav.org"><span class="font24" style="font-style:italic;">http://www.webdav.org</span></a><span class="font24">.</span></p></li></ul>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3095"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3096"></a>Version Management in WebDAV</span></h3>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark3097"></a><span class="font24">It may be ironic, given the “V” in “DAV,” but versioning is a feature that did not make the first cut. In a multi-author, collaborative environment, version management is critical. In fact, to completely fix the lost update problem (illustrated in </span><a href="#bookmark3009"><span class="font24">Figure 19-3</span></a><span class="font24">), locking and versioning are essential. Some of the common features associated with versioning are the ability to store and access previous document versions and the ability to manage the change history and any associated annotations detailing the changes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Versioning was added to WebDAV in RFC 3253.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark3098"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3099"></a>Future of WebDAV</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">WebDAV is well supported today. Working implementations of clients include IE 5. x and above, Windows Explorer, and Microsoft Office. On the server side, implementations include IIS5.x and above, Apache with mod_dav, and many others. Both Windows XP and Mac OS 10.x provide support for WebDAV out of the box; thus, any applications written to run on these operating systems are WebDAV-enabled natively.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><a name="bookmark3100"></a><span class="font9" style="font-weight:bold;"><a name="bookmark180"></a><a name="bookmark3101"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information, refer to:</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="http://officeupdate.microsoft.com/frontpage/wpp/serk/"><span class="font24" style="font-style:italic;">http://officeupdate.microsoft.com/frontpage/wpp/serk/</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Microsoft FrontPage 2000 Server Extensions Resource Kit.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a href="http://www.ietf.org/rfc/rfc2518.txt?number=2518"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2518.txt?number=2518</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">“HTTP Extensions for Distributed Authoring—WEBDAV,” by Y. Goland, J. Whitehead, A. Faizi, S. Carter, and D. Jensen.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a href="http://www.ietf.org/rfc/rfc3253.txt?number=3253"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc3253.txt?number=3253</span></a></p>
<p style="text-indent:18pt;"><span class="font24">“Versioning Extensions to WebDAV,” by G. Clemm, J. Amsden, T. Ellison, C.</span></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Kaler, and J. Whitehead.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="http://www.ics.uci.edu/pub/ietf/webdav/intro/webdav_intro.pdf"><span class="font24" style="font-style:italic;">http://www.ics.uci.edu/pub/ietf/webdav/intro/webdav_intro.pdf</span></a></p>
<p style="text-indent:18pt;"><span class="font24">“WEBDAV: IETF Standard for Collaborative Authoring on the Web,” by J.</span></p>
<p style="text-indent:18pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Whitehead and M. Wiggins.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a href="http://www.ics.uci.edu/~ejw/http-future/whitehead/http_pos_paper.html"><span class="font24" style="font-style:italic;">http://www.ics.uci.edu/~ejw/http-future/whitehead/http_pos_paper.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">“Lessons from WebDAV for the Next Generation Web Infrastructure,” by J. Whitehead.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a href="http://www.microsoft.com/msj/0699/dav/davtop.htm"><span class="font24" style="font-style:italic;">http://www.microsoft.com/msj/0699/dav/davtop.htm</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">“Distributed Authoring and Versioning Extensions for HTTP Enable Team Authoring,” by L. Braginski and M. Powell.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="http://www.webdav.org/dasl/protocol/draft-dasl-protocol-00.html"><span class="font24" style="font-style:italic;">http://www.webdav.org/dasl/protocol/draft-dasl-protocol-00.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 18pt;"><span class="font24">“DAV Searching &amp;&nbsp;Locating,” by S. Reddy, D. Lowry, S. Reddy, R. Henderson, J. Davis, and A. Babich.</span></p>
<ul style="list-style:none;"><li>
<p style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark3102"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3103"></a><a name="bookmark244"></a>CHAPTER 20</span></p></li></ul>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark3104"></a><span class="font11" style="font-weight:bold;"><a name="bookmark181"></a><a name="bookmark3105"></a>Redirection and Load Balancing</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark3106"></a><span class="font24">HTTP does not walk the Web alone. The data in an HTTP message is governed by many protocols on its journey. HTTP cares only about the endpoints of the journey— the sender and the receiver—but in a world with mirrored servers, web proxies, and caches, the destination of an HTTP message is not necessarily straightforward.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">This chapter is about redirection technologies—network tools, techniques, and protocols that determine the final destination ofan HTTP message. Redirection technologies usually determine whether the message ends up at a proxy, a cache, or a particular web server in a server farm. Redirection technologies may send your messages to places a client didn’t explicitly request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In this chapter, we’ll take a look at the following redirection techniques, how they work, and what their load-balancing capabilities are (if any):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP redirection</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS redirection</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Anycast routing</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Policy routing</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• IP MAC forwarding</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• IP address forwarding</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Web Cache Coordination Protocol (WCCP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Intercache Communication Protocol (ICP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Hyper Text Caching Protocol (HTCP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Network Element Control Protocol (NECP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Cache Array Routing Protocol (CARP)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The Web Proxy Autodiscovery Protocol (WPAD)</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3107"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3108"></a><a name="bookmark182"></a><a name="bookmark3109"></a>Why Redirect?</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3110"></a><span class="font24">Redirection is a fact of life in the modern Web because HTTP applications always want to do thr<a name="bookmark3111"></a>ee things:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Perform HTTP transactions reliably</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Minimize delay</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Conserve network bandwidth</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For these reasons, web content often is distributed in multiple locations. This is done for reliability, so that if one location fails, another is available; it is done to lower response times, because if clients can access a nearer resource, they receive their requested content faster; and it’s done to lower network congestion, by spreading out target servers. You can think of redirection as a set of techniques that help to find the “best” distributed content.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3112"></a><span class="font24">The subject of load balancing is included because redirection and load balancing coexist. Most redirection deployments include some form of load balancing; that is, they are capable of spreading incoming message load among a set of servers. Conversely, any form of load balancing involves redirection, because incoming messages must somehow be somehow among the servers sharing the load.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3113"></a><span class="font9" style="font-weight:bold;"><a name="bookmark183"></a><a name="bookmark3114"></a>Where to Redirect</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3115"></a><span class="font24">Servers, proxies, caches, and gateways all appear to clients as servers, in the sense that a client sends them an HTTP request, and they process it. Many redirection techniques work for servers, proxies, caches, and gateways because of their common, server-like traits. Other redirection techniques are specially designed for a particular class of endpoint and are not generally applicable. We’ll see general techniques and specialized techniques in later sections of this chapter.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Web servers handle requests on a per-IP basis. Distributing requests to duplicate servers means that each request for a specific URL should be sent to an optimal web server (the one nearest to the client, or the least-loaded one, or some other optimization). Redirecting to a server is like sending all drivers in search of gasoline to the nearest gas station.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Proxies tend to handle requests on a per-protocol basis. Ideally, all HTTP traffic in the neighborhood of a proxy should go through the proxy. For instance, if a proxy cache is near various clients, all requests ideally will flow through the proxy cache, because the cache will store popular documents and serve them directly, avoiding longer and more expensive trips to the origin servers. Redirecting to a proxy is like siphoning off traffic on a main access road (no matter where it is headed) to a local shortcut.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3116"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3117"></a><a name="bookmark3118"></a><a name="bookmark184"></a><a name="bookmark3119"></a>Overview of Redirection Protocols</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The goal of redirection is to send HTTP messages to available web servers as quickly as possible. The direction that an HTTP message takes on its way through the Internet is affected by the HTTP applications and routing devices it passes from, through, and toward. For example:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• The browser application that creates the client’s message could be configured to send it to a proxy server.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• DNS resolvers choose the IP address that is used for addressing the message. This IP address can be different for different clients in different geographical locations.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• As the message passes through networks, it is divided into addressed packets; switches and routers examine the TCP/IP addressing on the packets and make decisions about routing the packets on that basis.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Web servers can bounce requests back to different web servers with HTTP redirects.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Browser configuration, DNS, TCP/IP routing, and HTTP all provide mechanisms for redirecting messages. Notice that some methods, such as browser configuration, make sense only for redirecting traffic to proxies, while others, such as DNS redirection, can be used to send traffic to any server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3120"><span class="font24">Table 20-1 </span></a><span class="font24">summarizes the redirection methods used to redirect messages to servers, each of which is discussed later in this chapter.</span></p>
<table>
<tr><td>
<p><a name="bookmark3120"></a><span class="font23" style="font-style:italic;">Table 20-1. General redirection methods</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Mechanism</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">How it works</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Basis for rerouting</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Limitations</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HTTP redirection</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Initial HTTP request goes to a first web server that chooses a “best” web server to serve the content. The first web server sends the client an HTTP redirect to the chosen server. The client resends the request to the chosen server.</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Many options, from round-robin load balancing, tominimizing latency, to choosing the shortest path.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Can be slow—every transaction involves the extra redirect step. Also, the first server must be able to handle the request load.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">DNS redirection</span></p></td><td style="vertical-align:top;">
<p><span class="font2">DNS server decides which IP address, among several, to return for the hostname in the URL.</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Many options, from round-robin load balancing, tominimizing latency, to choosing the shortest path.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Need to configure DNS server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Anycast addressing</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Several servers use the same IP address. Each server masquerades as a backbone router. The other routers send packets addressed to the shared IP to the nearest server (believing they are sending packets to the nearest router).</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Routers use built-in shortest-path routing capabilities.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Need to own/configure routers. Risks address conflicts. Established TCP connections can break if routing changes and packets associated with a connection get sent to different servers.</span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Mechanism</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">How it works</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Basis for rerouting</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">Limitations</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IP MAC forwarding</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">A network element such as a switch or router reads a packet’s destination address; if the packet should be redirected, the switch gives the packet the destination MAC address of a server or proxy.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Save bandwidth and improve QOS. Load balance.</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font2">Server or proxy must be one hop away.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">IP address</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Layer-4 switch evaluates a packet’s des-</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Save bandwidth and</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2">IP address of the client can</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">forwarding</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">tination port and changes the IP address of a redirect packet to that of a proxy or mirrored server.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">improve QOS. Load balance.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:12pt;"><span class="font2">be lost to the server/proxy.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a href="#bookmark3121"><span class="font24">Table 20-2</span></a><span class="font24"> summarizes the redirection methods used to redirect messages to proxy servers.</span></p></td></tr>
</table>
<table border="1">
<tr><td colspan="4" style="vertical-align:top;">
<p><a name="bookmark3121"></a><span class="font23" style="font-style:italic;">Table 20-2. Proxy and cache redirection techniques</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Mechanism</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">How it works</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Basis for rerouting</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Limitations</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Explicit browser configuration</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Web browser is configured to send HTTP messages to a nearby proxy, usually a cache. The configuration can be done by the end user or by a service that manages the browser.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Save bandwidth and improve QOS. Load balance.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Depends on ability to configure the browser.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Proxy autoconfiguration (PAC)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Web browser retrieves a PAC file from a configuration server. The PAC file tells the browser what proxy to use for each URL.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Save bandwidth and improve QOS. Load balance.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Browser must be configured to query the configuration server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Web Proxy Autodiscovery Protocol (WPAD)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Web browser asks a configuration server for the URL of a PAC file. Unlike PAC alone, the browser does not have to be configured with a specific configuration server.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The configuration server bases the URL on information in client HTTP request headers. Load balance.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Only a few browsers support WPAD.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Web Cache Coordination Protocol (WCCP)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Router evaluates a packet’s destination address and encapsulates redirect packets with the IP address of a proxy or mirrored server. Works with many existing routers. Packet can be encapsulated, so the client’s IP address is not lost.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Save bandwidth and improve QOS. Load balance.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Must use routers that support WCCP. Some topological limitations.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Internet Cache</span></p>
<p style="text-indent:7pt;"><span class="font2">Protocol (ICP)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A proxy cache can query a group of sibling caches for requested content. Also supports cache hierarchies.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Obtaining content from a sibling or parent cache is faster than applying to the origin server.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">False cache hits can arise because only the URL is used to request content.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Cache Array Routing Protocol (CARP)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A proxy cache hashing protocol. Allows a cache to forward a request to a parent cache. Unlike with ICP, the content on the caches is disjoint, and the group of caches acts as a single large cache.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Obtaining content from a nearby peer cache is faster than applying to the origin server.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CARP cannot support sibling relationships. All CARP clients must agree on the configuration; otherwise, different clients will send the same URI to different parents, reducing hit ratios.</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 20-2. Proxy and cache redirection techniques (continued)</span></p>
<p><span class="font2" style="font-weight:bold;">Mechanism How it works &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basis for rerouting Limitations</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Hyper Text Caching</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Participating proxy caches can query a</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">Obtaining content from</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Protocol (HTCP)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">group of sibling caches for requested content. Supports HTTP 1.0 and 1.1 headers to fine-tune cache queries.</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 9pt;"><span class="font2">a sibling or parent cache is faster than applying to the origin server.</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3122"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3123"></a><a name="bookmark185"></a><a name="bookmark3124"></a>General Redirection Methods</span></h2>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In this section, we will delve deeper into the various redirection methods that are commonly used for both servers and proxies. These techniques can be used to redirect traffic to a different (presumably more optimal) server or to vector traffic through a proxy. Specifically, we’ll cover HTTP redirection, DNS redirection, anycast addressing, IP MAC forwarding, and IP address forwarding.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3125"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3126"></a>HTTP Redirection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web servers can send short redirect messages back to clients, telling them to try someplace else. Some web sites use HTTP redirection as a simple form of load balancing; the server that handles the redirect (the redirecting server) finds the least-loaded content server available and redirects the browser to that server. For widely distributed web sites, determining the “best” available server gets more complicated, taking into account not only the servers’ load but the Internet distance between the browser and the server. One advantage of HTTP redirection over some other forms of redirection is that the redirecting server knows the client’s IP address; in theory, it may be able to make a more informed choice.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s how HTTP redirection works. In </span><a href="#bookmark3127"><span class="font24">Figure 20-1</span></a><span class="font24">a, Alice sends a request to </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET /hammers.html HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">User-Agent: Mozilla/4.51 [en] (X11; U; IRIX 6.2 IP22)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In </span><a href="#bookmark3127"><span class="font24">Figure 20-1</span></a><span class="font24">b, instead of sending back a web page body with HTTP status code 200, the server sends back a redirect message with status code 302:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">HTTP/1.0 302 Redirect</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Server: Stronghold/2.4.2 Apache/1.3.6</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Location: </span><a href="http://161.58.228.45/hammers.html"><span class="font3">http://161.58.228.45/hammers.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Now, in</span><a href="#bookmark3127"><span class="font24"> Figure 20-1</span></a><span class="font24">c, the browser resends the request using the redirected URL, this time to host 161.58.228.45:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">GET /hammers.html HTTP/1.0</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Host: 161.58.228.45</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">User-Agent: Mozilla/4.51 [en] (X11; U; IRIX 6.2 IP22)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Another client could get redirected to a different server. In </span><a href="#bookmark3127"><span class="font24">Figure 20-1</span></a><span class="font24">d–f, Bob’s request gets redirected to 161.58.228.46.</span></p><img src="book_files/book-558.jpg" alt="" style="width:360pt;height:281pt;">
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3127"></a><span class="font24"><a name="bookmark3128"></a><a name="bookmark3129"></a>HTTP redirection can vector requests across servers, but it has several disadvantages:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• A significant amount of processing power is required from <a name="bookmark3130"></a>the original server to determine which server to redirect to. Sometimes almost as much server horsepower is required to issue the redirect as would be to serve up the page itself.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• User delays are increased, because two round trips are required to access pages.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3131"></a><span class="font24">• If the redirecting server is broken, the site will be broken.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Because of these weaknesses, HTTP redirection usually is used in combination with some of the other redirection technique.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3132"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3133"></a>DNS Redirection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Every time a client tries to access Joe’s Hardware’s web site, the domain name </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24"> must be resolved to an IP address. The DNS resolver may be the client’s own operating system, a DNS server in the client’s network, or a more remote DNS server. DNS allows several IP addresses to be associated to a single domain, and DNS resolvers can be configured or programmed to return varying IP addresses. The basis on which the resolver returns the IP address can run from the simple (round robin) to the complex (such as checking the load on several servers and returning the IP address of the least-loaded server).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:justify;"><span class="font24">In</span><a href="#bookmark3134"><span class="font24"> Figure 20-2</span></a><span class="font24">, Joe runs four servers for </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">. The DNS server has to decide which of four IP addresses to return for </span><a href="http://www.joes-hardware.com"><span class="font24" style="font-style:italic;">www.joes-hardware.com</span></a><span class="font24">. The easiest DNS decision algorithm is a simple round robin.</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font0">www</span></p></td><td style="vertical-align:bottom;">
<p><span class="font0">.joes-hardware.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 58pt;"><span class="font0">DNS server</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 88pt;"><span class="font0">Decides whether to resolve to 10.10.10.1,</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 88pt;"><span class="font0">10.10.10.2,</span></p></td><td style="vertical-align:bottom;">
<p><span class="font5"><sup>10.10.10.4</sup> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardware.com"><span class="font0">www.joes-hardware.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 88pt;"><span class="font0">1010103</span></p></td><td style="vertical-align:bottom;">
<p><span class="font0">Server 4</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font1" style="font-weight:bold;">Backbone network</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 127pt;"><span class="font0">10.10.10.1</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 132pt;"><span class="font0">Server 1</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:47pt;"><span class="font0">Client</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 162pt;"><span class="font0">Rou</span></p></td><td style="vertical-align:bottom;">
<p><span class="font0">ter</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font0">Switch</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 110pt;"><a href="http://www.joes-hardware.com"><span class="font0">www.joes-hardware.com</span></a></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:38pt;"><a name="bookmark3135"></a><span class="font0">Client</span></p>
<p style="text-indent:47pt;"><a name="bookmark3134"></a><span class="font1" style="font-weight:bold;"><a name="bookmark3136"></a>Edge network &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://www.joes-hardwa"><span class="font0">www.joes-hardwa</span></a></p></td><td style="vertical-align:bottom;">
<p><span class="font0">re.com</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font0">10.10.10.2 Server 2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:center;"><a name="bookmark3137"></a><span class="font0">10.10.10.3 Server 3</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-559.jpg" alt="" style="width:116pt;height:115pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-560.jpg" alt="" style="width:219pt;height:145pt;">
</div><br clear="all">
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3138"></a><span class="font23" style="font-style:italic;">Example 20-1. IP addresses for </span><a href="http://www.cnn.com"><span class="font23" style="font-style:italic;">www.cnn.com</span></a><span class="font23" style="font-style:italic;"> (continued)</span></p>
<p><a name="bookmark3139"></a><span class="font3">Addresses: 207.25.71.5, 207.25.71.6, 207.25.71.7, 207.25.71.8</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.9, 207.25.71.12, 207.25.71.20, 207.25.71.22, 207.25.71.23</span></p></li></ul>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.24, 207.25.71.25, 207.25.71.26, 207.25.71.27, 207.25.71.28</span></p></li></ul>
<p style="text-indent:41pt;"><span class="font3">207.25.71.29, 207.25.71.30, 207.25.71.82, 207.25.71.199, 207.25.71.245</span></p>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.246</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font3">Aliases: </span><a href="http://www.cnn.com"><span class="font3">www.cnn.com</span></a></p>
<p style="padding:0pt 0pt 13pt 0pt;"><span class="font24">The web site </span><a href="http://www.cnn.com"><span class="font24" style="font-style:italic;">www.cnn.com</span></a><span class="font24"> actually is a farm of 20 distinct IP addresses! Each IP address might typically translate to a different physical server.</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3140"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3141"></a>Multiple addresses and round-robin address rotation</span></h4>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Most DNS clients just use the first address of the multi-address set. To balance load, most DNS servers rotate the addresses each time a lookup is done. This address rotation often is called </span><span class="font24" style="font-style:italic;">DNS round robin</span><span class="font24">.</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">For example, three consecutive DNS lookups of </span><a href="http://www.cnn.com"><span class="font24" style="font-style:italic;">www.cnn.com</span></a><span class="font24"> might return rotated lists of IP addresses like those shown in</span><a href="#bookmark3142"><span class="font24"> Example 20-2</span></a><span class="font24">.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3142"></a><span class="font23" style="font-style:italic;">Example 20-2. Rotating DNS address lists</span></p>
<p><span class="font3">% </span><span class="font3" style="font-weight:bold;">nslookup </span><a href="http://www.cnn.com"><span class="font3" style="font-weight:bold;">www.cnn.com</span></a></p>
<p><span class="font3">Name: &nbsp;&nbsp;&nbsp;cnn.com</span></p>
<p><span class="font3">Addresses: 207.25.71.5, 207.25.71.6, 207.25.71.7, 207.25.71.8</span></p>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.9, 207.25.71.12, 207.25.71.20, 207.25.71.22, 207.25.71.23</span></p>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.24, 207.25.71.25, 207.25.71.26, 207.25.71.27, 207.25.71.28</span></p>
<p style="padding:0pt 0pt 10pt 41pt;"><span class="font3">207.25.71.29, 207.25.71.30, 207.25.71.82, 207.25.71.199, 207.25.71.245 207.25.71.246</span></p>
<p><span class="font3">% </span><span class="font3" style="font-weight:bold;">nslookup </span><a href="http://www.cnn.com"><span class="font3" style="font-weight:bold;">www.cnn.com</span></a></p>
<p><span class="font3">Name: &nbsp;&nbsp;&nbsp;cnn.com</span></p>
<p><span class="font3">Addresses: 207.25.71.6, 207.25.71.7, 207.25.71.8, 207.25.71.9</span></p>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.12, 207.25.71.20, 207.25.71.22, 207.25.71.23, 207.25.71.24</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 10pt 41pt;"><span class="font3">207.25.71.25, 207.25.71.26, 207.25.71.27, 207.25.71.28, 207.25.71.29 207.25.71.30, 207.25.71.82, 207.25.71.199, 207.25.71.245, 207.25.71.246 207.25.71.5</span></p></li></ul>
<p><span class="font3">% </span><span class="font3" style="font-weight:bold;">nslookup </span><a href="http://www.cnn.com"><span class="font3" style="font-weight:bold;">www.cnn.com</span></a></p>
<p><span class="font3">Name: &nbsp;&nbsp;&nbsp;cnn.com</span></p>
<p><span class="font3">Addresses: 207.25.71.7, 207.25.71.8, 207.25.71.9, 207.25.71.12</span></p>
<p style="text-align:justify;text-indent:41pt;"><span class="font3">207.25.71.20, 207.25.71.22, 207.25.71.23, 207.25.71.24, 207.25.71.25</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 10pt 41pt;"><span class="font3">207.25.71.26, 207.25.71.27, 207.25.71.28, 207.25.71.29, 207.25.71.30 207.25.71.82, 207.25.71.199, 207.25.71.245, 207.25.71.246, 207.25.71.5 207.25.71.6</span></p></li></ul>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">In</span><a href="#bookmark3142"><span class="font24"> Example 20-2</span></a><span class="font24">:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The first address of the first DNS lookup is 207.25.71.5.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The first address of the second DNS lookup is 207.25.71.6.</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The first address of the third DNS lookup is 207.25.71.7.</span></p></li></ul>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3143"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3144"></a><a name="bookmark3145"></a>DNS round robin for load balancing</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Because most DNS clients just use the first address, the DNS rotation serves to balance load among servers. If DNS did not rotate the addresses, most clients would always send load to the first client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a href="#bookmark3146"><span class="font24">Figure 20-3</span></a><span class="font24"> shows how DNS round-robin rotation acts to balance load:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• When Alice tries to connect to </span><a href="http://www.cnn.com"><span class="font24" style="font-style:italic;">www.cnn.com</span></a><span class="font24">, she looks up the IP address using DNS and gets back 207.25.71.5 as the first IP address. Alice connects to the web server 207.25.71.5 in</span><a href="#bookmark3146"><span class="font24"> Figure 20-3</span></a><span class="font24">c.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 10pt 19pt;"><span class="font24">• When Bob subsequently tries to connect to </span><a href="http://www.cnn.com"><span class="font24" style="font-style:italic;">www.cnn.com</span></a><span class="font24">, he also looks up the IP address using DNS, but he gets back a different result because the address list has been rotated one position, based on Alice’s previous request. Bob gets back 207.25.71.6 as the first IP address, and he connects to this server in </span><a href="#bookmark3146"><span class="font24">Figure 20-3</span></a><span class="font24">f.</span></p>
<table>
<tr><td><img src="book_files/book-561.jpg" alt="" style="width:360pt;height:267pt;"></td></tr>
<tr><td>
<p><a name="bookmark3146"></a><span class="font23" style="font-style:italic;"><a name="bookmark3147"></a>Figure 20-3. DNS round robin load balances across servers in a server farm</span></p></td></tr>
</table></li></ul>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3148"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3149"></a>The impact of DNS caching</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">DNS address rotation spreads the load around, because each DNS lookup to a server gets a different ordering of server addresses. However, this load balancing isn’t perfect, because the results of the DNS lookup may be memorized and reused by applications, operating systems, and some primitive child DNS servers. Many web browsers <a name="bookmark3150"></a><a name="bookmark3151"></a>perform a DNS lookup for a host but then use the same address over and over again, to eliminate the cost of DNS lookups and because some servers prefer to keep talking to the same client. Furthermore, many operating systems perform the DNS lookup automatically, and cache the result, but don’t rotate the addresses. Consequently, DNS round robin generally doesn’t balance the load of a single client—one client typically will be stuck to one server for a long period of time.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">But, even though DNS doesn’t deal out the transactions of a single client across server replicas, it does a decent job of spreading the aggregate load of multiple clients. As long as there is a modestly large number of clients with similar demand, the load will be relatively well distributed across servers.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3152"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3153"></a>Other DNS-based redirection algorithms</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">We’ve already discussed how DNS rotates address lists with each request. However, some enhanced DNS servers use other techniques for choosing the order of the addresses:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Load-balancing algorithms</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">Some DNS servers keep track of the load on the web servers and place the least-loaded web servers at the front of the list.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Proximity-routing algorithms</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><a name="bookmark3154"></a><span class="font24">DNS servers can attempt to direct users to nearby web servers, when the farm of web servers is geographically dispersed.</span></p>
<p style="text-align:justify;"><a name="bookmark3155"></a><span class="font24" style="font-style:italic;">Fault-masking algorithms</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">DNS servers can monitor the health of the network and route requests away from service interruptions or other faults.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3156"></a><span class="font24">Typically, the DNS server that runs sophisticated server-tracking algorithms is an authoritative server that is under the control of the content provider (see</span><a href="#bookmark3157"><span class="font24"> Figure 20-4</span></a><span class="font24">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">Several distributed hosting services use this DNS redirection model. One drawback of the model for services that look for nearby servers is that the only information that the authoritative DNS server uses to make its decision is the IP address of the local DNS server, not the IP address of the client.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3158"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3159"></a>Anycast Addressing</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">In anycast addressing, several geographically dispersed web servers have the exact same IP address and rely on the “shortest-path” routing capabilities of backbone routers to send client requests to the server nearest to the client. One way this method can work is for each web server to advertise itself as a router to a neighboring backbone router. The web server talks to its neighboring backbone router using a router communication protocol. When the backbone router receives packets aimed at the anycast address, it looks (as it usually would) for the nearest “router” that</span></p>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-562.jpg" alt="" style="width:19pt;height:18pt;">
</div><br clear="all">
<p><span class="font1" style="font-weight:bold;">Root DNS server</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Local DNS server</span></p>
<p style="text-align:center;"><span class="font1" style="font-weight:bold;">Authoritative DNS server monitors cnn servers</span></p>
<p><span class="font1" style="font-weight:bold;">(d) </span><span class="font1" style="font-style:italic;">Request IP address</span></p>
<p style="text-align:right;"><span class="font1" style="font-weight:bold;">(e) </span><span class="font1" style="font-style:italic;">Returns IP address 207.25.71.5</span></p></td></tr>
<tr><td><img src="book_files/book-563.jpg" alt="" style="width:169pt;height:82pt;"></td></tr>
<tr><td>
<p><a href="http://www.cnn.com"><span class="font0">www.cnn.com</span></a><span class="font0"> &nbsp;&nbsp;</span><a href="http://www.cnn.com"><span class="font0">www.cnn.com</span></a><span class="font0"> &nbsp;&nbsp;</span><a href="http://www.cnn.com"><span class="font0">www.cnn.com</span></a></p>
<p><span class="font0">(207.25.71.5) &nbsp;&nbsp;&nbsp;&nbsp;(207.25.71.6) &nbsp;&nbsp;&nbsp;&nbsp;(207.25.71.7)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-564.jpg" alt="" style="width:19pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-565.jpg" alt="" style="width:19pt;height:18pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-566.jpg" alt="" style="width:28pt;height:26pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Alice</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><a name="bookmark3157"></a><span class="font23" style="font-style:italic;">Figure 20-4. DNS request involving authoritative server</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">accepts that IP address. Because the server will have advertised itself as a router for that address, the backbone router will send the server the packet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">In</span><a href="#bookmark3160"><span class="font24"> Figure 20-5</span></a><span class="font24">, three servers front the same IP address, 10.10.10.1. The Los Angeles (LA) server advertises this address to the LA router, the New York (NY) server advertises the same address to the NY router, and so on. The servers communicate with the routers using a router protocol. The routers automatically route client requests aimed at 10.10.10.1 to the nearest server that advertises the address. In </span><a href="#bookmark3160"><span class="font24">Figure 20-5</span></a><span class="font24">, a request for the IP address 10.10.10.1 will be routed to server 3.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-567.jpg" alt="" style="width:327pt;height:130pt;"></td></tr>
<tr><td>
<p style="text-align:center;"><span class="font0">10.10.10.1 Server 3</span></p>
<p><a name="bookmark3160"></a><span class="font23" style="font-style:italic;">Figure 20-5. Distributed anycast addressing</span></p></td></tr>
</table>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3161"></a><span class="font24">Anycast addressing is still an experimental technique. Fo<a name="bookmark3162"></a>r distributed anycast to work, the servers must “speak router language” and the routers must be able to handle possible address conflicts, because Internet addressing basically assumes one server for one address. (If done improperly, this can lead to serious problems known as “route leaks.”) Distributed anycast is an emerging technology and might be a solution for content providers who control their own backbone networks.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3163"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3164"></a>IP MAC Forwarding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In Ethernet networks, HTTP messages are sent in the form of addressed data packets. Each packet has a layer-4 address, consisting of the source and destination IP address and TCP port numbers; this is the address to which layer 4–aware devices pay attention. Each packet also has a layer-2 address, the Media Access Control (MAC) address, to which layer-2 devices (commonly switches and hubs) pay attention. The job of layer-2 devices is to receive packets with particular incoming MAC addresses and forward them to particular outgoing MAC addresses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">In </span><a href="#bookmark3165"><span class="font24">Figure 20-6</span></a><span class="font24">, for example, the switch is programmed to send all traffic from MAC address “MAC3” to MAC address “MAC4.”</span></p><img src="book_files/book-568.jpg" alt="" style="width:360pt;height:124pt;">
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3165"></a><span class="font24">A layer 4–aware switch is able to examine the layer-4 addressing (IP addresses and TCP port numbers) and make routing decisions based on this information. For example, a layer-4 switch could send all port 80–destined web traffic to a proxy. In </span><a href="#bookmark3166"><span class="font24">Figure 20-7</span></a><span class="font24">, the switch is programmed to send all port 80 traffic from MAC3 to MAC6 (a proxy cache). All other MAC3 traffic goes to MAC5.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Typically, if the requested HTTP content is in the cache and is fresh, the proxy cache serves it; otherwise, the proxy cache sends an HTTP request to the origin server for the content, on the client’s behalf. The switch sends port 80 requests from the proxy (MAC6) to the Internet gateway (MAC5).</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Layer-4 switches that support MAC forwarding usually can forward requests to several proxy caches and balance the load among them. Likewise, HTTP traffic also can be forwarded to alternate HTTP servers.</span></p><img src="book_files/book-569.jpg" alt="" style="width:360pt;height:154pt;">
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3166"></a><span class="font24"><a name="bookmark3167"></a><a name="bookmark3168"></a>Because MAC address forwarding is point-to-point only, the server or proxy has to be located one hop away from the switch.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3169"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3170"></a>IP Address Forwarding</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">In IP address forwarding, a switch or other layer 4–aware device examines TCP/IP addressing on incoming packets and routes packets accordingly by changing the destination IP address, instead of the destination MAC address. An advantage over MAC forwarding is that the destination server need not be one hop away; it just needs to be located upstream from the switch, and the usual layer-3 end-to-end Internet routing gets the packet to the right place. This type of forwarding also is called Network Address Translation (NAT).</span></p>
<p style="text-align:justify;padding:0pt 0pt 8pt 0pt;"><span class="font24">There is a catch, however: routing symmetry. The switch that accepts the incoming TCP connection from the client is managing that connection; the switch must send the response back to the client on that TCP connection. Therefore, any response from the destination server or proxy must return to the switch (see</span><a href="#bookmark3171"><span class="font24"> Figure 20-8</span></a><span class="font24">).</span></p>
<table>
<tr><td><img src="book_files/book-570.jpg" alt="" style="width:363pt;height:145pt;"></td></tr>
<tr><td>
<p><a name="bookmark3171"></a><span class="font23" style="font-style:italic;">Figure 20-8. A switch doing IP forwarding to a caching proxy or mirrored web server</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3172"></a><span class="font24"><a name="bookmark3173"></a>Two ways to control the return path of the response are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Change the source IP address of the packet to the IP address of the switch. That way, regardless of the network configuration between the switch and server, the response packet goes to the switch. This is called </span><span class="font24" style="font-style:italic;">full NAT</span><span class="font24">, where the IP forwarding device translates both destination and source IP addresses. </span><a href="#bookmark3174"><span class="font24">Figure 20-9</span></a><span class="font24"> shows the effect of full NAT on a TCP/IP datagram. The consequence is that the client IP address is unknown to the web server, which might want it for authentication or billing purposes, for example.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 9pt 19pt;"><a name="bookmark3175"></a><span class="font24">• If the source IP address remains the client’s IP address, make sure (from a hardware perspective) that no routes exist directly from server to client (bypassing the switch). This sometimes is called </span><span class="font24" style="font-style:italic;">half NAT</span><span class="font24">. The advantage here is that the server obtains the client IP address, but the disadvantage is the requirement of some control of the entire network between client and server.</span></p><img src="book_files/book-571.jpg" alt="" style="width:360pt;height:144pt;"></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3174"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3176"></a><a name="bookmark3177"></a>Network Element Control Protocol</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3178"></a><span class="font24">The Network Element Control Protocol (NECP) allows network elements (NEs)— devices such as routers and switches that forward IP packets—to talk with server elements (SEs)—devices such as web servers and proxy caches that serve application layer requests. NECP does not explicitly support load balancing; it only offers a way for an SE to send an NE load-balancing information so that the NE can load balance as it sees fit. Like WCCP, NECP offers several ways to forward packets: MAC forwarding, GRE encapsulation, and NAT.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">NECP supports the idea of exceptions. The SE can decide that it cannot service particular source IP addresses, and send those addresses to the NE. The NE can then forward requests from those IP addresses to the origin server.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3179"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3180"></a>Messages</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The NECP messages are described in </span><a href="#bookmark3181"><span class="font24">Table 20-3</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3181"></a><span class="font23" style="font-style:italic;">Table 20-3. NECP messages</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Message</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Who sends it</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_NOOP</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">No operation—do nothing.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">NECP_INIT</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">SE initiates communication with NE. SE sends this message to NE after opening TCP connection with NE. SE must know which NE port to connect to.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_INIT_ACK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Acknowledges NECP_INIT.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_KEEPALIVE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE or SE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Asks if peer is alive.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_KEEPALIVE_ACK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE or SE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Answers keep-alive message.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">NECP_START</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">SE says “I am here and ready to accept network traffic.” Can specify a port.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">NECP_START_ACK</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Acknowledges NECP_START.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_STOP</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">SE tells NE “stop sending me traffic.”</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">NECP_STOP_ACK</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">NE acknowledges stop.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">NECP_EXCEPTION_ADD</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">SE says to add one or more exceptions to NE’s list. Exceptions can be based on source IP, destination IP, protocol (above IP), or port.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark3182"></a><span class="font2">NECP_EXCEPTION_ADD_ACK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Confirms EXCEPTION_ADD.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_DEL</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">Asks NE to delete one or more exceptions from its list.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_DEL_ACK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Confirms EXCEPTION_DEL.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_RESET</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Asks NE to delete entire exception list.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_RESET_ACK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Confirms EXCEPTION_RESET.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_QUERY</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Queries NE’s entire exception list.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NECP_EXCEPTION_RESP</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Responds to exception query.</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3183"></a><span class="font9" style="font-weight:bold;"><a name="bookmark186"></a><a name="bookmark3184"></a>Proxy Redirection Methods</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">So far, we have talked about general redirection methods. Content also may need to be accessed through various proxies (potentially for security reasons), or there might be a proxy cache in the network that a client should take advantage of (because it likely will be much faster to retrieve the cached content than it would be to go directly to the origin server).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">But how do clients such as web browsers know to go to a proxy? There are three ways to determine this: by explicit browser configuration, by dynamic automatic configuration, and by transparent interception. We will discuss these three techniques in this section.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">A proxy can, in turn, redirect client requests to a different proxy. For example, a proxy cache that does not have the content in its cache may choose to redirect the client to another cache. As this results in the response coming from a location different from the one from which the client requested the resource, we also will discuss several protocols used for peer proxy-cache redirection: the Internet Cache Protocol (ICP), the Cache Array Routing Protocol (CARP), and the Hyper Text Caching Protocol (HTCP).</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3185"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3186"></a><a name="bookmark3187"></a><a name="bookmark3188"></a>Explicit Browser Configuration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Most browsers can be configured to contact a proxy server for content—there is a pull-down menu where the user can enter the proxy’s name or IP address and port number. The browser then contacts the proxy for all requests. Rather than relying on users to correctly configure their browsers to use proxies, some service providers require users to download preconfigured browsers. These browsers know the address of the proxy to contact.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Explicit browser configuration has two main disadvantages:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><a name="bookmark3189"></a><span class="font24">• Browsers configured to use proxies do not contact the origin server even if the proxy is not responding. If the proxy is down or if the browser is incorrectly configured, the user experiences connectivity problems.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• It is difficult to make changes in network architecture and propagate those changes to all end users. If a service provider wants to add more proxies or take some out of service, browser users have to change their proxy settings.</span></p></li></ul>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3190"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3191"></a>Proxy Auto-configuration</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Explicit configuration of browsers to contact specific proxies can restrict changes in network architecture, because it depends on users to intervene and reconfigure their browsers. An automatic configuration methodology that allows browsers to dynamically configure themselves to contact the correct proxy server solves this problem. Such a methodology exists; it is called the Proxy Auto-configuration (PAC) protocol. PAC was defined by Netscape and is supported by the Netscape Navigator and Microsoft Internet Explorer browsers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The basic idea behind PAC is to have browsers retrieve a special file, called the PAC file, which specifies the proxy to contact for each URL. The browser must be configured to contact a specific server for the PAC file. The browser then fetches the PAC file every time it is restarted.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The PAC file is a JavaScript file, which must define the function:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">function FindProxyForURL(url, host)</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Browsers call this function for every requested URL, as follows:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">return_value = FindProxyForURL(url_of_request, host_in_url);</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">where the return value is a string specifying where the browser should request this URL. The return value can be a list of the names of proxies to contact (for example, “PROXY proxy1.domain.com; PROXY proxy2.domain.com”) or the string “DIRECT”, which means that the browser should go directly to the origin server, bypassing any proxies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The sequence of operations that illustrate the request for and response to a browser’s request for the PAC file are illustrated in</span><a href="#bookmark3192"><span class="font24"> Figure 20-10</span></a><span class="font24">. In this example, the server</span></p>
<p style="text-align:justify;padding:0pt 0pt 36pt 0pt;"><span class="font24">sends back a PAC file with a JavaScript program. The JavaScript program has a function called “FindProxyForURL” that tells the browser to contact the origin server directly if the host in the requested URL is in the “netscape.com” domain, and to go to “proxy1.joes-cache.com” for all other requests. The browser calls this function for each URL it requests and connects according to the results returned by the function.</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-572.jpg" alt="" style="width:29pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">PAC server</span></p></td></tr>
</table>
</div>
<p style="text-align:justify;text-indent:1pt;padding:0pt 0pt 18pt 85pt;"><span class="font1" style="font-style:italic;">Hi, I’ve been configured to ask you for the PAC file. Please send it to me.</span></p>
<div style="border-right:solid;float:left;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-573.jpg" alt="" style="width:39pt;height:70pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Browser</span></p></td></tr>
</table>
</div>
<p style="text-indent:10pt;"><span class="font2">HTTP/1.0 200 OK</span></p>
<p style="text-indent:10pt;"><span class="font2">Content-type: application/x-ns-proxy-autoconfig</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">Content-length: 176</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">function FindProxyForURL(url,host)</span></p>
<p><span class="font2">if (dnsDomain(host,&quot;.netscape.com&quot;)</span></p>
<p style="text-indent:27pt;"><span class="font2">return &quot;DIRECT&quot;;</span></p>
<p style="text-indent:17pt;"><span class="font2">else</span></p>
<p style="text-align:justify;text-indent:27pt;padding:0pt 0pt 11pt 0pt;"><span class="font2">return &quot;PROXY proxy1.joes-cache.com:8080; DIRECT&quot;;</span></p>
<p style="text-align:justify;text-indent:1pt;padding:0pt 0pt 2pt 85pt;"><span class="font1" style="font-style:italic;">Requests to netscape.com domain are sent directly to the server</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Go to the proxy1 if it is available or go directly to the origin server if proxy1 is not reachable</span></p>
</div>
<div style="float:right;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-574.jpg" alt="" style="width:32pt;height:34pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Origin server</span></p></td></tr>
</table>
</div>
<div style="border-top:solid;float:right;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Internet</span></p></td></tr>
<tr><td><img src="book_files/book-575.jpg" alt="" style="width:41pt;height:25pt;"></td></tr>
</table>
</div>
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-576.jpg" alt="" style="width:41pt;height:21pt;">
</div><br clear="all"><img src="book_files/book-577.jpg" alt="" style="width:19pt;height:12pt;">
<p style="text-align:justify;padding:2pt 0pt 11pt 54pt;"><span class="font1" style="font-style:italic;">Requests to all other domains are sent to proxy1.cache1.com</span><span class="font0" style="font-weight:bold;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<sub>Proxy1</sub></span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a name="bookmark3192"></a><span class="font23" style="font-style:italic;">Figure 20-10. Proxy auto-configuration</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3193"></a><span class="font24">The PAC protocol is quite powerful: the JavaScript program can ask the browser to choose a proxy based on any of a number of parameters related to the hostname, such as the DNS address and subnet, and even the day of week or time of day. PAC allows browsers automatically to contact the right proxy with changes in network architecture, as long as the PAC file is updated at the server to reflect changes to the proxy locations. The main drawback with PAC is that the browser must be configured to know which server to fetch the PAC file from, so it is not a completely automatic configuration system. WPAD, discussed in the next section, addresses this problem.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">PAC, like preconfigured browsers, is used by some major ISPs today.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3194"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3195"></a>Web Proxy Autodiscovery Protocol</span></h3>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The Web Proxy Autodiscovery Protocol (WPAD) aims to provide a way for web browsers to find and use nearby proxies, without requiring the end user to manually <a name="bookmark3196"></a>configure a proxy setting and without relying on transparent traffic interception. The general problem of defining a web proxy autodiscovery protocol is complicated by the existence of many discovery protocols to choose from and the differences in proxy-use configurations in different browsers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">This secti<a name="bookmark3197"></a>on contains an abbreviated and slightly reorganized version of the WPAD Internet draft. The draft currently is being developed as part of the Web Intermediaries Working Group of the IETF.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3198"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3199"></a>PAC file autodiscovery</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">WPAD enables HTTP clients to locate a PAC file and use the PAC file to discover the name of an appropriate proxy server. WPAD does not directly determine the name of the proxy server, because that would circumvent the additional capabilities provided by PAC files (load balancing, request routing to an array of servers, automated failover to backup proxy servers, and so on).</span></p>
<p style="text-align:justify;padding:0pt 0pt 18pt 0pt;"><span class="font24">As shown in</span><a href="#bookmark3200"><span class="font24"> Figure 20-11</span></a><span class="font24">, the WPAD protocol discovers a PAC file URL, also known as a </span><span class="font24" style="font-style:italic;">configuration URL</span><span class="font24"> (CURL). The PAC file executes a JavaScript program that returns the address of an appropriate proxy server.</span></p><img src="book_files/book-578.jpg" alt="" style="width:257pt;height:124pt;">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3200"></a><span class="font23" style="font-style:italic;"><a name="bookmark3201"></a>Figure 20-11. WPAD determines the PAC URL, which determines the proxy server</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">An HTTP client that implements the WPAD protocol:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Uses WPAD to find the PAC file CURL</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Fetches the PAC file (a.k.a. configuration file, or CFILE) corresponding to the CURL</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Executes the PAC file to determine the proxy server</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><span class="font24">• Sends HTTP requests to the proxy server returned by the PAC file</span></p></li></ul>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3202"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3203"></a>WPAD algorithm</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">WPAD uses a series of resource-discovery techniques to determine the proper PAC file CURL. Multiple discovery techniques are specified, because not all organizations can use all techniques. WPAD clients attempt each technique, one by one, until they succeed in obtaining a CURL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The current WPAD specification defines the following techniques, in order:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DHCP (Dynamic Host Discovery Protocol)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• SLP (Service Location Protocol)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS well-known hostnames</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS SRV records</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• DNS service URLs in TXT records</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Of these five mechanisms, only the DHCP and DNS well-known hostname techniques are required for WPAD clients. We present more details in subsequent sections.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The WPAD client sends a series of resource-discovery requests, using the discovery mechanisms mentioned above, in order. Clients attempt only mechanisms that they support. Whenever a discovery attempt succeeds, the client uses the information obtained to construct a PAC CURL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If a PAC file is retrieved successfully at that CURL, the process completes. If not, the client resumes where it left off in the predefined series of resource-discovery requests. If, after trying all discovery mechanisms, no PAC file is retrieved, the WPAD protocol fails and the client is configured to use no proxy server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The client tries DHCP first, followed by SLP. If no PAC file is retrieved, the client moves on to the DNS-based mechanisms.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The client cycles through the DNS SRV, well-known hostnames, and DNS TXT record methods multiple times. Each time, the DNS query QNAME is made less and less specific. In this manner, the client can locate the most specific configuration information possible, but still can fall back on less specific information. Every DNS lookup has the QNAME prefixed with “wpad” to indicate the resource type being requested.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Consider a client with hostname </span><span class="font24" style="font-style:italic;">johns-desktop.development.foo.com</span><span class="font24">. This is the sequence of discovery attempts a complete WPAD client would perform:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DHCP</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• SLP</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS A lookup on “QNAME=wpad.development.foo.com”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS SRV lookup on “QNAME=wpad.development.foo.com”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS TXT lookup on “QNAME=wpad.development.foo.com”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS A lookup on “QNAME=wpad.foo.com”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS SRV lookup on “QNAME=wpad.foo.com”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• DNS TXT lookup on “QNAME=wpad.foo.com”</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark3204"></a><span class="font24">Refer to the WPAD specification to get detailed pseudocode that addresses the entire sequence of operations. The following sections discuss the two required mechanisms, DHCP and DNS A lookup. For more details about the reminder of the CURL discovery methods, refer to the WPAD specification.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3205"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3206"></a>CURL discovery using DHCP</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3207"></a><span class="font24">For this mechanism to work, the CURLs must be stored on DHCP servers that WPAD clients can query. The WPAD client obtains the CURL by sending a DHCP query to a DHCP server. The CURL is contained in DHCP option code 252 (if the DHCP server is configured with this information). All WPAD client implementations are required to support DHCP. The DHCP protocol is detailed in RFC 2131. See RFC 2132 for a list of existing DHCP options.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">If the WPAD client already has conducted DHCP queries during its initialization, the DHCP server might already have supplied that value. If the value is not available through a client OS API, the client sends a DHCPINFORM message to query the DHCP server to obtain the value.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The DHCP option code 252 for WPAD is of type STRING and is of arbitrary size. This string contains a URL that points to an appropriate PAC file. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">&quot;</span><a href="http://server.domain/proxyconfig.pac"><span class="font3">http://server.domain/proxyconfig.pac</span></a><span class="font3">&quot;</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3208"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3209"></a>DNS A record lookup</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For this mechanism to work, the IP addresses of suitable proxy servers must be stored on DNS servers that the WPAD clients can query. The WPAD client obtains the CURL by sending an A record lookup to a DNS server. The result of a successful lookup contains an IP address for an appropriate proxy server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3210"></a><span class="font24">WPAD client implementations are required to support this mechanism. This should be straightforward, as only basic DNS lookup of A records is required. See RFC 2219 for a description of using well-known DNS aliases for resource discovery. For WPAD, the specification uses “well known alias” of “wpad” for web proxy autodiscovery.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The client performs the following DNS lookup:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">QNAME=wpad.TGTDOM., QCLASS=IN, QTYPE=A</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">A successful lookup contains an IP address from which the WPAD client constructs the CURL.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3211"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3212"></a>Retrieving the PAC file</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Once a candidate CURL is created, the WPAD client usually makes a GET request to the CURL. When making requests, WPAD clients are required to send Accept headers with appropriate CFILE format information that they are capable of handling. For example:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Accept: application/x-ns-proxy-autoconfig</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><a name="bookmark3213"></a><span class="font24">In addition, if the CURL results in a redirect, the clients are required to follow the redirect to its final destination.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3214"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3215"></a>When to execute WPAD</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The web proxy autodiscovery process is required to occur at least as frequently as one of the following:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Upon startup of the web client—WPAD is performed only for the start of the first instance. Subsequent instances inherit the settings.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Whenever there is an indication from the networking stack that the IP address of the client host has changed.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">A web client can use either option, depending on what makes sense in its environment. In addition, the client must attempt a discovery cycle upon expiration of a previously downloaded PAC file in accordance with HTTP expiration. It’s important that the client obey the timeouts and rerun the WPAD process when the PAC file expires.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3216"></a><span class="font24">Optionally, the client also may implement rerunning the WPAD process on failure of the currently configured proxy if the PAC file does not provide an alternative.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Whenever the client decides to invalidate the current PAC file, it must rerun the entire WPAD protocol to ensure it discovers the currently correct CURL. Specifically, there is no provision in the protocol to do an If-Modified-Since conditional fetch of the PAC file.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">A number of network round trips might be required during the WPAD protocol broadcast and/or multicast communications. The WPAD protocol should not be invoked at a more frequent rate than specified above (such as per-URL retrieval).</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3217"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3218"></a>WPAD spoofing</span></h4>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3219"></a><span class="font24">The IE 5 implementation of WPAD enabled web clients to detect proxy settings automatically, without user intervention. The algorithm used by WPAD prepends the hostname “wpad” to the fully qualified domain name and progressively removes subdomains until it either finds a WPAD server answering the hostname or reaches the third-level domain. For instance, web clients in the domain </span><span class="font24" style="font-style:italic;">a.b.microsoft.com </span><span class="font24">would query </span><span class="font24" style="font-style:italic;">wpad.a.b.microsoft</span><span class="font24">, </span><span class="font24" style="font-style:italic;">wpad.b.microsoft.com</span><span class="font24">, then </span><span class="font24" style="font-style:italic;">wpad.microsoft.com</span><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">This exposed a security hole, because in international usage (and certain other configurations), the third-level domain may not be trusted. A malicious user could set up a WPAD server and serve proxy configuration commands of her choice. Subsequent versions of IE (5.01 and later) rectified the problem.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3220"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3221"></a>Timeouts</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">WPAD goes through multiple levels of discovery, and clients must make sure that each phase is time-bound. When possible, limiting each phase to 10 seconds is <a name="bookmark3222"></a>considered reasonable, but implementors may choose a different value that is more appropriate to their network properties. For example, a device implementation, operating over a wireless network, might use a much larger timeout to account for low bandwidth or high latency.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3223"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3224"></a>Administrator considerations</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Administrators should configure at least one of the DHCP or DNS A record lookup methods in their environments, as those are the only two that all compatible clients are required to implement. Beyond that, configuring to support mechanisms earlier in the search order will improve client startup time.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">One of the major motivations for this protocol structure was to support client location of nearby proxy servers. In many environments, there are several proxy servers (workgroup, corporate gateway, ISP, backbone).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">There are a number of possible points at which “nearness” decisions can be made in the WPAD framework:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">• DHCP servers for different subnets can return different answers. They also can base decisions on the client cipaddr field or the client identifier option.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark3225"></a><span class="font24">• DNS servers can be configured to return different SRV/A/TXT resource records (RRs) for different domain suffixes (for example, QNAMEs </span><span class="font24" style="font-style:italic;">wpad.marketing.big-corp.com</span><span class="font24"> and </span><span class="font24" style="font-style:italic;">wpad.development.bigcorp.com</span><span class="font24">).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark3226"></a><span class="font24">• The web server handling the CURL request can make decisions based on the User-Agent header, Accept header, client IP address/subnet/hostname, topological distribution of nearby proxy servers, etc. This can occur inside a CGI executable created to handle the CURL. As mentioned earlier, it even can be a proxy server handling the CURL requests and making these decisions.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">• The PAC file may be expressive enough to select from a set of alternatives at runtime on the client. CARP is based on this premise for an array of caches. It is not inconceivable that the PAC file could compute some network distance or fitness metrics to a set of candidate proxy servers and then select the “closest” or “most responsive” server.</span></p></li></ul>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3227"></a><span class="font9" style="font-weight:bold;"><a name="bookmark187"></a><a name="bookmark3228"></a>Cache Redirection Methods</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">We’ve discussed techniques to redirect traffic to general servers and specialized techniques to vector traffic to proxies and gateways. This final section will explain some of the more sophisticated redirection techniques used for caching proxy servers. These techniques are more complex than the previously discussed protocols because they try to be reliable, high-performance, and content-aware—dispatching requests to locations likely to have particular pieces of content.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3229"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3230"></a><a name="bookmark3231"></a><a name="bookmark3232"></a><a name="bookmark3233"></a>WCCP Redirection</span></h3>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Cisco Systems developed the Web Cache Coordination Protocol (WCCP) to enable routers to redirect web traffic to proxy caches. WCCP governs communication between routers and caches so that routers can verify caches (make sure they are up and running), load balance among caches, and send specific types of traffic to specific caches. WCCP Version 2 (WCCP2) is an open protocol. We’ll discuss WCCP2 here.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3234"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3235"></a>How WCCP redirection works</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here’s a brief overview of how WCCP redirection works for HTTP (WCCP redirects other protocols similarly):</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• Start with a network containing WCCP-enabled routers and caches that can communicate with one another.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• A set of routers and their target caches form a WCCP service group. The configuration of the service group specifies what traffic is sent where, how traffic is sent, and how load should be balanced among the caches in the service group.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• If the service group is configured to redirect HTTP traffic, routers in the service group send HTTP requests to caches in the service group.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><a name="bookmark3236"></a><span class="font24">• When an HTTP request arrives at a router in the service group, the router chooses one of the caches in the service group to serve the request (based on either a hash on the request’s IP address or a mask/value set pairing scheme).</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• The router sends the request packets to the cache, either by encapsulating the packets with the cache’s IP address or by IP MAC forwarding.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">• If the cache cannot serve the request, the packets are returned to the router for normal forwarding.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 13pt 19pt;"><span class="font24">• The members of the service group exchange heartbeat messages with one another, continually verifying one another’s availability.</span></p></li></ul>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3237"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3238"></a>WCCP2 messages</span></h4>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">There are four WCCP2 messages, described in </span><a href="#bookmark3239"><span class="font24">Table 20-4</span></a><span class="font24">.</span></p>
<table border="1">
<tr><td colspan="3" style="vertical-align:top;">
<p><a name="bookmark3239"></a><span class="font23" style="font-style:italic;">Table 20-4. WCCP2 messages</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Message name</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:20pt;"><span class="font2" style="font-weight:bold;">Who sends it</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:21pt;"><span class="font2" style="font-weight:bold;">Information carried</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">WCCP2_HERE_I_AM</span></p></td><td style="vertical-align:top;">
<p style="text-indent:20pt;"><span class="font2">Cache to router</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 21pt;"><span class="font2">These messages tell routers that caches are available to receive traffic. The messages contain all of the cache’s service group information. As soon as a cache joins a service group, it sends these messages to all routers in the group. These messages negotiate with routers sending WCCP2_I_SEE_YOU messages.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">WCCP2_I_SEE_YOU</span></p></td><td style="vertical-align:top;">
<p style="text-indent:20pt;"><span class="font2">Router to cache</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 21pt;"><span class="font2">These messages respond to WCCP2_HERE_I_AM messages. They are used to negotiate the packet forwarding method, assignment method (who is the designated cache), packet return method, and security.</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 20-4. WCCP2 messages (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Message name</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Who sends it</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Information carried</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">WCCP2_REDIRECT_ASSIGN</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Designated cache to router</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">These messages make assignments for load balancing; they send bucket information for hash table load balancing or mask/ value set pair information for mask/value load balancing.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">WCCP2_REMOVAL_QUERY</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Router to cache that has not sent WCCP2_HERE_ I_AM messages for 2.5 </span><span class="font4">× </span><span class="font2">HERE_I_AM_T seconds</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Ifa router does not receive WCCP2_HERE_I_AM messages regularly, the router sends this message to see if the cache should be removed from the service group. The proper response from a cache is three identical WCCP2_HERE_I_AM messages, separated by HERE_I_AM_T/10 seconds.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font24">The WCCP2_HERE_I_AM message format is:</span></p>
<p style="text-indent:19pt;"><span class="font3">WCCP Message Header</span></p>
<p style="text-indent:19pt;"><span class="font3">Security Info Component</span></p>
<p style="text-indent:19pt;"><span class="font3">Service Info Component</span></p>
<p style="text-indent:19pt;"><span class="font3">Web-cache Identity Info Component</span></p>
<p style="text-indent:19pt;"><span class="font3">Web-cache View Info Component</span></p>
<p style="text-indent:19pt;"><span class="font3">Capability Info Component (optional)</span></p>
<p style="text-indent:19pt;"><span class="font3">Command Extension Component (optional)</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The WCCP2_I_SEE_YOU message format is:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">WCCP Message Header</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Security Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Service Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Router Identity Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Router View Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Capability Info Component (optional)</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Command Extension Component (optional)</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3240"></a><span class="font24">The WCCP2_REDIRECT_ASSIGN message format is:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">WCCP Message Header</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Security Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Service Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Assignment Info Component, or Alternate Assignment Component</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The WCCP2_REMOVAL_QUERY message format is:</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">WCCP Message Header</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Security Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">Service Info Component</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 13pt 0pt;"><span class="font3">Router Query Info Component</span></p>
<h4 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3241"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3242"></a>Message components</span></h4>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each WCCP2 message consists of a header and components. The WCCP header information contains the message type (Here I Am, I See You, Assignment, or Removal Query), WCCP version, and message length (not including the length of the header).</span></p>
<p style="text-align:justify;"><span class="font24">The components each begin with a four-octet header describing the component type and length. The component length does not include the length of the component header. The message components are described in </span><a href="#bookmark3243"><span class="font24">Table 20-5</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3243"></a><span class="font23" style="font-style:italic;">Table 20-5. WCCP2 message components</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Component</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Security Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Contains the security option and security implementation. The security option can be:</span></p>
<p style="text-indent:30pt;"><span class="font3">WCCP2_NO_SECURITY (0)</span></p>
<p style="text-indent:30pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">WCCP2_MD5_SECURITY (1)</span></p>
<p style="text-indent:1pt;padding:0pt 0pt 2pt 16pt;"><span class="font2">If the option is no security, the security implementation field does not exist. If the option is MD5, the security implementation field is a 16-octet field containing the message checksum and Service Group password. The password can be no more than eight octets.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Service Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">Describes the service group. The service type ID can have two values:</span></p>
<p style="text-indent:26pt;"><span class="font3">WCCP2_SERVICE_STANDARD (0)</span></p>
<p style="text-indent:26pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">WCCP2_SERVICE_DYNAMIC (1)</span></p>
<p style="text-indent:1pt;padding:0pt 0pt 2pt 16pt;"><span class="font2">If the service type is standard, the service is a well-known service, defined entirely by service ID. HTTP is an example of a well-known service. If the service type is dynamic, the following settings define the service: priority, protocol, service flags (which determine hashing), and port.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Router Identity Info</span></p></td><td style="vertical-align:top;">
<p style="text-indent:1pt;padding:0pt 0pt 0pt 16pt;"><span class="font2">Contains the router IP address and ID, and lists (by IP address) all of the web caches with which the router intends to communicate.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Web Cache Identity Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:1pt;padding:0pt 0pt 0pt 16pt;"><a name="bookmark3244"></a><span class="font2">Contains the web cache IP address and redirection hash table mapping.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Router View Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Contains the router’s view of the service group (identities of the routers and caches).</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Web Cache View Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Contains the web cache’s view of the service group.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark3245"></a><span class="font2">Assignment Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Shows the assignment of a web cache to a particular hashing bucket.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Router Query Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:1pt;padding:0pt 0pt 0pt 16pt;"><span class="font2">Contains the router’s IP address, address of the web cache being queried, and ID of the last router in the service group that received a Here I Am message from the web cache.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Capabilities Info</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:1pt;padding:0pt 0pt 0pt 16pt;"><span class="font2">Used by routers to advertise supported packet forwarding, load balancing, and packet return methods; used by web caches to let routers know what method the web cache prefers.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Alternate Assignment</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Contains hash table assignment information for load balancing.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Assignment Map</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;"><span class="font2">Contains mask/value set elements for service group.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3246"></a><span class="font2">Command Extension</span></p></td><td style="vertical-align:top;">
<p style="text-indent:1pt;padding:0pt 0pt 0pt 16pt;"><span class="font2">Used by web caches to tell routers they are shutting down; used by routers to acknowledge a cache shutdown.</span></p></td></tr>
</table></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3247"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3248"></a>Service groups</span></h4>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">A </span><span class="font24" style="font-style:italic;">service group</span><span class="font24"> consists of a set of WCCP-enabled routers and caches that exchange WCCP messages. The routers send web traffic to the caches in the service group. The configuration of the service group determines how traffic is distributed to caches in the service group. The routers and caches exchange service group configuration information in Here I Am and I See You messages.</span></p>
<h4 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3249"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3250"></a>GRE packet encapsulation</span></h4>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Routers that support WCCP redirect HTTP packets to a particular server by encapsulating them with the server’s IP address. The packet encapsulation also contains an IP header proto field that indicates Generic Router Encapsulation (GRE). The existence of the proto field tells the receiving proxy that it has an encapsulated packet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3251"></a><span class="font24">Because the packet is encapsulated, the client IP address is not lost.</span><a href="#bookmark3252"><span class="font24"> Figure 20-12</span></a><span class="font24"> illustrates GRE packet encapsulation.</span></p>
<table>
<tr><td><img src="book_files/book-579.jpg" alt="" style="width:360pt;height:170pt;"></td></tr>
<tr><td>
<p><a name="bookmark3252"></a><span class="font23" style="font-style:italic;"><a name="bookmark3253"></a><a name="bookmark3254"></a>Figure 20-12. How a WCCP router changes an HTTP packet’s destination IP address</span></p></td></tr>
</table>
<h4 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3255"></a><span class="font5" style="font-weight:bold;"><a name="bookmark3256"></a>WC<a name="bookmark3257"></a>CP load balancing</span></h4>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In addition to routing, WCCP routers can balance load among several receiving servers. WCCP routers and their receiving servers exchange </span><span class="font24" style="font-style:italic;">heartbeat messages</span><span class="font24"> to let one another know they are up and running. If a particular receiving server stops sending heartbeat messages, the WCCP router sends request traffic directly to the Internet, instead of redirecting it to that node. When the node returns to service, the WCCP router begins receiving heartbeat messages again and resumes sending request traffic to the node.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3258"></a><span class="font9" style="font-weight:bold;"><a name="bookmark188"></a><a name="bookmark3259"></a>Internet Cache Protocol</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The Internet Cache Protocol (ICP) allows caches to look for content hits in sibling caches. If a cache does not have the content requested in an HTTP message, it can find out if the content is in a nearby sibling cache and, if so, retrieve the content from there, hopefully avoiding a more costly query to an origin server. ICP can be thought of as a cache clustering protocol. It is a redirection protocol in the sense that the final destination ofan HTTP request message can be determined by a series of ICP queries.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">ICP is an object discovery protocol. It asks nearby caches, all at the same time, if any of them have a particular URL in their caches. The nearby caches send back a short message saying “HIT” if they have that URL or “MISS” if they don’t. The cache is then free to open an HTTP connection to a neighbor cache that has the object.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">ICP is simple and lightweight. ICP messages are 32-bit packed structures in network byte order, making them easy to parse. They are carried in UDP datagrams for efficiency. UDP is an unreliable Internet protocol, which means that the data can get destroyed in transit, so programs that speak ICP need to have timeouts to detect lost datagrams.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Here is a brief description of the parts of an ICP message:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Opcode</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The opcode is an 8-bit value that describes the meaning of the ICP message. Basic opcodes are ICP_OP_QUERY request messages and ICP_OP_HIT and ICP_OP_MISS response messages.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Version</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The 8-bit version number describes the version number of the ICP protocol. The version of ICP used by Squid, documented in Internet RFC 2186, is Version 2.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Message length</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The total size in bytes of the ICP message. Because there are only 16 bits, the ICP message size cannot be larger than 16,383 bytes. URLs usually are shorter than 16 KB; if they’re longer than that, many web applications will not process them.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Request number</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">ICP-enabled caches use the request number to keep track of multiple simultaneous requests and replies. An ICP reply message always must contain the same request number as the ICP request message that triggered the reply.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Options</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The 32-bit ICP options field is a bit vector containing flags that modify ICP behavior. ICPv2 defines two flags, both of which modify ICP_OP_QUERY requests. The ICP_FLAG_HIT_OBJ flag enables and disables the return of document data in ICP responses. The ICP_FLAG_SRC_RTT flag requests an estimate of the round-trip time to the origin server, as measured by a sibling cache.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Option data</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The 32-bit option data is reserved for optional features. ICPv2 uses the low 16 bits of the option data to hold an optional round-trip time estimate from the sibling to the origin server.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Sender host address</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">A historic field carrying the 32-bit IP address of the message sender; not used in practice.</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Payload</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">The contents of the payload vary depending on the message type. For ICP_OP_ QUERY, the payload is a 4-byte original requester host address followed by a NUL-terminated URL. For ICP_OP_HIT_OBJ, the payload is a NUL-terminated URL followed by a 16 bit object size, followed by the object data.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information about ICP, refer to informational RFCs 2186 and 2187. Excellent ICP and peering references also are available from the U.S. National Laboratory for Applied Network Research (</span><a href="http://www.nlanr.net/Squid/"><span class="font24" style="font-style:italic;">http://www.nlanr.net/Squid/</span></a><span class="font24">).</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3260"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3261"></a><a name="bookmark189"></a><a name="bookmark3262"></a>Cache Array Routing Protocol</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3263"></a><span class="font24">Proxy servers greatly reduce traffic to the Internet by intercepting requests from individual users and serving cached copies of the requested web objects. However, as the number of users grows, a high volume of traffic can overload the proxy servers themselves.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">One solution to this problem is to use multiple proxy servers to distribute the load to a collection of servers. The Cache Array Routing Protocol (CARP) is a standard proposed by Microsoft Corporation and Netscape Communication Corporation to administer a collection of proxy servers such that an array of proxy servers appears to clients as one logical cache.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">CARP is an alternative to ICP. Both CARP and ICP allow administrators to improve performance by using multiple proxy servers. This section discusses how CARP differs from ICP, the advantages and disadvantages of using CARP over ICP, and the technical details of how the CARP protocol is implemented.</span></p>
<p style="text-align:justify;"><span class="font24">Upon a cache miss in ICP, the proxy server queries neighboring caches using an ICP message format to determine the availability of the web object. The neighboring caches respond with either a “HIT” or a “MISS,” and the requesting proxy server uses these responses to select the most appropriate location from which to retrieve the object. If the ICP proxy servers were arranged in a hierarchical fashion, a miss would be elevated to the parent. </span><a href="#bookmark3264"><span class="font24">Figure 20-13 </span></a><span class="font24">diagrammatically shows how hits and misses are resolved using ICP.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Hit or miss reply (time </span><span class="font19" style="font-style:italic;">n</span><span class="font1" style="font-style:italic;">+1)</span></p></td><td><img src="book_files/book-580.jpg" alt="" style="width:19pt;height:18pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Sibling</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 0pt 165pt;"><span class="font0">Parent of proxy is polled if the siblings return a MISS</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Request (time </span><span class="font19" style="font-style:italic;">n</span><span class="font1" style="font-style:italic;">+2)</span></p></td><td><img src="book_files/book-581.jpg" alt="" style="width:31pt;height:34pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Parent</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">Client request</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Caching proxy</span></p></td></tr>
<tr><td>
<p><span class="font1" style="font-style:italic;">Hit or miss reply (time </span><span class="font19" style="font-style:italic;">n</span><span class="font1" style="font-style:italic;">+1)</span></p></td><td><img src="book_files/book-582.jpg" alt="" style="width:25pt;height:73pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Sibling</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Browser</span></p>
</div><br clear="all">
<p><a name="bookmark3264"></a><span class="font23" style="font-style:italic;">Figure 20-13. ICP queries</span></p>
<p style="text-align:justify;"><span class="font24">Note that each of the proxy servers, connected together using the ICP protocol, is a standalone cache server with redundant mirrors of content, meaning that duplicate entries of web objects across proxy servers is possible. In contrast, the collection of servers connected using CARP operates as a single, large server with each component server containing only a fraction of the total cached documents. By applying a hash function to the URL of a web object, CARP maps web objects to a specific proxy server. Because each web object has a unique home, we can determine the location of the object by a single lookup, rather than polling each of the proxy servers configured in the collection. </span><a href="#bookmark3265"><span class="font24">Figure 20-14</span></a><span class="font24"> summarizes the CARP approach.</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-583.jpg" alt="" style="width:24pt;height:33pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Sibling</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-584.jpg" alt="" style="width:30pt;height:33pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Parent</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font1" style="font-style:italic;">Client request</span></p></td><td><img src="book_files/book-585.jpg" alt="" style="width:48pt;height:26pt;"></td><td>
<p><span class="font1" style="font-style:italic;">Request (time </span><span class="font19" style="font-style:italic;">n</span><span class="font1" style="font-style:italic;">+2)</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Internet</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Caching proxy</span></p></td></tr>
<tr><td>
<p><span class="font0">Hash function used to decide which sibling proxy cache to contact</span></p>
<p style="padding:0pt 0pt 0pt 67pt;"><span class="font1" style="font-style:italic;">Response (time </span><span class="font19" style="font-style:italic;">n</span><span class="font1" style="font-style:italic;">+1)</span></p></td><td><img src="book_files/book-586.jpg" alt="" style="width:33pt;height:67pt;"></td></tr>
<tr><td colspan="2">
<p><span class="font1" style="font-weight:bold;">Sibling</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-weight:bold;">Browser</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3265"></a><span class="font23" style="font-style:italic;"><a name="bookmark3266"></a>Figure 20-14. CARP redirection</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Although</span><a href="#bookmark3265"><span class="font24"> Figure 20-14</span></a><span class="font24"> shows the caching proxy as being the intermediary between clients and proxy servers that distributes the load to the various proxy servers, it is possible for this function to be served by the clients themselves. Commercial browsers such as Internet Explorer and Netscape Navigator can be configured to compute the hash function in the form of a plug-in that determines the proxy server to which the request should be sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Deterministic resolution of the proxy server in CARP means that it isn’t necessary to send queries to all the neighbors, which means that this method requires fewer intercache messages to be sent out. As more proxy servers are added to the configuration, the collective cache system will scale fairly well. However, a disadvantage of CARP is that if one of the proxy servers becomes unavailable, the hash function needs to be modified to reflect this change, and the contents of the proxy servers must be reshuffled across the existing proxy servers. This can be expensive if the proxy server crashes often. In contrast, redundant content in ICP proxy servers means that reshuffling is not required. Another potential problem is that, because CARP is a new protocol, existing proxy servers running only the ICP protocol may not be included readily in a CARP collection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Having described the difference between CARP and ICP, let us now describe CARP in a little more detail. The CARP redirection method involves the following tasks:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Keep a table of participating proxy servers. These proxy servers are polled periodically to see which ones are still active.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• For each participating proxy server, compute a hash function. The value returned by the hash function takes into account the amount of load this proxy can handle.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Define a separate hash function that returns a number based on the URL of the requested web object.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">• Take the sum of the hash function of the URL and the hash function of the proxy servers to get an array of numbers. The maximum value of these numbers determines the proxy server to use for the URL. Because the computed values are deterministic, subsequent requests for the same web object will be forwarded to the same proxy server.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">These four chores can either be carried out on the browser, in a plug-in, or be computed on an intermediate server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">For each collection of proxy servers, create a table listing all of the servers in the collection. Each entry in the table should contain information about load factors, time-to-live (TTL) countdown values, and global parameters such as how often members should be polled. The load factor indicates how much load that machine can handle, which depends on the CPU speed and hard drive capacity of that machine. The table can be maintained remotely via an RPC interface. Once the fields in the tables have been updated by RPC, they can be made available or published to downstream clients and proxies. This publication is done in HTTP, allowing any client or proxy server to consume the table information without introducing another inter-proxy protocol. Clients and proxy servers simply use a well-known URL to retrieve the table.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The hash function used must ensure that the web objects are statistically distributed across the participating proxy servers. The load factor of the proxy server should be used to determine the statistic probability of a web object being assigned to that proxy.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In summary, the CARP protocol allows a group of proxy servers to be viewed as single collective cache, instead of a group of cooperating but separate caches (as in ICP). A deterministic request resolution path finds the home of a specific web object within a single hop. This eliminates the inter-proxy traffic that often is generated to <a name="bookmark3267"></a><a name="bookmark3268"></a>find the web object in a group of proxy servers in ICP. CARP also avoids duplicate copies of web objects being stored on different proxy servers, which has the advantage that the cache system collectively has a larger capacity for storing web objects but also has the disadvantage that a failure in any one proxy requires reshuffling some of the cache contents to existing proxies.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3269"></a><span class="font9" style="font-weight:bold;"><a name="bookmark190"></a><a name="bookmark3270"></a>Hyper Text Caching Protocol</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Earlier, we discussed ICP, a protocol that allows proxy caches to query siblings about the presence of documents. ICP, however, was designed with HTTP/0.9 in mind and therefore allows caches to send just the URL when querying a sibling about the presence of a resource. Versions 1.0 and 1.1 of HTTP introduced many new request headers that, along with the URL, are used to make decisions about document matching, so simply sending the URL in a request may not result in accurate responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The Hyper Te<a name="bookmark3271"></a>xt Caching Protocol (HTCP) reduces the probability of false hits by allowing siblings to query each other for the presence of documents using the URL and all of the request and response headers. Further, HTCP allows sibling caches to monitor and request the addition and deletion of selected documents in each other’s caches and to make changes in the caching policies of each other’s cached documents.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a href="#bookmark3264"><span class="font24">Figure 20-13</span></a><span class="font24">, which illustrates an ICP transaction, also can be used to illustrate an HTCP transaction—HTCP is just another object discovery protocol. If a nearby cache has the document, the requesting cache can open an HTTP connection to the cache to get a copy of the document. The difference between an ICP and an HTCP transaction is in the level of detail in the requests and responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">The structure of HTCP messages is illustrated in</span><a href="#bookmark3272"><span class="font24"> Figure 20-15</span></a><span class="font24">. The Header portion includes the message length and message versions. The Data portion starts with the data length and includes opcodes, response codes, and some flags and IDs, and it terminates with the actual data. An optional Authentication section may follow the Data section.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Details of the message fields are as follows:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">Header</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The Header section consists of a 32-bit message length, an 8-bit major protocol version, and an 8-bit minor protocol version. The message length includes all of the header, data, and authentication sizes.</span></p>
<p><span class="font24" style="font-style:italic;">Data</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">The Data section contains the HTCP message and has the structure illustrated in </span><a href="#bookmark3272"><span class="font24">Figure 20-15</span></a><span class="font24">. The data components are described in </span><a href="#bookmark3273"><span class="font24">Table 20-6</span></a><span class="font24">.</span></p><img src="book_files/book-587.jpg" alt="" style="width:192pt;height:206pt;">
<table>
<tr><td>
<p><a name="bookmark3272"></a><span class="font23" style="font-style:italic;"><a name="bookmark3274"></a>Figure 20-15. HTCP message format</span></p>
<p><a name="bookmark3273"></a><span class="font23" style="font-style:italic;">Table 20-6. HTCP data components</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Component</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:17pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Data length</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font2">A 16-bit value of the number of bytes in the Data section including the length of the Length field itself.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Opcode</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font2">The 4-bit operation code for the HTCP transaction. The full list of opcodes is provided in </span><a href="#bookmark3275"><span class="font2">Table 20-7</span></a><span class="font2">.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Response code</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 17pt;"><span class="font2">A 4-bit key indicating the success or failure of the transaction. The possible values are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 0—Authentication was not used, but is needed</span></p></li>
<li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 1—Authentication was used, but is not satisfactory</span></p></li>
<li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 2—Unimplemented opcode</span></p></li>
<li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 3—Major version not supported</span></p></li>
<li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 4—Minor version not supported</span></p></li>
<li>
<p style="text-indent:21pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">• 5—Inappropriate, disallowed, or undesirable opcode</span></p></li></ul></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">F1</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font2">F1 is overloaded—if the message is a request, F1is a 1-bit flag set by the requestor indicating that it needs a response (F1=1); if the message is a response, F1 is a 1-bit flag indicating whether the response is to be interpreted as a response to the overall message (F1=1) or just as a response to the Opcode data fields (F1=0).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">RR</span></p></td><td style="vertical-align:top;">
<p style="text-indent:17pt;"><span class="font2">A 1-bit flag indicating that the message is a request (RR=0) or a response (RR=1).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Transaction ID</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font2">A 32-bit value that, combined with the requestor’s network address, uniquely identifies the HTCP transaction.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Opcode data</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 17pt;"><span class="font2">Opcode data is opcode-dependent. See </span><a href="#bookmark3275"><span class="font2">Table 20-7</span></a><span class="font2">.</span></p></td></tr>
</table></td></tr>
</table>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3275"><span class="font24">Table 20-7</span></a><a name="bookmark3276"></a><span class="font24"> lists the HTCP opcodes and their corresponding data types.</span></p>
<table>
<tr><td>
<p><a name="bookmark3275"></a><span class="font23" style="font-style:italic;">Table 20-7. HTCP opcodes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Opcode</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Response codes</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Opcode data</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NOP</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">0</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">Essentially a “ping” operation.</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Always 0</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">None</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TST</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">1</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">0 if entity is present, 1 if entity is not present</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Contains the URL and request headers in the request and just response headers in the response</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3277"></a><span class="font2">MON</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">2</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">0 if accepted, 1 if refused</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SET</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">3</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font2">The SET message allows caches to request changes in caching policies. See </span><a href="#bookmark3278"><span class="font2">Table 20-9</span></a><span class="font2"> for a list of the headers that can be used in SET messages.</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">0 if accepted, 1 if ignored</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CLR</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">4</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">0ifIhadit, butit’snowgone; 1 if I had it, but I am keeping it; and 2 if I didn’t have it</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3279"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3280"></a>HTCP Authentication</span></h3>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">The authentication portion of the HTCP message is optional. Its structure is illustrated in</span><a href="#bookmark3272"><span class="font24"> Figure 20-15</span></a><span class="font24">, and its components are described in</span><a href="#bookmark3281"><span class="font24">Table 20-8</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3281"></a><span class="font23" style="font-style:italic;">Table 20-8. HTCP authentication components</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Component</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:20pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Auth length</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 20pt;"><span class="font2">The 16-bit number of bytes in the Authentication section of the message, including the length of the Length field itself.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3282"></a><span class="font2">Sig time</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 20pt;"><a name="bookmark3283"></a><span class="font2">A 32-bit number representing the number of seconds since 00:00:00 Jan 1, 1970 GMT at the time that the signature is generated.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sig expire</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 20pt;"><span class="font2">A 32-bit number representing the number of seconds since 00:00:00 Jan 1, 1970 GMT when the signature will expire.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Key name</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 20pt;"><span class="font2">A string that specifies the name of the shared secret. The Key section has two parts: the 16-bit length in bytes of the string that follows, followed by the stream of uninterrupted bytes of the string.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Signature</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 20pt;"><span class="font2">The HMAC-MD5 digest with a B value of 64 (representing the source and destination IP addresses and ports), the major and minor HTCP versions of the message, the Sig time and Sig expires values, the full HTCP data, and the key. The Signature also has two parts: the 16-bit length in bytes of the string, followed by the string.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3284"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3285"></a>Setting Caching Policies</span></h3>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font24">The SET message allows caches to request changes in the caching policies of cached documents. The headers that can be used in SET messages are described in</span><a href="#bookmark3278"><span class="font24"> Table 20-9</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3278"></a><span class="font23" style="font-style:italic;">Table 20-9. List of Cache headers for modifying caching policies</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Header</span></p></td><td style="vertical-align:top;">
<p style="text-indent:16pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Vary</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The requestor has learned that the content varies on a set of headers different from the set in the response Vary header. This header overrides the response Vary header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Location</span></p></td><td style="vertical-align:top;">
<p style="text-indent:16pt;"><span class="font2">The list of proxy caches that also may have copies of this object.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Policy</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The requestor has learned the caching policies for this object in more detail than is specified in the response headers. Possible values are: “no-cache,” meaning that the response is not cacheable but may be shareable among simultaneous requestors; “no-share,” meaning that the object is not shareable; and “no-cache-cookie,” meaning that the content may change as a result of cookies and caching therefore is not advised.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-Flags</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><a name="bookmark3286"></a><span class="font2">The requestor has modified the object’s caching policies and the object may have to be treated specially and not necessarily in accordance with the object’s actual policies.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">Cache-Expiry</span></p>
<p style="text-indent:7pt;"><span class="font2">Cache-MD5</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:16pt;padding:0pt 0pt 3pt 0pt;"><span class="font2">The actual expiration time for the document as learned by the requestor.</span></p>
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The requestor-computed MD5 checksum of the object, which may be different from the value in the Content-MD5 header, or may be supplied because the object does not have a Content-MD5 header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cache-to-Origin</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 16pt;"><span class="font2">The requestor-measured round-trip time to an origin server. The format of the values in this header is </span><span class="font3" style="font-style:italic;">&lt;origin server name or ip&gt; &lt;average round-trip time in seconds&gt; &lt;number of samples&gt; &lt;number of router hops between requestor and origin server&gt;</span><span class="font2">.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">By allowing request and response headers to be sent in query messages to sibling caches, HTCP can decrease the false-hit rate in cache queries. By further allowing sibling caches to exchange policy information with each other, HTCP can improve sibling caches’ ability to cooperate with each other.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3287"></a><span class="font9" style="font-weight:bold;"><a name="bookmark191"></a><a name="bookmark3288"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information, consult the following references:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">DNS and Bind</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">Cricket Liu, Paul Albitz, and Mike Loukides, O’Reilly &amp;&nbsp;Associates, Inc.</span></p>
<p style="text-align:justify;"><a href="http://www.wrec.org/Drafts/draft-cooper-webi-wpad-00.txt"><span class="font24" style="font-style:italic;">http://www.wrec.org/Drafts/draft-cooper-webi-wpad-00.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Web Proxy Auto-Discovery Protocol.”</span></p>
<p style="text-align:justify;"><a href="http://home.netscape.com/eng/mozilla/2.0/relnotes/demo/proxy-live.html"><span class="font24" style="font-style:italic;">http://home.netscape.com/eng/mozilla/2.0/relnotes/demo/proxy-live.html</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Navigator Proxy Auto-Config File Format.”</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2186.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2186.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">IETF RFC 2186, “Intercache Communication Protocol (ICP) Version 2,” by D. Wessels and K. Claffy.</span></p>
<p style="text-align:justify;"><a href="http://icp.ircache.net/carp.txt"><span class="font24" style="font-style:italic;">http://icp.ircache.net/carp.txt</span></a></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Cache Array Routing Protocol v1.0.”</span></p>
<p style="text-align:justify;"><a href="http://www.ietf.org/rfc/rfc2756.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2756.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 19pt;"><span class="font24">IETF RFC 2756, “Hyper Text Caching Protocol (HTCP/0.0),” byP. Vixie and D. Wessels.</span></p>
<p style="padding:0pt 0pt 2pt 18pt;"><a href="http://www.ietf.org/internet-drafts/draft-wilson-wrec-wccp-v2-00.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/internet-drafts/draft-wilson-wrec-wccp-v2-00.txt</span></a><span class="font24" style="font-style:italic;"> draft-wilson-wrec-wccp-v2-01.txt</span><span class="font24">, “Web Cache Communication Protocol V2.0,” by M. Cieslak, D. Forster, G. Tiwana, and R. Wilson.</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2131.txt?number=2131"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2131.txt?number=2131</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">“Dynamic Host Configuration Protocol.”</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2132.txt?number=2132"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2132.txt?number=2132</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">“DHCP Options and BOOTP Vendor Extensions.”</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2608.txt?number=2608"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2608.txt?number=2608</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">“Service Location Protocol, Version 2.”</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2219.txt?number=2219"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2219.txt?number=2219</span></a></p>
<p style="text-indent:18pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">“Use of DNS Aliases for Network Services.”</span></p>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">CHAPTER 21</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark3289"></a><span class="font11" style="font-weight:bold;"><a name="bookmark3290"></a><a name="bookmark245"></a><a name="bookmark192"></a><a name="bookmark3291"></a>Logging and Usage Tracking</span></h1>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3292"></a><span class="font24">Almost all servers and proxies log summaries of the HTTP transactions they process. This is done for a variety of reasons: usage tracking, security, billing, error detection, and so on. In this chapter, we take a brief tour of logging, examining what information about HTTP transactions typically is logged and what some of the common log formats contain.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3293"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3294"></a><a name="bookmark193"></a><a name="bookmark3295"></a>What to Log?</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For the most part, logging is done for two reasons: to look for problems on the server or proxy (e.g., which requests are failing), and to generate statistics about how web sites are accessed. Statistics are useful for marketing, billing, and capacity planning (for instance, determining the need for additional servers or bandwidth).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You could log all of the headers in an HTTP transaction, but for servers and proxies that process millions of transactions per day, the sheer bulk of all of that data quickly would get out of hand. You also would end up logging a lot of information that you don’t really care about and may never even look at.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Typically, just the basics of a transaction are logged. A few examples of commonly logged fields are:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP method</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP version of client and server</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• URL of the requested resource</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• HTTP status code of the response</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Size of the request and response messages (including any entity bodies)</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Timestamp of when the transaction occurred</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">• Referer and User-Agent header values</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3296"></a><span class="font24">The HTTP method and URL tell what the request was trying to do—for example, GETting a resource or POSTing an order form. The URL can be used to track popularity of pages on the web site.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3297"></a><span class="font24">The version strings give hints about the client and server, which are useful in debugging strange or unexpected interactions between clients and servers. For example, if requests are failing at a higher-than-expected rate, the version information may point to a new release of a browser that is unable to interact with the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The HTTP status code tells what happened to the request: whether it was successful, the authorization attempt failed, the resource was found, etc. (See</span><a href="#bookmark307"><span class="font24"> “Status</span></a><span class="font24"> </span><a href="#bookmark307"><span class="font24">Codes” in Chapter 3 </span></a><span class="font24">for a list of HTTP status codes.)</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The size of the request/response and the timestamp are used mainly for accounting purposes; i.e., to track how many bytes flowed into, out of, or through the application. The timestamp also can be used to correlate observed problems with the requests that were being made at the time.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3298"></a><span class="font9" style="font-weight:bold;"><a name="bookmark194"></a><a name="bookmark3299"></a>Log Formats</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3300"></a><span class="font24">Several log formats have become standard, and we’ll discuss some of the most common formats in this section. Most commercial and open source HTTP applications support logging in one or more of these common formats. Many of these applications also support the ability of administrators to configure log formats and create their own custom formats.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">One of the main benefits of supporting (for applications) and using (for administrators) these more standard formats rests in the ability to leverage the tools that have been built to process and generate basic statistics from these logs. Many open source and commercial packages exist to crunch logs for reporting purposes, and by utilizing standard formats, applications and their administrators can plug into these resources.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3301"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3302"></a>Common Log Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">One of the most common log formats in use today is called, appropriately, the Common Log Format. Originally defined by NCSA, many servers use this log format as a default. Most commercial and open source servers can be configured to use this format, and many commercial and freeware tools exist to help parse common log files.</span><a href="#bookmark3303"><span class="font24"> Table 21-1 </span></a><span class="font24">lists, in order, the fields of the Common Log Format.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3303"></a><span class="font23" style="font-style:italic;">Table 21-1. Common Log Format fields</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-align:justify;text-indent:7pt;"><span class="font2">remotehost &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The hostname or IP address of the requestor’s machine (IP if the server was not configured to perform</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 70pt;"><span class="font2">reverse DNS or cannot look up the requestor’s hostname)</span></p>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">username &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If an </span><span class="font3" style="font-style:italic;">ident</span><span class="font2"> lookup was performed, the requestor’s authenticated username<sup>a</sup></span></p>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 21-1. Common Log Format fields (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">auth-username</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">If authentication was performed, the username with which the requestor authenticated</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">timestamp request-line response-code response-size</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">The date and time of the request</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">The exact text of the HTTP request line, “GET /index.html HTTP/1.1”</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">The HTTP status code that was returned in the response</span></p>
<p style="text-indent:10pt;padding:0pt 0pt 4pt 0pt;"><span class="font2">The Content-Length of the response entity—if no entity was returned in the response, a zero is logged</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> RFC 931 describes the </span><span class="font3" style="font-style:italic;">ident</span><span class="font3"> lookup used in this authentication. The </span><span class="font3" style="font-style:italic;">ident</span><span class="font3"> protocol was discussed in </span><a href="#bookmark229"><span class="font3">Chapter 5</span></a><span class="font3">.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3304"><span class="font24">Example 21-1 </span></a><span class="font24">lists a few examples of Common Log Format entries.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3304"></a><span class="font23" style="font-style:italic;">Example 21-1. Common Log Format</span></p>
<p style="text-align:justify;"><span class="font3">209.1.32.44 - - [03/Oct/1999:14:16:00 -0400] &quot;GET / HTTP/1.0&quot; 200 1024</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font3">http-guide.com - dg [03/Oct/1999:14:16:32 -0400] &quot;GET / HTTP/1.0&quot; 200 477 http-guide.com - dg [03/Oct/1999:14:16:32 -0400] &quot;GET /foo HTTP/1.0&quot; 404 0</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">In these examples, the fields are assigned as follows:</span></p>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Entry 1</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Entry 2</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2" style="font-weight:bold;">Entry 2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">remotehost</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">209.1.32.44</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">http-guide.com</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">http-guide.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">username</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">&lt;empty&gt;</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">&lt;empty&gt;</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">&lt;empty&gt;</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">auth-username</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">&lt;empty&gt;</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">dg</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">dg</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">timestamp</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">03/Oct/1999:14:16:00 -0400</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">03/Oct/1999:14:16:32 -0400</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">03/Oct/1999:14:16:32 -0400</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">request-line</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">GET / HTTP/1.0</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">GET / HTTP/1.0</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">GET /foo HTTP/1.0</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark3305"></a><span class="font2">response-code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">200</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">200</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:10pt;"><span class="font2">404</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">response-size</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">1024</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">477</span></p></td><td style="vertical-align:top;">
<p style="text-indent:10pt;"><span class="font2">0</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Note that the </span><span class="font24" style="font-style:italic;">remotehost</span><span class="font24"> field can be either a hostname, as in </span><span class="font24" style="font-style:italic;">http-guide.com</span><span class="font24">, or an IP address, such as 209.1.32.44.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The dashes in the second (username) and third (auth-username) fields indicate that the fields are empty. This indicates that either an </span><span class="font24" style="font-style:italic;">ident</span><span class="font24"> lookup did not occur (second field empty) or authentication was not performed (third field empty).</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3306"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3307"></a>Combined Log Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Another commonly used log format is the Combined Log Format. This format is supported by servers such as Apache. The Combined Log Format is very similar to the Common Log Format; in fact, it mirrors it exactly, with the addition of two fields (listed in</span><a href="#bookmark3308"><span class="font24"> Table 21-2</span></a><span class="font24">). The User-Agent field is useful in noting which HTTP client applications are making the logged requests, while the Referer field provides more detail about where the requestor found this URL.</span></p>
<table>
<tr><td>
<p><a name="bookmark3308"></a><span class="font23" style="font-style:italic;">Table 21-2. Additional Combined Log Format fields</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Referer</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font2">The contents of the Referer HTTP header</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">User-Agent</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">The contents of the User-Agent HTTP header</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3309"><span class="font24">Example 21-2 </span></a><span class="font24">gives an example of a Combined Log Format entry.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3309"></a><span class="font23" style="font-style:italic;">Example 21-2. Combined Log Format</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font3">209.1.32.44 - - [03/Oct/1999:14:16:00 -0400] &quot;GET / HTTP/1.0&quot; 200 1024 &quot;</span><a href="http://www.joes-hardware.com/"><span class="font3">http://www.joes-hardware.com/</span></a><span class="font3">&quot; &quot;5.0: Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)&quot;</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">In</span><a href="#bookmark3309"><span class="font24"> Example 21-2</span></a><span class="font24">, the Referer and User-Agent fields are assigned as follows:</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3310"></a><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Referer</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><a href="http://www.joes-hardware.com/"><span class="font2">http://www.joes-hardware.com/</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">User-Agent</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:28pt;"><span class="font2">5.0: Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The first seven fields of the example Combined Log Format entry in</span><a href="#bookmark3309"><span class="font24"> Example 21-2</span></a><span class="font24"> are exactly as they would be in the Common Log Format (see the first entry in </span><a href="#bookmark3304"><span class="font24">Example 21-1)</span></a><span class="font24">. The two new fields, Referer and User-Agent, are tacked onto the end of the log entry.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3311"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3312"></a>Netscape Extended Log Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When Netscape entered into the commercial HTTP application space, it defined for its servers many log formats that have been adopted by other HTTP application developers. Netscape’s formats derive from the NCSA Common Log Format, but they extend that format to incorporate fields relevant to HTTP applications such as proxies and web caches.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The first seven fields in the Netscape Extended Log Format are identical to those in the Common Log Format (see</span><a href="#bookmark3303"><span class="font24"> Table 21-1</span></a><span class="font24">).</span><a href="#bookmark3313"><span class="font24"> Table 21-3 </span></a><span class="font24">lists, in order, the new fields that the Netscape Extended Log Format introduces.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3313"></a><span class="font23" style="font-style:italic;">Table 21-3. Additional Netscape Extended Log Format fields</span></p>
<p><span class="font2" style="font-weight:bold;">Field &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2">proxy-response-code</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 0pt 12pt;"><span class="font2">If the transaction went through a proxy, the HTTP response code from the server to the proxy</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">proxy-response-size</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 12pt;"><span class="font2">If the transaction went through a proxy, the Content-Length of the server’s response entity sent to the proxy</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">client-request-size</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 12pt;"><span class="font2">The Content-Length of any body or entity in the client’s request to the proxy</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">proxy-request-size</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 12pt;"><span class="font2">If the transaction went through a proxy, the Content-Length of any body or entity in the proxy’s request to the server</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">client-request-hdr-size</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 12pt;"><span class="font2">The length, in bytes, of the client’s request headers</span></p></td></tr>
</table>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table 21-3. Additional Netscape Extended Log Format fields (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">proxy-response-hdr-size</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">If the transaction went through a proxy, the length, in bytes, of the proxy’s response headers that were sent to the requestor</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">proxy-request-hdr-size</span></p></td><td style="vertical-align:top;">
<p><span class="font2">If the transaction went through a proxy, the length, in bytes, of the proxy’s request headers that were sent to the server</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">server-response-hdr-size proxy-timestamp</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The length, in bytes, of the server’s response headers</span></p>
<p><span class="font2">If the transaction went through a proxy, the elapsed time for the request and response to travel through the proxy, in seconds</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3314"><span class="font24">Example 21-3 </span></a><span class="font24">gives an example of a Netscape Extended Log Format entry.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3314"></a><span class="font23" style="font-style:italic;">Example 21-3. Netscape Extended Log Format</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font3">209.1.32.44 - - [03/Oct/1999:14:16:00-0400] &quot;GET / HTTP/1.0&quot; 200 1024 200 102400 215 260 279 254 3</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">In this example, the extended fields are assigned as follows:</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark3315"></a><span class="font2">proxy-response-code proxy-response-size client-request-size proxy-request-size client-request-hdr-size proxy-response-hdr-size proxy-request-hdr-size server-response-hdr-size proxy-timestamp</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">200</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">1024</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">0</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">0</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">215</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">260</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">279</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">254</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">3</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The first seven fields of the example Netscape Extended Log Format entry in </span><a href="#bookmark3314"><span class="font24">Example 21-3 </span></a><span class="font24">mirror the entries in the Common Log Format example (see the first entry in</span><a href="#bookmark3304"><span class="font24"> Example 21-1)</span></a><span class="font24">.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3316"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3317"></a>Netscape Extended 2 Log Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Another Netscape log format, the Netscape Extended 2 Log Format, takes the Extended Log Format and adds further information relevant to HTTP proxy and web caching applications. These extra fields help paint a better picture of the interactions between an HTTP client and an HTTP proxy application.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The Netscape Extended 2 Log Format derives from the Netscape Extended Log Format, and its initial fields are identical to those listed in </span><a href="#bookmark3313"><span class="font24">Table 21-3</span></a><span class="font24"> (it also extends the Common Log Format fields listed in </span><a href="#bookmark3303"><span class="font24">Table 21-1</span></a><span class="font24">).</span></p>
<p style="padding:0pt 0pt 13pt 0pt;"><a href="#bookmark3318"><span class="font24">Table 21-4 </span></a><span class="font24">lists, in order, the additional fields of the Netscape Extended 2 Log Format.</span></p>
<table>
<tr><td>
<p><a name="bookmark3318"></a><span class="font23" style="font-style:italic;">Table 21-4. Additional Netscape Extended 2 Log Format fields</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:10pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">route</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:10pt;"><span class="font2">The route that the proxy used to make the request for the client (see </span><a href="#bookmark3319"><span class="font2">Table 21-5</span></a><span class="font2">)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">client-finish-status-code</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">The client finish status code; specifies whether the client request to the proxy completed successfully (FIN) or was interrupted (INTR)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">proxy-finish-status-code</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 10pt;"><span class="font2">The proxy finish status code; specifies whether the proxy request to the server completed successfully (FIN) or was interrupted (INTR)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">cache-result-code</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:10pt;"><span class="font2">The cache result code; tells how the cache responded to the request<sup>a</sup></span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> </span><a href="#bookmark3320"><span class="font3">Table 21-7 </span></a><span class="font3">lists the Netscape cache result codes.</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3321"><span class="font24">Example 21-4 </span></a><span class="font24">gives an example of a Netscape Extended 2 Log Format entry.</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3321"></a><span class="font23" style="font-style:italic;">Example 21-4. Netscape Extended 2 Log Format</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">209.1.32.44 - - [03/Oct/1999:14:16:00-0400] &quot;GET / HTTP/1.0&quot; 200 1024 200 102400 215 260 279 254 3 DIRECT FIN FIN WRITTEN</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font24">The extended fields in this example are assigned as follows:</span></p>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">route</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">DIRECT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">client-finish-status-code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">FIN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">proxy-finish-status-code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">FIN</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">cache-result-code</span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2">WRITTEN</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">The first 16 fields in the Netscape Extended 2 Log Format entry in</span><a href="#bookmark3321"><span class="font24"> Example 21-4 </span></a><span class="font24">mirror the entries in the Netscape Extended Log Format example (see</span><a href="#bookmark3314"><span class="font24"> Example 21-3)</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a href="#bookmark3319"><span class="font24">Table 21-5</span></a><span class="font24"> lists the valid Netscape route codes.</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td colspan="2" style="vertical-align:top;">
<p><a name="bookmark3319"></a><span class="font23" style="font-style:italic;">Table 21-5. Netscape route codes</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">DIRECT</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The resource was fetched directly from the server.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">PROXY(host:port)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The resource was fetched through the proxy “host.”</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">SOCKS(socks:port)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:19pt;"><span class="font2">The resource was fetched through the SOCKS server “host.”</span></p></td></tr>
</table></td></tr>
</table>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3322"><span class="font24">Table 21-6</span></a><span class="font24"> lists the valid Netscape finish codes.</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a name="bookmark3322"></a><span class="font23" style="font-style:italic;">Table 21-6. Netscape finish status codes</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2" style="font-weight:bold;">Value &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The request never even started.</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 11pt 0pt;"><span class="font2">FIN &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The request was completed successfully.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">INTR</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font2">The request was interrupted by the client or ended by a proxy/server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TIMEOUT</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font2">The request was timed out by the proxy/server.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3320"><span class="font24">Table 21-7</span></a><span class="font24"> lists the valid Netscape cache codes.</span></p>
<table>
<tr><td>
<p><a name="bookmark3320"></a><span class="font23" style="font-style:italic;">Table 21-7. Netscape cache codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Code</span></p></td><td style="vertical-align:top;">
<p style="text-indent:13pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">-</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:13pt;"><span class="font2">The resource was uncacheable.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">WRITTEN</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">The resource was written into the cache.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">REFRESHED</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">The resource was cached and it was refreshed.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">NO-CHECK</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">The cached resource was returned; no freshness check was done.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UP-TO-DATE</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:13pt;"><span class="font2">The cached resource was returned; a freshness check was done.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HOST-NOT-AVAILABLE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">The cached resource was returned; no freshness check was done because the remote server was not available.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CL-MISMATCH</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">The resource was not written to the cache; the write was aborted because the Content-Length did not match the resource size.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3323"></a><span class="font2">ERROR</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 13pt;"><span class="font2">The resource was not written to the cache due to some error; for example, a timeout occurred or the client aborted the transaction.</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3324"></a><span class="font24">Netscape applications, like many other HTTP applications, have other log formats too, including a Flexible Log Format and a means for administrators to output custom log fields. These formats allow administrators greater control and the ability to customize their logs by choosing which parts of the HTTP transaction (headers, status, sizes, etc.) to report in their logs.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The ability for administrators to configure custom formats was added because it is difficult to predict what information administrators will be interested in getting from their logs. Many other proxies and servers also have the ability to emit custom logs.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3325"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3326"></a>Squid Proxy Log Format</span></h3>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font24">The Squid proxy cache (</span><a href="http://www.squid-cache.org"><span class="font24" style="font-style:italic;">http://www.squid-cache.org</span></a><span class="font24">) is a venerable part of the Web. Its roots trace back to one of the early web proxy cache projects (</span><span class="font24" style="font-style:italic;">ftp://ftp.cs.colorado.edu/ pub/techreports/schwartz/Harvest.Conf.ps.Z</span><span class="font24">). Squid is an open source project that has been extended and enhanced by the open source community over the years. Many tools have been written to help administer the Squid application, including tools to help process, audit, and mine its logs. Many subsequent proxy caches adopted the Squid format for their own logs so that they could leverage these tools.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font20">*</span><a href="#bookmark1520"><span class="font20"> Chapter 7</span></a><span class="font20"> discusses HTTP caching in detail.</span></p>
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font24">The format of a Squid log entry is fairly simple. Its fields are summarized in </span><a href="#bookmark3327"><span class="font24">Table 21-8</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3327"></a><span class="font23" style="font-style:italic;">Table 21-8. Squid Log Format fields</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">timestamp</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">The timestamp when the request arrived, in seconds since January 1, 1970 GMT.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">time-elapsed</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">The elapsed time for request and response to travel through the proxy, in milliseconds.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">host-ip</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">The IP address of the client’s (requestor’s) host machine.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">result-code/status</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">The result field is a Squid-ism that tells what action the proxy took during this request<sup>a</sup>; the code field is the HTTP response code that the proxy sent to the client.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">size</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">The length of the proxy’s response to the client, including HTTP response headers and body, in bytes.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">method</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">The HTTP method of the client’s request.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">url</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">The URL in the client’s request.<sup>b</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">rfc931-ident<sup>c</sup></span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">The client’s authenticated username.<sup>d</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">hierarchy/from</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 22pt;"><span class="font2">Like the route field in Netscape formats, the hierarchy field tells what route the proxy used to make the request for the client.<sup>e</sup> The from field tells the name of the server that the proxy used to make the request.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">content-type</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:22pt;"><span class="font2">The Content-Type of the proxy response entity.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> </span><a href="#bookmark3328"><span class="font3">Table 21-9 </span></a><span class="font3">lists the various result codes and their meanings.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font3"><sup>b</sup> Recall from </span><a href="#bookmark409"><span class="font3">Chapter 2 </span></a><span class="font3">that proxies often log the entire requested URL, so ifa username and password component are in the URL, a proxy can inadvertently record this information.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font3"><sup>c</sup> The rfc931-ident, hierarchy/from, and content-type fields were added in Squid 1.1. Previous versions did not have these fields.</span></p>
<p><span class="font3"><sup>d</sup> RFC 931 describes the </span><span class="font3" style="font-style:italic;">ident</span><span class="font3"> lookup used in this authentication.</span></p>
<p><span class="font3"><sup>e</sup> </span><a href="http://squid.nlanr.net/Doc/FAQ/FAQ-6.html%23ss6.6"><span class="font3" style="font-style:italic;">http://squid.nlanr.net/Doc/FAQ/FAQ-6.html#ss6.6</span></a><span class="font3"> lists all of the valid Squid hierarchy codes.</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3329"><span class="font24">Example 21-5 </span></a><span class="font24">gives an example of a Squid Log Format entry.</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3329"></a><span class="font23" style="font-style:italic;">Example 21-5. Squid Log Format</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font3">99823414 3001 209.1.32.44 TCP_MISS/200 4087 GET </span><a href="http://www.joes-hardware.com"><span class="font3">http://www.joes-hardware.com</span></a><span class="font3"> - DIRECT/ proxy.com text/html</span></p>
<table>
<tr><td>
<p><span class="font24">The fields are assigned as follows:</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font2" style="font-weight:bold;">Value</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">timestamp</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">99823414</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">time-elapsed</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font2">3001</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">host-ip</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">209.1.32.44</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">action-code</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">TCP_MISS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">status</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">200</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">size</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">4087</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">method</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font2">GET</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">URL</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><a href="http://www.joes-hardware.com"><span class="font2">http://www.joes-hardware.com</span></a></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Field</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Value</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">RFC 931 ident</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">-</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">hierarchy from</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font2">DIRECT<sup>a</sup></span></p>
<p><span class="font2">proxy.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">content-type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">text/html</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> The DIRECT Squid hierarchy value is the same as the DIRECT route value in Netscape log formats.</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3328"><span class="font24">Table 21-9</span></a><span class="font24"> lists the various Squid result codes.<a name="footnote160"></a><sup><a href="#bookmark3330">160</a></sup><sup></sup></span></p>
<table>
<tr><td>
<p><a name="bookmark3328"></a><span class="font23" style="font-style:italic;">Table 21-9. Squid result codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Action</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">TCP_HIT</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">TCP_MISS</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">TCP_REFRESH_HIT</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">A valid copy of the resource was served out of the cache.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The resource was not in the cache.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The resource was in the cache but needed to be checked for freshness. The proxy revalidated the resource with the server and found that the in-cache copy was indeed still fresh.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_REF_FAIL_HIT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The resource was in the cache but needed to be checked for freshness. However, the revalidation failed (perhaps the proxy could not connect to the server), so the “stale” resource was returned.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_REFRESH_MISS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The resource was in the cache but needed to be checked for freshness. Upon checking with the server, the proxy learned that the resource in the cache was out of date and received a new version.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_CLIENT_REFRESH_MISS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The requestor sent a Pragma: no-cache or similar Cache-Control directive, so the proxy was forced to fetch the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_IMS_HIT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The requestor issued a conditional request, which was validated against the cached copy of the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">TCP_SWAPFAIL_MISS</span></p>
<p style="text-indent:7pt;"><span class="font2">TCP_NEGATIVE_HIT</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The proxy thought the resource was in the cache but for some reason could not access it.</span></p>
<p><span class="font2">A cached response was returned, but the response was a negatively cached response. Squid supports the notion of caching errors for resources—for example, caching a 404 Not Found response—so if multiple requests go through the proxy-cache for an invalid resource, the error is served from the proxy cache.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_MEM_HIT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A valid copy of the resource was served out of the cache, and the resource was in the proxy cache’s memory (as opposed to having to access the disk to retrieve the cached resource).</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_DENIED</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The request for this resource was denied, probably because the requestor does not have permission to make requests for this resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TCP_OFFLINE_HIT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The requested resource was retrieved from the cache during its </span><span class="font3" style="font-style:italic;">offline</span><span class="font2"> mode. Resources are not validated when Squid (or another proxy using this format) is in offline mode.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">UDP_<sup><a href="#bookmark3330">160</a></sup></span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The UDP_<sup><a href="#bookmark3330">160</a></sup> codes indicate that requests were received through the UDP interface to the proxy. HTTP normally uses the TCP transport protocol, so these requests are not using the HTTP protocol.<sup>a</sup></span></p></td></tr>
</table></td></tr>
</table>
<table>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Action</span></p></td><td style="vertical-align:top;">
<p style="text-indent:15pt;"><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 5pt 7pt;"><span class="font2">UDP_HIT</span></p>
<p style="padding:0pt 0pt 5pt 7pt;"><a name="bookmark3331"></a><span class="font2">UDP_MISS</span></p>
<p style="padding:0pt 0pt 5pt 7pt;"><span class="font2">UDP_DENIED</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">A valid copy of the resource was served out of the cache.</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">The resource was not in the cache.</span></p>
<p style="padding:0pt 0pt 2pt 15pt;"><span class="font2">The request for this resource was denied, probably because the requestor does not have permission to make requests for this resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 5pt 7pt;"><span class="font2">UDP_INVALID</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark3332"></a><span class="font2"><a name="bookmark3333"></a>UDP_MISS_NOFETCH</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 3pt 15pt;"><span class="font2">The request that the proxy received was invalid.</span></p>
<p style="padding:0pt 0pt 0pt 15pt;"><span class="font2">Used by Squid during specific operation modes or in the cache of frequent failures. A cache miss was returned and the resource was not fetched.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">NONE</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 15pt;"><span class="font2">Logged sometimes with errors.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">TCP_CLIENT_REFRESH</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">TCP_SWAPFAIL UDP_RELOADING</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 5pt 15pt;"><span class="font2">See TCP_CLIENT_REFRESH_MISS.</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">See TCP_SWAPFAIL_MISS.</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 5pt 0pt;"><span class="font2">See UDP_MISS_NOFETCH.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><a name="bookmark3334"></a><span class="font3">Squid has its own protocol for making these requests: ICP. This protocol is used for cache-to-cache requests. See </span><a href="http://www.squid-cache.org"><span class="font3" style="font-style:italic;">http://www.squid-cache.org</span></a><span class="font3" style="font-style:italic;"> </span><span class="font3">for more information.</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3335"></a><span class="font9" style="font-weight:bold;"><a name="bookmark195"></a><a name="bookmark3336"></a>Hit Metering</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Origin servers often keep detailed logs for billing purposes. Content providers need to know how often URLs are accessed, advertisers want to know how often their ads are shown, and web authors want to know how popular their content is. Logging works well for tracking these things when clients visit web servers directly.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">However, caches stand between clients and servers and prevent many accesses from reaching servers (the very purpose of caches).<a name="footnote161"></a><sup><a href="#bookmark3337">161</a></sup><sup></sup> Because caches handle many HTTP requests and satisfy them without visiting the origin server, the server has no record that a client accessed its content, creating omissions in log files.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Missing log data makes content providers resort to </span><span class="font24" style="font-style:italic;">cache busting</span><span class="font24"> for their most important pages. Cache busting refers to a content producer intentionally making certain content uncacheable, so all requests for this content must go to the origin server.<a name="footnote162"></a><sup><a href="#bookmark3338">162</a></sup><sup> </sup>This allows the origin server to log the access. Defeating caching might yield better logs, but it slows down requests and increases load on the origin server and network.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because proxy caches (and some clients) keep their own logs, if servers could get access to these logs—or at least have a crude way to determine how often their content is served by a proxy cache—cache busting could be avoided. The proposed Hit Metering protocol, an extension to HTTP, suggests a solution to this problem. The Hit Metering protocol requires caches to periodically report cache access statistics to origin servers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">RFC 2227 defines the Hit Metering protocol in detail. This section provides a brief tour of the proposal.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3339"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3340"></a>Overview</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3341"></a><span class="font24">The Hit Metering protocol defines an extension to HTTP that provides a few basic facilities that caches and servers can implement to share access information and to regulate how many times cached resources can be used.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Hit Metering is, by design, not a complete solution to the problem caches pose for logging access, but it does provide a basic means for obtaining metrics that servers want to track. The Hit Metering protocol has not been widely implemented or deployed (and may never be). That said, a cooperative scheme like Hit Metering holds some promise of providing accurate access statistics while retaining caching performance gains. Hopefully, that will be motivation to implement the Hit Metering protocol instead of marking content uncacheable.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3342"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3343"></a>The Meter Header</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The Hit Metering extension proposes the addition of a new header, Meter, that caches and servers can use to pass to each other directives about usage and reporting, much like the Cache-Control header allows caching directives to be exchanged.</span></p>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3344"><span class="font24">Table 21-10</span></a><span class="font24"> defines the various directives and who can pass them in the Meter header.</span></p>
<table>
<tr><td>
<p><a name="bookmark3344"></a><span class="font23" style="font-style:italic;">Table 21-10. Hit Metering directives</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Abbreviation</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Who</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">will-report-and-limit</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">w</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Cache</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The cache is capable of reporting usage and obeying any usage limits the server specifies.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">wont-report</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">x</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">Cache</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The cache is able to obey usage limits but won’t report usage.</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">wont-limit</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font5"><sup>y</sup></span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">Cache</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">The cache is able to report usage but won’t limit usage.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">count</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">c</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Cache</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The reporting directive, specified as “uses/reuses” integers—for example, “:count=2/4”.<sup>a</sup></span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">max-uses</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">u</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows the server to specify the maximum number of times a response can be used by a cache—for example, “max-uses=100”.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">max-reuses</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">r</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows the server to specify the maximum number of times a response can be reused by a cache—for example, “max-reuses=100”.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">do-report</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">d</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The server requires proxies to send usage reports.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">dont-report</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">e</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The server does not want usage reports.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">timeout</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">t</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Allows the server to specify a timeout on the metering of a resource. The cache should send a report at or before the specified timeout, plus or minus 1 minute. The timeout is specified in minutes—for example, “timeout=60”.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">wont-ask</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">n</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">Server</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The server does not want any metering information.</span></p></td></tr>
</table></td></tr>
<tr><td>
<p><span class="font3"><sup>a</sup> Hit Metering defines a </span><span class="font3" style="font-style:italic;">use</span><span class="font3"> as satisfying a request with the response, whereas a </span><span class="font3" style="font-style:italic;">reuse</span><span class="font3"> is revalidating a client request.</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 17pt 0pt;"><a href="#bookmark3345"><span class="font24">Figure 21-1 </span></a><span class="font24">shows an example of Hit Metering in action. The first part of the transaction is just a normal HTTP transaction between a client and proxy cache, but in the proxy request, note the insertion of the Meter header and the response from the server. Here, the proxy is informing the server that it is capable of doing Hit Metering, and the server in turn is asking the proxy to report its hit counts.</span></p>
<p style="text-align:justify;text-indent:40pt;"><span class="font1" style="font-style:italic;">Request message</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p><span class="font3">GET </span><a href="http://joes-hardware.com/"><span class="font3">http://joes-hardware.com/</span></a><span class="font3"> HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">Accept: *</span></p></td></tr>
<tr><td><img src="book_files/book-588.jpg" alt="" style="width:160pt;height:16pt;"></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">GET / HTTP/1.1</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-589.jpg" alt="" style="width:25pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a><span class="font3"> Meter: will-report-and-limit Connection: Meter</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-590.jpg" alt="" style="width:98pt;height:58pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
<p><span class="font1" style="font-style:italic;">Response message</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;"><img src="book_files/book-591.jpg" alt="" style="width:47pt;height:20pt;">
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Date: Fri, 06 Dec 1996 18:44:29 GMT</span></p>
<p><span class="font3">Content-length: 3152</span></p>
<p><span class="font3">Content-type: text/html</span></p>
<p><span class="font3">Connection: Meter</span></p>
<p><span class="font3">ETag: &quot;v1.27&quot;</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Meter: do-report</span></p>
<p><span class="font3">[...]</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td><img src="book_files/book-592.jpg" alt="" style="width:30pt;height:22pt;"></td></tr>
<tr><td>
<p><span class="font1" style="font-weight:bold;">Client</span></p></td></tr>
</table>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-indent:29pt;"><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><span class="font1" style="font-style:italic;">Response sent to client, cached, and used for subsequent requests</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">HTTP/1.1 200 OK</span></p>
<p><span class="font3">Date: Fri, 06 Dec 1996 18:44:29 GMT</span></p>
<p><span class="font3">Content-length: 3152</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font3">Content-type: text/html</span></p>
<p><span class="font3">[...]</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<table>
<tr><td>
<p style="text-align:justify;"><span class="font1" style="font-style:italic;">Later, the cache revalidates the response and at the same time reports the hit count</span></p></td><td><img src="book_files/book-593.jpg" alt="" style="width:190pt;height:121pt;">
<p><span class="font3">GET / HTTP/1.1</span></p>
<p><span class="font3">Host: </span><a href="http://www.joes-hardware.com"><span class="font3">www.joes-hardware.com</span></a></p>
<p><span class="font3">Meter: 12/4</span></p>
<p><span class="font3">If-None-Match: &quot;v Connection: Meter</span></p></td><td>
<p><span class="font3">HTTP/1.1 304 Not Modified</span></p></td></tr>
<tr><td colspan="3">
<p><span class="font1" style="font-weight:bold;">Proxy</span></p>
<p><a href="http://www.joes-hardware.com"><span class="font1" style="font-weight:bold;">www.joes-hardware.com</span></a></p>
<p><span class="font3">[...]</span></p></td></tr>
</table>
</div><br clear="all">
<p style="padding:0pt 0pt 10pt 0pt;"><a name="bookmark3345"></a><span class="font23" style="font-style:italic;">Figure 21-1. Hit Metering example</span></p>
<p style="text-align:justify;"><span class="font24">The request completes as it normally would, from the client’s perspective, and the proxy begins tracking hits to that resource on behalf of the server. Later, the proxy tries to revalidate the resource with the server. The proxy embeds the metered information it has been tracking in the conditional request to the server.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3346"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3347"></a><a name="bookmark196"></a><a name="bookmark3348"></a>A Word on Privacy</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Because logging really is an administrative function that servers and proxies perform, the whole operation is transparent to users. Often, they may not even be aware that their HTTP transactions are being logged—in fact, many users probably do not even know that they are using the HTTP protocol when accessing content on the Web.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Web application developers and administrators need to be aware of the implications of tracking a user’s HTTP transactions. Much can be gleaned about a user based on the information he retrieves. This information obviously can be put to bad use— discrimination, harassment, blackmail, etc. Web servers and proxies that log must be vigilant in protecting the privacy of their end users.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Sometimes, such as in work environments, tracking a user’s usage to make sure he is not goofing off may be appropriate, but administrators also should make public the fact that people’s transactions are being monitored.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">In short, logging is a very useful tool for the administrator and developer—just be aware of the privacy infringements that logs can have without the permission or knowledge of the users whose actions are being logged.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3349"></a><span class="font9" style="font-weight:bold;"><a name="bookmark197"></a><a name="bookmark3350"></a>For More Information</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">For more information on logging, refer to:</span></p>
<p style="text-align:justify;"><a href="http://httpd.apache.org/docs/logs.html"><span class="font24" style="font-style:italic;">http://httpd.apache.org/docs/logs.html</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Apache HTTP Server: Log Files.” Apache HTTP Server Project web site.</span></p>
<p><a href="http://www.squid-cache.org/Doc/FAQ/FAQ-6.html"><span class="font24" style="font-style:italic;">http://www.squid-cache.org/Doc/FAQ/FAQ-6.html</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Squid Log Files.” Squid Proxy Cache web site.</span></p>
<p><a href="http://www.w3.org/Daemon/User/Config/Logging.html%23common-logfile-format"><span class="font24" style="font-style:italic;">http://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Logging Control in W3C httpd.”</span></p>
<p><a href="http://www.w3.org/TR/WD-logfile.html"><span class="font24" style="font-style:italic;">http://www.w3.org/TR/WD-logfile.html</span></a></p>
<p style="text-indent:19pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">“Extended Log File Format.”</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2227.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2227.txt</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">RFC 2227, “Simple Hit-Metering and Usage-Limiting for HTTP,” by J. Mogul and P. Leach.</span></p>
<h1 style="text-align:right;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3351"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3352"></a>PART VI</span></h1>
<p style="text-align:right;padding:0pt 0pt 112pt 0pt;"><a name="bookmark222"></a><span class="font12" style="font-weight:bold;">Appendixes</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark198"></a><span class="font24"><a name="bookmark199"></a>This collection of appendixes contains useful reference tables, background information, and tutorials on a variety of topics relevant to HTTP architecture and implementation:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark246"><span class="font24">Appendix A, </span><span class="font24" style="font-style:italic;">URI Schemes</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark247"><span class="font24">Appendix B, </span><span class="font24" style="font-style:italic;">HTTP Status Codes</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark248"><span class="font24">Appendix C, </span><span class="font24" style="font-style:italic;">HTTP Header Reference</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark249"><span class="font24">Appendix D, </span><span class="font24" style="font-style:italic;">MIME Types</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark250"><span class="font24">Appendix E, </span><span class="font24" style="font-style:italic;">Base-64 Encoding</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark251"><span class="font24">Appendix F, </span><span class="font24" style="font-style:italic;">Digest Authentication</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark252"><span class="font24">Appendix G, </span><span class="font24" style="font-style:italic;">Language Tags</span></a></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• </span><a href="#bookmark253"><span class="font24">Appendix H, </span><span class="font24" style="font-style:italic;">MIME Charset Registry</span></a></p></li></ul>
<p style="text-align:right;padding:0pt 0pt 5pt 0pt;"><span class="font7" style="font-weight:bold;">APPENDIX A</span></p>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark246"></a><span class="font11" style="font-weight:bold;"><a name="bookmark200"></a><a name="bookmark3353"></a>URI Schemes</span></h1>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3354"></a><span class="font24"><a name="bookmark3355"></a><a name="bookmark3356"></a>Many URI schemes have been defined, but few are in common use. Generally speaking, those URI schemes with associated RFCs are in more common use, though there are a few schemes that have been developed by leading software corporations (notably Netscape and Microsoft), but not formalized, that also are in wide use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The W3C maintains a list of URI schemes, which you can view at:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.w3.org/Addressing/schemes.html"><span class="font24" style="font-style:italic;">http://www.w3.org/Addressing/schemes.html</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The IANA also maintains a list of URL schemes, at:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><a href="http://www.iana.org/assignments/uri-schemes"><span class="font24" style="font-style:italic;">http://www.iana.org/assignments/uri-schemes</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3357"><span class="font24">Table A-1 </span></a><span class="font24">informally describes some of the schemes that have been proposed and those that are in active use. Note that many of the approximately 90 schemes in the table are not widely used, and many are extinct.</span></p>
<table>
<tr><td>
<p><a name="bookmark3357"></a><span class="font23" style="font-style:italic;">Table A-1. URI schemes from the W3C registry</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">about</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Netscape scheme to explore aspects of the browser. For example: about by itself is the same as choosing “About Communicator” from the Navigator Help menu, about:cache displays diskcache statistics, and about:plugins displays information about configured plug-ins. Other browsers, such as Microsoft Internet Explorer, also use this scheme.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">acap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Application Configuration Access Protocol.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2244</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">afp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">For file-sharing services using the Apple Filing Protocol (AFP) protocol, defined as part of the expired IETF </span><span class="font3" style="font-style:italic;">draft-ietf-svrloc-afp-service-01.txt</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">afs</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Reserved for future use by the Andrew File System.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">callto</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Initiates a Microsoft NetMeeting conference session, such as:</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-indent:15pt;"><span class="font3" style="font-style:italic;">callto: ws3.joes-hardware.com/</span><a href="mailto:joe@joes-hardware.com"><span class="font3" style="font-style:italic;">joe@joes-hardware.com</span></a></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">chttp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The CHTTP caching protocol defined by Real Networks. RealPlayer does not cache all items streamed by HTTP. Instead, you designate files to cache by using </span><span class="font3" style="font-style:italic;">chttp://</span><span class="font2"> instead of </span><span class="font3" style="font-style:italic;">http://</span><span class="font2"> in the file’s URL. When RealPlayer reads a CHTTP URLina SMIL file, it first checks its disk cache for the file. If the file isn’t present, it requests the file through HTTP, storing the file in its cache.</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">cid</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The use of [MIME] within email to convey web pages and their associated images requires a</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2392</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">URL scheme to permit the HTML to refer to the images or other data included in the message. The Content-ID URL, “cid:”, serves that purpose.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2111</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">clsid</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows Microsoft OLE/COM (Component Object Model) classes to be referenced. Used to insert active objects into web pages.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">data</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Allows inclusion of small, constant data items as “immediate” data. This URL encodes the text/ plain string “A brief note”:</span></p>
<p style="text-indent:15pt;"><span class="font3" style="font-style:italic;">data:A%20brief%20note</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2397</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">date</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proposal for scheme to support dates, as in </span><span class="font3" style="font-style:italic;">date:1999-03-04T20:42:08</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">dav</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">To ensure correct interoperation based on this specification, the IANA must reserve the URI namespaces starting with “DAV:” and with “opaquelocktoken:” for use by this specification, its revisions, and related WebDAV specifications.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2518</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">dns</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">Used by REBOL software.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.rebol.com/users/valurl.html"><span class="font3" style="font-style:italic;">www.rebol.com/users/valurl.html</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">eid</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The external ID (eid) scheme provides a mechanism by which the local application can reference data that has been obtained by other, non-URL scheme means. The scheme is intended to provide a general escape mechanism to allow access to information for applications that are too specialized to justify their own schemes. There is some controversy about this URI.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.ics.uci.edu/pub/ietf/uri/draft-finseth-url-00.txt"><span class="font3" style="font-style:italic;">www.ics.uci.edu/pub/ietf/uri/draft-finseth-url-00.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">fax</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The “fax” scheme describes a connection to a terminal that can handle telefaxes (facsimile machines).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2806</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">file</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Designates files accessible on a particular host computer. A hostname can be included, but the scheme is unusual in that it does not specify an Internet protocol or access method for such files; as such, its utility in network protocols between hosts is limited.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">finger</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The finger URL has the form:</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 3pt 0pt;"><span class="font3" style="font-style:italic;">finger://host[:port][/&lt;request&gt;]</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The &lt;request&gt; must conform with the RFC 1288 request format.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.ics.uci.edu/pub/ietf/uri/draft-ietf-uri-url-finger-03.txt"><span class="font3" style="font-style:italic;">www.ics.uci.edu/pub/ietf/uri/draft-ietf-uri-url-finger-03.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">freenet</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">URIs for information in the Freenet distributed information system. See </span><span class="font3" style="font-style:italic;">http //freenet.sourceforge.net</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ftp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">File Transfer Protocol scheme.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">gopher</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The archaic gopher protocol.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">gsm-sms</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">URIs for the GSM mobile phone short message service.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">h323, h324</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">Multimedia conferencing URI schemes.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.ics.uci.edu/pub/ietf/uri/draft-cordell-sg16-conv-url-00.txt"><span class="font3" style="font-style:italic;">www.ics.uci.edu/pub/ietf/uri/draft-cordell-sg16-conv-url-00.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">hdl</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The Handle System is a comprehensive system for assigning, managing, and resolving persistent identifiers, known as “handles,” for digital objects and other resources on the Internet. Handles can be used as URNs.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //www.handle.net</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">hnews</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">HNEWS is an HTTP-tunneling variant of the NNTP news protocol. The syntax of hnews URLs is designed to be compatible with the current common usage of the news URL scheme.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.ics.uci.edu/pub/ietf/uri/draft-stockwell-hnews-url-00.txt"><span class="font3" style="font-style:italic;">www.ics.uci.edu/pub/ietf/uri/draft-stockwell-hnews-url-00.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">http</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The HTTP protocol. Read this book for more information.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2616</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">https</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">HTTP over SSL.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //sitesearch.netscape.com/eng/ssl3/draft302.txt</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">iioploc</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">CORBA extensions. The Interoperable Name Service defines one URL-format object reference, iioploc, that can be typed into a program to reach defined services at remote locations, including the Naming Service. For example, this iioploc identifier:</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">iioploc //www.omg.org/NameService</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">would resolve to the CORBA Naming Service running on the machine whose IP address corresponded to the domain name </span><a href="http://www.omg.org"><span class="font3" style="font-style:italic;">www.omg.org</span></a><span class="font2">.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">http //www.omg.org</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ilu</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The Inter-Language Unification (ILU) system is a multilingual object interface system. The object interfaces provided by ILU hide implementation distinctions between different languages, different address spaces, and different operating system types. ILU can be used to build multilingual object-oriented libraries (“class libraries”) with well-specified, language-independent interfaces. It also can be used to implement distributed systems.</span></p>
<p><span class="font2">See </span><a href="ftp://parcftp.parc.xerox.com/pub/ilu/ilu.html"><span class="font3" style="font-style:italic;">ftp://parcftp.parc.xerox.com/pub/ilu/ilu.html</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">imap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The IMAP URL scheme is used to designate IMAP servers, mailboxes, messages, MIME bodies [MIME], and search programs on Internet hosts accessible using the IMAP protocol.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2192</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IOR</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CORBA interoperable object reference. See </span><span class="font3" style="font-style:italic;">http //www.omg.org</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">irc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The irc URL scheme is used to refer to either Internet Relay Chat (IRC) servers or individual entities (channels or people) on IRC servers.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.w3.org/Addressing/draft-mirashi-url-irc-01.txt"><span class="font3" style="font-style:italic;">www.w3.org/Addressing/draft-mirashi-url-irc-01.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">isbn</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">Proposed scheme for ISBN book references.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //lists.w3.org/Archives/Public/www-talk/1991NovDec/0008.html</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">java</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Identifies Java classes.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">javascript</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The Netscape browser processes javascript URLs, evaluates the expression after the colon (:), if there is one, and loads a page containing the string value of the expression, unless it is undefined.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">jdbc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used in the Java SQL API.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ldap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows Internet clients direct access to the LDAP protocol.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2255</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">lid</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">The Local Identifier (lid:) scheme.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">draft-blackketter-lid-00</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">lifn</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A Location-Independent File Name (LIFN) for the Bulk File Distribution distributed storage system developed at UTK.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">livescript</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Old name for JavaScript.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">lrq</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">See h323.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">mailto</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The mailto URL scheme is used to designate the Internet mailing address of an individual or service.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2368</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">mailserver</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Old proposal from 1994–1995 to let an entire message be encoded in a URL, so that (for example) the URL can automatically send email to a mail server for subscribing to a mailing list.</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">md5</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MD5 is a cryptographic checksum.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 15pt 7pt;"><span class="font2">mid</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">mocha</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The mid scheme uses (a part of) the message-id of an email message to refer to a specific message.</span></p>
<p><span class="font2">See javascript.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2392</span></p>
<p><span class="font2">2111</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 3pt 7pt;"><span class="font2">modem</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">mms, mmst, mmsu</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The modem scheme describes a connection to a terminal that can handle incoming data calls.</span></p>
<p><span class="font2">Scheme for Microsoft Media Server (MMS) to stream Active Streaming Format (ASF) files. To force UDP transport, use the mmsu scheme. To force TCP transport, use mmst.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2806</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">news</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The news URL scheme is used to refer to either news groups or individual articles of USENET news. A news URL takes one of two forms: </span><span class="font3" style="font-style:italic;">news:&lt;newsgroup-name&gt;</span><span class="font2"> or </span><span class="font3" style="font-style:italic;">news:&lt;message-id&gt;</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">1738</span></p>
<p><span class="font2">1036</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">nfs</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used to refer to files and directories on NFS servers.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2224</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 70pt 7pt;"><span class="font2">nntp</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 24pt 0pt;"><span class="font2">opaquelocktoken</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 27pt 0pt;"><span class="font2">path</span></p>
<p style="text-indent:7pt;"><span class="font2">phone</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">An alternative method of referencing news articles, useful for specifying news articles from NNTP servers. An nntp URL looks like:</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">nntp //&lt;host&gt;:&lt;port&gt;/&lt;newsgroup-name&gt;/&lt;article-num&gt;</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Note that while nntp URLs specify a unique location for the article resource, most NNTP servers currently on the Internet are configured to allow access only from local clients, and thus nntp URLs do not designate globally accessible resources. Hence, the news form of URL is preferred as a way of identifying news articles.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">A WebDAV lock token, represented as a URI, that identifies a particular lock. A lock token is returned by every successful LOCK operation in the lockdiscovery property in the response body and also can be found through lock discovery on a resource. See RFC 2518.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The path scheme defines a uniformly hierarchical namespace where a path URN is a sequence of components and an optional opaque string.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">http //www.hypernews.org/~liberte/www/path html</span><span class="font2">.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Used in “URLs for Telephony”; replaced with tel: in RFC 2806.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1738</span></p>
<p><span class="font2">977</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 16pt 0pt;"><span class="font2">pop</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 6pt 0pt;"><span class="font2">pnm</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 24pt 0pt;"><span class="font2">pop3</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 16pt 0pt;"><span class="font2">printer</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The POP URL designates a POP email server, and optionally a port number, authentication mechanism, authentication ID, and/or authorization ID.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Real Networks’s streaming protocol.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The POP3 URL scheme allows a URL to specify a POP3 server, allowing other protocols to use a general “URL to be used for mail access” in place of an explicit reference to POP3. Defined in expired </span><span class="font3" style="font-style:italic;">draft-earhart-url-pop3-00.txt</span><span class="font2">.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Abstract URLs for use with the Service Location standard.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">draft-ietf-srvloc-printer-scheme-02.txt</span><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2384</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 6pt 0pt;"><span class="font2">prospero</span></p>
<p style="text-indent:7pt;"><span class="font2">res</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Names resources to be accessed via the Prospero Directory Service.</span></p>
<p><span class="font2">Microsoft scheme that specifies a resource to be obtained from a module. Consists of a string or numerical resource type, and a string or numerical ID.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 17pt 0pt;"><span class="font2">rtsp</span></p>
<p style="text-indent:7pt;"><span class="font2">rvp</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 6pt 0pt;"><span class="font2">Real-time streaming protocol that is the basis for Real Networks’s modern streaming control protocols.</span></p>
<p><span class="font2">URLs for the RVP rendezvous protocol, used to notify the arrival of users on a computer network.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">draft-calsyn-rvp-01</span><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2326</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">rwhois</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">RWhois isan Internet directory access protocol, defined in RFC 1714 and RFC 2167. The RWhois URL gives clients direct access to rwhois.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //www.rwhois.net/rwhois/docs/</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">rx</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">An architecture to allow remote graphical applications to display data inside web pages.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //www.w3.org/People/danield/papers/mobgui/</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">sdp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Session Description Protocol (SDP) URLs. See RFC 2327.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">service</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The service scheme is used to provide access information for arbitrary network services. These URLs provide an extensible framework for client-based network software to obtain configuration information required to make use of network services.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2609</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">sip</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The sip* family of schemes are used to establish multimedia conferences using the Session Initiation Protocol (SIP).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2543</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">shttp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">S-HTTP is a superset of HTTP designed to secure HTTP connections and provide a wide variety of mechanisms to provide for confidentiality, authentication, and integrity. It has not been widely deployed, and it has mostly been supplanted with HTTPS SSL-encrypted HTTP.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.homeport.org/~adam/shttp.html"><span class="font3" style="font-style:italic;">www.homeport.org/~adam/shttp.html</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">snews</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SSL-encrypted news.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">STANF</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Old proposal for stable network filenames. Related to URNs. See </span><span class="font3" style="font-style:italic;">http //web3.w3.org/Addressing/#STANF</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">t120</span></p></td><td style="vertical-align:top;">
<p><span class="font2">See h323.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">tel</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">URL to place a call using the telephone network.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2806</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">telephone</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used in previous drafts of tel.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">telnet</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Designates interactive services that may be accessed by the Telnet protocol. A telnet URL takes the form:</span></p>
<p style="text-indent:15pt;"><span class="font3" style="font-style:italic;">telnet //&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">tip</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports TIP atomic Internet transactions.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2371</span></p>
<p><span class="font2">2372</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">tn3270</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Reserved, as per </span><span class="font3" style="font-style:italic;">ftp //ftp.isi.edu/in-notes/iana/assignments/url-schemes</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">tv</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The TV URL names a particular television broadcast channel.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2838</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">uuid</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Universally unique identifiers (UUIDs) contain no information about location. They also are known as globally unique identifiers (GUIDs). They are persistent over time, like URNs, and consist of a 128-bit unique ID. UUID URIs are useful in situations where a unique identifier is required that cannot or should not be tied to a particular physical root namespace (such as a DNS name).</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">draft-kindel-uuid-uri-00.txt</span><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">urn</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Persistent, location-independent, URNs.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">2141</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">vemmi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Allows versatile multimedia interface (VEMMI) client software and VEMMI terminals to connect to VEMMI-compliant services. VEMMI is an international standard for online multimedia services.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2122</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">videotex</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Allows videotex client software or terminals to connect to videotex services compliant with the ITU-T and ETSI videotex standards.</span></p>
<p><span class="font2">See </span><span class="font3" style="font-style:italic;">http //</span><a href="http://www.ics.uci.edu/pub/ietf/uri/draft-mavrakis-videotex-url-spec-01.txt"><span class="font3" style="font-style:italic;">www.ics.uci.edu/pub/ietf/uri/draft-mavrakis-videotex-url-spec-01.txt</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Scheme</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">RFCs</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">view-source</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3358"></a><span class="font2">Netscape Navigator source viewers. These view-source URLs display HTML that was generated with JavaScript.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">wais</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The wide area information service—an early form of search engine.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">1738</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 18pt 0pt;"><span class="font2">whois++</span></p>
<p style="text-indent:7pt;"><span class="font2">whodp</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">URLs for the WHOIS++ simple Internet directory protocol.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">http //martinh.net/wip/whois-url.txt</span><span class="font2">.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The Widely Hosted Object Data Protocol (WhoDP) exists to communicate the current location and state of large numbers of dynamic, relocatable objects. A WhoDP program “subscribes” to locate and receive information about an object and “publishes” to control the location and visible state of an object.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">draft-mohr-whodp-00.txt</span><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">1835</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">z39.50r, z39.50s</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Z39.50 session and retrieval URLs. Z39.50 is an information retrieval protocol that does not fit neatly into a retrieval model designed primarily around the stateless fetch of data. Instead, it models a general user inquiry as a session-oriented, multi-step task, any step of which may be suspended temporarily while the server requests additional parameters from the client before continuing.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">2056</span></p></td></tr>
</table>
<h1 style="text-align:right;padding:0pt 0pt 115pt 0pt;"><a name="bookmark247"></a><span class="font11" style="font-weight:bold;"><a name="bookmark201"></a><a name="bookmark3359"></a>HTTP Status Codes</span></h1>
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark3360"></a><span class="font24"><a name="bookmark3361"></a><a name="bookmark3362"></a>This appendix is a quick reference of HTTP status codes and their meanings.</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3363"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3364"></a>Status Code Classifications</span></h2>
<p style="padding:0pt 0pt 11pt 0pt;"><a name="bookmark3365"></a><span class="font24"><a name="bookmark3366"></a>HTTP status codes are segmented into five classes, shown in </span><a href="#bookmark3367"><span class="font24">Table B-1</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3367"></a><span class="font23" style="font-style:italic;"><a name="bookmark3368"></a>Table B-1. Status code classifications</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark3369"></a><span class="font2" style="font-weight:bold;"><a name="bookmark3370"></a>Overall range</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Defined range</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3371"></a><span class="font2" style="font-weight:bold;">Category</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">100–199</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">100–101</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Informational</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">200–299</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">200–206</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Successful</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">300–399</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">300–305</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Redirection</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">400–499</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">400–415</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Client error</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">500–599</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">500–505</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Server error</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3372"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3373"></a>Status Codes</span></h2>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3374"><span class="font24">Table B-2 </span></a><span class="font24">is a quick reference for all the status codes defined in the HTTP/1.1 specification, providing a brief summary of each.</span><a href="#bookmark307"><span class="font24"> “Status Codes” in Chapter 3 </span></a><span class="font24">goes into more detailed descriptions of these status codes and their uses.</span></p>
<table>
<tr><td>
<p><a name="bookmark3374"></a><span class="font23" style="font-style:italic;">Table B-2. Status codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">100</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Continue</span></p></td><td style="vertical-align:top;">
<p><span class="font2">An initial part of the request was received, and the client should continue.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">101</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Switching Protocols</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The server is changing protocols, as specified by the client, to one listed in the Upgrade header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">200</span></p></td><td style="vertical-align:top;">
<p><span class="font2">OK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The request is okay.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">201</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Created</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The resource was created (for requests that create server objects).</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">202</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Accepted</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The request was accepted, but the server has not yet performed any action with it.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">203</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Non-Authoritative Information</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The transaction was okay, except the information contained in the entity headers was not from the origin server, but from a copy of the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">204</span></p></td><td style="vertical-align:top;">
<p><span class="font2">No Content</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The response message contains headers and a status line, but no entity body.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">205</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Reset Content</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Another code primarily for browsers; basically means that the browser should clear any HTML form elements on the current page.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">206</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Partial Content</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A partial request was successful.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">300</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Multiple Choices</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A client has requested a URL that actually refers to multiple resources. This code is returned along with a list of options; the user can then select which one he wants.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">301</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Moved Permanently</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The requested URL has been moved. The response should contain a Location URL indicating where the resource now resides.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3375"></a><span class="font2">302</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Found</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Like the 301 status code, but the move is temporary. The client should use the URL given in the Location header to locate the resource temporarily.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">303</span></p></td><td style="vertical-align:top;">
<p><span class="font2">See Other</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Tells the client that the resource should be fetched using a different URL. This new URL is in the Location header of the response message.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">304</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Not Modified</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Clients can make their requests conditional by the request headers they include. This code indicates that the resource has not changed.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">305</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Use Proxy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The resource must be accessed through a proxy, the location of the proxy is given in the Location header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">306</span></p></td><td style="vertical-align:top;">
<p><span class="font2">(Unused)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">This status code currently is not used.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">307</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Temporary Redirect</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Like the 301 status code; however, the client should use the URL given in the Location header to locate the resource temporarily.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">400</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Bad Request</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Tells the client that it sent a malformed request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">401</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unauthorized</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Returned along with appropriate headers that ask the client to authenticate itself before it can gain access to the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">402</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Payment Required</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Currently this status code is not used, but it has been set aside for future use.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">403</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Forbidden</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The request was refused by the server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">404</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Not Found</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The server cannot find the requested URL.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">405</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Method Not Allowed</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A request was made with a method that is not supported for the requested URL. The Allow header should be included in the response to tell the client what methods are allowed on the requested resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">406</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Not Acceptable</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Clients can specify parameters about what types of entities they are willing to accept. This code is used when the server has no resource matching the URL that is acceptable for the client.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">407</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proxy Authentication Required</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Like the 401 status code, but used for proxy servers that require authentication for a resource.</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Status code</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Reason phrase</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Meaning</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">408</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Request Timeout</span></p></td><td style="vertical-align:top;">
<p><span class="font2">If a client takes too long to complete its request, a server can send back this status code and close down the connection.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">409</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Conflict</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The request is causing some conflict on a resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">410</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gone</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Like the 404 status code, except that the server once held the resource.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">411</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Length Required</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Servers use this code when they require a Content-Length header in the request message. The server will not accept requests for the resource without the Content-Length header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3376"></a><span class="font2">412</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Precondition Failed</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">If a client makes a conditional request and one of the conditions fails, this response code is returned.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">413</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Request Entity Too Large</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The client sent an entity body that is larger than the server can or wants to process.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">414</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Request URI Too Long</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The client sent a request with a request URL that is larger than what the server can or wants to process.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">415</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unsupported Media Type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The client sent an entity of a content type that the server does not understand or support.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">416</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Requested Range Not Satisfiable</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The request message requested a range of a given resource, and that range either was invalid or could not be met.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">417</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Expectation Failed</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3377"></a><span class="font2">The request contained an expectation in the Expect request header that could not be satisfied by the server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">500</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Internal Server Error</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The server encountered an error that prevented it from servicing the request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">501</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Not Implemented</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The client made a request that is beyond the server’s capabilities.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">502</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Bad Gateway</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A server acting as a proxy or gateway encountered a bogus response from the next link in the request response chain.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">503</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Service Unavailable</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The server cannot currently service the request but will be able to in the future.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">504</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gateway Timeout</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Similar to the 408 status code, except that the response is coming from a gateway or proxy that has timed out waiting for a response to its request from another server.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">505</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTTP Version Not Supported</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The server received a request in a version of the protocol that it can’t or won’t support.</span></p></td></tr>
</table>
<h1 style="padding:0pt 0pt 115pt 0pt;"><a name="bookmark202"></a><span class="font11" style="font-weight:bold;"><a name="bookmark3378"></a>HTTP Header Reference</span></h1>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">It’s almost amusing to remember that the first version of HTTP, 0.9, had no headers. While this certainly had its down sides, its fun to marvel in its simplistic elegance.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Well, back to reality. Today there are a horde of HTTP headers, many part of the specification and still others that are extensions to it. This appendix provides some background on these official and extension headers. It also acts as an index for the various headers in this book, pointing out where their concepts and features are discussed in the running text. Most of these headers are simple up-front; it’s the interactions with each other and other features of HTTP where things get hairy. This appendix provides a bit of background for the headers listed and directs you to the sections of the book where they are discussed at length.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font24">Th<a name="bookmark3379"></a>e headers listed in this appendix are drawn from the HTTP specifications, related documents, and our own experience poking around with HTTP messages and the various servers and clients on the Internet.</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font24">This list is far from exhaustive. There are many other extension headers floating around on the Web, not to mention those potentially used in private intranets. Nonetheless, we have attempted to make this list as complete as possible. See RFC 2616 for the current version of the HTTP/1.1 specification and a list of official headers and their specification descriptions.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3380"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3381"></a>Accept</span></h2>
<p style="text-align:justify;"><span class="font21">The Accept header is used by clients to let servers know what media types are </span><span class="font21" style="font-style:italic;">acceptable</span><span class="font21">. The value of the Accept header field is a list of media types that the client can use. For instance, your web browser cannot display every type of multimedia object on the Web. By including an Accept header in your requests, your browser can save you from downloading a video or other type of object that you can’t use.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font21">The Accept header field also may include a list of quality values (q values) that tell the server which media type is preferred, in case the server has multiple versions of the media type. See</span><a href="#bookmark241"><span class="font21"> Chapter 17</span></a><span class="font21"> for a complete discussion of content negotiation and q values.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark3382"></a><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Notes</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font21">“<a name="footnote163"></a><sup><a href="#bookmark3383">163</a></sup>” is a special value that is used to wildcard media types. For example, “<sup><a href="#bookmark3383">163</a></sup>/<sup><a href="#bookmark3383">163</a></sup>” represents all types, and “image/<sup><a href="#bookmark3383">163</a></sup>” represents all image types.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">Accept: text/<sup><a href="#bookmark3383">163</a></sup>, image/<sup><a href="#bookmark3383">163</a></sup></span></p>
<p style="text-indent:8pt;"><span class="font21">Accept: text/<sup><a href="#bookmark3383">163</a></sup>, image/gif, image/jpeg;q=1</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3384"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3385"></a>Accept-Charset</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The Accept-Charset header is used by clients to tell servers what character sets are acceptable or preferred. The value of this request header is a list of character sets and possibly quality values for the listed character sets. The quality values let the server know which character set is preferred, in case the server has the document in multiple acceptable character sets. See</span><a href="#bookmark241"><span class="font21"> Chapter 17 </span></a><span class="font21">for a complete discussion of content negotiation and q values.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">No<a name="bookmark3386"></a>tes</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font21">As with the Accept header, “<sup><a href="#bookmark3383">163</a></sup>” is a special character. If present, it represents all character sets, except those that also are mentioned explicitly in the value. If it’s not present, any charset not in the value field has a default q value of zero, with the exception of the iso-latin-1 charset, which gets a default of 1.</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 8pt;"><span class="font21">Accept-Charset: 1# ((charset | &quot;<sup><a href="#bookmark3383">163</a></sup>&quot;) [&quot;;&quot; &quot;q&quot; &quot;=&quot; qvalue])</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:8pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">Accept-Charset: iso-latin-1</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3387"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3388"></a>Accept-Encoding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The Accept-Encoding header is used by clients to tell servers what encodings are acceptable. If the content the server is holding is encoded (perhaps compressed), this request header lets the server know whether the client will accept it.</span><a href="#bookmark241"><span class="font21"> Chapter 17</span></a><span class="font21"> contains a complete description of the Accept-Encoding header.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:8pt;"><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;text-indent:8pt;"><span class="font21">Accept-Encoding: 1# ((content-coding | &quot;<sup><a href="#bookmark3383">163</a></sup>&quot;) [&quot;;&quot; &quot;q&quot; &quot;=&quot; qvalue])</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples<sup><a href="#bookmark3383">163</a></sup></span><span class="font3"><sup></sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:8pt;"><span class="font21">Accept-Encoding:</span></p>
<p style="text-align:justify;text-indent:8pt;"><span class="font21">Accept-Encoding: gzip</span></p>
<p style="text-align:justify;text-indent:8pt;"><span class="font21">Accept-Encoding: compress;q=0.5, gzip;q=1</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3389"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3390"></a><a name="bookmark3391"></a>Accept-Language</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3392"></a><span class="font21">The Accept-Language request header functions like the other Accept headers, allowing clients to inform the server about what languages (e.g., the natural language for content) are acceptable or preferred.</span><a href="#bookmark241"><span class="font21"> Chapter 17 </span></a><span class="font21">contains a complete description of the Accept-Language header.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Accept-Language: 1# (language-range [&quot;;&quot; &quot;q&quot; &quot;=&quot; qvalue]) language-range = ((1*8ALPHA * (&quot;-&quot; 1*8ALPHA)) | &quot;*&quot;)</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font21">Accept-Language: en</span></p>
<p style="text-indent:11pt;"><span class="font21">Accept-Language: en;q=0.7, en-gb;q=0.5</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3393"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3394"></a>Accept-Ranges</span></h2>
<p style="text-align:justify;"><span class="font21">The Accept-Ranges header differs from the other Accept headers—it is a response header used by servers to tell clients whether they accept requests for ranges of a resource. The value of this header tells what type of ranges, if any, the server accepts for a given resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark1361"></a><span class="font21">A client can attempt to make a range request on a resource without having received this header. If the server does not support range requests for that resource, it can respond with an appropriate status code<sup>*</sup> and the Accept-Ranges value “none”. Servers might want to send the “none” value for normal requests to discourage clients from making range re<a name="bookmark3395"></a>quests in the future.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a href="#bookmark241"><span class="font21">Chapter 17</span></a><span class="font21"> contains a complete description of the Accept-Ranges header.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Accept-Ranges: 1# range-unit | none</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Accept-Ranges: none Accept-Ranges: bytes</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3396"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3397"></a>Age</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The Age header tells the receiver how old a response is. It is the sender’s best guess as to how long ago the response was generated by or revalidated with the origin server. The value of the header is the sender’s guess, a delta in seconds. See</span><a href="#bookmark231"><span class="font21"> Chapter 7</span></a><span class="font21"> for more on the Age header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 24pt 0pt;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">HTTP/1.1 caches must include an Age header in every response they send.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font20">* For example, status code 416 (see </span><a href="#bookmark687"><span class="font20">“400–499: Client Error Status Codes” in Chapter 3</span></a><span class="font20">).</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark3398"></a><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Age: delta-seconds</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="padding:5pt 0pt 0pt 0pt;"><span class="font21">Age: 60</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3399"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3400"></a>Allow</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3401"></a><span class="font21">The Allow header is used to inform clients what HTTP methods are supported on a particular resource.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Notes</span></p></td><td style="vertical-align:middle;">
<p><span class="font21">An HTTP/1.1 server sending a 405 Method Not Allowed response must include an Allow header.<a name="footnote164"></a><sup><a href="#bookmark3402">164</a></sup><sup></sup></span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p><span class="font21">Allow: #Method</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="padding:5pt 0pt 0pt 0pt;"><span class="font21">Allow: GET, HEAD</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3403"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3404"></a>Authorization</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3405"></a><span class="font21">The Authorization header is sent by a client to authenticate itself with a server. A client will include this header in its request after receiving a 401 Authentication Required response from a server. The value of this header depends on the authentication scheme in use. See </span><a href="#bookmark238"><span class="font21">Chapter 14</span></a><span class="font21"> for a detailed discussion of the Authorization header.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p><span class="font21">Authorization: authentication-scheme #authentication-param</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:5pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="padding:6pt 0pt 0pt 0pt;"><span class="font21">Authorization: Basic YnJpYW4tdG90dHk6T3ch</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3406"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3407"></a>Cache-Control</span></h2>
<p style="text-align:justify;"><span class="font21">The Cache-Control header is used to pass information about how an object can be cached. This header is one of the more complex headers introduced in HTTP/1.1. Its value is a caching directive, giving caches special instructions about an object’s cacheability.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">In </span><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21">, we discuss caching in general as well as the specific details about this header.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">General header</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p><span class="font21">Cache-Control: no-cache</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3408"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3409"></a><a name="bookmark3410"></a>Client-ip</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3411"></a><span class="font21">The Client-ip header is an extension header used by some older clients and some proxies to transmit the IP address of the machine on which the client is running.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Extension request header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Notes</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Implementors should be aware that the information provided in the value of this header is not secure.</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font21">Client-ip: ip-address</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font21">Client-ip: 209.1.33.49</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3412"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3413"></a>Connection</span></h2>
<p style="text-align:justify;"><span class="font21">The Connection header is a somewhat overloaded header that can lead to a bit of confusion. This header was used in HTTP/1.0 clients that were extended with keep-alive connections for control information.<sup>*</sup> In HTTP/1.1, the older semantics are mostly recognized, but the header has taken on a new function.</span></p>
<p style="text-align:justify;"><span class="font21">In HTTP/1.1, the Connection header’s value is a list of tokens that correspond to header names. Applications receiving an HTTP/1.1 message with a Connection header are supposed to parse the list and remove any of the headers in the message that are in the Connection header list. This is mainly for proxies, allowing a server or other proxy to specify hop-by-hop headers that should not be passed along.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">One special token value is “close”. This token means that the connection is going to be closed after the response is completed. HTTP/1.1 applications that do not support persistent connections need to insert the Connection header with the “close” token in all requests and responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">General header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">While RFC 2616 does not specifically mention keep-alive as a connec</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 73pt;"><span class="font21">tion token, some browsers (including those sending HTTP/1.1 as their versions) use it in making requests.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Connection: 1# (connection-token)</span></p>
<p style="padding:0pt 0pt 71pt 0pt;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Connection: close</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font20">* See</span><a href="#bookmark226"><span class="font20"> Chapter 4</span></a><span class="font20"> for more on keep-alive and persistent connections.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3414"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3415"></a><a name="bookmark3416"></a>Content-Base</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Content-Base header provides a way for a server to specify a base URL for resolving URLs found in the entity body of a response.<sup>*</sup> The value of the Content-Base header is an absolute URL that can be used to resolve relative URLs found inside the entity.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3417"></a><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">This header is not defined in RFC 2616; it was previously defined in RFC</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 73pt;"><span class="font21">2068, an earlier draft of the HTTP/1.1 specification, and has since been removed from the official specification.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Base: absoluteURL</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Base: </span><a href="http://www.joes-hardware.com/"><span class="font21">http://www.joes-hardware.com/</span></a></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3418"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3419"></a>Content-Encoding</span></h2>
<p style="text-align:justify;"><span class="font21">The Content-Encoding header is used to specify whether any encodings have been performed on the object. By encoding the content, a server can compress it before sending the response. The value of the Content-Encoding header tells the client what type or types of encoding have been performed on the object. With that information, the client can then decode the message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3420"></a><span class="font21">Sometimes more than one encoding is applied to an entity, in which case the encodings must be listed in the order in which they were performed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Encoding: 1# content-coding</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Encoding: gzip</span></p>
<p style="padding:0pt 0pt 22pt 73pt;"><span class="font21">Content-Encoding: compress, gzip</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3421"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3422"></a>Content-Language</span></h2>
<p style="text-align:justify;"><span class="font21">The Content-Language header tells the client the natural language that should be understood in order to understand the object. For instance, a document written in French would have a Content-Language value indicating French. If this header is not present in the response, the object is intended for all audiences. Multiple languages in the header’s value indicate that the object is suitable for audiences of each language listed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 28pt 0pt;"><span class="font21">One caveat about this header is that the header’s value may just represent the natural language of the intended audience of this object, not all or any of the languages contained</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font20">* See</span><a href="#bookmark438"><span class="font20"> Chapter 2 </span></a><span class="font20">for more on base URLs. <a name="bookmark3423"></a></span><span class="font21">in the object. Also, this header is not limited to text or written data objects; images, video, and other media types can be tagged with their intended audiences’ natural languages.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Language: 1# language-tag</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Language: en</span></p>
<p style="padding:0pt 0pt 22pt 73pt;"><span class="font21">Content-Language: en, fr</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3424"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3425"></a>Content-Length</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3426"></a><span class="font21">The Content-Length header gives the length or size of the entity body. If the header is in a response message to a HEAD HTTP request, the value of the header indicates the size that the entity body would have been had it been sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Length: 1*DIGIT</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Length: 2417</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3427"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3428"></a>Content-Location</span></h2>
<p style="text-align:justify;"><span class="font21">The Content-Location header is included in an HTTP message to give the URL corresponding to the entity in the message. For objects that may have multiple URLs, a response message can include a Content-Location header indicating the URL of the object used to generate the response. The Content-Location can be different from the requested URL. Th<a name="bookmark3429"></a>is generally is used by servers that are directing or redirecting a client to a new URL.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">If the URL is relative, it should be interpreted relative to the Content-Base header. If the Content-Base header is not present, the URL used in the request should be used.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Location: (absoluteURL | relativeURL)</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Location: </span><a href="http://www.joes-hardware.com/index.html"><span class="font21">http://www.joes-hardware.com/index.html</span></a></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3430"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3431"></a>Content-MD5</span></h2>
<p style="text-align:justify;"><span class="font21">The Content-MD5 header is used by servers to provide a message-integrity check for the message body. Only an origin server or requesting client should insert a Content-MD5 header in the message. The value of the header is an MD5 digest<sup>*</sup> of the (potentially encoded) message body.</span></p>
<p style="text-align:justify;"><span class="font21">The value of this header allows for an end-to-end check on the data, useful for detecting unintentional modifications to the data in transit. It is not intended to be used for security purposes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3432"></a><span class="font21">RFC 1864 defines this header in more detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">The MD5 digest value is a base-64 (see </span><a href="#bookmark250"><span class="font21">Appendix E</span></a><span class="font21">) or 128-bit MD5</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 73pt;"><span class="font21">digest, as defined in RFC 1864.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-MD5: md5-digest</span></p>
<p style="padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-MD5: Q2h1Y2sgSW51ZwDIAXR5IQ==</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3433"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3434"></a>Content-Range</span></h2>
<p style="text-align:justify;"><span class="font21">The Content-Range header is sent as the result of a request that transmitted a range of a document. It provides the location (range) within the original entity that this entity represents. It also gives the length of the entire entity.</span></p>
<p style="text-align:justify;"><span class="font21">If an “*” is present in the value instead of the length of the entire entity, this means that the le<a name="bookmark3435"></a>ngth was not known when the response was sent.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">See</span><a href="#bookmark239"><span class="font21"> Chapter 15 </span></a><span class="font21">for more on the Content-Range header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Servers responding with the 206 Partial Content response code must not</span></p>
<p style="padding:0pt 0pt 9pt 73pt;"><span class="font21">include a Content-Range header with an “*” as the length.</span></p>
<p style="padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Range: bytes 500-999 / 5400</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3436"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3437"></a>Content-Type</span></h2>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font21">The Content-Type header tells the media type of the object in the message.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Type: media-type</span></p>
<p style="padding:0pt 0pt 37pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Content-Type: text/html; charset=iso-latin-1</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font20">* The MD5 digest is defined in RFC 1864.</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3438"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3439"></a><a name="bookmark3440"></a><a name="bookmark3441"></a>Cookie</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Cookie header is an extension header used for client identification and tracking. </span><a href="#bookmark235"><span class="font21">Chapter 11 </span></a><span class="font21">talks about the Cookie header and its use in detail (also see</span><a href="#bookmark3442"><span class="font21"> “Set-Cookie</span></a><span class="font21">”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Extension request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Cookie: ink=IUOK164y59BC708378908CFF89OE5573998A115</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark715"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3443"></a><a name="bookmark3444"></a><a name="bookmark3445"></a>Cookie2</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Cookie2 header is an extension header used for client identification and tracking. Cookie2 is used to identify what version of cookies a requestor understands. It is defined in greater detail in RFC 2965.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark235"><span class="font21">Chapter 11 </span></a><span class="font21">talks about the Cookie2 header and its use in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Extension request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Cookie2: $version=&quot;1&quot;</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3446"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3447"></a>Date</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Date header gives the date and time at which the message was created. This header is required in servers’ responses because the time and date at which the server believes the message was created can be used by caches in evaluating the freshness of a response. For clients, this header is completely optional, although it’s good form to include it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">General header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Date: HTTP-date</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Date: Tue, 3 Oct 1997 02:15:31 GMT</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 73pt;"><span class="font21">HTTP has a few specific date formats. This one is defined in RFC 822 and is the preferred format for HTTP/1.1 messages. However, in earlier specifications of HTTP, the date format was not spelled out as well, so server and client implementors have used other formats, which need to be supported for the sake of legacy. You will run into date formats like the one specified in RFC 850, as well as dates in the format produced by the </span><span class="font21" style="font-style:italic;">asctime()</span><span class="font21"> system call. Here they are for the date represented above:</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 91pt;"><span class="font3">Date: Tuesday, 03-Oct-97 02:15:31 GMT </span><span class="font20" style="font-style:italic;">RFC 850 format</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 91pt;"><span class="font3">Date: Tue Oct 3 02:15:31 1997 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font20" style="font-style:italic;">asctime() format</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 73pt;"><span class="font21">The </span><span class="font21" style="font-style:italic;">asctime()</span><span class="font21"> format is looked down on because it is in local time and it does not specify its time zone (e.g., GMT). In general, the date header should be in GMT; however, robust applications should handle dates that either do not specify the time zone or include Date values in non-GMT time.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark694"></a><span class="font7" style="font-weight:bold;"><a name="bookmark1450"></a><a name="bookmark3448"></a><a name="bookmark3449"></a><a name="bookmark3450"></a>ETag</span></h2>
<p style="text-align:justify;"><a name="bookmark3451"></a><span class="font21">The ETag header provides the </span><span class="font21" style="font-style:italic;">entity tag</span><span class="font21"> for the entity contained in the message. An entity tag is basically a way of identifying a resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">Entity tags and their relationship to resources are discussed in detail in</span><a href="#bookmark239"><span class="font21"> Chapter 15</span></a><span class="font21">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">ETag: entity-tag</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">ETag: &quot;11e92a-457b-31345aa&quot;</span></p>
<p style="padding:0pt 0pt 22pt 73pt;"><span class="font21">ETag: W/&quot;11e92a-457b-3134b5aa&quot;</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3452"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3453"></a>Expect</span></h2>
<p style="text-align:justify;"><span class="font21">The Expect header is used by clients to let servers know that they expect certain behavior. This header currently is closely tied to the response code 100 Continue (see </span><a href="#bookmark647"><span class="font21">“100–199:</span></a><span class="font21"> </span><a href="#bookmark647"><span class="font21">Informational Status Codes” in Chapter 3</span></a><a name="bookmark3454"></a><span class="font21">).</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">If a server does not understand the Expect header’s value, it should respond with a status code of 417 Expectation Failed.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Expect: 1# (&quot;100-continue&quot; | expectation-extension)</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Expect: 100-continue</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3455"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3456"></a>Expires</span></h2>
<p style="text-align:justify;"><span class="font21">The Expires header gives a date and time at which the response is no longer valid. This allows clients such as your browser to cache a copy and not have to ask the server if it is stil<a name="bookmark3457"></a>l valid until after this time has expired.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses how the Expires header is used—in particular, how it relates to caches and having to revalidate responses with the origin server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Expires: HTTP-date</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Expires: Thu, 03 Oct 1997 17:15:00 GMT</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3458"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3459"></a>From</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The From header says who the request is coming from. The format is just a valid Internet email address (specified in RFC 1123) for the user of the client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3460"></a><span class="font21">There are potential privacy issues with using/populating this header. Client implementors should be careful to inform their users and give them a choice before including this header in a request message. Given the potential for abuse by people collecting email addresses for unsolicited mail messages, woe to the implementor who broadcasts this header unannounced and has to answer to angry users.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">From: mailbox</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">From: </span><a href="mailto:slurp@inktomi.com"><span class="font21">slurp@inktomi.com</span></a></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3461"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3462"></a>Host</span></h2>
<p style="text-align:justify;"><span class="font21">The Host header is used by clients to provide the server with the Internet hostname and port number of the machine from which the client wants to make a request. The hostname and port are those from the URL the client was requesting.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Host header allows servers to differentiate different relative URLs based on the hostname, giving the server the ability to host several different hostnames on the same machine (i.e., the same IP address).</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3463"></a><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">HTTP/1.1 clients must include a Host header in all requests. All HTTP/</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 73pt;"><span class="font21">1.1 servers must respond with the 400 Bad Request status code to HTTP/1.1 clients that do not provide a Host header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Host: host [&quot;:&quot; port]</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Host: </span><a href="http://www.hotbot.com:80"><span class="font21">www.hotbot.com:80</span></a></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3464"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3465"></a>If-Modified-Since</span></h2>
<p style="text-align:justify;"><span class="font21">The If-Modified-Since request header is used to make conditional requests. A client can use the GET method to request a resource from a server, having the response hinge on whether the resource has been modified since the client last requested it.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">If the object has not been modified, the server will respond with a 304 Not Modified response, instead of with the resource. If the object has been modified, the server will respond as if it was a non-conditional GET request. </span><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses conditional requests in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Modified-Since: HTTP-date</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Modified-Since: Thu, 03 Oct 1997 17:15:00 GMT</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3466"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3467"></a>If-Match</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a name="bookmark3468"></a><span class="font21">Like the If-Modified-Since header, the If-Match header can be used to make a request conditional. Instead of a date, the If-Match request uses an entity tag. The server compares the entity tag in the If-Match header with the current entity tag of the resource and returns the object if the tags match.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The server should use the If-Match value of “*” to match any entity tag it has for a resource; “*” will always match, unless the server no longer has the resource.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3469"></a><span class="font21">This header is useful for updating resources that a client or cache already has. The resource is returned only if it has changed—that is, if the previously requested object’s entity tag does not match the entity tag of the current version on the server. </span><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses conditional requests in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Match: (&quot;*&quot; | 1# entity-tag)</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Match: &quot;11e92a-457b-31345aa&quot;</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3470"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3471"></a>If-None-Match</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The If-None-Match header, like all the If headers, can be used to make a request conditional. The client supplies the server with a list of entity tags, and the server compares those tags against the entity tags it has for the resource, returning the resource only if none match.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3472"></a><span class="font21">This allows a cache to update resources only if they have changed. Using the If-None-Match header, a cache can use a single request to both invalidate the entities it has and receive the new entity in the response.</span><a href="#bookmark231"><span class="font21"> Chapter 7</span></a><span class="font21"> discusses conditional requests in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-None-Match: (&quot;*&quot; | 1# entity-tag)</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-None-Match: &quot;11e92a-457b-31345aa&quot;</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3473"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3474"></a>If-Range</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The If-Range header, like all the If headers, can be used to make a request conditional. It is used when an application has a copy of a range of a resource, to revalidate the range or get the complete resource if the range is no longer valid. </span><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses conditional requests in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Range: (HTTP-date | entity-tag)</span></p>
<p><a name="bookmark3475"></a><span class="font5" style="font-weight:bold;">Examples </span><span class="font21">If-Range: Tue, 3 Oct 1997 02:15:31 GMT</span></p>
<p style="padding:0pt 0pt 23pt 73pt;"><span class="font21">If-Range: &quot;11e92a-457b-3134b5aa&quot;</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3476"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3477"></a>If-Unmodified-Since</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3478"></a><span class="font21">The If-Unmodified-Since header is the twin of the If-Modified-Since header. Including it in a request makes the request conditional. The server should look at the date value of the header and return the object only if it has not been modified since the date provided. </span><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses conditional requests in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Unmodified-Since: HTTP-date</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">If-Unmodified-Since: Thu, 03 Oct 1997 17:15:00 GMT</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3479"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3480"></a>Last-Modified</span></h2>
<p style="text-align:justify;"><span class="font21">The Last-Modified header tries to provide information about the last time this entity was changed. This could mean a lot of things. For example, resources typically are files on a server, so the Last-Modified value could be the last-modified time provided by the server’s filesystem. On the other hand, for dynamically created resources such as those created by scripts, the Last-Modified value could be the time the response was created.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3481"></a><span class="font21">Servers need to be careful that the Last-Modified time is not in the future. HTTP/1.1 servers should reset the Last-Modified time if it is later than the value that would be sent in the Date header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Last-Modified: HTTP-date</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Last-Modified: Thu, 03 Oct 1997 17:15:00 GMT</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3482"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3483"></a>Location</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Location header is used by servers to direct clients to the location of a resource that either was moved since the client last requested it or was created in response to the request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Location: absoluteURL</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Location: </span><a href="http://www.hotbot.com"><span class="font21">http://www.hotbot.com</span></a></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3484"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3485"></a><a name="bookmark3486"></a>Max-Forwards</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">This header is used only with the TRACE method, to limit the number of proxies or other intermediaries that a request goes through. Its value is an integer. Each application that receives a TRACE request with this header should decrement the value before it forwards the request along.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><a name="bookmark3487"></a><span class="font21">If the value is zero when the application receives the request, it should send back a 200 OK response to the request, with an entity body containing the original request. If the MaxForwards header is missing from a TRACE request, assume that there is no maximum number of forwards.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">For other HTTP methods, this header should be ignored. See</span><a href="#bookmark609"><span class="font21"> “Methods” in Chapter 3 </span></a><span class="font21">for more on the TRACE method.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font21">Max-Forwards: 1*DIGIT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font21">Max-Forwards: 5</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3488"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3489"></a>MIME-Version</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">MIME is HTTP’s cousin. While they are radically different, some HTTP servers do construct messages that are valid under the MIME specification. When this is the case, the MIME-Version header can be supplied by the server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3490"></a><span class="font21">This header has never been part of the official specification, although it is mentioned in the HTTP/1.0 specification. Many older servers send messages with this header, however, those messages often are not valid MIME messages, making this header both confusing and impossible to trust.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Extension general header</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">MIME-Version: DIGIT &quot;.&quot; DIGIT</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">MIME-Version: 1.0</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3491"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3492"></a>Pragma</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Pragma header is used to pass directions along with the message. These directions could be almost anything, but often they are used to control caching behavior. Proxies and gateways must not remove the Pragma header, because it could be intended for all applications that receive the message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The most common form of Pragma, Pragma: no-cache, is a request header that forces caches to request or revalidate the document from the origin server even when a fresh copy is available in the cache. It is sent by browsers when users click on the Reload/Refresh button. Many servers send Pragma: no-cache as a response header (as an equivalent to Cache-Control: no-cache), but despite its common use, this behavior is technically un<a name="bookmark3493"></a>definded. Not all applications support Pragma response headers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark231"><span class="font21">Chapter 7</span></a><span class="font21"> discusses the Pragma header and how it is used by HTTP/1.0 applications to control caches.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Pragma: 1# pragma-directive<sup>*</sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 24pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Pragma: no-cache</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3494"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3495"></a>Proxy-Authenticate</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Proxy-Authenticate header functions like the WWW-Authenticate header. It is used by proxies to challenge an application sending a request to authenticate itself. The full details of this challenge/response, and other security mechanisms of HTTP, are discussed in detail in</span><a href="#bookmark238"><span class="font21"> Chapter 14</span></a><span class="font21">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">If an HTTP/1.1 proxy server is sending a 407 Proxy Authentication Required response, it must include the Proxy-Authenticate header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">Proxies and gateways must be careful in interpreting all the Proxy headers. They generally are <a name="bookmark3496"></a>hop-by-hop headers, applying only to the current connection. For instance, the Proxy-Authenticate header requests authentication for the current connection.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font21">Proxy-Authenticate: challenge</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">Proxy-Authenticate: Basic realm=&quot;Super Secret Corporate Financial Documents&quot;</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3497"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3498"></a>Proxy-Authorization</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Proxy-Authorization header functions like the Authorization header. It is used by client applications to respond to Proxy-Authenticate challenges. See</span><a href="#bookmark238"><span class="font21"> Chapter 14 </span></a><span class="font21">for more on how the challenge/response security mechanism works.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Proxy-Authorization: credentials</span></p>
<p style="text-align:justify;padding:0pt 0pt 30pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Proxy-Authorization: Basic YnJpYW4tdG90dHk6T3ch</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 7pt;"><span class="font20">* The only specification-defined Pragma directive is “no-cache”; however, you may run into other Pragma headers that have been defined as extensions to the specification.</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3499"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3500"></a><a name="bookmark3501"></a><a name="bookmark3502"></a>Proxy-Connection</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Proxy-Connection header was meant to have similar semantics to the HTTP/1.0 Connection header. It was to be used between clients and proxies to specify options about the connections (chiefly keep-alive connections).<sup>*</sup> It is not a standard header and is viewed as an ad hoc header by the standards committee. However, it is widely used by browsers and proxies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">Browser implementors created the Proxy-Connection header to solve the problem of a client sending an HTTP/1.0 Connection header that gets blindly forwarded by a dumb proxy. A server receiving the blindly forwarded Connection header could confuse the capabilities of the client connection with those of the proxy connection.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Proxy-Connection header is sent instead of the Connection header when the client knows that it is going through a proxy. Because servers don’t recognize the ProxyConnection header, they ignore it, allowing dumb proxies that blindly forward the header to do so without causing harm.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The problem with this solution occurs if there is more than one proxy in the path of the client to the server. If the first one blindly forwards the header to the second, which understands it, the second proxy can suffer from the same confusion the server did with the Connection header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3503"></a><span class="font21">This is the problem that the HTTP working group had with this solution—they saw it as a hack that solved the case of a single proxy, but not the bigger problem. Nonetheless, it does handle some of the more common cases, and because older versions of both Netscape Navigator and Microsoft Internet Explorer implement it, proxy implementors need to deal with it. See</span><a href="#bookmark226"><span class="font21"> Chapter 4</span></a><span class="font21"> for more information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">General header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Proxy-Connection: 1# (connection-token)</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Proxy-Connection: close</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3504"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3505"></a>Public</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Public header allows a server to tell a client what methods it supports. These methods can be used in future requests by the client. Proxies need to be careful when they receive a response from a server with the Public header. The header indicates the capabilities of the server, not the proxy, so the proxy needs to either edit the list of methods in the header or remove the header before it sends the response to the client.</span></p>
<p style="text-align:justify;padding:0pt 0pt 51pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font20">* See</span><a href="#bookmark226"><span class="font20"> Chapter 4</span></a><span class="font20"> for more on keep-alive and persistent connections.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark3506"></a><span class="font5" style="font-weight:bold;">Notes</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 0pt 11pt;"><span class="font21">This header is not defined in RFC 2616. It was previously defined in RFC 2068, an earlier draft of the HTTP/1.1 specification, but it has since been removed from the official specification.</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;text-indent:11pt;"><span class="font21">Public: 1# HTTP-method</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:11pt;"><span class="font21">Public: OPTIONS, GET, HEAD, TRACE, POST</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3507"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3508"></a>Range</span></h2>
<p style="text-align:justify;"><a name="bookmark3509"></a><span class="font21">The Range header is used in requests for parts or ranges of an entity. Its value indicates the range of the entity that is included in the message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">Requests for ranges of a document allow for more efficient requests of large objects (by requesting them in segments) or for recovery from failed transfers (allowing a client to request the range of the resource that did not make it). Range requests and the headers that make the requests possible are discussed in detail in</span><a href="#bookmark239"><span class="font21"> Chapter 15</span></a><span class="font21">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Entity header</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Range: bytes=500-1500</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3510"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3511"></a>Referer</span></h2>
<p style="text-align:justify;"><span class="font21">The Referer header is inserted into client requests to let the server know where the client got the URL from. This is a voluntary effort, for the server’s benefit; it allows the server to better log the requests or perform other tasks. The misspelling of “Referer” hearkens back to the early days of HTTP, to the frustration of English-speaking copyeditors throughout the world.</span></p>
<p style="text-align:justify;"><span class="font21">What your browser does is fairly simple. If you get home page A and click on a link to go to home page B, your browser will insert a Referer header in the request with value A. Referer headers are inserted by your browser only when you click on links; requests for URLs you type in yourself will not contain a Referer header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">Because some pages are private, there are some privacy concerns with this header. While some of this is unwarranted paranoia, this header does allow web servers and their administrators to see where you came from, potentially allowing them to better track your surfing. As a result, the HTTP/1.1 specification recommends that application writers allow the user to decide whether this header is transmitted.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Referer: (absoluteURL | relativeURL)</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Referer: </span><a href="http://www.inktomi.com/index.html"><span class="font21">http://www.inktomi.com/index.html</span></a></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3512"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3513"></a>Retry-After</span></h2>
<p style="text-align:justify;"><a name="bookmark3514"></a><span class="font21">Servers can use the Retry-After header to tell a client when to retry its request for a resource. It is used with the 503 Service Unavailable status code to give the client a specific date and time (or number of seconds) at which it should retry its request.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3515"></a><span class="font21">A server can also use this header when it is redirecting clients to resources, giving the client a time to wait before making a request on the resource to which it is redirected.<sup>*</sup> This can be very useful to servers that are creating dynamic resources, allowing the server to redirect the client to the newly created resource but giving time for the resource to be created.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax </span><span class="font21">Retry-After: (HTTP-date | delta-seconds)</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Retry-After: Tue, 3 Oct 1997 02:15:31 GMT</span></p>
<p style="padding:0pt 0pt 21pt 73pt;"><span class="font21">Retry-After: 120</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3516"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3517"></a>Server</span></h2>
<p style="text-align:justify;"><span class="font21">The Server header is akin to the User-Agent header; it provides a way for servers to identify themselves to clients. Its value is the server name and an optional comment about the server.</span></p>
<p style="text-align:justify;"><span class="font21">Because the Server header identifies the server product and can contain additional comments about the product, its format is somewhat free-form. If you are writing software that depends on how a server identifies itself, you should experiment with the server software to see what it sends back, because these tokens vary from product to product and release to release.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3518"></a><span class="font21">As with the User-Agent header, don’t be surprised if an older proxy or gateway inserts what amounts to a Via header in the Server header itself.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Server: 1* (product | comment)</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Examples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Server: Microsoft-Internet-Information-Server/1.0</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 73pt;"><span class="font21">Server: websitepro/1.1f (s/n wpo-07d0)</span></p>
<p style="text-align:justify;padding:0pt 0pt 21pt 73pt;"><span class="font21">Server: apache/1.2b6 via proxy gateway CERN-HTTPD/3.0 libwww/2.13</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3442"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3519"></a><a name="bookmark3520"></a>Set-Cookie</span></h2>
<p style="text-align:justify;padding:0pt 0pt 24pt 0pt;"><span class="font21">The Set-Cookie header is the partner to the Cookie header; in</span><a href="#bookmark235"><span class="font21"> Chapter 11</span></a><span class="font21">, we discuss the use of this header in detail.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font20">* See</span><a href="#bookmark682"><span class="font20"> “Redirection status codes and reason phrases” in Chapter 3 </span></a><span class="font20">for more on server redirect responses.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark3521"></a><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Extension response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p><a name="bookmark3522"></a><span class="font21">Set-Cookie: command</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:top;">
<p style="padding:5pt 0pt 0pt 0pt;"><span class="font21">Set-Cookie: lastorder=00183; path=/orders</span></p>
<p><span class="font21">Set-Cookie: private_id=519; secure</span></p></td></tr>
</table>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font7" style="font-weight:bold;">Set-Cookie2</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The Set-Cookie2<a name="bookmark3523"></a> header is an extension of the Set-Cookie header; in</span><a href="#bookmark235"><span class="font21"> Chapter 11</span></a><span class="font21">, we discuss the use of this header in detail.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Extension response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p><span class="font21">Set-Cookie2: command</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:5pt 0pt 0pt 0pt;"><span class="font21">Set-Cookie2: ID=&quot;29046&quot;; Domain=&quot;.joes-hardware.com&quot;</span></p>
<p><span class="font21">Set-Cookie2: color=blue</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3524"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3525"></a>TE</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The poorly named TE header functions like the Accept-Encoding header, but for transfer encodings (it could have been named Accept-Transfer-Encoding, but it wasn’t). The TE header also can be used to indicate whether a client can handle headers in the trailer of a response that has been through the chunked encoding. See</span><a href="#bookmark239"><span class="font21"> Chapter 15 </span></a><span class="font21">for more on the TE header, chunked encoding, and trailers.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">Request header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">No<a name="bookmark3526"></a>tes</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;"><span class="font21">If the value is empty, only the chunked transfer encoding is acceptable. The special token “trailers” indicates that trailer headers are acceptable in a chunked response.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p><span class="font21">TE: # (transfer-codings)</span></p>
<p><span class="font21">transfer-codings= &quot;trailers&quot; | (transfer-extension [accept-params])</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:top;">
<p style="padding:5pt 0pt 0pt 0pt;"><span class="font21">TE:</span></p>
<p><span class="font21">TE: chunked</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3527"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3528"></a>Trailer</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The Trailer header is used to indicate which headers are present in the trailer of a message. </span><a href="#bookmark239"><span class="font21">Chapter 15 </span></a><span class="font21">discusses chunked encodings and trailers in detail.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p><span class="font21">General header</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3529"></a><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Trailer: 1#field-name</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Trailer: Content-Length</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3530"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3531"></a>Title</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Title header is a non-specification header that is supposed to give the title of the entity. This header was part of an early HTTP/1.0 extension and was used primarily for HTML pages, which have clear title markers that servers can use. Because many, if not most, media types on the Web do not have such an easy way to extract a title, this header has limited usefulness. As a result, it never made it into the official specification, though some older servers on the Net still send it faithfully.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark3532"></a><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Notes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">The Title header is not defined in RFC 2616. It was originally defined in</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 73pt;"><span class="font21">the HTTP/1.0 draft definition (</span><a href="http://www.w3.org/Protocols/HTTP/"><span class="font21" style="font-style:italic;">http://www.w3.org/Protocols/HTTP/</span></a><span class="font21" style="font-style:italic;"> HTTP2.html</span><span class="font21">) but has since been removed from the official specification.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Title: document-title</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Title: CNN Interactive</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3533"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3534"></a>Transfer-Encoding</span></h2>
<p style="text-align:justify;"><span class="font21">If some encoding had to be performed to transfer the HTTP message body safely, the message will contain the Transfer-Encoding header. Its value is a list of the encodings that were performed on the message body. If multiple encodings were performed, they are listed in order.</span></p>
<p style="text-align:justify;"><span class="font21">The Transfer-Encoding header differs from the Content-Encoding header because the trans<a name="bookmark3535"></a>fer encoding is an encoding that was performed by a server or other intermediary application to transfer the message.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">Transfer encodings are discussed in</span><a href="#bookmark239"><span class="font21"> Chapter 15</span></a><span class="font21">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">General header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Transfer-Encoding: 1# transfer-coding</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Transfer-Encoding: chunked</span></p>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3536"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3537"></a>UA-(CPU, Disp, OS, Color, Pixels)</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">These User-Agent headers are nonstandard and no longer common. They provide information about the client machine that could allow for better content selection by a server. For instance, if a server knew that a user’s machine had only an 8-bit color display, the server could select images that were optimized for that type of display.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">With any header that gives information about the client that otherwise would be unavailable, there are some security concerns (see</span><a href="#bookmark238"><span class="font21"> Chapter 14</span></a><span class="font21"> for more information).</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:11pt;"><span class="font21">Extension request headers</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Notes</span></p></td><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 11pt;"><span class="font21">These headers are not defined in RFC 2616, and their use is frowned upon.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><a name="bookmark3538"></a><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 11pt;"><span class="font21">&quot;UA&quot; &quot;-&quot; (&quot;CPU&quot; | &quot;Disp&quot; | &quot;OS&quot; | &quot;Color&quot; | &quot;Pixels&quot;) &quot;:&quot; machine-value machine-value = (cpu | screensize | os-name | display-color-depth)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Examples</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:11pt;"><span class="font21">UA-CPU: x86 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21" style="font-style:italic;">CPU of client’s machine</span></p>
<p style="text-align:justify;text-indent:11pt;"><span class="font21">UA-Disp: 640, 480, 8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21" style="font-style:italic;">Size and color depth of client’s display</span></p>
<p style="text-align:justify;text-indent:11pt;"><span class="font21">UA-OS: Windows 95 &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21" style="font-style:italic;">Operating system of client machine</span></p>
<p style="text-align:justify;text-indent:11pt;"><span class="font21">UA-Color: color8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21" style="font-style:italic;">Color depth of client’s display</span></p>
<p style="text-align:justify;text-indent:11pt;"><span class="font21">UA-Pixels: 640x480 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21" style="font-style:italic;">Size of client’s display</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3539"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3540"></a>Upgrade</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Upgrade header provides the sender of a message with a means of broadcasting the desire to use another, perhaps completely different, protocol. For instance, an HTTP/1.1 client could send an HTTP/1.0 request to a server and include an Upgrade header with the value “HTTP/1.1”, allowing the client to test the waters and see whether the server speaks HTTP/1.1.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">If the server is capable, it can send an appropriate response letting the client know that it is okay to use the new protocol. This provides an efficient way to move to other protocols. Most servers currently are only HTTP/1.0-compliant, and this strategy allows a client to av<a name="bookmark3541"></a>oid confusing a server with too many HTTP/1.1 headers until it determines whether the server is indeed capable of speaking HTTP/1.1.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">When a server sends a 101 Switching Protocols response, it must include this header.</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">General header</span></p>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Upgrade: 1# protocol</span></p>
<p style="text-align:justify;padding:0pt 0pt 22pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Upgrade: HTTP/2.0</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3542"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3543"></a>User-Agent</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The User-Agent header is used by client applications to identify themselves, much like the Server header for servers. Its value is the product name and possibly a comment describing the client application.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">This header’s format is somewhat free-form. Its value varies from client product to product and release to release. This header sometimes even contains information about the machine on <a name="bookmark3544"></a>which the client is running.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">As with the Server header, don’t be surprised if older proxy or gateway applications insert what amounts to a Via header in the User-Agent header itself.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Request header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">User-Agent: 1* (product | comment)</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">User-Agent: Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0)</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3545"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3546"></a>Vary</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Vary header is used by servers to inform clients what headers from a client’s request will be used in server-side negotiation.<sup>*</sup> Its value is a list of headers that the server looks at to determine what to send the client as a response.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">An example of this would be a server that sends special HTML pages based on your web browser’s features. A server sending these special pages for a URL would include a Vary header that indicated that it looked at the User-Agent header of the request to determine wh<a name="bookmark3547"></a>at to send as a response.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font21">The Vary header also is used by caching proxies; see</span><a href="#bookmark231"><span class="font21"> Chapter 7</span></a><span class="font21"> for more on how the Vary header relates to cached HTTP responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Response header</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font5" style="font-weight:bold;">Basic Syntax &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Vary: (&quot;*&quot; | 1# field-name)</span></p>
<p style="text-align:justify;padding:0pt 0pt 23pt 0pt;"><span class="font5" style="font-weight:bold;">Example &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font21">Vary: User-Agent</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3548"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3549"></a>Via</span></h2>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">The Via header is used to trace messages as they pass through proxies and gateways. It is an informational header that can be used to see what applications are handling requests and responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font21">When a message passes through an HTTP application on its way to a client or a server, that application can use the Via header to tag the message as having gone </span><span class="font21" style="font-style:italic;">via</span><span class="font21"> it. This is an HTTP/1.1 header; many older applications insert a Via-like string in the User-Agent or Server headers of requests and responses.</span></p>
<p style="text-align:justify;padding:0pt 0pt 30pt 0pt;"><span class="font21">If the message passes through multiple in-between applications, each one should tack on its Via string. The Via header must be inserted by HTTP/1.1 proxies and gateways.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font20">* See</span><a href="#bookmark241"><span class="font20"> Chapter 17</span></a><span class="font20"> for more on content negotiation.</span></p>
<table>
<tr><td>
<p><span class="font21">General header</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span><span class="font3"><sup>*</sup></span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font21">Via: 1# (received-protocol received-by [comment])</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;padding:0pt 0pt 2pt 0pt;"><span class="font21">Via: 1.1 joes-hardware.com (Joes-Server/1.0)</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 9pt;"><span class="font21">The above says that the message passed through the Joes Server Version 1.0 software running on the machine </span><span class="font21" style="font-style:italic;">joes-hardware.com</span><span class="font21">. Joe’s Server was speaking HTTP 1.1. The Via header should be formatted like this:</span></p>
<p style="text-indent:27pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">HTTP-Version machine-hostname (Application-Name-Version)</span></p></td></tr>
</table></td></tr>
</table>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font5" style="font-weight:bold;">Ty<a name="bookmark3550"></a>pe</span></p>
</div>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3551"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3552"></a>Warning</span></h2>
<p style="text-align:justify;"><span class="font21">The Warning header is used to give a little more information about what happened during a request. It provides the server with a way to send additional information that is not in the status code or reason phrase. Several warning codes are defined in the HTTP/1.1 specification:</span></p>
<p style="text-align:justify;"><span class="font21" style="font-style:italic;">101 Response Is Stale</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">When a response message is known to be stale—for instance, if the origin server is unavailable for revalidation—this warning must be included.</span></p>
<p><span class="font21" style="font-style:italic;">111 Revalidation Failed</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">If a cache attempts to revalidate a response with an origin server and the revalidation fails because the cache cannot reach the origin server, this warning must be included in the response to the client.</span></p>
<p><span class="font21" style="font-style:italic;">112 Disconnected Operation</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">An informative warning; should be used if a cache’s connectivity to the network is removed.</span></p>
<p><span class="font21" style="font-style:italic;">113 Heuristic Expiration</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">Caches must include this warning if their freshness heuristic is greater than 24 hours and they are returning a response with an age greater than 24 hours.</span></p>
<p><span class="font21" style="font-style:italic;">199 Miscellaneous Warning</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">Systems receiving this warning must not take any automated response; the message may and probably should contain a body with additional information for the user.</span></p>
<p><span class="font21" style="font-style:italic;">214 Transformation Applied</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font21">Must be added by any intermediate application, such as a proxy, if the application performs any transformation that changes the content encoding of the response.</span></p>
<p><span class="font21" style="font-style:italic;">299 Miscellaneous Persistent Warning</span></p>
<p style="text-align:justify;padding:0pt 0pt 64pt 19pt;"><span class="font21">Systems receiving this warning must not take any automated reaction; the error may contain a body with more information for the user.</span></p>
<p><span class="font20">* See the HTTP/1.1 specification for the complete Via header syntax.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-align:justify;"><a name="bookmark3553"></a><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font21">Warning: 1# warning-value</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:justify;padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">Warning: 113</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3554"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3555"></a>WWW-Authenticate</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3556"></a><span class="font21">The WWW-Authenticate header is used in 401 Unauthorized responses to issue a challenge authentication scheme to the client.</span><a href="#bookmark238"><span class="font21"> Chapter 14</span></a><span class="font21"> discusses the WWW-Authenticate header and its use in HTTP’s basic challenge/response authentication system.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font21">Response header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font21">WWW-Authenticate: 1# challenge</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:justify;padding:4pt 0pt 0pt 0pt;"><a name="bookmark3557"></a><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">WWW-Authenticate: Basic realm=&quot;Your Private Travel Profile&quot;</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3558"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3559"></a>X-Cache</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font21">The X headers are all extension headers. The X-Cache header is used by Squid to inform a client whether a resource is available.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font21">Extension response header</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:justify;padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">X-Cache: HIT</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3560"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3561"></a>X-Forwarded-For</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><a name="bookmark3562"></a><span class="font21">This header is used by many proxy servers (e.g., Squid) to note whom a request has been forwarded for. Like the Client-ip header mentioned earlier, this request header notes the address from which the request originates.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font21">Extension request header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-align:justify;"><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font21">X-Forwarded-For: addr</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-align:justify;padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">X-Forwarded-For: 64.95.76.161</span></p></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><a name="bookmark3563"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3564"></a>X-Pad</span></h2>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font21">This header is used to overcome a bug related to response header length in some browsers; it pads the response message headers with extra bytes to work around the bug.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><a name="bookmark3565"></a><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Extension general header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font21">X-Pad: pad-text</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:4pt 0pt 0pt 0pt;"><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;padding:5pt 0pt 0pt 0pt;"><span class="font21">X-Pad: bogosity</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 4pt 0pt;"><a name="bookmark3566"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3567"></a>X-Serial-Number</span></h2>
<p><a name="bookmark3568"></a><span class="font21">The X-Serial-Number header is an extension header. It was used by some older HTTP applications to insert the serial number of the licensed software in the HTTP message.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font21">Its use has pretty much died out, but it is listed here as an example of the X headers that are out there.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font5" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:top;">
<p style="text-indent:11pt;"><span class="font21">Extension general header</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font5" style="font-weight:bold;">Basic Syntax</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:11pt;"><span class="font21">X-Serial-Number: serialno</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font5" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:11pt;"><span class="font21">X-Serial-Number: 010014056</span></p></td></tr>
</table>
<p style="text-align:right;padding:0pt 0pt 3pt 0pt;"><span class="font7" style="font-weight:bold;">APPENDIX D</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark249"></a><span class="font11" style="font-weight:bold;"><a name="bookmark203"></a><a name="bookmark3569"></a>MIME Types</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark3570"></a><span class="font24"><a name="bookmark3571"></a><a name="bookmark3572"></a>MIME media types (MIME types, for short) are standardized names that describe the contents of a message entity body (e.g., text/html, image/jpeg). This appendix explains how MIME types work, how to register new ones, and where to go for more information.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In addition, this appendix contains 10 convenient tables, detailing hundreds of MIME types, gathered from many sources around the globe. This may be the most detailed tabular listing of MIME types ever compiled. We hope these tables are useful to you.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">In this appendix, we will:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Outline the primary reference material, in </span><a href="#bookmark3573"><span class="font24">“Background</span></a><span class="font24">.”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Explain the structure of MIME types, in</span><a href="#bookmark3574"><span class="font24"> “MIME Type Structure.”</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Show you how to register MIME types, in</span><a href="#bookmark3575"><span class="font24"> “MIME Type IANA Registration</span></a><span class="font24">.</span><a href="#bookmark3574"><span class="font24">”</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Make it easier for you to look up MIME types.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">The following MIME type tables are included in this appendix:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• application/*—</span><a href="#bookmark3576"><span class="font24">Table D-3</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• audio/*—</span><a href="#bookmark3577"><span class="font24">Table D-4</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• chemical/*</span><a href="#bookmark3578"><span class="font24">—Table D-5</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• image/*—</span><a href="#bookmark3579"><span class="font24">Table D-6</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• message/*</span><a href="#bookmark3580"><span class="font24">—Table D-7</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• model/*—</span><a href="#bookmark3581"><span class="font24">Table D-8</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• multipart/*</span><a href="#bookmark3582"><span class="font24">—Table D-9</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• text/*—</span><a href="#bookmark3583"><span class="font24">Table D-10</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• video/*</span><a href="#bookmark3584"><span class="font24">—Table D-11</span></a></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Other—</span><a href="#bookmark3585"><span class="font24">Table D-12</span></a></p></li></ul>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3573"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3586"></a><a name="bookmark3587"></a><a name="bookmark3588"></a>Background</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">MIME types originally were developed for multimedia email (MIME stands for Multipurpose Internet Mail Extensions), but they have been reused for HTTP and several other protocols that need to describe the format and purpose of data objects.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">MIME is defined by five primary documents:</span></p>
<p style="text-align:justify;"><span class="font24" style="font-style:italic;">RFC 2045, “MIME: Format of Internet Message Bodies”</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Describes the overall MIME message structure, and introduces the ContentType header, borrowed by HTTP</span></p>
<p><span class="font24" style="font-style:italic;">RFC 2046, “MIME: Media Types”</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Introduces MIME types and their structure</span></p>
<p><span class="font24" style="font-style:italic;">RFC 2047, “MIME: Message Header Extensions for Non-ASCII Text”</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">Defines ways to include non-ASCII characters in headers</span></p>
<p><a name="bookmark3589"></a><span class="font24" style="font-style:italic;">RFC 2048, “MIME: Registration Procedures”</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">Defines how to register MIME values with the Internet Assigned Numbers Authority (IANA)</span></p>
<p><span class="font24" style="font-style:italic;">RFC 2049, “MIME: Conformance Criteria and Examples”</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Details rules for compliance, and provides examples</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">For the purposes of HTTP, we are most interested in RFC 2046 (Media Types) and RFC 2048 (Registration Procedures).</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3574"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3590"></a><a name="bookmark3591"></a><a name="bookmark3592"></a>MIME Type Structure</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Each MIME media type consists of a type, a subtype, and a list of optional parameters. The type and subtype are separated by a slash, and the optional parameters begin with a semicolon, if they are present. In HTTP, MIME media types are widely used in Content-Type and Accept headers. Here are a few examples:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Content-Type: video/quicktime</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><a name="bookmark3593"></a><span class="font3">Content-Type: text/html; charset=&quot;iso-8859-6&quot;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">Content-Type: multipart/mixed; boundary=gc0p4Jq0M2Yt08j34c0p</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 15pt 0pt;"><span class="font3">Accept: image/gif</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3594"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3595"></a>Discrete Types</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">MIME types can directly describe the object type, or they can describe collections or packages of other object types. If a MIME type describes an object type directly, it is a </span><span class="font24" style="font-style:italic;">discrete type</span><span class="font24">. These include text files, videos, and application-specific file formats.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3596"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3597"></a>Composite Types</span></h3>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">If a MIME type describes a collection or encapsulation of other content, the MIME type is called a </span><span class="font24" style="font-style:italic;">composite type</span><span class="font24">. A composite type describes the format of the enclosing <a name="bookmark3598"></a>package. When the enclosing package is opened, each enclosed object will have its own type.</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3599"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3600"></a>Multipart Types</span></h3>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">Multipart media types are composite types. A multipart object consists of multiple component types. Here’s an example of multipart/mixed content, where each component has its own MIME type:</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Type: </span><span class="font3" style="font-weight:bold;">multipart/mixed</span><span class="font3">; boundary=unique-boundary-1</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-1</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-type: </span><span class="font3" style="font-weight:bold;">text/plain</span><span class="font3">; charset=US-ASCII</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Hi there, I'm some boring ASCII text...</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-1</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Type: </span><span class="font3" style="font-weight:bold;">multipart/parallel</span><span class="font3">; boundary=unique-boundary-2</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-2</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Type: </span><span class="font3" style="font-weight:bold;">audio/basic</span></p>
<p style="padding:0pt 0pt 10pt 51pt;"><span class="font3">... 8000 Hz single-channel mu-law-format audio data goes here ...</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-2</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Type: </span><span class="font3" style="font-weight:bold;">image/jpeg</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">... image data goes here ...</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">--unique-boundary-2--</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-1</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-type: </span><span class="font3" style="font-weight:bold;">text/enriched</span></p>
<p style="text-indent:19pt;"><span class="font3">This is &lt;bold&gt;&lt;italic&gt;enriched.&lt;/italic&gt;&lt;/bold&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">&lt;smaller&gt;as defined in RFC 1896&lt;/smaller&gt;</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Isn't it &lt;bigger&gt;&lt;bigger&gt;cool?&lt;/bigger&gt;&lt;/bigger&gt;</span></p>
<p style="text-indent:19pt;"><span class="font3">--unique-boundary-1</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Type: </span><span class="font3" style="font-weight:bold;">message/rfc822</span></p>
<p style="text-indent:19pt;"><span class="font3">From: (mailbox in US-ASCII)</span></p>
<p style="text-indent:19pt;"><span class="font3">To: (address in US-ASCII)</span></p>
<p style="text-indent:19pt;"><span class="font3">Subject: (subject in US-ASCII)</span></p>
<p style="text-indent:19pt;"><span class="font3">Content-Type: Text/plain; charset=ISO-8859-1</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">Content-Transfer-Encoding: Quoted-printable</span></p>
<p style="text-indent:35pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">... Additional text in ISO-8859-1 goes here ...</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">--unique-boundary-1--</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3601"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3602"></a><a name="bookmark3603"></a>Syntax</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">As we stated earlier, MIME types consist of a primary type, a subtype, and an optional list of parameters.</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The primary type can be a predefined type, an IETF-defined extension token, or an experimental token (beginning with “x-”). Some common primary types are described in </span><a href="#bookmark3604"><span class="font24">Table D-1</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3604"></a><span class="font23" style="font-style:italic;">Table D-1. Common primary MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Application-specific content format (discrete type)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Audio format (discrete type)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">chemical</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Chemical data set (discrete IETF extension type)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">image</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Image format (discrete type)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">message</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Message format (composite type)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model</span></p></td><td style="vertical-align:top;">
<p><span class="font2">3-D model format (discrete IETF extension type)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">multipart</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Collection of multiple objects (composite type)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Text format (discrete type)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">video</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Video movie format (discrete type)</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Subtypes can be primary types (as in “text/text”), IANA-registered subtypes, or experimental extension tokens (beginning with “x-”).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Types and subtypes are made up of a subset of US-ASCII characters. Spaces and certain reserved grouping and punctuation characters, called “tspecials,” are control characters and are forbidden from type and subtype names.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The grammar from RFC 2046 is shown below:</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 51pt;"><span class="font3">TYPE := &quot;application&quot; | &quot;audio&quot; | &quot;image&quot; | &quot;message&quot; | &quot;multipart&quot; | &quot;text&quot; | &quot;video&quot; | IETF-TOKEN | X-TOKEN</span></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 51pt;"><span class="font3">SUBTYPE := IANA-SUBTOKEN | IETF-TOKEN | X-TOKEN</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">IETF-TOKEN := &lt;extension token with RFC and registered with IANA&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">IANA-SUBTOKEN := &lt;extension token registered with IANA&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 10pt 0pt;"><span class="font3">X-TOKEN := &lt;&quot;X-&quot; or &quot;x-&quot; prefix, followed by any token&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">PARAMETER := TOKEN &quot;=&quot; VALUE</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">VALUE := TOKEN / QUOTED-STRING</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">TOKEN := 1*&lt;any (US-ASCII) CHAR except SPACE, CTLs, or TSPECIALS&gt;</span></p>
<p style="text-align:justify;text-indent:19pt;"><a href="#bookmark3605"><span class="font3">TSPECIALS := &nbsp;&nbsp;&quot;(&quot; &nbsp;| &nbsp;&quot;)&quot; &nbsp;| &nbsp;&quot;&lt;&quot;&nbsp;&nbsp;| &nbsp;&quot;&gt;&quot;&nbsp;&nbsp;| &nbsp;&quot;@&quot;</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 75pt;"><a href="#bookmark3606"><span class="font3">&quot;,&quot; &nbsp;| &nbsp;&quot;;&quot; &nbsp;| &nbsp;&quot;:&quot; &nbsp;| &nbsp;&quot;\&quot; &nbsp;| &nbsp;&lt;&quot;&gt;</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 75pt;"><a href="#bookmark3607"><span class="font3">&quot;/&quot; &nbsp;| &nbsp;&quot;[&quot; &nbsp;| &nbsp;&quot;]&quot; &nbsp;| &nbsp;&quot;?&quot; &nbsp;|</span></a></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3575"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3608"></a><a name="bookmark3609"></a><a name="bookmark3610"></a><a name="bookmark3611"></a>MIME Type IANA Registration</span></h2>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">The MIME media type registration process is described in RFC 2048. The goal of the registration process is to make it easy to register new media types but also to provide some sanity checking to make sure the new types are well thought out.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3612"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3613"></a>Registration Trees</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">MIME type tokens are split into four classes, called “registration trees,” each with its own registration rules. The four trees—IETF, vendor, personal, and experimental— are described in </span><a href="#bookmark3614"><span class="font24">Table D-2</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3614"></a><span class="font23" style="font-style:italic;">Table D-2. Four MIME media type registration trees</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Registration tree</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Example</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IETF</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">text/html</span></p>
<p><span class="font2">(HTML text)</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The IETF tree is intended for types that are of general significance to the Internet community. New IETF tree media types require approval by the Internet Engineering Steering Group (IESG) and an accompanying standards-track RFC.</span></p>
<p><span class="font2">IETF tree types have no periods (.) in tokens.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Vendor</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">image/vnd.fpx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The vendor tree is intended for media types used by commercially available</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">(vnd.)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">(Kodak FlashPix image)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">products. Public review of new vendor types is encouraged but not required.</span></p>
<p><span class="font2">Vendor tree types begin with “vnd.”.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark3615"></a><span class="font2">Personal/Vanity</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">image/prs.btif</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Private, personal, or vanity media types can be registered in the personal</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">(prs.)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">(internal checkmanagement format used by Nations Bank)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tree. These media types will not be distributed commercially. Personal tree types begin with “prs.”.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Experimental</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">application/x-tar</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The experimental tree is for unregistered or experimental media types.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">(x- or x.)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">(Unix tar archive)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Because it’s relatively simple to register a new vendor or personal media type, software should not be distributed widely using x- types.</span></p>
<p><span class="font2">Experimental tree types begin with “x.” or “x-”.</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3616"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3617"></a>Registration Process</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Read RFC 2048 carefully for the details of MIME media type registration.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The basic registration process is not a formal standards process; it’s just an administrative procedure intended to sanity check new types with the community, and record them in a registry, without much delay. The process follows the following steps:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">1. Present the media type to the community for review.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 5pt 19pt;"><span class="font24">Send a proposed media type registration to the </span><a href="mailto:ietf-types@iana.org"><span class="font24" style="font-style:italic;">ietf-types@iana.org</span></a><span class="font24"> mailing list for a two-week review period. The public posting solicits feedback about the choice of name, interoperability, and security implications. The “x-” prefix specified in RFC 2045 can be used until registration is complete.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><a name="bookmark3618"></a><span class="font24">2. IESG approval (for IETF tree only).</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">If the media type is being registered in the IETF tree, it must be submitted to the IESG for approval and must have an accompanying standards-track RFC.</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">3. IANA registration.</span></p></li></ul>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">As soon as the media type meets the approval requirements, the author can submit the registration request to the IANA, using the email template in </span><a href="#bookmark3619"><span class="font24">Example D-1 </span></a><span class="font24">and mailing the information to </span><a href="mailto:ietf-types@iana.org"><span class="font24" style="font-style:italic;">ietf-types@iana.org</span></a><span class="font24" style="font-style:italic;">.</span><span class="font24"> The IANA will register the media type and make the media type application available to the community at </span><a href="http://www.isi.edu/in-notes/iana/assignments/media-types/"><span class="font24" style="font-style:italic;">http://www.isi.edu/in-notes/iana/assignments/media-types/</span></a><span class="font24">.</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3620"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3621"></a>Registration Rules</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">The IANA will register media types in the IETF tree only in response to a communication from the IESG stating that a given registration has been approved.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Vendor and personal types will be registered by the IANA automatically and without any formal review as long as the following minimal conditions are met:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><a name="bookmark3622"></a><span class="font24">1. Media types must function as actual media formats. Types that act like transfer encodings or character sets may not be registered as media types.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 2pt 19pt;"><span class="font24">2. All media types must have proper type and subtype names. All type names must be defined by standards-track RFCs. All subtype names must be unique, must conform to the MIME grammar for such names, and must contain the proper tree prefixes.</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font24">3. Personal tree types must provide a format specification or a pointer to one.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 15pt 19pt;"><span class="font24">4. Any security considerations given must not be obviously bogus. Everyone who is developing Internet software needs to do his part to prevent security holes.</span></p></li></ul>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3623"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3624"></a>Registration Template</span></h3>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">The actual IANA registration is done via email. You complete a registration form using the template shown in </span><a href="#bookmark3619"><span class="font24">Example D-1</span></a><span class="font24">, and mail it to </span><span class="font24" style="font-style:italic;">ietf-types@iana.org</span><span class="font24">.<a name="footnote165"></a><sup><a href="#bookmark3625">165</a></sup><sup></sup></span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3619"></a><span class="font23" style="font-style:italic;">Example D-1. IANA MIME registration email template</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font3">To: </span><a href="mailto:ietf-types@iana.org"><span class="font3">ietf-types@iana.org</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font3">Subject: Registration of MIME media type XXX/YYY</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font3">MIME media type name:</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font23" style="font-style:italic;">Example D-1. IANA MIME registration email template (continued)</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">MIME subtype name:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Required parameters:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Optional parameters:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Encoding considerations:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Security considerations:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Interoperability considerations:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Published specification:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Applications which use this media type:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Additional information:</span></p>
<p style="text-indent:17pt;"><span class="font3">Magic number(s):</span></p>
<p style="text-indent:17pt;"><span class="font3">File extension(s):</span></p>
<p style="text-indent:17pt;padding:0pt 0pt 11pt 0pt;"><a name="bookmark3626"></a><span class="font3">Macintosh File Type Code(s):</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Person &amp;&nbsp;email address to contact for further information:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Intended usage:</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">(One of COMMON, LIMITED USE or OBSOLETE)</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">Author/Change controller:</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><a name="bookmark3627"></a><span class="font3">(Any other information that the author deems interesting may be added below this line.)</span></p>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3628"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3629"></a>MIME Media Type Registry</span></h3>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3630"></a><span class="font24">The submitted forms are accessible from the IANA web site (</span><a href="http://www.iana.org"><span class="font24" style="font-style:italic;">http://www.iana.org</span></a><span class="font24">). At the time of writing, the actual database of MIME media types is stored on an ISI web server, at </span><a href="http://www.isi.edu/in-notes/iana/assignments/media-types/"><span class="font24" style="font-style:italic;">http://www.isi.edu/in-notes/iana/assignments/media-types/</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">The media types are stored in a directory tree, structured by primary type and subtype, with one leaf file per media type. Each file contains the email submission. Unfortunately, each person completes the registration template slightly differently, so the quality and format of information varies across submissions. (In the tables in this appendix, we tried to fill in the holes omitted by registrants.)</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3631"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3632"></a>MIME Type Tables</span></h2>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">This section summarizes hundreds of MIME types in 10 tables. Each table lists the MIME media types within a particular primary type (image, text, etc.).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3633"></a><span class="font24">The information is gathered from many sources, including the IANA media type registry, the Apache </span><span class="font24" style="font-style:italic;">mime.types</span><span class="font24"> file, and assorted Internet web pages. We spent several days refining the data, plugging holes, and including descriptive summaries from cross-references to make the data more useful.</span></p>
<p style="text-align:justify;padding:0pt 0pt 14pt 0pt;"><span class="font24">This may well be the most detailed tabular listing of MIME types ever compiled. We hope you find it handy!</span></p>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3634"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3635"></a>application/*</span></h3>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3576"><span class="font24">Table D-3 </span></a><span class="font24">describes many of the application-specific MIME media types.</span></p>
<table>
<tr><td>
<p><a name="bookmark3576"></a><span class="font23" style="font-style:italic;">Table D-3. “Application” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/activemessage</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the Active Mail groupware system.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“Active Mail: A Framework for Integrated Groupware Applications” in </span><span class="font3" style="font-style:italic;">Readings in Groupware and Computer-Supported Cooperative Work</span><span class="font2">, Ronald M. Baecker, ed., Morgan Kaufmann, ISBN 1558602410</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/andrew-inset</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the creation of multimedia content with the Andrew toolkit.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ez</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">Multimedia Applications Development with the Andrew Toolkit</span><span class="font2">, Nathaniel S. Borenstein, Prentice Hall, ASIN 0130366331 </span><a href="mailto:nsb@bellcore.com"><span class="font3" style="font-style:italic;">nsb@bellcore.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/applefile</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Permits MIME-based transmission of data with Apple/Macintosh-specific information, while allowing general access to nonspecific user data.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1740</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/atomicmail</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ATOMICMAIL was an experimental research project at Bellcore, designed for including programs in electronic mail messages that are executed when mail is read. ATOMICMAIL is rapidly becoming obsolete in favor of safe-tcl.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">“ATOMICMAIL Language Reference Manual,” Nathaniel S. Borenstein, Bellcore Technical Memorandum TM ARH-018429</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/batch-SMTP</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Defines a MIME content type suitable for tunneling an ESMTP mail transaction through any MIME-capable transport.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2442</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/beep+xml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the interaction protocol called BEEP. BEEP permits simultaneous and independent exchanges of MIME messages between peers, where the messages usually are XML-structured text.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3080</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/cals-1840</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports MIME email exchanges of U.S. Department of Defense digital datathatwaspreviouslyexchanged by tapem, as defined by MIL-STD-1840.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1895</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/commonground</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Common Ground is an electronic document exchange and distribution pro-gramthatlets users create documents that anyone can view, search, and print, without requiring that they have the creating applications or fonts on their systems.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Nick Gault</span></p>
<p><span class="font2">No Hands Software </span><a href="mailto:ngault@nohands.com"><span class="font3" style="font-style:italic;">ngault@nohands.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/cybercash</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports credit card payment through the CyberCash protocol. When a user starts payment, a message is sent by the merchant to the customer as the body of a message of MIME type application/cybercash.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1898</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/dca-rft</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM Document Content Architecture.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">“IBM Document Content Architec-ture/Revisable Form Text Reference,” document number SC23-0758-1, International Business Machines</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/dec-dx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">DEC Document Transfer Format.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“Digital Document Transmission (DX) Technical Notebook,” document number EJ29141-86, Digital Equipment Corporation</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/dvcs</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the protocols used bya Data Validation and Certification Server (DVCS), which acts as a trusted third party in a public-key security infrastructure.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3029</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/EDI-Consent</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports bilateral trading via electronic data interchange (EDI), using nonstandard specifications.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/ application/EDI-Consent</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/EDI-X12</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports bilateral trading via electronic data interchange (EDI), using the ASC X12 EDI specifications.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/ application/EDI-X12</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/EDIFACT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports bilateral trading via electronic data interchange (EDI), using the EDIFACT specifications.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/ application/EDIFACT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/eshop</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unknown.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Steve Katz</span></p>
<p><span class="font2">System Architecture Shop </span><a href="mailto:steve_katz@eshop.com"><span class="font3" style="font-style:italic;">steve_katz@eshop.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/font-tdpfr</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Defines a Portable Font Resource (PFR) that contains a set of glyph shapes, each associated with a character code.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3073</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/http</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used to enclose a pipeline of one or more HTTP request or response messages (not intermixed).</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2616</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/hyperstudio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports transfer of HyperStudio educational hypermedia files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">stk</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.hyperstudio.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/iges</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A commonly used format for CAD model interchange.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“ANS/US PRO/IPO-100”</span></p>
<p><span class="font2">U.S. Product Data Association 2722 Merrilee Drive, Suite 200 Fairfax, VA 22031-4499</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/index application/index.cmd application/index.obj application/index.response application/index.vnd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Support the Common Indexing Protocol (CIP). CIP is an evolution of the Whois++ directory service, used to pass indexing information from server to server in order to redirect and replicate queries through a distributed database system.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2652, and RFCs 2651, 1913, and 1914</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/iotp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Internet Open Trading Protocol (IOTP) messages over HTTP.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2935</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/ipp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Internet Printing Protocol (IPP) over HTTP.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2910</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/mac-binhex40</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Encodes a string of 8-bit bytes into a string of 7-bit bytes, which is safer for some applications (though not quite as safe as the 6-bit base-64 encoding).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hqx</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application/mac-compactpro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cpt</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/macwriteii</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Claris MacWrite II.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/marc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MARC objects are Machine-Readable Cataloging records—standards for the representation and communication of bibliographic and related information.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mrc</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2220</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/mathematica application/mathematica-old</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Mathematica and MathReader numerical analysis software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nb, ma, mb</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">The Mathematica Book</span><span class="font2">, Stephen Wolfram, Cambridge University Press, ISBN 0521643147</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 4pt 7pt;"><span class="font2">application/msword</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/news-message-id</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft Word MIME type.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">doc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFCs 822 (message IDs), 1036 (application to news), and 977 (NNTP)</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/news-transmission</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Allows transmission of news articles by email or other transport.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 1036</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/ocsp-request</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the Online Certificate Status Protocol (OCSP), which provides a way to check on the validity of a digital certificate without requiring local certificate revocation lists.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">orq</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2560</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application/ocsp-response</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ors</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2560</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/octet-stream</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unclassified binary data.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">bin, dms, lha, lzh, exe, class</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;padding:0pt 0pt 107pt 0pt;"><span class="font2">application/oda</span></p>
<p style="text-indent:7pt;"><span class="font2">application/parityfec</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Used for information encoded according to the Office Document Architecture (ODA) standards, using the Office Document Interchange Format (ODIF) representation format. The ContentType line also should specify an attribute/value pair that indicates the document application profile (DAP), as in:</span></p>
<p style="text-indent:15pt;"><span class="font2">Content-Type: application/oda;</span></p>
<p style="text-indent:15pt;padding:0pt 0pt 2pt 0pt;"><span class="font2">profile=Q112</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Forward error correction parity encoding for RTP data streams.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">oda</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">RFC 1341</span></p>
<p style="padding:0pt 0pt 53pt 0pt;"><span class="font2">ISO 8613; “Information Processing: Text and Office System; Office Document Architecture (ODA) and Interchange Format (ODIF),” Part 1-8, 1989</span></p>
<p><span class="font2">RFC 3009</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;padding:0pt 0pt 19pt 0pt;"><span class="font2">application/pdf</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pgp-encrypted application/pgp-keys application/pgp-signature</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 25pt 0pt;"><span class="font2">Adode PDF files.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">PGP encrypted data.</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">PGP public-key blocks.</span></p>
<p style="padding:0pt 0pt 14pt 0pt;"><span class="font2">PGP cryptographic signature.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pdf</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">See </span><span class="font3" style="font-style:italic;">Portable Document Format Reference Manual</span><span class="font2">, AdobeSystems, Inc., Addison Wesley, ISBN 0201626284</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">RFC 2015</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">RFC 2015</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">RFC 2015</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkcs10</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Public Key Crypto System #10—the application/pkcs10 body type </span><span class="font3" style="font-style:italic;">must</span><span class="font2"> be used to transfer a PKCS #10 certification request.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">p10</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2311</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkcs7-mime</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Public Key Crypto System #7—this type is used to carry PKCS #7 objects of several types including enveloped-Data and signedData.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">p7m</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2311</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkcs7-signature</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Public Key Crypto System #7—this type always contains a single PKCS #7 object of type signedData.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">p7s</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2311</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkix-cert</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Transports X.509 certificates.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cer</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2585</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkix-crl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Transports X.509 certificate revocation lists.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">crl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2585</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/pkixcmp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Message format used by X.509 Public Key Infrastructure Certificate Management Protocols.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pki</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2510</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 12pt 7pt;"><span class="font2">application/postscript</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/prs.alvestrand. titrax-sheet</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">An Adobe PostScript graphics file (program).</span></p>
<p><span class="font2">“TimeTracker” program by Harald T. Alvestrand.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ai, ps, eps</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font2">RFC 2046</span></p>
<p><span class="font3" style="font-style:italic;">http //domen.uninett.no/~hta/ titrax/</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/prs.cww</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CU-Writer for Windows.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cw, cww</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Dr. Somchai Prasitjutrakul </span><a href="mailto:somchaip@chulkn.car.chula.ac.th"><span class="font3" style="font-style:italic;">somchaip@chulkn.car.chula.ac.th</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/prs.nprend</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unknown.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rnd, rct</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">John M. Doggett </span><a href="mailto:jdoggett@tiac.net"><span class="font3" style="font-style:italic;">jdoggett@tiac.net</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/remote-printing</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Contains meta information used when remote printing, for the printer cover sheet.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font2">RFC 1486</span></p>
<p><span class="font2">Marshall T. Rose</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><a href="mailto:mrose@dbc.mtview.ca.us"><span class="font3" style="font-style:italic;">mrose@dbc.mtview.ca.us</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/riscos</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Acorn RISC OS binaries.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">RISC OS Programmer’s Reference Manuals</span><span class="font2">, Acorn Computers, Ltd., ISBN1852501103</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/sdp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">SDP is intended for describing live multimedia sessions for the purposes of session announcement, session invitation, and other forms of multimedia session initiation.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">RFC 2327</span></p>
<p><span class="font2">Henning Schulzrinne </span><a href="mailto:hgs@cs.columbia.edu"><span class="font3" style="font-style:italic;">hgs@cs.columbia.edu</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/set-payment application/set-payment-initiation</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/set-registration application/set-registration-initiation</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the SET secure electronic transaction payment protocol.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.visa.com</span></p>
<p><span class="font3" style="font-style:italic;">http //www.mastercard.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/sgml-open-catalog</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Intended for use with systems that support the SGML Open TR9401:1995 “Entity Management” specification.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">SGML Open</span></p>
<p><span class="font2">910 Beaver Grade Road, #3008</span></p>
<p><span class="font2">Coraopolis, PA 15109 </span><a href="mailto:info@sgmlopen.org"><span class="font3" style="font-style:italic;">info@sgmlopen.org</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/sieve</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Sieve mail filtering script.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3028</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/slate</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The BBN/Slate document format is published as part of the standard documentation set distributed with the BBN/Slate product.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">BBN/Slate Product Mgr</span></p>
<p><span class="font2">BBN Systems and Technologies 10 Moulton Street</span></p>
<p><span class="font2">Cambridge, MA 02138</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/smil</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The Synchronized Multimedia Integration Language (SMIL) integrates a set of independent multimedia objects into a synchronized multimedia presentation.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">smi, smil</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.w3.org/AudioVideo/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/tve-trigger</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports embedded URLs in enhanced television receivers.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“SMPTE: Declarative Data Essence, Content Level 1,” produced by the Society of Motion Picture and Television Engineers </span><span class="font3" style="font-style:italic;">http //www.smpte.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vemmi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Enhanced videotex standard.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2122</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.3M.Post-it-Notes</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used by the “Post-it® Notes for Internet Designers” Internet control/ plug-in.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pwn</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.3M.com/psnotes/</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.accpac. simply.aso</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Simply Accounting v7.0 and higher. Files of this type conform to Open Financial Exchange v1.02 specifications.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">aso</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.ofx.net</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.accpac. simply.imp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used by Simply Accounting v7.0 and higher, to import its own data.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">imp</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.ofx.net</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.acucobol</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ACUCOBOL-GT Runtime.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Dovid Lubin </span><a href="mailto:dovid@acucobol.com"><span class="font3" style="font-style:italic;">dovid@acucobol.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.aether.imp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports airtime-efficient Instant Message communications between an Instant Messaging service, such as AOL Instant Messenger, Yahoo! Messenger, or MSN Messenger, and a special set of Instant Messaging client software on a wireless device.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Wireless Instant Messaging Protocol (IMP) specification available from Aether Systems by license</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.anser-web-certificate-issue-initiation</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Trigger for web browsers to launch the ANSER-WEB Terminal Client.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cii</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Hiroyoshi Mori </span><a href="mailto:mori@mm.rd.nttdata.co.jp"><span class="font3" style="font-style:italic;">mori@mm.rd.nttdata.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.anser-web-funds-transfer-initiation</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fti</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.audiograph</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">AudioGraph.</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">aep</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Horia Cristian</span></p>
<p><a href="mailto:H.C.Slusanschi@massey.ac.nz"><span class="font3" style="font-style:italic;">H.C.Slusanschi@massey.ac.nz</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.bmi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">BMI graphics format by CADAM Systems.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bmi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Tadashi Gotoh</span></p>
<p><a href="mailto:tgotoh@cadamsystems.co.jp"><span class="font3" style="font-style:italic;">tgotoh@cadamsystems.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd. businessobjects</span></p></td><td style="vertical-align:top;">
<p><span class="font2">BusinessObjects 4.0 and higher.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rep</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.canon-cpdl application/vnd.canon-lips</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Canon, Inc. office imaging products.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Shin Muto</span></p>
<p><a href="mailto:shinmuto@pure.cpdc.canon.co.jp"><span class="font3" style="font-style:italic;">shinmuto@pure.cpdc.canon.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.claymore</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Claymore.exe.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cla</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Ray Simpson </span><a href="mailto:ray@cnation.com"><span class="font3" style="font-style:italic;">ray@cnation.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.commerce-battelle</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports a generic mechanism for delimiting smart card–based information, for digital commerce, identification, authentication, and exchange of smart card–based card holder information.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ica, icf, icd, icc, ic0, ic1, ic2, ic3, ic4, ic5, ic6, ic7, ic8</span></p></td><td style="vertical-align:top;">
<p><span class="font2">David C. Applebaum </span><a href="mailto:applebau@131.167.52.15"><span class="font3" style="font-style:italic;">applebau@131.167.52.15</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd. commonspace</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows for proper transmission of CommonSpace™ documents via MIME-based processes. CommonSpace is published by Sixth Floor Media, part of the Houghton-Mifflin Company.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csp, cst</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Ravinder Chandhok </span><a href="mailto:chandhok@within.com"><span class="font3" style="font-style:italic;">chandhok@within.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.contact.cmsg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used for CONTACT software’s CIM DATABASE.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cdbcmsg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Frank Patz </span><a href="mailto:fp@contact.de"><span class="font3" style="font-style:italic;">fp@contact.de</span></a><span class="font3" style="font-style:italic;"> http //www.contact.de</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.cosmocaller</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows for files containing connection parameters to be downloaded from web sites, invokes the CosmoCaller application to interpret the parameters, and initiates connections with the CosmoCallACD server.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cmc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Steve Dellutri</span></p>
<p><a href="mailto:sdellutri@cosmocom.com"><span class="font3" style="font-style:italic;">sdellutri@cosmocom.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ctc-posml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Continuum Technology’s PosML.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Bayard Kohlhepp </span><a href="mailto:bayardk@ctcexchange.com"><span class="font3" style="font-style:italic;">bayardk@ctcexchange.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.cups-postscript</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.cups-raster application/vnd.cups-raw</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Common UNIX Printing System (CUPS) servers and clients.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.cups.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.cybank</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary data type for Cybank data.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Nor Helmee B. Abd. Halim </span><a href="mailto:helmee@cybank.net"><span class="font3" style="font-style:italic;">helmee@cybank.net</span></a><span class="font3" style="font-style:italic;"> http //www.cybank.net</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.dna</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">DNA is intended to easily Web-enable any 32-bit Windows application.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dna</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Meredith Searcy </span><a href="mailto:msearcy@newmoon.com"><span class="font3" style="font-style:italic;">msearcy@newmoon.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.dpgraph</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used by DPGraph 2000 and MathWare Cyclone.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">dpg, mwc, dpgraph</span></p></td><td style="vertical-align:top;">
<p><span class="font2">David Parker</span></p>
<p><span class="font3" style="font-style:italic;">http //www.davidparker.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.dxr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Digital Xpress Reports by PSI Technologies.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dxr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Michael Duffy </span><a href="mailto:miked@psiaustin.com"><span class="font3" style="font-style:italic;">miked@psiaustin.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.ecdis-update</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports ECDIS applications.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.sevencs.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ecowin.chart application/vnd.ecowin. filerequest application/vnd.ecowin. fileupdate</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ecowin.series application/vnd.ecowin.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">seriesrequest application/vnd.ecowin. seriesupdate</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EcoWin.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mag</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Thomas Olsson </span><span class="font3" style="font-style:italic;">thomas@vinga se</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.enliven</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports delivery of Enliven interactive multimedia.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Paul Santinelli</span></p>
<p style="text-align:justify;"><a href="mailto:psantinelli@narrative.com"><span class="font3" style="font-style:italic;">psantinelli@narrative.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.epson.esf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary content for Seiko Epson QUASS Stream Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">esf</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">Shoji Hoshina</span></p>
<p style="text-align:justify;"><a href="mailto:Hoshina.Shoji@exc.epson.co.jp"><span class="font3" style="font-style:italic;">Hoshina.Shoji@exc.epson.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.epson.msf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary content for Seiko Epson QUASS Stream Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">msf</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.epson. quickanime</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary content for Seiko Epson QuickAnime Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qam</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">Yu Gu</span></p>
<p><a href="mailto:guyu@rd.oda.epson.co.jp"><span class="font3" style="font-style:italic;">guyu@rd.oda.epson.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.epson.salt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary content for Seiko Epson SimpleAnimeLite Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">slt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Yasuhito Nagatomo </span><a href="mailto:naga@rd.oda.epson.co.jp"><span class="font3" style="font-style:italic;">naga@rd.oda.epson.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.epson.ssf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary content for Seiko Epson QUASS Stream Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ssf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Shoji Hoshina</span></p>
<p><a href="mailto:Hoshina.Shoji@exc.epson.co.jp"><span class="font3" style="font-style:italic;">Hoshina.Shoji@exc.epson.co.jp</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ericsson. quickcall</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Phone Doubler Quick Call.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qcall, qca</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Paul Tidwell </span><a href="mailto:paul.tidwell@ericsson.com"><span class="font3" style="font-style:italic;">paul.tidwell@ericsson.com</span></a><span class="font3" style="font-style:italic;"> http //www.ericsson.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.eudora.data</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Eudora Version 4.3 and later.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Pete Resnick </span><a href="mailto:presnick@qualcomm.com"><span class="font3" style="font-style:italic;">presnick@qualcomm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fdf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Adobe Forms Data Format.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“Forms Data Format,” Technical Note 5173, Adobe Systems</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ffsns</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used for application communication with FirstFloor’s Smart Delivery.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Mary Holstege </span><a href="mailto:holstege@firstfloor.com"><span class="font3" style="font-style:italic;">holstege@firstfloor.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.FloGraphIt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">NpGraphIt.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gph</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.framemaker</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Adobe FrameMaker files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fm, mif, book</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.adobe.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fsc. weblaunch</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Friendly Software Corporation’s golf simulation software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fsc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Derek Smith</span></p>
<p><a href="mailto:derek@friendlysoftware.com"><span class="font3" style="font-style:italic;">derek@friendlysoftware.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu.oasys</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu.oasys2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fujitsu’s OASYS software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">oas</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Nobukazu Togashi </span><a href="mailto:togashi@ai.cs.fujitsu.co.jp"><span class="font3" style="font-style:italic;">togashi@ai.cs.fujitsu.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu.oasys2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fujitsu’s OASYS V2 software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">oa2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu.oasys3</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Support’sFujitsu’sOASYSV5software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">oa3</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Seiji Okudaira</span></p>
<p><a href="mailto:okudaira@candy.paso.fujitsu.co.jp"><span class="font3" style="font-style:italic;">okudaira@candy.paso.fujitsu.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu. oasysgp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fujitsu’s OASYS GraphPro software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fg5</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Masahiko Sugimoto </span><a href="mailto:sugimoto@sz.sel.fujitsu.co.jp"><span class="font3" style="font-style:italic;">sugimoto@sz.sel.fujitsu.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujitsu. oasysprs</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Support’s Fujitsu’s OASYS Presentation software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bh2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Masumi Ogita </span><a href="mailto:ogita@oa.tfl.fujitsu.co.jp"><span class="font3" style="font-style:italic;">ogita@oa.tfl.fujitsu.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujixerox.ddd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fuji Xerox’s EDMICS 2000 and DocuFile.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ddd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Masanori Onda</span></p>
<p><a href="mailto:Masanori.Onda@fujixerox.co.jp"><span class="font3" style="font-style:italic;">Masanori.Onda@fujixerox.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujixerox. docuworks</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fuji Xerox’s DocuWorks Desk and DocuWorks Viewer software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xdw</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Yasuo Taguchi </span><a href="mailto:yasuo.taguchi@fujixerox.co.jp"><span class="font3" style="font-style:italic;">yasuo.taguchi@fujixerox.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fujixerox. docuworks.binder</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Fuji Xerox’s DocuWorks Desk and DocuWorks Viewer software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xbd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.fut-misnet</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unknown.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Jaan Pruulmann </span><a href="mailto:jaan@fut.ee"><span class="font3" style="font-style:italic;">jaan@fut.ee</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.grafeq</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lets users of GrafEq exchange GrafEq documents through the Web and email.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gqf, gqs</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.peda.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-account</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Groove is a peer-to-peer communication system implementing a virtual space for small group interaction.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gac</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Todd Joseph </span><a href="mailto:todd_joseph@groove.net"><span class="font3" style="font-style:italic;">todd_joseph@groove.net</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-identity-message</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gim</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-injector</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">grv</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-tool-message</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gtm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-tool-template</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tpl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.groove-vcard</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">vcg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hhe.lesson-player</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the LessonPlayer and PresentationEditor software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">les</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Randy Jones</span></p>
<p><span class="font2">Harcourt E-Learning </span><a href="mailto:randy_jones@archipelago.com"><span class="font3" style="font-style:italic;">randy_jones@archipelago.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hp-HPGL</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HPGL files.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">The HP-GL/2 and HP RTL Reference Guide</span><span class="font2">, Addison Wesley, ISBN 0201310147</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hp-hpid</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Hewlett-Packard’s Instant Delivery Software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hpi, hpid</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //</span><a href="http://www.instant-delivery.com"><span class="font3" style="font-style:italic;">www.instant-delivery.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hp-hps</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Hewlett-Packard’s WebPrintSmart software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hps</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.hp.com/go/ webprintsmart_mimetype_specs/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hp-PCL application/vnd.hp-PCLXL</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PCL printer files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pcl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">“PCL-PJL Technical Reference Manual Documentation Package,” HP Part No. 5012-0330</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.httphone</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HTTPhone asynchronous voice over IP system.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Franck LeFevre </span><a href="mailto:franck@k1info.com"><span class="font3" style="font-style:italic;">franck@k1info.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.hzn-3d-crossword</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used to encode crossword puzzles by Horizon, A Glimpse of Tomorrow.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">x3d</span></p></td><td style="vertical-align:top;">
<p><span class="font2">James Minnis </span><a href="mailto:james_minnis@glimpse-of-tomorrow.com"><span class="font3" style="font-style:italic;">james_minnis@glimpse-of-tomorrow.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ibm. afplinedata</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Print Services Facility (PSF), AFP Conversion and Indexing Facility (ACIF).</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Roger Buis </span><a href="mailto:buis@us.ibm.com"><span class="font3" style="font-style:italic;">buis@us.ibm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.ibm.MiniPay</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MiniPay authentication and payment software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mpy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Amir Herzberg </span><a href="mailto:amirh@vnet.ibm.com"><span class="font3" style="font-style:italic;">amirh@vnet.ibm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.ibm.modcap</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Mixed Object Document Content.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">list3820, listafp,</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Reinhard Hohensee</span></p>
<p><a href="mailto:rhohensee@vnet.ibm.com"><span class="font3" style="font-style:italic;">rhohensee@vnet.ibm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">afp, pseg3820</span></p></td><td style="vertical-align:top;">
<p><span class="font2">“Mixed Object Document Content Architecture Reference,” IBM publication SC31-6802</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.informix-visionary</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Informix Visionary.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vis</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Christopher Gales</span></p>
<p><a href="mailto:christopher.gales@informix.com"><span class="font3" style="font-style:italic;">christopher.gales@informix.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.intercon. formnet</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Intercon Associates FormNet software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xpw, xpx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Thomas A. Gurak </span><a href="mailto:assoc@intercon.roc"><span class="font3" style="font-style:italic;">assoc@intercon.roc</span></a><span class="font3" style="font-style:italic;"> servtech.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.intertrust. digibox</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.intertrust. nncp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports InterTrust architecture for secure electronic commerce and digital rights management.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">InterTrust Technologies 460 Oakmead Parkway Sunnyvale, CA 94086 USA </span><a href="mailto:info@intertrust.com"><span class="font3" style="font-style:italic;">info@intertrust.com</span></a><span class="font3" style="font-style:italic;"> http //www.intertrust.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.intu.qbo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Intended for use only with QuickBooks 6.0 (Canada).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qbo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Greg Scratchley </span><a href="mailto:greg_scratchley@intuit.com"><span class="font3" style="font-style:italic;">greg_scratchley@intuit.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Format of these files discussed in the Open Financial Exchange specs, available from </span><a href="http://www.ofx.net"><span class="font3" style="font-style:italic;">http://www.ofx.net</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.intu.qfx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Intended for use only with Quicken 99 and following versions.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qfx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;padding:0pt 0pt 13pt 0pt;"><span class="font2">application/vnd.is-xpr</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-directory-service application/vnd.japannet-jpnstore-wakeup</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-payment-wakeup</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-registration</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-registration-wakeup application/vnd.japannet-setstore-wakeup</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-verification</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.japannet-verification-wakeup</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 12pt 0pt;"><span class="font2">Express by Infoseek.</span></p>
<p><span class="font2">Supports Mitsubishi Electric’s Japan-Net security, authentication, and payment sofwtare.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xpr</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">Satish Natarajan </span><a href="mailto:satish@infoseek.com"><span class="font3" style="font-style:italic;">satish@infoseek.com</span></a></p>
<p><span class="font2">Jun Yoshitake</span></p>
<p><a href="mailto:yositake@iss.isl.melco.co.jp"><span class="font3" style="font-style:italic;">yositake@iss.isl.melco.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.koan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the automatic playback of Koan music files over the Internet, by helper applications such as SSEYO Koan Netscape Plugin.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">skp, skd, skm, skt</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Peter Cole</span></p>
<p><a href="mailto:pcole@sseyod.demon.co.uk"><span class="font3" style="font-style:italic;">pcole@sseyod.demon.co.uk</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-1-2-3</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus 1-2-3 and Lotus approach.</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">123, wk1, wk3, wk4</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Paul Wattenberger</span></p>
<p><a href="mailto:Paul_Wattenberger@lotus.com"><span class="font3" style="font-style:italic;">Paul_Wattenberger@lotus.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-approach</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus Approach.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">apr, vew</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-freelance</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus Freelance.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">prz, pre</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-notes</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus Notes.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">nsf, ntf, ndl, ns4, ns3, ns2, nsh, nsg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Michael Laramie</span></p>
<p><a href="mailto:laramiem@btv.ibm.com"><span class="font3" style="font-style:italic;">laramiem@btv.ibm.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-organizer</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus Organizer.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">or3, or2, org</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Paul Wattenberger</span></p>
<p><a href="mailto:Paul_Wattenberger@lotus.com"><span class="font3" style="font-style:italic;">Paul_Wattenberger@lotus.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-screencam</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus ScreenCam.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">scm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.lotus-wordpro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Lotus Word Pro.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lwp, sam</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.mcd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Micro CADAM CAD software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mcd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Tadashi Gotoh </span><a href="mailto:tgotoh@cadamsystems.co.jp"><span class="font3" style="font-style:italic;">tgotoh@cadamsystems.co.jp</span></a><span class="font3" style="font-style:italic;"> http //www.cadamsystems.co.jp</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">mediastation.cdkey</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Media Station’s CDKey remote CDROM communications protocol.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cdkey</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Henry Flurry </span><a href="mailto:henryf@mediastation.com"><span class="font3" style="font-style:italic;">henryf@mediastation.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.meridian-slingshot</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Slingshot by Meridian Data.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Eric Wedel</span></p>
<p><span class="font2">Meridian Data, Inc.</span></p>
<p><span class="font2">5615 Scotts Valley Drive</span></p>
<p><span class="font2">Scotts Valley, CA 95066 </span><a href="mailto:ewedel@meridian-data.com"><span class="font3" style="font-style:italic;">ewedel@meridian-data.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.mif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">FrameMaker interchange format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mif</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">ftp://ftp.frame.com/pub/techsup/ techinfo/dos/mif4.zip</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Mike Wexler</span></p>
<p><span class="font2">Adobe Systems, Inc 333 W. San Carlos St.</span></p>
<p><span class="font2">San Jose, CA 95110 USA</span></p>
<p><a href="mailto:mwexler@adobe.com"><span class="font3" style="font-style:italic;">mwexler@adobe.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.minisoft-hp3000-save</span></p></td><td style="vertical-align:top;">
<p><span class="font2">NetMail 3000 save format.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Minisoft, Inc.</span></p>
<p><a href="mailto:support@minisoft.com"><span class="font3" style="font-style:italic;">support@minisoft.com</span></a><span class="font3" style="font-style:italic;"> </span><a href="ftp://ftp.3k.com/DOC/ms92-save-format.txt"><span class="font3" style="font-style:italic;">ftp://ftp.3k.com/DOC/ms92-save-format.txt</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.mitsubishi. misty-guard.trustweb</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Mitsubishi Electric’s Trustweb software.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Manabu Tanaka </span><a href="mailto:mtana@iss.isl.melco.co.jp"><span class="font3" style="font-style:italic;">mtana@iss.isl.melco.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.Mobius.DAF</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports Mobius Management Systems software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">daf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Celso Rodriguez </span><a href="mailto:crodrigu@mobius.com"><span class="font3" style="font-style:italic;">crodrigu@mobius.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Greg Chrzczon </span><a href="mailto:gchrzczo@mobius.com"><span class="font3" style="font-style:italic;">gchrzczo@mobius.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.DIS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dis</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.MBK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mbk</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.MQY</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mqy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.MSL</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">msl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.PLC</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">plc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.Mobius.TXF</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">txf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite</span></p></td><td style="vertical-align:top;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type is used by the network gateways of wireless messaging service providers as well as wireless OSs and applications.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Mark Patton</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Motorola Personal Networks Group </span><a href="mailto:fmp014@email.mot.com"><span class="font3" style="font-style:italic;">fmp014@email.mot.com</span></a></p>
<p><span class="font2">FLEXsuite™ specification available from Motorola under appropriate licensing agreement</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.adsi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type provides a wireless-friendly format for enabling various data-encryption solutions.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.fis</span></p></td><td style="vertical-align:top;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type is a wireless-friendly format for the efficient delivery of structured information (e.g., news, stocks, weather) to a wireless device.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.gotap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type provides a common wireless-friendly format for the programming of wireless device attributes via over-the-air messages.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.kmr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type provides a wireless-friendly format for encryption key management.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.ttc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type supports a wireless-friendly format for the efficient delivery of text using token text compression.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.motorola. flexsuite.wem</span></p></td><td style="vertical-align:top;">
<p><span class="font2">FLEXsuite™ is a collection of wireless messaging protocols. This type provides a wireless-friendly format for the communication of Internet email to wireless devices.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.mozilla.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the Mozilla Internet applica-</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">xul</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Dan Rosen2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">xul+xml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tion suite.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><a href="mailto:dr@netscape.com"><span class="font3" style="font-style:italic;">dr@netscape.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-artgalry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Microsoft’s Art Gallery.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cil</span></p></td><td style="vertical-align:top;">
<p><a href="mailto:deansl@microsoft.com"><span class="font3" style="font-style:italic;">deansl@microsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-asf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ASF is a multimedia file format whose contents are designed to be streamed across a network to support distributed multimedia applications. ASF content may include any combination of any media type (e.g., audio, video, images, URLs, HTML content, MIDI, 2-D and 3-D modeling, scripts, and objects of various types).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">asf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Eric Fleischman</span></p>
<p><a href="mailto:ericf@microsoft.com"><span class="font3" style="font-style:italic;">ericf@microsoft.com</span></a></p>
<p><span class="font3" style="font-style:italic;">http //www.microsoft.com/</span></p>
<p><span class="font3" style="font-style:italic;">mind/0997/netshow/netshow.asp</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-excel</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft Excel spreadsheet.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xls</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Sukvinder S. Gill </span><a href="mailto:sukvg@microsoft.com"><span class="font3" style="font-style:italic;">sukvg@microsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-lrm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft proprietary.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lrm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Eric Ledoux </span><a href="mailto:ericle@microsoft.com"><span class="font3" style="font-style:italic;">ericle@microsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-powerpoint</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft PowerPoint presentation.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ppt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Sukvinder S. Gill </span><a href="mailto:sukvg@microsoft.com"><span class="font3" style="font-style:italic;">sukvg@microsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-project</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft Project file.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mpp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-tnef</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Identifies an attachment that in general would be processable only by a MAPI-aware application. This type is an encapsulated format of rich MAPI properties, such as Rich Text and Icon information, that may otherwise be degraded by the messaging transport.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.ms-works</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft Works software.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.mseq</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MSEQisa compact multimedia format suitable for wireless devices.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mseq</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Gwenael Le Bodic </span><a href="mailto:Gwenael.le_bodic@alcatel.fr"><span class="font3" style="font-style:italic;">Gwenael.le_bodic@alcatel.fr</span></a><span class="font3" style="font-style:italic;"> http //www.3gpp.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.msign</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used by applications implementing the msign protocol, which requests signatures from mobile devices.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Malte Borcherding</span></p>
<p><a href="mailto:Malte.Borcherding@brokat.com"><span class="font3" style="font-style:italic;">Malte.Borcherding@brokat.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.music-niff</span></p></td><td style="vertical-align:top;">
<p><span class="font2">NIFF music files.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Cindy Grande</span></p>
<p><a href="mailto:72723.1272@compuserve.com"><span class="font3" style="font-style:italic;">72723.1272@compuserve.com</span></a><span class="font3" style="font-style:italic;"> </span><a href="ftp://blackbox.cartah.washington"><span class="font3" style="font-style:italic;">ftp://blackbox.cartah.washington</span></a><span class="font3" style="font-style:italic;">.</span></p>
<p><span class="font3" style="font-style:italic;">edu/pub/NIFF/NIFF6A.TXT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.musician</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MUSICIANscoring language/encoding conceived and developed by RenaiScience Corporation.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mus</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Robert G. Adams </span><a href="mailto:gadams@renaiscience.com"><span class="font3" style="font-style:italic;">gadams@renaiscience.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.netfpx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Intended for dynamic retrieval of multiresolution image information, as used by Hewlett-Packard Company Imaging for Internet.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fpx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Andy Mutz </span><a href="mailto:andy_mutz@hp.com"><span class="font3" style="font-style:italic;">andy_mutz@hp.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.noblenet-directory</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the NobleNet Directory software, purchased by RogueWave.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nnd</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.noblenet.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.noblenet-sealer</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the NobleNet Sealer software, purchased by RogueWave.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nns</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.noblenet.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.noblenet-web</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports the NobleNet Web software, purchased by RogueWave.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nnw</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.noblenet.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.novadigm. EDM</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Novadigm’s RADIA and EDM products.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">edm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Phil Burgard </span><a href="mailto:pburgard@novadigm.com"><span class="font3" style="font-style:italic;">pburgard@novadigm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.novadigm. EDX</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">edx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.novadigm. EXT</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ext</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.osa. netdeploy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the Open Software Associates netDeploy application deployment software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ndc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Steve Klos </span><a href="mailto:stevek@osa.com"><span class="font3" style="font-style:italic;">stevek@osa.com</span></a><span class="font3" style="font-style:italic;"> http //www.osa.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.palm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used by PalmOS system software and applications—this new type, “appli-cation/vnd.palm,” replaces the old type “application/x-pilot.”</span></p></td><td style="vertical-align:top;">
<p><span class="font2">prc, pdb, pqa, oprc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gavin Peacock </span><a href="mailto:gpeacock@palm.com"><span class="font3" style="font-style:italic;">gpeacock@palm.com</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.pg.format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary Proctor &amp;&nbsp;Gamble Standard Reporting System.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">str</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">April Gandert</span></p>
<p><span class="font2">TN152</span></p>
<p><span class="font2">Procter &amp;&nbsp;Gamble Way Cincinnati, Ohio 45202 (513) 983-4249</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.pg.osasli</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary Proctor &amp;&nbsp;Gamble Standard Reporting System.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ei6</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd. powerbuilder6 application/vnd. powerbuilder6-s application/vnd.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">powerbuilder7 application/vnd. powerbuilder7-s application/vnd. powerbuilder75 application/vnd.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">powerbuilder75-s</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used only by Sybase PowerBuilder release 6, 7, and 7.5 runtime environments, nonsecure and secure.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pbd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Reed Shilts</span></p>
<p><a href="mailto:reed.shilts@sybase.com"><span class="font3" style="font-style:italic;">reed.shilts@sybase.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">previewsystems.box</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Preview Systems ZipLock/VBox product.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">box, vbox</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Roman Smolgovsky </span><a href="mailto:romans@previewsystems.com"><span class="font3" style="font-style:italic;">romans@previewsystems.com</span></a><span class="font3" style="font-style:italic;"> http //www.previewsystems.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.publishare-delta-tree</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Used by Capella Computers’ PubliShare runtime environment.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qps</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Oren Ben-Kiki</span></p>
<p><a href="mailto:publishare-delta-tree@capella.co.il"><span class="font3" style="font-style:italic;">publishare-delta-tree@capella.co.il</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.rapid</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Emultek’s rapid packaged applications.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">zrp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Itay Szekely </span><a href="mailto:etay@emultek.co.il"><span class="font3" style="font-style:italic;">etay@emultek.co.il</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.s3sms</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Integrates the transfer mechanisms of the Sonera SmartTrust products into the Internet infrastructure.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Lauri Tarkkala</span></p>
<p><a href="mailto:Lauri.Tarkkala@sonera.com"><span class="font3" style="font-style:italic;">Lauri.Tarkkala@sonera.com</span></a><span class="font3" style="font-style:italic;"> http //www.smarttrust.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.seemail</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the transmission of SeeMail files. SeeMail is an application that captures video and sound and uses bitwise compression to compress and archive the two pieces into one file.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">see</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Steven Webb </span><a href="mailto:steve@wynde.com"><span class="font3" style="font-style:italic;">steve@wynde.com</span></a><span class="font3" style="font-style:italic;"> http //www.realmediainc.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.shana. informed.formdata</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Shana e-forms data formats.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ifm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Guy Selzler Shana Corporation </span><a href="mailto:gselzler@shana.com"><span class="font3" style="font-style:italic;">gselzler@shana.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.shana. informed.formtemp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Shana e-forms data formats.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">itp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.shana. informed.interchange</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Shana e-forms data formats.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iif, iif1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.shana. informed.package</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Shana e-forms data formats.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ipk, ipkg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.street-stream</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary to Street Technologies.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Glenn Levitt</span></p>
<p><span class="font2">Street Technologies</span></p>
<p><a href="mailto:streetd1@ix.netcom.com"><span class="font3" style="font-style:italic;">streetd1@ix.netcom.com</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.svd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Dateware Electronics SVD files.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Scott Becker</span></p>
<p><a href="mailto:dataware@compumedia.com"><span class="font3" style="font-style:italic;">dataware@compumedia.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.swiftview-ics</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports SwiftView®.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Randy Prakken </span><a href="mailto:tech@ndg.com"><span class="font3" style="font-style:italic;">tech@ndg.com</span></a><span class="font3" style="font-style:italic;"> http //www.ndg.com/svm htm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.triscape.mxs</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Triscape Map Explorer.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mxs</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Steven Simonoff </span><a href="mailto:scs@triscape.com"><span class="font3" style="font-style:italic;">scs@triscape.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.trueapp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">True BASIC files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tra</span></p></td><td style="vertical-align:top;">
<p><span class="font2">J. Scott Hepler </span><a href="mailto:scott@truebasic.com"><span class="font3" style="font-style:italic;">scott@truebasic.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.truedoc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary to Bitstream, Inc.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Brad Chase</span></p>
<p><a href="mailto:brad_chase@bitstream.com"><span class="font3" style="font-style:italic;">brad_chase@bitstream.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/vnd.ufdl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UWI’s UFDL files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ufdl, ufd, frm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Dave Manning </span><a href="mailto:dmanning@uwi.com"><span class="font3" style="font-style:italic;">dmanning@uwi.com</span></a><span class="font3" style="font-style:italic;"> http //www.uwi.com/</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.uplanet.alert application/vnd.uplanet. alert-wbxml application/vnd.uplanet. bearer-choi-wbxml application/vnd.uplanet. bearer-choice application/vnd.uplanet. cacheop application/vnd.uplanet. cacheop-wbxml application/vnd.uplanet. channel</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.uplanet. channel-wbxml application/vnd.uplanet.list application/vnd.uplanet.list-wbxml</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.uplanet. listcmd</span></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.uplanet. listcmd-wbxml application/vnd.uplanet. signal</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Formats used by Unwired Planet (now Openwave) UP browser microbrowser for mobile devices.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><a href="mailto:iana-registrar@uplanet.com"><span class="font3" style="font-style:italic;">iana-registrar@uplanet.com</span></a><span class="font3" style="font-style:italic;"> http //www.openwave.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.vcx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">VirtualCatalog.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vcx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Taisuke Sugimoto</span></p>
<p><a href="mailto:sugimototi@noanet.nttdata.co.jp"><span class="font3" style="font-style:italic;">sugimototi@noanet.nttdata.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.vectorworks</span></p></td><td style="vertical-align:top;">
<p><span class="font2">VectorWorks graphics files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mcd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Paul C. Pharr</span></p>
<p><a href="mailto:pharr@diehlgraphsoft.com"><span class="font3" style="font-style:italic;">pharr@diehlgraphsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.vidsoft. vidconference</span></p></td><td style="vertical-align:top;">
<p><span class="font2">VidConference format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vsc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Robert Hess </span><a href="mailto:hess@vidsoft.de"><span class="font3" style="font-style:italic;">hess@vidsoft.de</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.visio</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Visio files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">vsd, vst, vsw, vss</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Troy Sandal </span><a href="mailto:troys@visio.com"><span class="font3" style="font-style:italic;">troys@visio.com</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.vividence. scriptfile</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Vividence files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">vsf, vtd, vd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Mark Risher </span><a href="mailto:markr@vividence.com"><span class="font3" style="font-style:italic;">markr@vividence.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wap.sic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAP Service Indication format.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sic, wbxml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WAP Forum Ltd </span><span class="font3" style="font-style:italic;">http //www.wapforum.org</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wap.slc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WAP Service Loading format.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">slc,</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Anything that conforms to the Service Loading specification, available at </span><a href="http://www.wapforum.org"><span class="font3" style="font-style:italic;">http://www.wapforum.org</span></a><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wbxml</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wap.wbxml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAP WBXML binary XML format for wireless devices.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wbxml</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Same as above</span></p>
<p><span class="font2">“WAP Binary XML Content Format—WBXML version 1.1”</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wap.wmlc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WAP WML format for wireless devices.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">wmlc, wbxml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wap. wmlscriptc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAP WMLScript format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wmlsc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.webturbo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WebTurbo format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wtb</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Yaser Rehem Sapient Corporation </span><a href="mailto:yrehem@sapient.com"><span class="font3" style="font-style:italic;">yrehem@sapient.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wrq-hp3000-labelled</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports HP3000 formats.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><a href="mailto:support@wrq.com"><span class="font3" style="font-style:italic;">support@wrq.com</span></a><span class="font3" style="font-style:italic;"> </span><a href="mailto:support@3k.com"><span class="font3" style="font-style:italic;">support@3k.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.wt.stf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports Worldtalk software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">stf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Bill Wohler</span></p>
<p><a href="mailto:wohler@worldtalk.com"><span class="font3" style="font-style:italic;">wohler@worldtalk.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.xara</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Xara files are saved by CorelXARA, an object-oriented vector graphics package written by Xara Limited (and marketed by Corel).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">David Matthewman </span><a href="mailto:david@xara.com"><span class="font3" style="font-style:italic;">david@xara.com</span></a><span class="font3" style="font-style:italic;"> http //www.xara.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.xfdl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UWI’s XFDL files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xfdl, xfd, frm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Dave Manning </span><a href="mailto:dmanning@uwi.com"><span class="font3" style="font-style:italic;">dmanning@uwi.com</span></a><span class="font3" style="font-style:italic;"> http //www.uwi.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/vnd.yellowriver-custom-menu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the Yellow River CustomMenu plug-in, which provides customized browser drop-down menus.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cmp</span></p></td><td style="vertical-align:top;">
<p><a href="mailto:yellowriversw@yahoo.com"><span class="font3" style="font-style:italic;">yellowriversw@yahoo.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/whoispp-query</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Defines Whois++ protocol queries within MIME.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2957</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/whoispp-response</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Defines Whois++ protocol responses within MIME.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2958</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/wita</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Wang Information Transfer Architecture.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Document number 715-0050A, Wang Laboratories </span><a href="mailto:campbell@redsox.bsw.com"><span class="font3" style="font-style:italic;">campbell@redsox.bsw.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/wordperfect5.1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WordPerfect documents.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x400-bp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Carries any X.400 body part for which there is no registered IANA mapping.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1494</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-bcpio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Old-style binary CPIO archives.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">bcpio</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-cdlink</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Allows integration of CD-ROM media within web pages.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vcd</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.cdlink.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-chess-pgm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">pgn</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-compress</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Binary data from Unix compress.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">z</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-cpio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CPIO archive file.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cpio</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-csh</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CSH scripts.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csh</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-director</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Macromedia director files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dcr, dir, dxr</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-dvi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TeX DVI files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dvi</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-futuresplash</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">spl</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-gtar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">GNU tar archives.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gtar</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-gzip</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">GZIP compressed data.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gz</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-hdf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hdf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-javascript</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">JavaScript files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">js</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-koan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the automatic playback of Koan music files over the Internet, by helper applications such as SSEYO Koan Netscape Plugin.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">skp, skd, skt, skm</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-latex</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LaTeX files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">latex</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-netcdf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">NETCDF files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nc, cdf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-sh</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SH scripts.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sh</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-shar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">SHAR archives.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">shar</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-shockwave-flash</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Macromedia Flash files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">swf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-stuffit</span></p></td><td style="vertical-align:top;">
<p><span class="font2">StuffIt archives.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sit</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-sv4cpio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Unix SysV R4 CPIO archives.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sv4cpio</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-sv4crc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Unix SysV R4 CPIO w/CRC archives.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sv4crc</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-tar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TAR archives.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tar</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-tcl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TCL scripts.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tcl</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-tex</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TeX files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tex</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-texinfo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TeX info files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">texinfo, texi</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-troff</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TROFF files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">t, tr, roff</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-troff-man</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TROFF Unix manpages.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">man</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-troff-me</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TROFF+me files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">me</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">application/x-troff-ms</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TROFF+ms files</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ms</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3636"></a><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/x-ustar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The extended tar interchange format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ustar</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">See the IEEE 1003.1(1990) specifications</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/x-wais-source</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAIS source structure.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">src</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">application/xml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extensible Markup Language format file (use text/xml if you want the file treated as plain text by browsers, etc.).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xml, dtd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2376</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">application/zip</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PKWARE zip archives.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">zip</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><a name="bookmark3637"></a><span class="font7" style="font-weight:bold;">audio/*</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:middle;">
<p><a href="#bookmark3577"><span class="font24">Table D-4 </span></a><span class="font24">summarizes</span></p></td><td style="vertical-align:middle;">
<p><span class="font24">audio content types.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td colspan="2" style="vertical-align:middle;">
<p><a name="bookmark3577"></a><span class="font23" style="font-style:italic;">Table D-4. “Audio” MIME types</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">audio/32kadpcm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">8 kHz ADPCM audio encoding.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2421</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/basic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Audio encoded with 8-kHz monaural 8-bit ISDN u-law PCM.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">au, snd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/G.772.1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">G.722.1 compresses 50Hz–7kHz audio signals into 24 kbit/s or 32 kbit/s. It may be used for speech, music, and other types of audio.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3047</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/L16</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Audio/L16 is based on L16, described in RFC 1890. L16 denotes uncompressed audio data, using 16-bit signed representation.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2586</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/MP4A-LATM</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MPEG-4 audio.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3016</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/midi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MIDI music files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mid, midi, kar</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/mpeg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MPEG encoded audio files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mpga, mp2, mp3</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3003</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/parityfec</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Parity-based forward error correction for RTP audio.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3009</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/prs.sid</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Commodore 64 SID audio files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sid, psid</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.geocities.com/ SiliconValley/Lakes/5147/sidplay/ docs.html#fileformats</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">audio/telephone-event</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Logical telephone event.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2833</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/tone</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Telephonic sound pattern.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2833</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">audio/vnd.cns.anp1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports voice and unified messaging application features available on the Access NP network services platform from Comverse Network Systems.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Ann McLaughlin</span></p>
<p><span class="font2">Comverse Network Systems </span><a href="mailto:amclaughlin@comversens.com"><span class="font3" style="font-style:italic;">amclaughlin@comversens.com</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.cns.inf1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports voice and unified messaging application features available on the TRILOGUE Infinity network services platform from Comverse Network Systems.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.digital-winds</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Digital Winds music is never-ending, reproducible, and interactive MIDI music in very small packages (&lt;3K).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">eol</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Armands Strazds </span><a href="mailto:armands.strazds@medienhaus-bremen.de"><span class="font3" style="font-style:italic;">armands.strazds@medienhaus-bremen.de</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.everad.plj</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary EverAD audio encoding.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">plj</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Tomer Weisberg </span><a href="mailto:tomer@everad.com"><span class="font3" style="font-style:italic;">tomer@everad.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.lucent.voice</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Voice messaging including Lucent Technologies’ Intuity™ AUDIX® Multimedia Messaging System and the Lucent Voice Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lvp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Frederick Block </span><a href="mailto:rickblock@lucent.com"><span class="font3" style="font-style:italic;">rickblock@lucent.com</span></a><span class="font3" style="font-style:italic;"> http //www.lucent.com/lvp/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.nortel.vbk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Proprietary Nortel Networks Voice Block audio encoding.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vbk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Glenn Parsons</span></p>
<p><a href="mailto:Glenn.Parsons@NortelNetworks.com"><span class="font3" style="font-style:italic;">Glenn.Parsons@NortelNetworks.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.nuera.ecelp4800</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary Nuera Communications audio and speech encoding, available in Nuera voice-over-IP gateways, terminals, application servers, and as a media service for various host platforms and OSs.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ecelp4800</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Michael Fox </span><a href="mailto:mfox@nuera.com"><span class="font3" style="font-style:italic;">mfox@nuera.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">audio/vnd.nuera.ecelp7470</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ecelp7470</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">audio/vnd.nuera.ecelp9600</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ecelp9600</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.octel.sbc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Variable-rate encoding averaging 18 kbps used for voice messaging in Lucent Technologies’ Sierra™, Overture™, and IMA™ platforms.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Jeff Bouis </span><a href="mailto:jbouis@lucent.com"><span class="font3" style="font-style:italic;">jbouis@lucent.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.qcelp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Qualcomm audio encoding.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">qcp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Andy Dejaco </span><a href="mailto:adejaco@qualcomm.com"><span class="font3" style="font-style:italic;">adejaco@qualcomm.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.rhetorex. 32kadpcm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">32-kbps Rhetorex™ ADPCM audio encoding used in voice messaging products such as Lucent Technologies’s CallPerformer™, Unified Messenger™, and other products.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Jeff Bouis </span><a href="mailto:jbouis@lucent.com"><span class="font3" style="font-style:italic;">jbouis@lucent.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/vnd.vmx.cvsd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Audio encoding used in voice messaging products including Lucent Technologies’ Overture200™, Overture 300™, and VMX 300™ product lines.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/x-aiff</span></p></td><td style="vertical-align:top;">
<p><span class="font2">AIFF audio file format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">aif, aiff, aifc</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/x-pn-realaudio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RealAudio metafile format by Real Networks (formerly Progressive Networks).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ram, rm</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">audio/x-pn-realaudio-plugin</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">rpm</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3638"></a><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/x-realaudio</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RealAudio audio format by Real Networks (formerly Progressive Networks).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ra</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">audio/x-wav</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAV audio files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wav</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3639"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3640"></a>chemical/*</span></h3>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font24">Much of the information in </span><a href="#bookmark3578"><span class="font24">Table D-5 </span></a><span class="font24">was obtained courtesy of the “Chemical MIME Home Page” (</span><a href="http://www.ch.ic.ac.uk/chemime/"><span class="font24" style="font-style:italic;">http://www.ch.ic.ac.uk/chemime/</span></a><span class="font24">).</span></p>
<table>
<tr><td>
<p><a name="bookmark3578"></a><span class="font23" style="font-style:italic;">Table D-5. “Chemical” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-alchemy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Alchemy format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">alc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cache-csf</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">csf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-cactvs-binary</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CACTVS binary format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cbin</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //cactvs.cit.nih.gov</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cactvs-ascii</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CACTVS ASCII format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cascii</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //cactvs.cit.nih.gov</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cactvs-table</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CACTVS table format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ctab</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //cactvs.cit.nih.gov</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cdx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ChemDraw eXchange file</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cdx</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cerius</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MSI Cerius II format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cer</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.msi.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-chemdraw</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ChemDraw file</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">chm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Crystallographic Interchange Format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cif</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //</span><a href="http://www.bernstein-plus-sons.com/software/rasmol/"><span class="font3" style="font-style:italic;">www.bernstein-plus-sons.com/software/rasmol/</span></a></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //ndbserver.rutgers.edu/NDB/ mmcif/examples/index.html</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-mmcif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MacroMolecular CIF</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mcif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-chem3d</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Chem3D format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">c3d</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cmdf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CrystalMaker Data Format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cmdf</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.crystalmaker.co.uk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-compass</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Compass program of the Takahashi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cpa</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-crossfire</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Crossfire file</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bsd</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-cml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Chemical Markup Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //</span><a href="http://www.xml-cml.org"><span class="font3" style="font-style:italic;">www.xml-cml.org</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-csml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Chemical Style Markup Language</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csml, csm</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-ctx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Gasteiger group CTX file format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ctx</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-cxf</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">cxf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-daylight-smiles</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Smiles format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">smi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.daylight.com/dayhtml/ smiles/index.html</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-embl-dl-nucleotide</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EMBL nucleotide format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">emb</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //mercury.ebi.ac.uk</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">chemical/x-galactic-spc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SPC format for spectral and chromatographic data</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">spc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.galactic.com/galactic/ Data/spcvue.htm</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-gamess-input</span></p></td><td style="vertical-align:top;">
<p><span class="font2">GAMESS Input format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">inp, gam</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.msg.ameslab.gov/ GAMESS/Graphics/</span></p>
<p><span class="font3" style="font-style:italic;">MacMolPlt.shtml</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-gaussian-input</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Gaussian Input format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gau</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-gaussian-checkpoint</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gaussian Checkpoint format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fch, fchk</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //products.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-gaussian-cube</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Gaussian Cube (Wavefunction) format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cub</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-gcg8-sequence</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">gcg</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-genbank</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ToGenBank format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gen</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-isostar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IsoStar Library of intermolecular interactions</span></p></td><td style="vertical-align:top;">
<p><span class="font2">istr, ist</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.ccdc.cam.ac.uk</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-jcamp-dx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">JCAMP Spectroscopic Data Exchange format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">jdx, dx</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-jjc-review-surface</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Re_View3 Orbital Contour files</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rv3</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.brunel.ac.uk/depts/ chem/ch241s/re_view/rv3 htm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-jjc-review-xyz</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Re_View3 Animation files</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xyb</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.brunel.ac.uk/depts/ chem/ch241s/re_view/rv3 htm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-jjc-review-vib</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Re_View3 Vibration files</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rv2, vib</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.brunel.ac.uk/depts/ chem/ch241s/re_view/rv3 htm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-kinemage</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Kinetic (Protein Structure) Images</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kin</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.faseb.org/protein/ kinemages/MageSoftware.html</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-macmolecule</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MacMolecule file format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mcm</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-macromodel-input</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MacroModel Molecular Mechanics</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mmd, mmod</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.columbia.edu/cu/ chemistry/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mdl-molfile</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MDL Molfile</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mol</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mdl-rdfile</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Reaction data file</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rd</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mdl-rxnfile</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MDL Reaction format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">rxn</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mdl-sdfile</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MDL Structure data file</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sd</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mdl-tgf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MDL Transportable Graphics Format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tgf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mif</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mif</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mol2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Portable representation of a SYBYL molecule</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mol2</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.tripos.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-molconn-Z</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Molconn-Z format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">b</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.eslc.vabiotech.com/ molconn/molconnz.html</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mopac-input</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MOPAC Input format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mop</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-mopac-graph</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MOPAC Graph format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gpt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //products.camsoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">chemical/x-ncbi-asn1</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">asn (old form)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">chemical/x-ncbi-asn1-binary</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">val</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">chemical/x-pdb</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Protein DataBank pdb</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pdb</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3641"></a><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><a name="bookmark3642"></a><span class="font2">chemical/x-swissprot</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SWISS-PROT protein sequence database</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">sw</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //</span><a href="http://www.expasy.ch/spdbv/text/"><span class="font3" style="font-style:italic;">www.expasy.ch/spdbv/text/</span></a><span class="font3" style="font-style:italic;"> download.htm</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">chemical/x-vamas-iso14976</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Versailles Agreement on Materials and Standards</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">vms</span></p></td><td style="vertical-align:middle;">
<p><span class="font3" style="font-style:italic;">http //www.acolyte.co.uk/JISO/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-vmd</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Visual Molecular Dynamics</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vmd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.ks.uiuc.edu/Research/ vmd/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">chemical/x-xtel</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Xtelplot file format</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xtel</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.recipnet.indiana.edu/ graphics/xtelplot/xtelplot htm</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">chemical/x-xyz</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Co-ordinate Animation format</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">xyz</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.mdli.com</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3643"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3644"></a>image/*</span></h3>
<p style="padding:0pt 0pt 12pt 0pt;"><a href="#bookmark3579"><span class="font24">Table D-6 </span></a><span class="font24">summarizes some of the image types commonly exchanged by email and HTTP.</span></p>
<table>
<tr><td>
<p><a name="bookmark3579"></a><span class="font23" style="font-style:italic;">Table D-6. “Image” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">image/bmp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Windows BMP image format.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">bmp</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/cgm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Computer Graphics Metafile (CGM) is an International Standard for the portable storage and transfer of 2-D illustrations.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Alan Francis</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><a href="mailto:A.H.Francis@open.ac.uk"><span class="font3" style="font-style:italic;">A.H.Francis@open.ac.uk</span></a></p>
<p><span class="font2">See ISO 8632:1992, IS 8632:1992</span></p>
<p><span class="font2">Amendment 1 (1994), and IS 8632: 1992 Amendment 2 (1995)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">image/g3fax</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">G3 Facsimile byte streams.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1494</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/gif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Compuserve GIF images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/ief</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">ief</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1314</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/jpeg</span></p></td><td style="vertical-align:top;">
<p><span class="font2">JPEG images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">jpeg,jpg, jpe, jfif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">JPEG Draft Standard ISO 10918-1 CD</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/naplps</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">North American Presentation Layer Protocol Syntax (NAPLPS) images.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">ANSI X3.110-1983 CSA T500-1983</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/png</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Portable Network Graphics (PNG) images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">png</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Internet draft </span><span class="font3" style="font-style:italic;">draft-boutell-png-spec-04.txt</span><span class="font2">, “Png (Portable Network Graphics) Specification</span></p>
<p><span class="font2">Version 1.0”</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/prs.btif</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Format used by Nations Bank for BTIF image viewing of checks and other applications.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">btif, btf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Arthur Rubin </span><a href="mailto:arthurr@crt.com"><span class="font3" style="font-style:italic;">arthurr@crt.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/prs.pti</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PTI encoded images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pti</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Juern Laun</span></p>
<p><a href="mailto:juern.laun@gmx.de"><span class="font3" style="font-style:italic;">juern.laun@gmx.de</span></a></p>
<p><span class="font3" style="font-style:italic;">http //server.hvzgymn.wn.schule-bw.de/pti/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/tiff</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TIFF images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tiff, tif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2302</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/vnd.cns.inf2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports application features available on the TRILOGUE Infinity network services platform from Comverse Network Systems.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Ann McLaughlin</span></p>
<p><span class="font2">Comverse Network Systems </span><a href="mailto:amclaughlin@comversens.com"><span class="font3" style="font-style:italic;">amclaughlin@comversens.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/vnd.dxf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">DXF vector CAD files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dxf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/vnd.fastbidsheet</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A FastBid Sheet contains a raster or vector image that represents an engineering or architectural drawing.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fbs</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Scott Becker </span><a href="mailto:scottb@bxwa.com"><span class="font3" style="font-style:italic;">scottb@bxwa.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/vnd.fpx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Kodak FlashPix images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fpx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Chris Wing</span></p>
<p><span class="font3" style="font-style:italic;">format_change_request@kodak.</span></p>
<p><span class="font3" style="font-style:italic;">com</span></p>
<p><span class="font3" style="font-style:italic;">http //www.kodak.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">image/vnd.fst</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Image format from FAST Search and Transfer.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fst</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Arild Fuldseth</span></p>
<p><a href="mailto:Arild.Fuldseth@fast.no"><span class="font3" style="font-style:italic;">Arild.Fuldseth@fast.no</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.fujixerox.edmics-mmr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Fuji Xerox EDMICS MMR image format.</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">mmr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Masanori Onda</span></p>
<p><a href="mailto:Masanori.Onda@fujixerox.co.jp"><span class="font3" style="font-style:italic;">Masanori.Onda@fujixerox.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.fujixerox.edmics-rlc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Fuji Xerox EDMICS RLC image format.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rlc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.mix</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MIX files contain binary data in streams that are used to represent images and related information. They are used by Microsoft PhotDraw and PictureIt software.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Saveen Reddy2 </span><a href="mailto:saveenr@microsoft.com"><span class="font3" style="font-style:italic;">saveenr@microsoft.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.net-fpx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Kodak FlashPix images.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Chris Wing</span></p>
<p><span class="font3" style="font-style:italic;">format_change_request@kodak.</span></p>
<p><span class="font3" style="font-style:italic;">com</span></p>
<p><span class="font3" style="font-style:italic;">http //www.kodak.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.wap.wbmp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">wbmp</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/vnd.xiff</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Extended Image Format used by Pagis software.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xif</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Steve Martin</span></p>
<p><a href="mailto:smartin@xis.xerox.com"><span class="font3" style="font-style:italic;">smartin@xis.xerox.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-cmu-raster</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ras</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-portable-anymap</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PBM generic images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pnm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Jeff Poskanzer</span></p>
<p><span class="font3" style="font-style:italic;">http //www.acme.com/software/ pbmplus/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-portable-bitmap</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PBM bitmap images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">pbm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-portable-graymap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PBM grayscale images.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">pgm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-portable-pixmap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PBM color images.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ppm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-rgb</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Silicon Graphics’s RGB images.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">rgb</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-xbitmap</span></p></td><td style="vertical-align:top;">
<p><span class="font2">X-Window System bitmap images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xbm</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-xpixmap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">X-Window System color images.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">xpm</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">image/x-xwindowdump</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">X-Window System screen capture images.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xwd</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3645"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3646"></a><a name="bookmark3647"></a>message/*</span></h3>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">Messages are composite types used to communicate data objects (through email, HTTP, or other transport protocols). </span><a href="#bookmark3580"><span class="font24">Table D-7</span></a><span class="font24"> describes the common MIME message types.</span></p>
<table>
<tr><td>
<p><a name="bookmark3580"></a><span class="font23" style="font-style:italic;">Table D-7. “Message” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">message/delivery-status</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">message/disposition-notification</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2298</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">message/external-body</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">message/http</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2616</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark3648"></a><span class="font2">message/news</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Defines a way to transmit news articles via email for human reading— message/rfc822 is not sufficient because news headers have semantics beyond those defined by RFC 822.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 1036</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">message/partial</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Permits the fragmented transmission of bodies that are thought to be too large to be sent directly by email.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">message/rfc822</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A complete email message.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">message/s-http</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Secure HTTP messages, an alternative to HTTP over SSL.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC 2660</span></p></td></tr>
</table></td></tr>
</table>
<h3 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3649"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3650"></a>model/*</span></h3>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><span class="font24">The model MIME type is an IETF-registered extension type. It represents mathematical models of physical worlds, for computer-aided design, and 3-D graphics. </span><a href="#bookmark3581"><span class="font24">Table D-8 </span></a><span class="font24">describes some of the model formats.</span></p>
<table>
<tr><td>
<p><a name="bookmark3581"></a><span class="font23" style="font-style:italic;">Table D-8. “Model” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model/iges</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The Initial Graphics Exchange Specification (IGES) defines a neutral data format that allows for the digital exchange of information between computer-aided design (CAD) systems.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">igs, iges</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2077</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model/mesh</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">msh, mesh, silo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2077</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model/vnd.dwf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">DWF CAD files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dwf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Jason Pratt</span></p>
<p><a href="mailto:jason.pratt@autodesk.com"><span class="font3" style="font-style:italic;">jason.pratt@autodesk.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model/vnd.flatland.3dml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports 3DML models supported by Flatland products.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">3dml, 3dm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Michael Powers </span><a href="mailto:pow@flatland.com"><span class="font3" style="font-style:italic;">pow@flatland.com</span></a><span class="font3" style="font-style:italic;"> http //www.flatland.com</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">model/vnd.gdl model/vnd.gs-gdl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The Geometric Description Language (GDL) isa parametric object definition language for ArchiCAD by Graphisoft.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gdl, gsm, win, dor, lmp, rsm, msm, ism</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Attila Babits </span><a href="mailto:ababits@graphisoft.hu"><span class="font3" style="font-style:italic;">ababits@graphisoft.hu</span></a><span class="font3" style="font-style:italic;"> http //www.graphisoft.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">model/vnd.gtw</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Gen-Trix models.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">gtw</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Yutaka Ozaki</span></p>
<p><a href="mailto:yutaka_ozaki@gen.co.jp"><span class="font3" style="font-style:italic;">yutaka_ozaki@gen.co.jp</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3651"></a><span class="font2">model/vnd.mts</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MTS model format by Virtue.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mts</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Boris Rabinovitch </span><a href="mailto:boris@virtue3d.com"><span class="font3" style="font-style:italic;">boris@virtue3d.com</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">model/vnd.parasolid.trans-mit.binary</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Binary Parasolid modeling file.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">x_b</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.ugsolutions.com/ products/parasolid/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">model/vnd.parasolid.trans-mit.text</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Text Parasolid modeling file.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">x_t</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.ugsolutions.com/ products/parasolid/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">model/vnd.vtu</span></p></td><td style="vertical-align:top;">
<p><span class="font2">VTU model format by Virtue.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">vtu</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Boris Rabinovitch </span><a href="mailto:boris@virtue3d.com"><span class="font3" style="font-style:italic;">boris@virtue3d.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">model/vrml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Virtual Reality Markup Language format files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wrl, vrml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2077</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3652"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3653"></a>multipart/*</span></h3>
<p style="text-align:justify;padding:0pt 0pt 12pt 0pt;"><span class="font24">Multipart MIME types are composite objects that contain other objects. The subtype describes the implementation of the multipart packaging and how to process the components. Multipart media types are summarized in </span><a href="#bookmark3582"><span class="font24">Table D-9</span></a><span class="font24">.</span></p>
<table>
<tr><td>
<p><a name="bookmark3582"></a><span class="font23" style="font-style:italic;">Table D-9. “Multipart” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 35pt 0pt;"><span class="font2">multipart/alternative</span></p>
<p style="padding:0pt 0pt 54pt 0pt;"><span class="font2">multipart/appledouble</span></p>
<p><span class="font2">multipart/byteranges</span></p></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">The content consists of a list of alternative representations, each with its own Content-Type. The client can select the best supported component.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">Apple Macintosh files contain “resource forks” and other desktop data that describes the actual file contents. This multipart content sends the Apple metadata in one part and the actual content in another part.</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">When an HTTP message includes the content of multiple ranges, these are transmitted in a “multipart/byter-anges” object. This media type includes two or more parts, separated by MIME boundaries, each with its own Content-Type and ContentRange fields.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="padding:0pt 0pt 33pt 0pt;"><span class="font2">RFC 1341</span></p>
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/</span></p>
<p style="padding:0pt 0pt 33pt 0pt;"><span class="font3" style="font-style:italic;">multipart/appledouble</span></p>
<p><span class="font2">RFC 2068</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/digest</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Contains a collection of individual email messages, in an easy-to-read form.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/encrypted</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Uses two parts to support cryptographically encrypted content. The first part contains the control information necessary to decrypt the data in the second body part and is labeled according to the value of the protocol parameter. The second part contains the encrypted data in type applica-tion/octet-stream.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1847</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/form-data</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used to bundle up a set of values as the result of a user filling out a form.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2388</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/header-set</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Separates user data from arbitrary descriptive metadata.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/ multipart/header-set</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/mixed</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A collection of objects.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/parallel</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Syntactically identical to multipart/ mixed, but all of the parts are intended to be presented simultaneously, on systems capable of doing so.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/related</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Intended for compound objects consisting of several interrelated body parts. The relationships between the body parts distinguish them from other object types. These relationships often are represented by links internal to the object’s components that reference the other components.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2387</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3654"></a><span class="font2">multipart/report</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Defines a general container type for electronic mail reports of any kind.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1892</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/signed</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Uses two parts to support cryptographically signed content. The first part is the content, including its MIME headers. The second part contains the information necessary to verify the digital signature.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1847</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">multipart/voice-message</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Provides a mechanism for packaging a voice message into one container that is tagged as VPIM v2–compliant.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFCs 2421 and 2423</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3655"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3656"></a>text/*</span></h3>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font24">Text media types contain characters and potential formatting information. </span><a href="#bookmark3583"><span class="font24">Table D-10</span></a><span class="font24"> summarizes text MIME types.</span></p>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/calendar</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports the iCalendar calendaring and scheduling standard.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2445</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/css</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Cascading Style Sheets.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">css</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2318</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/directory</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Holds record data from a directory database, such as LDAP.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2425</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/enriched</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Simple formatted text, supporting fonts, colors, and spacing. SGML-like tags are used to begin and end formatting.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1896</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/html</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HTML file.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">html, htm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2854</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/parityfec</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Forward error correction for text streamed in an RTP stream.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3009</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">text/plain</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Plain old text.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">asc, txt</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/prs.lines.tag</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Supports tagged forms, as used for email registration.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tag, dsc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">John Lines</span></p>
<p><a href="mailto:john@paladin.demon.co.uk"><span class="font3" style="font-style:italic;">john@paladin.demon.co.uk</span></a><span class="font3" style="font-style:italic;"> http //www.paladin.demon.co.uk/ tag-types/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/rfc822-headers</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used to bundle a set of email headers, such as when sending mail failure reports.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1892</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/richtext</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Older form of enriched text. See text/ enriched.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rtx</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/rtf</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The Rich Text Format (RTF) is a method of encoding formatted text and graphics for transfer between applications. The format is widely supported by word-processing applications on the MS-DOS, Windows, OS/2, and Macintosh platforms.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rtf</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/sgml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">SGML markup files.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sgml, sgm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1874</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/t140</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports standardized T.140 text, as used in synchronized RTP multimedia.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2793</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/tab-separated-values</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TSV is a popular method of data interchange among databases and spreadsheets and word processors. It consists of a set of lines, with fields separated by tab characters.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tsv</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.isi.edu/in-notes/iana/ assignments/media-types/text/tab-separated-values</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/uri-list</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Simple, commented lists of URLs and URNs used by URN resolvers, and any other applications that need to communicate bulk URI lists.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">uris, uri</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2483</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.abc</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ABC files are a human-readable format for musical scores.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">abc</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font3" style="font-style:italic;">http //www.gre.ac.uk/ ~c.walshaw/abc/</span></p>
<p><span class="font3" style="font-style:italic;">http //home1.swipnet.se/ ~w-11382/abcbnf.htm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.curl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Provides a set of content definition languages interpreted by the CURL runtime plug-in.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">curl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Tim Hodge </span><a href="mailto:thodge@curl.com"><span class="font3" style="font-style:italic;">thodge@curl.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.DMClientScript</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CommonDM Client Script files are used as hyperlinks to non-http sites (such as BYOND, IRC, or telnet) accessed by the Dream Seeker client application.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dms</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Dan Bradley </span><a href="mailto:dan@dantom.com"><span class="font3" style="font-style:italic;">dan@dantom.com</span></a><span class="font3" style="font-style:italic;"> http //www.byond.com/code/ref/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.fly</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Fly is a text preprocessor that uses a simple syntax to create an interface between databases and web pages.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fly</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">John-Mark Gurney </span><a href="mailto:jmg@flyidea.com"><span class="font3" style="font-style:italic;">jmg@flyidea.com</span></a><span class="font3" style="font-style:italic;"> http //www.flyidea.com</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.fmi.flexstor</span></p></td><td style="vertical-align:top;">
<p><span class="font2">For use in the SUVDAMA and UVRAPPF projects.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">flx</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.ozone.fmi.fi/</span></p>
<p style="text-align:justify;padding:0pt 0pt 4pt 0pt;"><span class="font3" style="font-style:italic;">SUVDAMA/</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font3" style="font-style:italic;">http //www.ozone.fmi.fi/UVRAPPF/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.in3d.3dml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">For In3D Player.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">3dml, 3dm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Michael Powers </span><a href="mailto:powers@insideout.net"><span class="font3" style="font-style:italic;">powers@insideout.net</span></a></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.in3d.spot</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">For In3D Player.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">spot, spo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.IPTC.NewsML</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">NewsML format specified by the International Press Telecommunications Council (IPTC).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">David Allen</span></p>
<p><a href="mailto:m_director_iptc@dial.pipex.com"><span class="font3" style="font-style:italic;">m_director_iptc@dial.pipex.com</span></a><span class="font3" style="font-style:italic;"> http //www.iptc.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.IPTC.NITF</span></p></td><td style="vertical-align:top;">
<p><span class="font2">NITF format specified by the IPTC.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Same as above </span><span class="font3" style="font-style:italic;">http //www.nitf.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.latex-z</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Supports LaTeX documents containing Z notation. Z notation (pronounced “zed”), is based on Zermelo-Fraenkel set theory and first order predicate logic, and it is useful for describing computer systems.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.comlab.ox.ac.uk/ archive/z/</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.motorola.reflex</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Provides a common method for submitting simple text messages from ReFLEX™ wireless devices.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">Mark Patton </span><a href="mailto:fmp014@email.mot.com"><span class="font3" style="font-style:italic;">fmp014@email.mot.com</span></a></p>
<p><span class="font2">Part of the FLEXsuite™ of Enabling Protocols specification available from Motorola under the licensing agreement</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.ms-mediapackage</span></p></td><td style="vertical-align:top;">
<p><span class="font2">This type is intended to be handled by the Microsoft application programs MStore.exe and 7 storDB.exe.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mpf</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Jan Nelson </span><a href="mailto:jann@microsoft.com"><span class="font3" style="font-style:italic;">jann@microsoft.com</span></a></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.wap.si</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Service Indication (SI) objects contain a message describing an event and a URI describing where to load the corresponding service.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">si, xml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WAP Forum Ltd </span><span class="font3" style="font-style:italic;">http //www.wapforum.org</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.wap.sl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The Service Loading (SL) content type provides a means to convey a URItoa user agent in a mobile client. The client itself automatically loads the content indicated by that URI and executes it in the addressed user agent without user intervention when appropriate.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sl, xml</span></p></td><td style="vertical-align:top;">
<p><a name="bookmark3657"></a><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3658"></a><span class="font2">text/vnd.wap.wml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Wireless Markup Language (WML) is a markup language, based on XML, that defines content and user interface for narrow-band devices, including cellular phones and pagers.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/vnd.wap.wmlscript</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">WMLScript is an evolution of JavaScript for wireless devices.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">wmls</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Same as above</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/x-setext</span></p></td><td style="vertical-align:top;">
<p><span class="font2">From Apache </span><span class="font3" style="font-style:italic;">mime.types</span><span class="font2">.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">etx</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">text/xml</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extensible Markup Language format file (use application/xml if you want the browser to save to file when downloaded).</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2376</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3659"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3660"></a>video/*</span></h3>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3584"><span class="font24">Table D-11 </span></a><span class="font24">lists some popular video movie formats. Note that some video formats are classified as application types.</span></p>
<table>
<tr><td>
<p><a name="bookmark3584"></a><span class="font23" style="font-style:italic;">Table D-11. “Video” MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">video/MP4V-ES</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MPEG-4 video payload, as carried by RTP.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3016</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">video/mpeg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Video encoded per the ISO 11172 CD</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mpeg,</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1341</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">MPEG standard.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mpg,</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mpe</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">video/parityfec</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Forward error correcting video format for data carried through RTP streams.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 3009</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">video/pointer</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Transporting pointer position information for presentations.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2862</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">video/quicktime</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Apple Quicktime video format.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">qt, mov</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.apple.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">video/vnd.fvt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Video format from FAST Search &amp;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">fvt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Arild Fuldseth</span></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">Transfer.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><a href="mailto:Arild.Fuldseth@fast.no"><span class="font3" style="font-style:italic;">Arild.Fuldseth@fast.no</span></a></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">video/vnd.motorola.video</span></p>
<p style="text-indent:7pt;"><span class="font2">video/vnd.motorola.videop</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Proprietary formats used by products from Motorola ISG.</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Tom McGinty Motorola ISG </span><a href="mailto:tmcginty@dma.isg.mot"><span class="font3" style="font-style:italic;">tmcginty@dma.isg.mot</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3661"></a><span class="font2">video/vnd.mpegurl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This media type consists of a series of URLs of MPEG Video files.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mxu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Heiko Recktenwald </span><a href="mailto:uzs106@uni-bonn.de"><span class="font3" style="font-style:italic;">uzs106@uni-bonn.de</span></a></p></td></tr>
<tr><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">“Power and Responsibility: Conversations with Contributors,” Guy van Belle, et al., LMJ 9 (1999), 127– 133, 129 (MIT Press)</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">video/vnd.nokia.interleaved-multimedia</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used in Nokia 9210 Communicator video player and related tools.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">nim</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3662"></a><span class="font2">Petteri Kangaslampi </span><a href="mailto:petteri.kangaslampi@nokia.com"><span class="font3" style="font-style:italic;">petteri.kangaslampi@nokia.com</span></a></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">video/x-msvideo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Microsoft AVI movies.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">avi</span></p></td><td style="vertical-align:top;">
<p><span class="font3" style="font-style:italic;">http //www.microsoft.com</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">video/x-sgi-movie</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Silicon Graphics’s movie format.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">movie</span></p></td><td style="vertical-align:bottom;">
<p><span class="font3" style="font-style:italic;">http //www.sgi.com</span></p></td></tr>
</table>
<h3 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3663"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3664"></a>Experimental Types</span></h3>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font24">The set of primary types supports most content types. </span><a href="#bookmark3585"><span class="font24">Table D-12 </span></a><span class="font24">lists one experimental type, for conferencing software, that is configured in some web servers.</span></p>
<table>
<tr><td>
<p><a name="bookmark3585"></a><span class="font23" style="font-style:italic;">Table D-12. Extension MIME types</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">MIME type</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Extension</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Contact and reference</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">x-conference/x-cooltalk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Collaboration tool from Netscape</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ice</span></p></td><td style="vertical-align:top;"></td></tr>
</table></td></tr>
</table>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3665"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3666"></a><a name="bookmark250"></a><a name="bookmark3667"></a>APPENDIX E</span></p>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark204"></a><span class="font11" style="font-weight:bold;"><a name="bookmark3668"></a>Base-64 Encoding</span></h1>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3669"></a><span class="font24">Base-64 encoding is used by HTTP, for basic and digest authentication, and by several HTTP extensions. This appendix explains base-64 encoding and provides conversion tables and pointers to Perl software to help you correctly use base-64 encoding in HTTP software.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3670"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3671"></a>Base-64 Encoding Makes Binary Data Safe</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3672"></a><span class="font24">The base-64 encoding converts a series of arbitrary bytes into a longer sequence of common text characters that are all legal header field values. Base-64 encoding lets us take user input or binary data, pack it into a safe format, and ship it as HTTP header field values without fear of them containing colons, newlines, or binary values that would break HTTP parsers.</span></p>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">Base-64 encoding was developed as part of the MIME multimedia electronic mail standard, so MIME could transport rich text and arbitrary binary data between different legacy email gateways.<a name="footnote166"></a><sup><a href="#bookmark3673">166</a></sup><sup></sup> Base-64 encoding is similar in spirit, but more efficient in space, to the uuencode and BinHex standards for textifying binary data. Section 6.8 of MIME RFC 2045 details the base-64 algorithm.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3674"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3675"></a>Eight Bits to Six Bits</span></h2>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font24">Base-64 encoding takes a sequence of 8-bit bytes, breaks the sequence into 6-bit pieces, and assigns each 6-bit piece to one of 64 characters comprising the base-64 alphabet. The 64 possible output characters are common and safe to place in HTTP header fields. The 64 characters include upper- and lowercase letters, numbers, +, <a name="bookmark3676"></a>and /. The special character = also is used. The base-64 alphabet is shown in </span><a href="#bookmark3677"><span class="font24">Table E-1</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 13pt 0pt;"><span class="font24">Note that because the base-64 encoding uses 8-bit characters to represent 6 bits of information, base 64–encoded strings are about 33% larger than the original values.</span></p>
<table>
<tr><td>
<p><a name="bookmark3677"></a><span class="font23" style="font-style:italic;">Table E-1. Base-64 alphabet</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2">0</span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2">A</span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2">8</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">I</span></p></td><td style="vertical-align:top;">
<p style="text-indent:8pt;"><span class="font2">16</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Q</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">24</span></p></td><td style="vertical-align:top;">
<p style="text-align:center;"><span class="font2">Y</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">32</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font5"><sup>g</sup></span></p></td><td style="vertical-align:top;">
<p style="text-indent:9pt;"><span class="font2">40</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">o</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">48</span></p></td><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">w</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">56</span></p></td><td style="vertical-align:top;">
<p style="text-align:right;"><span class="font2">4</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">1</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">B</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">9</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">J</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">17</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">R</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">25</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">Z</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">33</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">h</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">41</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font5"><sup>p</sup></span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">49</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">x</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">57</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2">5</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p><span class="font2">2</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:9pt;"><span class="font2">C</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:9pt;"><span class="font2">10</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">K</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:8pt;"><span class="font2">18</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">S</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">26</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font2">a</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">34</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">i</span></p></td><td style="vertical-align:middle;">
<p style="text-indent:9pt;"><span class="font2">42</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font5"><sup>q</sup></span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">50</span></p></td><td style="vertical-align:middle;">
<p style="text-align:center;"><span class="font5"><sup>y</sup></span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">58</span></p></td><td style="vertical-align:middle;">
<p style="text-align:right;"><span class="font2">6</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">3</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">D</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">11</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">L</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">19</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">T</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">27</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">b</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">35</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">j</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">43</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">r</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">51</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">z</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">59</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2">7</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">4</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">E</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">12</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">M</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">20</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">U</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">28</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">c</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">36</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">k</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">44</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">s</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">52</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">0</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">60</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2">8</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">5</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">F</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">13</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">N</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">21</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">V</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">29</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">d</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">37</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">l</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">45</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">t</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">53</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">1</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">61</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2">9</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">6</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">G</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">14</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">O</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">22</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">W</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">30</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">e</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">38</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">m</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">46</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">u</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">54</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">2</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">62</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">+</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">7</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">H</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">15</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">P</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:8pt;"><span class="font2">23</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">X</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">31</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:center;"><span class="font2">f</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">39</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">n</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:9pt;"><span class="font2">47</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:7pt;"><span class="font2">v</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">55</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">3</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:9pt;"><span class="font2">63</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:right;"><span class="font2">/</span></p></td></tr>
</table></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a href="#bookmark3678"><span class="font24">Figure E-1 </span></a><span class="font24">shows a simple example of base-64 encoding. Here, the three-character input value “Ow!” is base 64–encoded, resulting in the four-character base 64– encoded value “T3ch”. It works like this:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">1. The string “Ow!” is broken into 3 8-bit bytes (0x4F, 0x77, 0x21).</span></p></li>
<li>
<p style="text-align:justify;text-indent:7pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">2. The 3 bytes create the 24-bit binary value 010011110111011100100001.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 3pt 19pt;"><span class="font24">3. These bits are segmented into the 6-bit sequences 010011, 110111, 01110, 100001.</span></p></li>
<li>
<p style="text-align:justify;padding:0pt 0pt 0pt 19pt;"><span class="font24">4. Each of these 6-bit values represents a number from 0 to 63, corresponding to one of 64 characters in the base-64 alphabet. The resulting base 64–encoded string is the 4-character string “T3ch”, which can then be sent across the wire as “safe” 8-bit characters, because only the most portable characters are used (letters, numbers, etc.).</span></p>
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="padding:0pt 0pt 8pt 0pt;"><span class="font28">w</span></p>
<p><span class="font28">$77</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">8-bit characters</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font28">$21</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font1" style="font-style:italic;">8-bit value (hexidecimal)</span></p>
</div><br clear="all"></li></ul>
<div style="border-right:solid;float:left;writing-mode:horizontal-tb;">
<p style="text-align:right;padding:0pt 0pt 19pt 0pt;"><span class="font1" style="font-style:italic;">8-bit value (binary)</span></p>
<p style="text-align:right;padding:0pt 0pt 19pt 0pt;"><span class="font1" style="font-style:italic;">6-bit value (decimal)</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 19pt 0pt;"><span class="font1" style="font-style:italic;">Base-64 character</span></p>
</div>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font28">010011110111011100100001</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font28">19 &nbsp;&nbsp;&nbsp;55 &nbsp;&nbsp;&nbsp;28 &nbsp;&nbsp;&nbsp;33</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font28">T3ch</span></p>
<p style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3678"></a><span class="font23" style="font-style:italic;">Figure E-1. Base-64 encoding example</span></p>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3679"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3680"></a><a name="bookmark3681"></a><a name="bookmark3682"></a>Base-64 Padding</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Base-64 encoding takes a sequence of 8-bit bytes and segments the bit stream into 6-bit chunks. It is unlikely that the sequence of bits will divide evenly into 6-bit pieces. When the bit sequence does not divide evenly into 6-bit pieces, the bit sequence is padded with zero bits at the end to make the length of the bit sequence a multiple of 24 (the least common multiple of 6 and 8 bits).</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">When encoding the padded bit string, any group of 6 bits that is completely padding (containing no bits from the original data) is represented by a special 65th symbol: “=”. If a group of 6 bits is partially padded, the padding bits are set to zero.</span></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3683"><span class="font24">Table E-2 </span></a><span class="font24">shows examples of padding. The initial input string “a:a” is 3 bytes long, or 24 bits. 24 is a multiple of 6 and 8, so no padding is required. The resulting base 64–encoded string is “YTph”.</span></p>
<table border="1">
<tr><td colspan="3" style="vertical-align:top;">
<p><a name="bookmark3683"></a><span class="font23" style="font-style:italic;">Table E-2. Base-64 padding examples</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Input data</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:16pt;"><span class="font2" style="font-weight:bold;">Binary sequence (padding noted as “x”)</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font2" style="font-weight:bold;">Encoded data</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3">a:a</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:16pt;"><span class="font3">011000 010011 101001 100001</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font3">YTph</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><a name="bookmark3684"></a><span class="font3">a:aa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:16pt;"><span class="font3">011000 010011 101001 100001 011000 01xxxx xxxxxx xxxxxx</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font3">YTphYQ==</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3">a:aaa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:16pt;"><span class="font3">011000 010011 101001 100001 011000 010110 0001xx xxxxxx</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font3">YTphYWE=</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font3">a:aaaa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;text-indent:16pt;"><span class="font3">011000 010011 101001 100001 011000 010110 000101 100001</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:12pt;"><span class="font3">YTphYWFh</span></p></td></tr>
</table>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><a name="bookmark3685"></a><span class="font24">However, when another character is added, the input string grows to 32 bits long. The next smallest multiple of 6 and 8 is 48 bits, so 16 bits of padding are added. The first 4 bits of padding are mixed with data bits. The resulting 6-bit group, 01xxxx, is treated as 010000, 16 decimal, or base-64 encoding Q. The remaining two 6-bit groups are all padding and are represented by “=”.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3686"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3687"></a>Perl Implementation</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">MIME::Base64 is a Perl module for base-64 encoding and decoding. You can read about this module at </span><a href="http://www.perldoc.com/perl5.6.1/lib/MIME/Base64.html"><span class="font24" style="font-style:italic;">http://www.perldoc.com/perl5.6.1/lib/MIME/Base64.html</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">You can encode and decode strings using the MIME::Base64 encode_base64 and decode_base64 methods:</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 11pt 0pt;"><span class="font3">use MIME::Base64;</span></p>
<p style="text-align:justify;text-indent:19pt;"><span class="font3">$encoded = encode_base64('Aladdin:open sesame');</span></p>
<p style="text-align:justify;text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">$decoded = decode_base64($encoded);</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark85"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3688"></a>For More Information</span></h2>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">For more information on base-64 encoding, see:</span></p>
<p><a href="http://www.ietf.org/rfc/rfc2045.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2045.txt</span></a></p>
<p style="padding:0pt 0pt 3pt 19pt;"><span class="font24">Section 6.8 of RFC 2045, “MIME Part 1: Format of Internet Message Bodies,” provides an official specification of base-64 encoding.</span></p>
<p><a href="http://www.perldoc.com/perl5.6.1/lib/MIME/Base64.html"><span class="font24" style="font-style:italic;">http://www.perldoc.com/perl5.6.1/lib/MIME/Base64.html</span></a></p>
<p style="padding:0pt 0pt 3pt 19pt;"><span class="font24">This web site contains documentation for the MIME::Base64 Perl module that provides encoding and decoding of base-64 strings.</span></p>
<p style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3689"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3690"></a><a name="bookmark251"></a><a name="bookmark3691"></a>APPENDIX F</span></p>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark3692"></a><span class="font11" style="font-weight:bold;"><a name="bookmark205"></a><a name="bookmark3693"></a>Digest Authentication</span></h1>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">This appendix contains supporting data and source code for implementing HTTP digest authentication facilities.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3694"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3695"></a>Digest WWW-Authenticate Directives</span></h2>
<p style="padding:0pt 0pt 9pt 0pt;"><span class="font24">WWW-Authenticate directives are described in</span><a href="#bookmark3696"><span class="font24"> Table F-1</span></a><span class="font24">, paraphrased from the descriptions in RFC 2617. As always, refer to the official specifications for the most up-to-date details.</span></p>
<p style="padding:0pt 0pt 9pt 0pt;"><a name="bookmark3696"></a><span class="font23" style="font-style:italic;">Table F-1. Digest WWW-Authenticate header directives (from RFC 2617)</span></p>
<p style="text-indent:7pt;padding:0pt 0pt 2pt 0pt;"><span class="font2" style="font-weight:bold;">Directive Description</span></p>
<p style="text-indent:7pt;"><span class="font2">realm &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A string to be displayed to users so they know which username and password to use. This string should</span></p>
<p style="padding:0pt 0pt 2pt 66pt;"><span class="font2">contain at least the name of the host performing the authentication and might additionally indicate the collection of users who might have access. An example might be “registered_users@gotham.news.com”.</span></p>
<div style="float:left;writing-mode:horizontal-tb;">
<p><span class="font2">nonce</span></p>
</div>
<p style="padding:0pt 0pt 2pt 31pt;"><span class="font2">A server-specified data string that should be uniquely generated each time a 401 response is made. It is recommended that this string be base-64 or hexadecimal data. Specifically, because the string is passed in the header lines as a quoted string, the double-quote character is not allowed.</span></p>
<p style="padding:0pt 0pt 2pt 66pt;"><span class="font2">The contents of the nonce are implementation-dependent. The quality of the implementation depends on a good choice. A nonce might, for example, be constructed as the base-64 encoding of:</span></p>
<p style="padding:0pt 0pt 2pt 74pt;"><span class="font3">time-stamp H(time-stamp &quot;:&quot; ETag &quot;:&quot; private-key)</span></p>
<p style="padding:0pt 0pt 2pt 66pt;"><span class="font2">where </span><span class="font3" style="font-style:italic;">time-stamp</span><span class="font2"> is a server-generated time or other nonrepeating value, </span><span class="font3" style="font-style:italic;">ETag</span><span class="font2"> is the value of the HTTP ETag header associated with the requested entity, and </span><span class="font3" style="font-style:italic;">private-key</span><span class="font2"> is data known only to the server. With a nonce of this form, a server would recalculate the hash portion after receiving the client Authentication header and reject the request if it did not match the nonce from that header or if the time-stamp value is not recent enough. In this way, the server can limit the time of the nonce’s validity. The inclusion of the ETag prevents a replay request for an updated version of the resource. (Note: including the IP address of the client in the nonce appears to offer the server the ability to limit the reuse of the nonce to the same client that originally got it. However, that would break proxy farms, where requests from a single user often go through different proxies in the farm. Also, IP address spoofing is not that hard.)</span></p>
<p style="padding:0pt 0pt 4pt 66pt;"><span class="font2">An implementation might choose not to accept a previously used nonce or a previously used digest, to protect against replay attacks, or it might choose to use one-time nonces or digests for POST or PUT requests and time-stamps for GET requests.</span></p>
<table>
<tr><td>
<p><span class="font23" style="font-style:italic;">Table F-1. Digest WWW-Authenticate header directives (from RFC 2617) (continued)</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">domain</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">A quoted, space-separated list of URIs (as specified in RFC 2396, “Uniform Resource Identifiers: Generic Syntax”) that define the protection space. Ifa URI is an abs_path, it is relative to the canonical root URL of the server being accessed. An absolute URI in this list may refer to a different server than the one being accessed.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The client can use this list to determine the set of URIs for which the same authentication information may be sent: any URI that has a URI in this list as a prefix (after both have been made absolute) may be assumed to be in the same protection space.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">If this directive is omitted or its value is empty, the client should assume that the protection space consists of all URIs on the responding server.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">This directive is not meaningful in Proxy-Authenticate headers, for which the protection space is always the entire proxy; if present, it should be ignored.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">opaque</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">A string of data, specified by the server, that should be returned by the client unchanged in the Authorization header of subsequent requests with URIs in the same protection space. It is recommended that this string be base-64 or hexadecimal data.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">stale</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">A flag indicating that the previous request from the client was rejected because the nonce value was stale. If stale is TRUE (case-insensitive), the client may want to retry the request with a new encrypted response, without reprompting the user for a new username and password. The server should set stale to TRUE only if it receives a request for which the nonce is invalid but has a valid digest (indicating that the client knows the correct username/password). If stale is FALSE, or anything other than TRUE, or the stale directive is not present, the username and/or password are invalid, and new values must be obtained.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">algorithm</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">A string indicating a pair of algorithms used to produce the digest and a checksum. If this is not present, it is assumed to be “MD5”. If the algorithm is not understood, the challenge should be ignored (and a different one used, if there is more than one).</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">In this document, the string obtained by applying the digest algorithm to the data “data” with secret “secret” will be denoted by “KD(secret, data)”, and the string obtained by ap<a name="bookmark3697"></a>plying the checksum algorithm to the data “data” will be denoted “H(data)”. The notation “unq(X)” means the value of the quoted string “X” without the surrounding quotes.</span></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">For the MD5 and MD5-sess algorithms:</span></p>
<p style="text-indent:14pt;"><span class="font3">H(data) = MD5(data)</span></p>
<p style="text-indent:14pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">HD(secret, data) = H(concat(secret, &quot;:&quot;, data))</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">I.e., the digest is the MD5 of the secret concatenated with a colon concatenated with the data. The MD5-sess algorithm is intended to allow efficient third-party authentication servers.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3698"></a><span class="font2">qop</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">This directive is optional but is made so only for backward compatibility with RFC 2069 [6]; it should be used by all implementations compliant with this version of the digest scheme.</span></p>
<p><span class="font2">If present, it is a quoted string of one or more tokens indicating the “quality of protection” values supported by the server. The value “auth” indicates authentication; the value “auth-int” indicates authentication with integrity protection. Unrecognized options must be ignored.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">&lt;extension&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This directive allows for future extensions. Any unrecognized directives must be ignored.</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3699"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3700"></a>Digest Authorization Directives</span></h2>
<p style="text-align:justify;padding:0pt 0pt 9pt 0pt;"><span class="font24">Each of the Authorization directives is described in</span><a href="#bookmark3701"><span class="font24"> Table F-2</span></a><span class="font24">, paraphrased from the descriptions in RFC 2617. Refer to the official specifications for the most up-to-date details.</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">username</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The user’s name in the specified realm.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">realm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The realm passed to the client in the WWW-Authenticate header.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">nonce</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The same nonce passed to the client in the WWW-Authenticate header.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">uri</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The URI from the request URI of the request line; duplicated because proxies are allowed to change the request line in transit, and we may need the original URI for proper digest verification calculations.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">response</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This is the actual digest—the whole point of digest authentication! The response is a string of 32 hexadecimal digits, computed by a negotiated digest algorithm, which proves that the user knows the password.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">algorithm</span></p></td><td style="vertical-align:top;">
<p><span class="font2">A string indicating a pair of algorithms used to produce the digest and a checksum. If this is not present, it is assumed to be “MD5”.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">opaque</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">A string of data, specified by the server in a WWW-Authenticate header, that should be returned by the client unchanged in the Authorization header of subsequent requests with URIs in the same protection space.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">cnonce</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">This must be specified if a qop directive is sent and must not be specified if the server did not send a qop directive in the WWW-Authenticate header field.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The cnonce value is an opaque quoted string value provided by the client and used by both client and server to avoid chosen plaintext attacks, to provide mutual authentication, and to provide some messageintegrity protection.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">See the descriptions of the response-digest and request-digest calculations later in this appendix.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">qop</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Indicates what “quality of protection” the client has applied to the message. If present, its value must be one of the alternatives the server indicated it supports in the WWW-Authenticate header. These values affect the computation of the request digest.</span></p>
<p><span class="font2">This is a single token, not a quoted list of alternatives, as in WWW-Authenticate.</span></p>
<p><span class="font2">This directive is optional, to preserve backward compatibility with a minimal implementation of RFC 2069, but it should be used if the server indicated that qop is supported by providing a qop directive in the WWW-Authenticate header field.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3702"></a><span class="font2">nc</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">This must be specified if a qop directive is sent and must not be specified if the server did not send a qop directive in the WWW-Authenticate header field.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The value is the hexadecimal count of the number of requests (including the current request) that the client has sent with the nonce value in this request. For example, in the first request sent in response to a given nonce value, the client sends nc=“00000001”.</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">The purpose of this directive is to allow the server to detect request replays by maintaining its own copy of this count—if the same nc value is seen twice, the request is a replay.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">&lt;extension&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This directive allows for future extensions. Any unrecognized directive must be ignored.</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3703"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3704"></a>Digest Authentication-Info Directives</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><span class="font24">Each of the Authentication-Info directives is described in </span><a href="#bookmark3705"><span class="font24">Table F-3</span></a><span class="font24">, paraphrased from the descriptions in RFC 2617. Refer to the official specifications for the most up-to-date details.</span></p>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Directive</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">nextnonce</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">The value of the nextnonce directive is the nonce the server wants the client to use for a future authentication response. The server may send the Authentication-Info header with a nextnonce field as a means of implementing one-time or otherwise changing nonces. If the nextnonce field is present the client should use it when constructing the Authorization header for its next request. Failure of the client to do so may result in a reauthentication request from the server with “stale=TRUE”.</span></p>
<p style="text-align:justify;"><span class="font2">Server implementations should carefully consider the performance implications of the use of this mechanism; pipelined requests will not be possible if every response includes a nextnonce directive that must be used on the next request received by the server. Consideration should be given to the performance versus security trade-offs of allowing an old nonce value to be used for a limited time to permit request pipelining. Use of the nonce count can retain most of the security advantages of a new server nonce without the deleterious effects on pipelining.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">qop</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">Indicates the “quality of protection” options applied to the response by the server. The value “auth” indicates authentication; the value “auth-int” indicates authentication with integrity protection. The server should use the same value for the qop directive in the response as was sent by the client in the corresponding request.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">rspauth</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font2">The optional response digest in the “response auth” directive supports mutual authentication—the server proves that it knows the user’s secret, and, with qop=“auth-int”, it also provides limited integrity protection of the response. The “response-digest” value is calculated as for the “request-digest” in the Authorization header, except that if qop=“auth” or qop is not specified in the Authorization header for the request, A2 is:</span></p>
<p style="text-indent:14pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">A2 = &quot;:&quot; digest-uri-value</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">and if qop=“auth-int”, A2 is:</span></p>
<p style="text-indent:14pt;padding:0pt 0pt 2pt 0pt;"><span class="font3">A2 = &quot;:&quot; digest-uri-value &quot;:&quot; H(entity-body)</span></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font2">where </span><span class="font3" style="font-style:italic;">digest-uri-value</span><span class="font2"> is the value of the uri directive on the Authorization header in the request. The cnonce and nc values must be the same as the ones in the client request to which this message is a response. The rspauth directive must be present if qop=“auth” or qop=“auth-int” is specified.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark3706"></a><span class="font2"><a name="bookmark3707"></a>cnonce</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The cnonce value must be the same as the one in the client request to which this message is a response. The cnonce directive must be present if qop=“auth” or qop=“auth-int” is specified.</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">nc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The nc value mustbethesameastheone in the client request to which this message is a response. The nc directive must be present if qop=“auth” or qop=“auth-int” is specified.</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">&lt;extension&gt;</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This directive allows for future extensions. Any unrecognized directive must be ignored.</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3708"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3709"></a>Reference Code</span></h2>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font24">The following code implements the calculations of H(A1), H(A2), request-digest, and response-digest, from RFC 2617. It uses the MD5 implementation from RFC 1321.</span></p>
<h3 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3710"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3711"></a>File “digcalc.h”</span></h3>
<p><span class="font3">#define HASHLEN 16</span></p>
<p><span class="font3">typedef char HASH[HASHLEN];</span></p>
<p><span class="font3">#define HASHHEXLEN 32</span></p>
<p><span class="font3">typedef char HASHHEX[HASHHEXLEN+1];</span></p>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font3">#define IN</span></p>
<p><span class="font3">#define OUT</span></p>
<p><span class="font3">/* calculate H(A1) as per HTTP Digest spec */ void DigestCalcHA1(</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszAlg,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszUserName,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszRealm,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszPassword,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszNonce,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszCNonce,</span></p>
<p style="text-indent:17pt;"><span class="font3">OUT HASHHEX SessionKey</span></p>
<p style="text-indent:17pt;"><a name="bookmark3712"></a><span class="font3">);</span></p>
<table cellpadding="5pt">
<tr>
<td valign="top" style="width:46%;">
<div style="display:inline;writing-mode:horizontal-tb;">
<p><span class="font3">/* calculate request-digest/response-digest as per HTTP Digest spec */</span></p>
</div><br clear="all">
<div style="display:inline;writing-mode:horizontal-tb;">
<p style="text-align:center;"><span class="font3">void DigestCalcResponse(</span></p>
</div><br clear="all">
<p style="text-align:justify;padding:0pt 0pt 0pt 17pt;"><span class="font3">IN HASHHEX HA1, /* IN char * pszNonce, /* IN char * pszNonceCount, /* IN char * pszCNonce, /* IN char * pszQop, /* IN char * pszMethod, /* IN char * pszDigestUri, /* IN HASHHEX HEntity, /* OUT HASHHEX Response /* );</span></p></td>
<td valign="top" style="width:53%;">
<p><span class="font3">H(A1) */</span></p>
<p><span class="font3">nonce from server */</span></p>
<p><span class="font3">8 hex digits */</span></p>
<p><span class="font3">client nonce */</span></p>
<p><span class="font3">qop-value: &quot;&quot;, &quot;auth&quot;, &quot;auth-int&quot; */</span></p>
<p><span class="font3">method from the request */</span></p>
<p><span class="font3">requested URL */</span></p>
<p><span class="font3">H(entity body) if qop=&quot;auth-int&quot; */ request-digest or response-digest */</span></p></td></tr></table><hr>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3713"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3714"></a>File “digcalc.c”</span></h3>
<p><span class="font3">#include &lt;global.h&gt;</span></p>
<p><span class="font3">#include &lt;md5.h&gt;</span></p>
<p><span class="font3">#include &lt;string.h&gt;</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font3">#include &quot;digcalc.h&quot;</span></p>
<p><span class="font3">void CvtHex(</span></p>
<p style="text-indent:17pt;"><span class="font3">IN HASH Bin,</span></p>
<p style="text-indent:17pt;"><span class="font3">OUT HASHHEX Hex</span></p>
<p style="text-indent:17pt;"><span class="font3">)</span></p>
<p><span class="font3">{</span></p>
<p style="text-indent:17pt;"><span class="font3">unsigned short i;</span></p>
<p style="text-indent:17pt;"><span class="font3">unsigned char j;</span></p>
<p style="text-indent:17pt;"><span class="font3">for (i = 0; i &lt;&nbsp;HASHLEN; i++) {</span></p>
<p style="text-align:justify;text-indent:33pt;"><span class="font3">j = (Bin[i] &gt;&gt;&nbsp;4) &amp;&nbsp;0xf;</span></p>
<p style="text-align:justify;text-indent:33pt;"><span class="font3">if (j &lt;= 9)</span></p>
<p style="text-indent:49pt;"><span class="font3">Hex[i*2] = (j + '0');</span></p>
<p style="text-indent:37pt;"><span class="font3">else</span></p>
<p style="text-indent:49pt;"><span class="font3">Hex[i*2] = (j + 'a' - 10);</span></p>
<p style="text-indent:33pt;"><span class="font3">j = Bin[i] &amp;&nbsp;0xf;</span></p>
<p style="text-align:justify;text-indent:33pt;"><span class="font3">if (j &lt;= 9)</span></p>
<p style="text-indent:49pt;"><span class="font3">Hex[i*2+1] = (j + '0');</span></p>
<p style="text-indent:37pt;"><span class="font3">else</span></p>
<p style="text-indent:49pt;"><span class="font3">Hex[i*2+1] = (j + 'a' - 10);</span></p>
<p style="text-indent:17pt;"><span class="font3">};</span></p>
<p style="text-indent:17pt;"><span class="font3">Hex[HASHHEXLEN] = '\0';</span></p>
<p><span class="font3">};</span></p>
<p><span class="font3">/* calculate H(A1) as per spec */ void DigestCalcHA1(</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszAlg,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszUserName,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszRealm,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszPassword,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszNonce,</span></p>
<p style="text-indent:17pt;"><span class="font3">IN char * pszCNonce,</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 17pt;"><span class="font3">OUT HASHHEX SessionKey )</span></p>
<p><span class="font3">{</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5_CTX Md5Ctx;</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">HASH HA1;</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Init(&amp;Md5Ctx);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszUserName, strlen(pszUserName));</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszRealm, strlen(pszRealm));</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszPassword, strlen(pszPassword));</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Final(HA1, &amp;Md5Ctx);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">if (stricmp(pszAlg, &quot;md5-sess&quot;) == 0) {</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Init(&amp;Md5Ctx);</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, HA1, HASHLEN);</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszNonce, strlen(pszNonce));</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszCNonce, strlen(pszCNonce));</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Final(HA1, &amp;Md5Ctx);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">};</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">CvtHex(HA1, SessionKey);</span></p>
<p><span class="font3">};</span></p>
<p><span class="font3">/* calculate request-digest/response-digest as per HTTP Digest spec */ void DigestCalcResponse(</span></p>
<p style="text-indent:17pt;"><a href="#bookmark3715"><span class="font3">IN HASHHEX HA1,</span></a></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font3">H(A1) */</span></p>
<p><span class="font3">nonce from server */</span></p>
<p><span class="font3">8 hex digits */</span></p>
<p><span class="font3">client nonce */</span></p>
<p><span class="font3">qop-value: &quot;&quot;, &quot;auth&quot;, &quot;auth-int&quot; */</span></p>
<p><span class="font3">method from the request */</span></p>
<p><span class="font3">requested URL */</span></p>
<p><span class="font3">H(entity body) if qop=&quot;auth-int&quot; */ request-digest or response-digest */</span></p>
</div>
<p style="text-indent:17pt;"><a href="#bookmark3716"><span class="font3">IN char * pszNonce,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3717"><span class="font3">IN char * pszNonceCount,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3718"><span class="font3">IN char * pszCNonce,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3719"><span class="font3">IN char * pszQop,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3720"><span class="font3">IN char * pszMethod,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3721"><span class="font3">IN char * pszDigestUri,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3722"><span class="font3">IN HASHHEX HEntity,</span></a></p>
<p style="text-indent:17pt;"><a href="#bookmark3723"><span class="font3">OUT HASHHEX Response</span></a></p>
<p style="text-indent:17pt;padding:0pt 0pt 3pt 0pt;"><span class="font3">)</span></p>
<p><span class="font3">{</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5_CTX Md5Ctx;</span></p>
<p style="text-indent:25pt;"><span class="font3">HASH HA2;</span></p>
<p style="text-indent:25pt;"><span class="font3">HASH RespHash;</span></p>
<p style="text-align:justify;text-indent:29pt;"><span class="font3">HASHHEX HA2Hex;</span></p>
<p style="text-indent:25pt;"><span class="font3">// calculate H(A2)</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Init(&amp;Md5Ctx);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszMethod, strlen(pszMethod));</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszDigestUri, strlen(pszDigestUri));</span></p>
<p style="text-align:justify;text-indent:25pt;"><span class="font3">if (stricmp(pszQop, &quot;auth-int&quot;) == 0) {</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:49pt;"><span class="font3">MD5Update(&amp;Md5Ctx, HEntity, HASHHEXLEN);</span></p>
<p style="text-indent:25pt;"><span class="font3">};</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Final(HA2, &amp;Md5Ctx);</span></p>
<p style="text-indent:29pt;"><span class="font3">CvtHex(HA2, HA2Hex);</span></p>
<p style="text-indent:25pt;"><span class="font3">// calculate response</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Init(&amp;Md5Ctx);</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, HA1, HASHHEXLEN);</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszNonce, strlen(pszNonce));</span></p>
<p style="text-indent:25pt;"><a name="bookmark3724"></a><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:25pt;"><span class="font3">if (*pszQop) {</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszNonceCount, strlen(pszNonceCount));</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszCNonce, strlen(pszCNonce));</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, pszQop, strlen(pszQop));</span></p>
<p style="text-indent:41pt;"><span class="font3">MD5Update(&amp;Md5Ctx, &quot;:&quot;, 1);</span></p>
<p style="text-indent:25pt;"><span class="font3">};</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Update(&amp;Md5Ctx, HA2Hex, HASHHEXLEN);</span></p>
<p style="text-indent:25pt;"><span class="font3">MD5Final(RespHash, &amp;Md5Ctx);</span></p>
<p style="text-indent:25pt;"><span class="font3">CvtHex(RespHash, Response);</span></p>
<p style="padding:0pt 0pt 15pt 0pt;"><span class="font3">};</span></p>
<h3 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3725"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3726"></a>File “digtest.c”</span></h3>
<p><span class="font3">#include &lt;stdio.h&gt;</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><span class="font3">#include &quot;digcalc.h&quot;</span></p>
<p><span class="font3">void main(int argc, char ** argv) {</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszNonce = &quot;dcd98b7102dd2f0e8b11d0f600bfb0c093&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszCNonce = &quot;0a4f113b&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszUser = &quot;Mufasa&quot;;</span></p>
<p style="text-indent:25pt;"><a name="bookmark3727"></a><span class="font3">char * pszRealm = &quot;</span><a href="mailto:testrealm@host.com"><span class="font3">testrealm@host.com</span></a><span class="font3">&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszPass = &quot;Circle Of Life&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszAlg = &quot;md5&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char szNonceCount[9] = &quot;00000001&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszMethod = &quot;GET&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszQop = &quot;auth&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">char * pszURI = &quot;/dir/index.html&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">HASHHEX HA1;</span></p>
<p style="text-indent:25pt;"><span class="font3">HASHHEX HA2 = &quot;&quot;;</span></p>
<p style="text-indent:25pt;"><span class="font3">HASHHEX Response;</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 41pt;"><span class="font3">DigestCalcHA1(pszAlg, pszUser, pszRealm, pszPass, pszNonce, pszCNonce, HA1);</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 41pt;"><span class="font3">DigestCalcResponse(HA1, pszNonce, szNonceCount, pszCNonce, pszQop, pszMethod, pszURI, HA2, Response);</span></p>
<p style="text-indent:25pt;"><span class="font3">printf(&quot;Response = %s\n&quot;, Response);</span></p>
<p><span class="font3">};</span></p>
<h1 style="text-align:right;padding:0pt 0pt 114pt 0pt;"><a name="bookmark252"></a><span class="font11" style="font-weight:bold;"><a name="bookmark206"></a><a name="bookmark3728"></a>Language Tags</span></h1>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark3729"></a><span class="font24"><a name="bookmark3730"></a><a name="bookmark3731"></a>Language tags are short, standardized strings that name spoken languages—for example, “fr” (French) and “en-GB” (Great Britain English). Each tag has one or more parts, separated by hyphens, called </span><span class="font24" style="font-style:italic;">subtags</span><span class="font24">. Language tags were described in detail in the section</span><a href="#bookmark2679"><span class="font24"> “Language Tags and HTTP” in Chapter 16</span></a><span class="font24">.</span></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><a name="bookmark3732"></a><span class="font24">This appendix summarizes the rules, standardized tags, and registration information for language tags. It contains the following reference material:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Rules for the first (primary) subtag are summarized in</span><a href="#bookmark3733"><span class="font24"> “First Subtag Rules</span></a><span class="font24">.”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Rules for the second subtag are summarized in</span><a href="#bookmark3734"><span class="font24"> “Second Subtag Rules</span></a><span class="font24">.”</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• IANA-registered language tags are shown in </span><a href="#bookmark3735"><span class="font24">Table G-1</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• ISO 639 language codes are shown in</span><a href="#bookmark3736"><span class="font24"> Table G-2</span></a><span class="font24">.</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 15pt 0pt;"><span class="font24">• ISO 3166 country codes are shown in </span><a href="#bookmark3737"><span class="font24">Table G-3</span></a><span class="font24">.</span></p></li></ul>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3733"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3738"></a><a name="bookmark3739"></a>First Subtag Rules</span></h2>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">If the first subtag is:</span></p>
<ul style="list-style:none;"><li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Two characters long, it’s a language code from the ISO 639<a name="footnote167"></a><sup><a href="#bookmark3740">167</a></sup><sup></sup> and 639-1 standards</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• Three characters long, it’s a language code listed in the ISO 639-2<a name="footnote168"></a><sup><a href="#bookmark3741">168</a></sup><sup></sup> standard</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The letter “i,” the language tag is explicitly IANA-registered</span></p></li>
<li>
<p style="text-align:justify;text-indent:8pt;padding:0pt 0pt 3pt 0pt;"><span class="font24">• The letter “x,” the language tag is a private, nonstandard, extension subtag</span></p></li></ul>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font24">The ISO 639 and 639-2 names are summarized in </span><a href="#bookmark3736"><span class="font24">Table G-2</span></a><span class="font24">.</span></p>
<h2 style="padding:0pt 0pt 6pt 0pt;"><a name="bookmark3734"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3742"></a><a name="bookmark3743"></a><a name="bookmark3744"></a>Seco<a name="bookmark2731"></a>nd Subt<a name="bookmark3745"></a>ag Rules</span></h2>
<p style="padding:0pt 0pt 4pt 0pt;"><span class="font24">If the second subtag is:</span></p>
<ul style="list-style:none;"><li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Two characters long, it’s a country/region defined by ISO 3166<a name="footnote169"></a><sup><a href="#bookmark3746">169</a></sup><sup></sup></span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• Three to eight characters long, it may be registered with the IANA</span></p></li>
<li>
<p style="text-indent:8pt;padding:0pt 0pt 4pt 0pt;"><span class="font24">• One character long, it is illegal</span></p></li></ul>
<p style="padding:0pt 0pt 16pt 0pt;"><span class="font24">The ISO 3166 country codes are summarized in </span><a href="#bookmark3737"><span class="font24">Table G-3</span></a><span class="font24">.</span></p>
<h2 style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark3747"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3748"></a>IANA-Registered Language Tags</span></h2>
<table>
<tr><td>
<p><a name="bookmark3735"></a><span class="font23" style="font-style:italic;">Table G-1. Language tags</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">IANA language tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-bnn</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Bunun</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">i-default</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Default language context</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-hak</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Hakka</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">i-klingon</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Klingon</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-lux</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Luxembourgish</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">i-mingo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Mingo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">i-navajo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Navajo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-pwn</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Paiwan</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-tao</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Tao</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">i-tay</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Tayal</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">i-tsu</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Tsou</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">no-bok</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Norwegian “Book language”</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">no-nyn</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Norwegian “New Norwegian”</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-gan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Kan or Gan</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-guoyu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Mandarin or Standard Chinese</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">zh-hakka</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Hakka</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-min</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Min, Fuzhou, Hokkien, Amoy, or Taiwanese</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-wuu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Shanghaiese or Wu</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-xiang</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Xiang or Hunanese</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">zh-yue</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Cantonese</span></p></td></tr>
</table></td></tr>
</table>
<h2 style="padding:0pt 0pt 13pt 0pt;"><a name="bookmark2732"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3749"></a><a name="bookmark3750"></a><a name="bookmark3751"></a>ISO 639 Language Codes</span></h2>
<table>
<tr><td>
<p><a name="bookmark3736"></a><span class="font23" style="font-style:italic;">Table G-2. ISO 639 and 639-2 language codes</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Abkhazian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ab</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">abk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Achinese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ace</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Acoli</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ach</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Adangme</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ada</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Afar</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">aa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">aar</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Afrihili</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">afh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Afrikaans</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">af</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">afr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Afro-Asiatic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">afa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Akan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">aka</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Akkadian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">akk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Albanian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sq</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">alb/sqi</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Aleut</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ale</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Algonquian languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">alg</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Altaic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tut</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Amharic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">am</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">amh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Apache languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">apa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Arabic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ar</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ara</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Aramaic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">arc</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Arapaho</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">arp</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Araucanian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">arn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Arawak</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">arw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Armenian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">hy</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">arm/hye</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Artificial (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">art</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Assamese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">as</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">asm</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Athapascan languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ath</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Austronesian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">map</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Avaric</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ava</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Avestan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ave</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Awadhi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">awa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Aymara</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ay</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">aym</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Azerbaijani</span></p></td><td style="vertical-align:top;">
<p><span class="font2">az</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">aze</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Aztec</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">nah</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Balinese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ban</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Baltic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bat</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Baluchi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bal</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bambara</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bamileke languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bai</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Banda</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bad</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bantu (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bnt</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Basa</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bas</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bashkir</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ba</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bak</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Basque</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">eu</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">baq/eus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Beja</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bej</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bemba</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bem</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bengali</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">bn</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ben</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Berber (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ber</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bhojpuri</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bho</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bihari</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bh</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bih</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bikol</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bik</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bini</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bin</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bislama</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bi</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bis</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Braj</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bra</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Breton</span></p></td><td style="vertical-align:top;">
<p><span class="font2">be</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bre</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Buginese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bug</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bulgarian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bg</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bul</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Buriat</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bua</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Burmese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">my</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">bur/mya</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Byelorussian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">be</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">bel</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Caddo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">cad</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Carib</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">car</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Catalan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ca</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cat</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Caucasian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cau</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cebuano</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ceb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Celtic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cel</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Central American Indian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Chagatai</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">chg</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Chamorro</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">cha</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Chechen</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">che</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Cherokee</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">chr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cheyenne</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">chy</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Chibcha</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">chb</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Chinese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">zh</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">chi/zho</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Chinook jargon</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">chn</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Choctaw</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">cho</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Church Slavic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">chu</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Chuvash</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">chv</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Coptic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cop</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cornish</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Corsican</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">co</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cos</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cree</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cre</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Creek</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Creoles and Pidgins (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">crp</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Creoles and Pidgins, English-based (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cpe</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Creoles and Pidgins, French-based (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cpf</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Creoles and Pidgins, Portuguese-based (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cpp</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Cushitic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cus</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Croatian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hr</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Czech</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cs</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ces/cze</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Dakota</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">dak</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Danish</span></p></td><td style="vertical-align:top;">
<p><span class="font2">da</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dan</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Delaware</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">del</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Dinka</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">din</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Divehi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">div</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Dogri</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">doi</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Dravidian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">dra</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Duala</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">dua</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Dutch</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">nl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">dut/nla</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Dutch, Middle (ca. 1050-1350)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">dum</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Dyula</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">dyu</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Dzongkha</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dz</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dzo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Efik</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">efi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Egyptian (Ancient)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">egy</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ekajuk</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">eka</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Elamite</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">elx</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">English</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">en</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">eng</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">English, Middle (ca. 1100-1500)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">enm</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">English, Old (ca. 450-1100)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ang</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Eskimo (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">esk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Esperanto</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">eo</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">epo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Estonian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">et</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">est</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ewe</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ewe</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ewondo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ewo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Fang</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fan</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Fanti</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">fat</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Faroese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fo</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">fao</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Fijian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">fj</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fij</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Finnish</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fi</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">fin</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Finno-Ugrian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fiu</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Fon</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">fon</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">French</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">fr</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fra/fre</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">French, Middle (ca. 1400-1600)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">frm</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">French, Old (842- ca. 1400)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fro</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Frisian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">fy</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">fry</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Fulah</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ful</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ga</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gaa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gaelic (Scots)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gae/gdh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gallegan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gl</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">glg</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Ganda</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">lug</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gayo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gay</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Geez</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gez</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Georgian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ka</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">geo/kat</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">German</span></p></td><td style="vertical-align:top;">
<p><span class="font2">de</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">deu/ger</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">German, Middle High (ca. 1050-1500)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gmh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">German, Old High (ca. 750-1050)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">goh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Germanic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gem</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gilbertese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gil</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gondi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gon</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gothic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">got</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Grebo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">grb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Greek, Ancient (to 1453)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">grc</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Greek, Modern (1453-)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">el</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ell/gre</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Greenlandic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kl</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">kal</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guarani</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gn</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">grn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gujarati</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">gu</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">guj</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Haida</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">hai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hausa</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ha</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">hau</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hawaiian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">haw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hebrew</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">he</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">heb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Herero</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">her</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hiligaynon</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">hil</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Himachali</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">him</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hindi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">hi</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">hin</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hiri Motu</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">hmo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Hungarian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">hu</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">hun</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hupa</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">hup</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iban</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">iba</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Icelandic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">is</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ice/isl</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Igbo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ibo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ijo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ijo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iloko</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ilo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Indic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">inc</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Indo-European (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ine</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Indonesian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">id</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ind</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Interlingua (IALA)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ina</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Interlingue</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ie</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ine</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Inuktitut</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iu</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">iku</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Inupiak</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ik</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ipk</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iranian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ira</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Irish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ga</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">gai/iri</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Irish, Old (to 900)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sga</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Irish, Middle (900 - 1200)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mga</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iroquoian languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">iro</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Italian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">it</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ita</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Japanese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ja</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">jpn</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Javanese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">jv/jw</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">jav/jaw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Judeo-Arabic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">jrb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Judeo-Persian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">jpr</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Kabyle</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">kab</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kachin</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kac</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kamba</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kannada</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">kn</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">kan</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kanuri</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kau</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kara-Kalpak</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kaa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Karen</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kar</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kashmiri</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ks</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">kas</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kawi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kaw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kazakh</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">kk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">kaz</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Khasi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kha</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Khmer</span></p></td><td style="vertical-align:top;">
<p><span class="font2">km</span></p></td><td style="vertical-align:top;">
<p><span class="font2">khm</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Khoisan (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">khi</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Khotanese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kho</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kikuyu</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kik</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kinyarwanda</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rw</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kin</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kirghiz</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ky</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kir</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Komi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kom</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kongo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kon</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Konkani</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kok</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Korean</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ko</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kpelle</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kpe</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kru</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kro</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kuanyama</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kua</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kumyk</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">kum</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Kurdish</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ku</span></p></td><td style="vertical-align:top;">
<p><span class="font2">kur</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kurukh</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kru</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kusaie</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Kutenai</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">kut</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ladino</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">lad</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Lahnda</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">lah</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Lamba</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">lam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Langue d’Oc (post-1500)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">oc</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">oci</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Lao</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lao</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Latin</span></p></td><td style="vertical-align:top;">
<p><span class="font2">la</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lat</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Latvian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lv</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lav</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Letzeburgesch</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">ltz</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Lezghian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">lez</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Lingala</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ln</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lin</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Lithuanian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lt</span></p></td><td style="vertical-align:top;">
<p><span class="font2">lit</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Lozi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">loz</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Luba-Katanga</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">lub</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Luiseno</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">lui</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Lunda</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">lun</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Luo (Kenya and Tanzania)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">luo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Macedonian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mk</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mac/mak</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Madurese</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mad</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Magahi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mag</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Maithili</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Makasar</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mak</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Malagasy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mlg</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Malay</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ms</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">may/msa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Malayalam</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mal</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Maltese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ml</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mlt</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mandingo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">man</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Manipuri</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mni</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Manobo languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mno</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Manx</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">max</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Maori</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mao/mri</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Marathi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mar</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mari</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">chm</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Marshall</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mah</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Marwari</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mwr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Masai</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mas</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mayan languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">myn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mende</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">men</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Micmac</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mic</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Minangkabau</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">min</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Miscellaneous (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">mis</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Mohawk</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">moh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Moldavian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mol</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mon-Kmer (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">mkh</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Mongo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">lol</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mongolian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">mn</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mon</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Mossi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mos</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Multiple languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mul</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Munda languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">mun</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nauru</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">na</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nau</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Navajo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nav</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ndebele, North</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">nde</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ndebele, South</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nbl</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ndongo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ndo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nepali</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ne</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nep</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Newari</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">new</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Niger-Kordofanian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nic</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nilo-Saharan (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ssa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Niuean</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">niu</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Norse, Old</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">non</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">North American Indian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Norwegian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">no</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Norwegian (Nynorsk)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nno</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Nubian languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">nub</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nyamwezi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nym</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nyanja</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nya</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nyankole</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nyn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Nyoro</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">nyo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Nzima</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">nzi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ojibwa</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">oji</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Oriya</span></p></td><td style="vertical-align:top;">
<p><span class="font2">or</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ori</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Oromo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">om</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">orm</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Osage</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">osa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ossetic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">oss</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Otomian languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">oto</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Pahlavi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pal</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Palauan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pau</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Pali</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pli</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Pampanga</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Pangasinan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pag</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Panjabi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">pa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pan</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Papiamento</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pap</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Papuan-Australian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">paa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Persian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">fa</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">fas/per</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Persian, Old (ca 600 - 400 B.C.)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">peo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Phoenician</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">phn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Polish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">pl</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pol</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ponape</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pon</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Portuguese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">pt</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">por</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Prakrit languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pra</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Provencal, Old (to 1500)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pro</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Pushto</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ps</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">pus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Quechua</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">qu</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">que</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Rhaeto-Romance</span></p></td><td style="vertical-align:top;">
<p><span class="font2">rm</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">roh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Rajasthani</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">raj</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Rarotongan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">rar</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Romance (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">roa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Romanian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ro</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ron/rum</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Romany</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">rom</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Rundi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">rn</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">run</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Russian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ru</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">rus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Salishan languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sal</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Samaritan Aramaic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sami languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">smi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Samoan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sm</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">smo</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sandawe</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">sad</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sango</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sg</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sag</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sanskrit</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">san</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sardinian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">srd</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Scots</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sco</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Selkup</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sel</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Semitic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">sem</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Serbian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sr</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Serbo-Croatian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sh</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">scr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Serer</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">srr</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Shan</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">shn</span></p></td></tr>
<tr><td style="vertical-align:middle;">
<p style="text-indent:7pt;"><span class="font2">Shona</span></p></td><td style="vertical-align:middle;">
<p><span class="font2">sn</span></p></td><td style="vertical-align:middle;">
<p style="text-align:justify;"><span class="font2">sna</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sidamo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">sid</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Siksika</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">bla</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sindhi</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sd</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">snd</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Singhalese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">si</span></p></td><td style="vertical-align:top;">
<p><span class="font2">sin</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sino-Tibetan (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">sit</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Siouan languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">sio</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Slavic (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">sla</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Siswant</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ss</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ssw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Slovak</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">slk/slo</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Slovenian</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">slv</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sogdian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">sog</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Somali</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">so</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">som</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Songhai</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">son</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sorbian languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">wen</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sotho, Northern</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">nso</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sotho, Southern</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">st</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sot</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">South American Indian (Other)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">sai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Spanish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">es</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">esl/spa</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sukuma</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">suk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sumerian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">sux</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Sudanese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">su</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sun</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Susu</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">sus</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Swahili</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sw</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">swa</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Swazi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">ssw</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Swedish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sv</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">sve/swe</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Syriac</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">syr</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tagalog</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tl</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tgl</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tahitian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">tah</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tajik</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tgk</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tamashek</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">tmh</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tamil</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ta</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tam</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tatar</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tat</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Telugu</span></p></td><td style="vertical-align:top;">
<p><span class="font2">te</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tel</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tereno</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">ter</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Thai</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">th</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tha</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tibetan</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bo</span></p></td><td style="vertical-align:top;">
<p><span class="font2">bod/tib</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tigre</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tig</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tigrinya</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ti</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tir</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Timne</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tem</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tivi</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tiv</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tlingit</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tli</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tonga (Nyasa)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">to</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tog</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tonga (Tonga Islands)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ton</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Truk</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tru</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tsimshian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tsi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tsonga</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ts</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tso</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tswana</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tn</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tsn</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tumbuka</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tum</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Turkish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">tr</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tur</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Turkish, Ottoman (1500–1928)</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ota</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Turkmen</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tk</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">tuk</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tuvinian</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">tyv</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Twi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">tw</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">twi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Ugaritic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">uga</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Uighur</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ug</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">uig</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ukrainian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">uk</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ukr</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Umbundu</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">umb</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Undetermined</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">und</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Urdu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ur</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">urd</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Uzbek</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">uz</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">uzb</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Vai</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">vai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Venda</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ven</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Vietnamese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">vi</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">vie</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Volapük</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">vo</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">vol</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Votic</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">vot</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Wakashan languages</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">wak</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Walamo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">wal</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Waray</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">war</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Washo</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">was</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Welsh</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cy</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">cym/wel</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Wolof</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">wo</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">wol</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Xhosa</span></p></td><td style="vertical-align:top;">
<p><span class="font2">xh</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">xho</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Language</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">ISO 639</span></p></td><td style="vertical-align:bottom;">
<p><a name="bookmark3752"></a><span class="font2" style="font-weight:bold;">ISO 639-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Yakut</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">sah</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Yao</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">yao</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Yap</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">yap</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><a name="bookmark2733"></a><span class="font2">Yiddish</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><a name="bookmark3753"></a><span class="font2">yi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">yid</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Yoruba</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">yo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">yor</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Zapotec</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">zap</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Zenaga</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">zen</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Zhuang</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">za</span></p></td><td style="vertical-align:top;">
<p><span class="font2">zha</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Zulu</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">zu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">zul</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Zuni</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">zun</span></p></td></tr>
<tr><td colspan="2" style="vertical-align:middle;">
<p style="padding:0pt 0pt 12pt 0pt;"><a name="bookmark3754"></a><span class="font9" style="font-weight:bold;">ISO 3166 Country Codes</span></p>
<p><a name="bookmark3737"></a><span class="font23" style="font-style:italic;">Table G-3. ISO 3166 country codes</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Code</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Afghanistan</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AF</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Albania</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AL</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Algeria</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">DZ</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">American Samoa</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AS</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Andorra</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AD</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Angola</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AO</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Anguilla</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AI</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Antarctica</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AQ</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Antigua and Barbuda</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AG</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Argentina</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AR</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Armenia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">AM</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Aruba</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AW</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Australia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AU</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Austria</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AT</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Azerbaijan</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AZ</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Bahamas</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BS</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bahrain</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BH</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Bangladesh</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BD</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Barbados</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BB</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Belarus</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BY</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Belgium</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BE</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Belize</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BZ</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Benin</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BJ</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Bermuda</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Bhutan</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Bolivia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Bosnia and Herzegovina</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Botswana</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Bouvet Island</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Brazil</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">British Indian Ocean Territory</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IO</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Brunei Darussalam</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Bulgaria</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Burkina Faso</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">BF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Burundi</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">BI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cambodia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">KH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cameroon</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Canada</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cape Verde</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cayman Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">KY</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Central African Republic</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CF</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Chad</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">TD</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Chile</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">CL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">China</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Christmas Island</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CX</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cocos (Keeling) Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CC</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Colombia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">CO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Comoros</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">KM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Congo</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Congo (Democratic Republic of the)</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">CD</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Cook Islands</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">CK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Costa Rica</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cote D’Ivoire</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Croatia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">HR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cuba</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Cyprus</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">CY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Czech Republic</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">CZ</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Denmark</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">DK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Djibouti</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">DJ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Dominica</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">DM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Dominican Republic</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">DO</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">East Timor</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">TP</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ecuador</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">EC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Egypt</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">EG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">El Salvador</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Equatorial Guinea</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GQ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Eritrea</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ER</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Estonia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">EE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Ethiopia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ET</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Falkland Islands (Malvinas)</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">FK</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Faroe Islands</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">FO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Fiji</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">FJ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Finland</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">FI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">France</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">FR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">French Guiana</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">French Polynesia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PF</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">French Southern Territories</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">TF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gabon</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Gambia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">GM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Georgia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GE</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Germany</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">DE</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Ghana</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">GH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Gibraltar</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Greece</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GR</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Greenland</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">GL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Grenada</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GD</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guadeloupe</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GP</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Guam</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">GU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guatemala</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guinea</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guinea-Bissau</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Guyana</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Haiti</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">HT</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Heard Island and Mcdonald Islands</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Holy See (Vatican City State)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Honduras</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Hong Kong</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HK</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Hungary</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HU</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iceland</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">India</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Indonesia</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ID</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Iran (Islamic Republic of)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IR</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Iraq</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IQ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Ireland</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Israel</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Italy</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Jamaica</span></p></td><td style="vertical-align:top;">
<p><span class="font2">JM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Japan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">JP</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Jordan</span></p></td><td style="vertical-align:top;">
<p><span class="font2">JO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Kazakstan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">KZ</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Kenya</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">KE</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Kiribati</span></p></td><td style="vertical-align:top;">
<p><span class="font2">KI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Korea (Democratic People’s Republic of)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">KP</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Korea (Republic of)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">KR</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Kuwait</span></p></td><td style="vertical-align:top;">
<p><span class="font2">KW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Kyrgyzstan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">KG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Lao People’s Democratic Republic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Latvia</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Lebanon</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LB</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Lesotho</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Liberia</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Libyan Arab Jamahiriya</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Liechtenstein</span></p></td><td style="vertical-align:top;">
<p><span class="font2">LI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Lithuania</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Luxembourg</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LU</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Macau</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Macedonia (The Former Yugoslav Republic of)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">MK</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Madagascar</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Malawi</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MW</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Malaysia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Maldives</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mali</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ML</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Malta</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MT</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Marshall Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Martinique</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MQ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Mauritania</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mauritius</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mayotte</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">YT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Mexico</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MX</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Micronesia (Federated States of)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">FM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Moldova (Republic of)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MD</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Monaco</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mongolia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MN</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Montserrat</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Morocco</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Mozambique</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MZ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Myanmar</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">MM</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Namibia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">NA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Nauru</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Nepal</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NP</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Netherlands</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">NL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Netherlands Antilles</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">AN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">New Caledonia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">New Zealand</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NZ</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Nicaragua</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NI</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Niger</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">NE</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Nigeria</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">NG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Niue</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">NU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Norfolk Island</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Northern Mariana Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">MP</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Norway</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">NO</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Oman</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">OM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Pakistan</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Palau</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Palestinian Territory (Occupied)</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PS</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Panama</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">PA</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Papua New Guinea</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PG</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Paraguay</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Peru</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">PE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Philippines</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PH</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Pitcairn</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">PN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Poland</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Portugal</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Puerto Rico</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">PR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Qatar</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">QA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Reunion</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Romania</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">RO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Russian Federation</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">RU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Rwanda</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">RW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Saint Helena</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Saint Kitts and Nevis</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">KN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Saint Lucia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">LC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Saint Pierre and Miquelon</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">PM</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Saint Vincent and the Grenadines</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">VC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Samoa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">WS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">San Marino</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Sao Tome and Principe</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ST</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Saudi Arabia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Senegal</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SN</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Seychelles</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SC</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Sierra Leone</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SL</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Singapore</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Slovakia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SK</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Slovenia</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SI</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Solomon Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SB</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Somalia</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SO</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">South Africa</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ZA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">South Georgia and the South Sandwich Islands</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">GS</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Spain</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ES</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Sri Lanka</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">LK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Sudan</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SD</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">Suriname</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">SR</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">Svalbard and Jan Mayen</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">SJ</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Country</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Code</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Swaziland</span></p></td><td style="vertical-align:top;">
<p><span class="font2">SZ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Sweden</span></p></td><td style="vertical-align:top;">
<p><span class="font2">SE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Switzerland</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Syrian Arab Republic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SY</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Taiwan, Province of China</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TW</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tajikistan</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TJ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tanzania (United Republic of)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TZ</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Thailand</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Togo</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tokelau</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TK</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tonga</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TO</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Trinidad and Tobago</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Tunisia</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Turkey</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TR</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Turkmenistan</span></p></td><td style="vertical-align:top;">
<p><span class="font2">TM</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Turks and Caicos Islands</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TC</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Tuvalu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">TV</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Uganda</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">UG</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ukraine</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">United Arab Emirates</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">AE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">United Kingdom</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">GB</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">United States</span></p></td><td style="vertical-align:top;">
<p><span class="font2">US</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">United States Minor Outlying Islands</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">UM</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Uruguay</span></p></td><td style="vertical-align:top;">
<p><a name="bookmark3755"></a><span class="font2">UY</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Uzbekistan</span></p></td><td style="vertical-align:top;">
<p><span class="font2">UZ</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Vanuatu</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VU</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Venezuela</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Viet NAM</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VN</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Virgin Islands (British)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VG</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Virgin ISLANDS (U.S.)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VI</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Wallis and Futuna</span></p></td><td style="vertical-align:top;">
<p><span class="font2">WF</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Western Sahara</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">EH</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Yemen</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">YE</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Yugoslavia</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">YU</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Zambia</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ZM</span></p></td></tr>
</table>
<h2 style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3756"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3757"></a><a name="bookmark3758"></a>Language Administrative Organizations</span></h2>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">ISO 639 defines a maintenance agency for additions to and changes in the list of languages in ISO 639. This agency is:</span></p>
<p style="text-indent:19pt;"><span class="font24">International Information Centre for Terminology (Infoterm)</span></p>
<p style="text-indent:19pt;"><span class="font24">P.O. Box 130</span></p>
<p style="text-indent:19pt;"><span class="font24">A-1021 Wien</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 12pt 0pt;"><span class="font24">Austria</span></p>
<p style="text-indent:19pt;"><span class="font24">Phone: +43 1 26 75 35 Ext. 312</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">Fax: +43 1 216 32 72</span></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">ISO 639-2 defines a maintenance agency for additions to and changes in the list of languages in ISO 639-2. This agency is:</span></p>
<p style="text-indent:19pt;"><span class="font24">Library of Congress</span></p>
<p style="text-indent:19pt;"><span class="font24">Network Development and MARC Standards Office</span></p>
<p style="text-indent:19pt;"><span class="font24">Washington, D.C. 20540</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 12pt 0pt;"><span class="font24">USA</span></p>
<p style="text-indent:19pt;"><span class="font24">Phone: +1 202 707 6237</span></p>
<p style="text-indent:19pt;"><span class="font24">Fax: +1 202 707 0115</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">URL: </span><a href="http://www.loc.gov/standards/iso639/"><span class="font24" style="font-style:italic;">http://www.loc.gov/standards/iso639/</span></a></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font24">The maintenance agency for ISO 3166 (country codes) is:</span></p>
<p style="text-indent:19pt;"><span class="font24">ISO 3166 Maintenance Agency Secretariat</span></p>
<p style="text-indent:19pt;"><span class="font24">c/o DIN Deutsches Institut fuer Normung</span></p>
<p style="text-indent:19pt;"><span class="font24">Burggrafenstrasse 6</span></p>
<p style="text-indent:19pt;"><span class="font24">Postfach 1107</span></p>
<p style="text-indent:19pt;"><span class="font24">D-10787 Berlin</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 12pt 0pt;"><span class="font24">Germany</span></p>
<p style="text-indent:19pt;"><span class="font24">Phone: +49 30 26 01 320</span></p>
<p style="text-indent:19pt;"><span class="font24">Fax: +49 30 26 01 231</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font24">URL: </span><a href="http://www.din.de/gremien/nas/nabd/iso3166ma/"><span class="font24" style="font-style:italic;">http://www.din.de/gremien/nas/nabd/iso3166ma/</span></a></p>
<p style="padding:0pt 0pt 5pt 0pt;"><a name="bookmark3759"></a><span class="font7" style="font-weight:bold;"><a name="bookmark3760"></a><a name="bookmark253"></a><a name="bookmark3761"></a>APPENDIX H</span></p>
<h1 style="padding:0pt 0pt 114pt 0pt;"><a name="bookmark207"></a><span class="font11" style="font-weight:bold;"><a name="bookmark3762"></a>MIME Charset Registry</span></h1>
<p style="text-align:justify;padding:0pt 0pt 15pt 0pt;"><span class="font24">This appendix describes the MIME charset registry maintained by the Internet Assigned Numbers Authority (IANA). A formatted table of charsets from the registry is provided in</span><a href="#bookmark3763"><span class="font24"> Table H-1</span></a><span class="font24">.</span></p>
<h2 style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><a name="bookmark3764"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3765"></a>MIME Charset Registry</span></h2>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">MIME charset tags are registered with the IANA (</span><a href="http://www.iana.org/numbers.htm"><span class="font24" style="font-style:italic;">http://www.iana.org/numbers.htm</span></a><span class="font24">). The charset registry is a flat-file text database of records. Each record contains a charset name, reference citations, a unique MIB number, a source description, and a list of aliases. A name or alias may be flagged “preferred MIME name.”</span></p>
<p style="text-align:justify;padding:0pt 0pt 5pt 0pt;"><span class="font24">Here is the record for US-ASCII:</span></p>
<p style="text-indent:19pt;"><span class="font3">Name: ANSI_X3.4-1968</span></p>
<div style="float:right;writing-mode:horizontal-tb;">
<p><span class="font3">[RFC1345, KXS2]^</span></p>
</div>
<p style="text-indent:19pt;"><span class="font3">MIBenum: 3</span></p>
<p style="text-indent:19pt;"><span class="font3">Source: ECMA registry</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: iso-ir-6</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: ANSI_X3.4-1986</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: ISO_646.irv:1991</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: ASCII</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: ISO646-US</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: US-ASCII (preferred MIME name)</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: us</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: IBM367</span></p>
<p style="text-indent:19pt;"><span class="font3">Alias: cp367</span></p>
<p style="text-indent:19pt;padding:0pt 0pt 5pt 0pt;"><span class="font3">Alias: csASCII</span></p>
<p style="text-align:justify;"><span class="font24">The procedure for registering a charset with the IANA is documented in RFC 2978 (</span><a href="http://www.ietf.org/rfc/rfc2978.txt"><span class="font24" style="font-style:italic;">http://www.ietf.org/rfc/rfc2978.txt</span></a><span class="font24">).</span></p>
<h2 style="padding:0pt 0pt 7pt 0pt;"><a name="bookmark3766"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3767"></a><a name="bookmark3768"></a>Preferred MIME Names</span></h2>
<p style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><span class="font24">Of the 235 charsets registered at the time of this writing, only 20 include “preferred MIME names”—common charsets used by email and web applications. These are:</span></p>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font24">Big5</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;text-indent:28pt;"><span class="font24">EUC-JP</span></p></td><td style="vertical-align:top;">
<p style="text-indent:30pt;"><span class="font24">EUC-KR</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font24">GB2312</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font24">ISO-2022-JP</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:30pt;"><span class="font24">ISO-2022-JP-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><a name="bookmark2764"></a><span class="font24">ISO-2022-KR</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font24">ISO-8859-1</span></p></td><td style="vertical-align:top;">
<p style="text-indent:30pt;"><span class="font24">ISO-8859-2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font24">ISO-8859-3</span></p></td><td style="vertical-align:top;">
<p style="text-indent:28pt;"><span class="font24">ISO-8859-4</span></p></td><td style="vertical-align:top;">
<p style="text-indent:30pt;"><span class="font24">ISO-8859-5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font24">ISO-8859-6</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font24">ISO-8859-7</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:30pt;"><span class="font24">ISO-8859-8</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font24">ISO-8859-9</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font24">ISO-8859-10</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:30pt;"><span class="font24">KOI8-R</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font24">Shift-JIS</span></p></td><td style="vertical-align:bottom;">
<p style="text-indent:28pt;"><span class="font24">US-ASCII</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<h2 style="text-align:justify;padding:0pt 0pt 7pt 0pt;"><a name="bookmark3769"></a><span class="font9" style="font-weight:bold;"><a name="bookmark3770"></a>Registered Charsets</span></h2>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark3763"><span class="font24">Table H-1 </span></a><span class="font24">lists the contents of the charset registry as of March 2001. Refer directly to </span><a href="http://www.iana.org"><span class="font24" style="font-style:italic;">http://www.iana.org</span></a><span class="font24"> for more information about the contents of this table.</span></p>
<table>
<tr><td>
<p><a name="bookmark3763"></a><span class="font23" style="font-style:italic;">Table H-1. IANA MIME charset tags</span></p></td></tr>
<tr><td>
<table border="1">
<tr><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:top;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">US-ASCII</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ANSI_X3.4-1968, iso-ir-6, ANSI_X3.4-1986, ISO_646.irv:1991, ASCII, ISO646-US, us, IBM367, cp367, csASCII</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">ISO-10646-UTF-1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csISO10646UTF1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Universal Transfer Format (1)—this is the multibyte encoding that subsets ASCII-7; it does not have byte-ordering issues</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">ISO_646.basic:1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ref, csISO646basic1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">INVARIANT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csINVARIANT</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">ISO_646.irv:1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-2, irv, csISO2IntlRefVersion</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">BS_4730</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-4, ISO646-GB, gb, uk, csISO4UnitedKingdom</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NATS-SEFI</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-8-1, csNATSSEFI</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NATS-SEFI-ADD</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-8-2, csNATSSEFIADD</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NATS-DANO</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-9-1, csNATSDANO</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">NATS-DANO-ADD</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-9-2, csNATSDANOADD</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SEN_850200_B</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-10, FI, ISO646-FI, ISO646-SE, se, csISO10Swedish</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SEN_850200_C</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-11, ISO646-SE2, se2, csISO11SwedishForNames</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">KS_C_5601-1987</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-149, KS_C_5601-1989,</span></p>
<p><span class="font2">KSC_5601, korean, csKSC56011987</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-2022-KR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csISO2022KR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1557 (see also KS_C_5601-1987)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1557, Choi</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">EUC-KR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csEUCKR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1557 (see also KS_C_5861-1992)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1557, Choi</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-2022-JP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csISO2022JP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1468 (see also RFC 2237)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1468, Murai</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-2022-JP-2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csISO2022JP2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1554</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1554, Ohta</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-2022-CN</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1922</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1922</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-2022-CN-EXT</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1922</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1922</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6220-1969-jp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">JIS_C6220-1969, iso-ir-13, katakana, x0201-7, csISO13JISC6220jp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6220-1969-ro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-14, jp, ISO646-JP, csISO14JISC6220ro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-15, ISO646-IT, csISO15Italian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">PT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-16, ISO646-PT, csISO16Portuguese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ES</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-17, ISO646-ES, csISO17Spanish</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">greek7-old</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-18, csISO18Greek7Old</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">latin-greek</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-19, csISO19LatinGreek</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">DIN_66003</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-21, de, ISO646-DE, csISO21German</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NF_Z_62-010_(1973)</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-25, ISO646-FR1, csISO25French</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">Latin-greek-1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-27, csISO27LatinGreek1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_5427</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-37, csISO5427Cyrillic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6226-1978</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-42, csISO42JISC62261978</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">BS_viewdata</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-47, csISO47BSViewdata</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">INIS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-49, csISO49INIS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">INIS-8</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-50, csISO50INIS8</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">INIS-cyrillic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-51, csISO51INISCyrillic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_5427:1981</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-54, ISO5427Cyrillic1981</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_5428:1980</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-55, csISO5428Greek</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">GB_1988-80</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-57, cn, ISO646-CN, csISO57GB1988</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, K5, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">GB_2312-80</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-58, chinese, csISO58GB231280</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NS_4551-1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-60, ISO646-NO, no, csISO60DanishNorwegian, csISO60Norwegian1</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NS_4551-2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO646-NO2, iso-ir-61, no2, csISO61Norwegian2</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NF_Z_62-010</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-69, ISO646-FR, fr, csISO69French</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">videotex-suppl</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-70, csISO70VideotexSupp1</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">PT2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-84, ISO646-PT2, csISO84Portuguese2</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ES2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-85, ISO646-ES2, csISO85Spanish2</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">MSZ_7795.3</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-86, ISO646-HU, hu, csISO86Hungarian</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6226-1983</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-87, x0208, JIS_X0208-1983, csISO87JISX0208</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">greek7</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-88, csISO88Greek7</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ASMO_449</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ISO_9036, arabic7, iso-ir-89, csISO89ASMO449</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">iso-ir-90</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csISO90</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-a</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-91, jp-ocr-a, csISO91JISC62291984a</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-b</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-92, ISO646-JP-OCR-B, jp-ocr-b, csISO92JISC62991984b</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-b-add</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-93, jp-ocr-b-add, csISO93JIS62291984badd</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-hand</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-94, jp-ocr-hand, csISO94JIS62291984hand</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-hand-add</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-95, jp-ocr-hand-add, csISO95JIS62291984handadd</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_C6229-1984-kana</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-96, csISO96JISC62291984kana</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_2033-1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-98, e13b, csISO2033</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ANSI_X3.110-1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-99, CSA_T500-1983, NAPLPS, csISO99NAPLPS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-1:1987, iso-ir-100,</span></p>
<p><span class="font2">ISO_8859-1, latin1, l1, IBM819, CP819, csISOLatin1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-2:1987, iso-ir-101,</span></p>
<p><span class="font2">ISO_8859-2, latin2, l2, csISOLatin2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">T.61-7bit</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-102, csISO102T617bit</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">T.61-8bit</span></p></td><td style="vertical-align:top;">
<p><span class="font2">T.61, iso-ir-103, csISO103T618bit</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-3</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ISO_8859-3:1988, iso-ir-109,</span></p>
<p><span class="font2">ISO_8859-3, latin3, l3, csISOLatin3</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-4</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-4:1988, iso-ir-110,</span></p>
<p><span class="font2">ISO_8859-4, latin4, l4, csISOLatin4</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ECMA-cyrillic</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-111, csISO111ECMACyrillic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CSA_Z243.4-1985-1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-121, ISO646-CA, csa7-1, ca, csISO121Canadian1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CSA_Z243.4-1985-2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-122, ISO646-CA2, csa7-2, csISO122Canadian2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CSA_Z243.4-1985-gr</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-123, csISO123CSAZ24341985gr</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-6</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ISO_8859-6:1987, iso-ir-127, ISO_8859-6, ECMA-114, ASMO-708, arabic, csISOLatinArabic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_8859-6-E</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csISO88596E</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1556</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1556, IANA</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_8859-6-I</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csISO88596I</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1556</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1556, IANA</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-7</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-7:1987, iso-ir-126, ISO_8859-7, ELOT_928,</span></p>
<p><span class="font2">ECMA-118, greek, greek8, csISOLatinGreek</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1947,</span></p>
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">T.101-G2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-128, csISO128T101G2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-8</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ISO_8859-8:1988, iso-ir-138,</span></p>
<p><span class="font2">ISO_8859-8, hebrew, csISOLatinHebrew</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO_8859-8-E</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csISO88598E</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1556</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1556, Nussbacher</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO_8859-8-I</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csISO88598I</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1556</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1556, Nussbacher</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">CSN_369103</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-139, csISO139CSN369103</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JUS_I.B1.002</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-141, ISO646-YU, js, yu, csISO141JUSIB1002</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_6937-2-add</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-142, csISOTextComm</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry and ISO 6937-2:1983</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">IEC_P27-1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-143, csISO143IECP271</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-5</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-5:1988, iso-ir-144,</span></p>
<p><span class="font2">ISO_8859-5, cyrillic, csISOLatinCyrillic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JUS_I.B1.003-serb</span></p></td><td style="vertical-align:top;">
<p><span class="font2">iso-ir-146, serbian, csISO146Serbian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JUS_I.B1.003-mac</span></p></td><td style="vertical-align:top;">
<p><span class="font2">macedonian, iso-ir-147, csISO147Macedonian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-9</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-9:1989, iso-ir-148,</span></p>
<p><span class="font2">ISO_8859-9, latin5, l5, csISOLatin5</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">greek-ccitt</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-150, csISO150, csISO150GreekCCITT</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">NC_NC00-10:81</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cuba, iso-ir-151, ISO646-CU, csISO151Cuba</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_6937-2-25</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-152, csISO6937Add</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">GOST_19768-74</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ST_SEV_358-88, iso-ir-153, csISO153GOST1976874</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO_8859-supp</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-154, latin1-2-5, csISO8859Supp</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO_10367-box</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-155, csISO10367Box</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-10</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-157, l6, ISO_8859-10:1992, csISOLatin6, latin6</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">latin-lap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">lap, iso-ir-158, csISO158Lap</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_X0212-1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">x0212, iso-ir-159, csISO159JISX02121990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ECMA registry</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">DS_2089</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">DS2089, ISO646-DK, dk, csISO646Danish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Danish Standard, DS 2089, February 1974</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">us-dk</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csUSDK</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">dk-us</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csDKUS</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_X0201</span></p></td><td style="vertical-align:top;">
<p><span class="font2">X0201, csHalfWidthKatakana</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">JIS X 0201-1976—1 byte only; this is equivalent to JIS/Roman (similar to ASCII) plus 8-bit half-width katakana</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p><span class="font2">KSC5636</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO646-KR, csKSC5636</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">ISO-10646-UCS-2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicode</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The 2-octet Basic Multilingual Plane, a.k.a. Unicode—this needs to specify network byte order; the standard does not specify it (it is a 16-bit integer space)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">ISO-10646-UCS-4</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUCS4</span></p></td><td style="vertical-align:top;">
<p><span class="font2">The full code space (same comment about byte order; these are 31-bit numbers)</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">DEC-MCS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">dec, csDECMCS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">VAX/VMS User’s Manual, Order Number: AI-Y517A-TE, April 1986</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">hp-roman8</span></p></td><td style="vertical-align:top;">
<p><span class="font2">roman8, r8, csHPRoman8</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">LaserJet IIP Printer User’s Manual, HP part no 33471-90901, Hewlett-Packard, June 1989</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5, RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">macintosh</span></p></td><td style="vertical-align:top;">
<p><span class="font2">mac, csMacintosh</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">The Unicode Standard v1.0, ISBN 0201567881, Oct 1991</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM037</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp037, ebcdic-cp-us, ebcdic-cp-ca, ebcdic-cp-wt, ebcdic-cp-nl, csIBM037</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM038</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-INT, cp038, csIBM038</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3174 Character Set Ref, GA27-3831-02, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM273</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP273, csIBM273</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM274</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-BE, CP274, csIBM274</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3174 Character Set Ref, GA27-3831-02, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM275</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-BR, cp275, csIBM275</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM277</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-CP-DK, EBCDIC-CP-NO, csIBM277</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM278</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CP278, ebcdic-cp-fi, ebcdic-cp-se, csIBM278</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM280</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP280, ebcdic-cp-it, csIBM280</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM281</span></p></td><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-JP-E, cp281, csIBM281</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3174 Character Set Ref, GA27-3831-02, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM284</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CP284, ebcdic-cp-es, csIBM284</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM285</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CP285, ebcdic-cp-gb, csIBM285</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM290</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp290, EBCDIC-JP-kana, csIBM290</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3174 Character Set Ref, GA27-3831-02, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM297</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp297, ebcdic-cp-fr, csIBM297</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM420</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp420, ebcdic-cp-ar1, csIBM420</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990, IBM NLS RM p 11-11</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM423</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp423, ebcdic-cp-gr, csIBM423</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM424</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp424, ebcdic-cp-he, csIBM424</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM437</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp437, 437, csPC8CodePage437</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM500</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CP500, ebcdic-cp-be, ebcdic-cp-ch, csIBM500</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM775</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp775, csPC775Baltic</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">HP PCL 5 Comparison Guide (P/N 50210329) pp B-13, 1996</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM850</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp850, 850, csPC850Multilingual</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM851</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp851, 851, csIBM851</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM852</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp852, 852, csPCp852</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM855</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp855, 855, csIBM855</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM857</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp857, 857, csIBM857</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM860</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp860, 860, csIBM860</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM861</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp861, 861, cp-is, csIBM861</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM862</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp862, 862, csPC862LatinHebrew</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM863</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp863, 863, csIBM863</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBM keyboard layouts and code pages, PN 07G4586, June 1991</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM864</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp864, csIBM864</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBM keyboard layouts and code pages, PN 07G4586, June 1991</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM865</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp865, 865, csIBM865</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBM DOS 3.3 Ref (Abridged), 94X9575, Feb 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM866</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp866, 866, csIBM866</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBM NLDG Vol2 SE09-8002-03, August 1994</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">Pond</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM868</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP868, cp-ar, csIBM868</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM869</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp869, 869, cp-gr, csIBM869</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2">IBM keyboard layouts and code pages, PN 07G4586, June 1991</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM870</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP870, ebcdic-cp-roece, ebcdic-cp-yu, csIBM870</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">IBMNLSRMVol2SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p style="text-align:justify;"><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM871</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP871, ebcdic-cp-is, csIBM871</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM880</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">cp880, EBCDIC-Cyrillic, csIBM880</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM891</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp891, csIBM891</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM903</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp903, csIBM903</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM904</span></p></td><td style="vertical-align:top;">
<p><span class="font2">cp904, 904, csIBBM904</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM905</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP905, ebcdic-cp-tr, csIBM905</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3174 Character Set Ref, GA27-3831-02, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM918</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CP918, ebcdic-cp-ar2, csIBM918</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">IBM1026</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CP1026, csIBM1026</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM NLS RM Vol2 SE09-8002-01, March 1990</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-AT-DE</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csIBMEBCDICATDE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-AT-DE-A</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICATDEA</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-CA-FR</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICCAFR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-DK-NO</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICDKNO</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-DK-NO-A</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICDKNOA</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-FI-SE</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICFISE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-FI-SE-A</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICFISEA</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-FR</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICFR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-IT</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICIT</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-PT</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-ES</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICES</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p><span class="font2">EBCDIC-ES-A</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICESA</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p style="text-align:justify;"><span class="font2">RFC1345, KXS2</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">EBCDIC-ES-S</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICESS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">EBCDIC-UK</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICUK</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">EBCDIC-US</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEBCDICUS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM 3270 Char Set Ref Ch 10, GA27-2837-9, April 1987</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">UNKNOWN-8BIT</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnknown8BiT</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC1428</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">MNEMONIC</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csMnemonic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1345, also known as “mnemonic+ascii+38”</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">MNEM</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csMnem</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1345, also known as “mnemonic+ascii+8200”</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1345, KXS2</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">VISCII</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csVISCII</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1456</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1456</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">VIQR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csVIQR</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1456</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1456</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">KOI8-R</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csKOI8R</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1489, based on GOST-19768-74, ISO-6937/8, INIS-Cyrillic, ISO-5427</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1489</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">KOI8-U</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2319</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC2319</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM00858</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID00858, CP00858, PC-</span></p>
<p><span class="font2">Multilingual-850+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM00858) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM00924</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CCSID00924, CP00924, ebcdic-</span></p>
<p><span class="font2">Latin9--euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM00924) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01140</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CCSID01140, CP01140, ebcdic-us-37+euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01140) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01141</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CCSID01141, CP01141, ebcdic-de-273+euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01141) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01142</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CCSID01142, CP01142, ebcdic-dk-277+euro, ebcdic-no-277+euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01142) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01143</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01143, CP01143, ebcdic-fi-278+euro, ebcdic-se-278+euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01143) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01144</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01144, CP01144, ebcdic-it-280+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01144) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01145</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01145, CP01145, ebcdic-es-284+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01145) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01146</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01146, CP01146, ebcdic-gb-285+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01146) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01147</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01147, CP01147, ebcdic-fr-297+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01147) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01148</span></p></td><td style="vertical-align:top;">
<p><span class="font2">CCSID01148, CP01148, ebcdic-international-500+euro</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01148) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM01149</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">CCSID01149, CP01149, ebcdic-is-871+euro</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM (see .../assignments/character-set-info/IBM01149) [Mahdi]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Big5-HKSCS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">See (.../assignments/character-set-info/Big5-HKSCS) [Yick]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">UNICODE-1-1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicode11</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 1641</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC1641</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">SCSU</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">SCSU (see .../assignments/character-set-info/SCSU) [Scherer]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">UTF-7</span></p></td><td style="vertical-align:top;">
<p><span class="font2">None</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC 2152</span></p></td><td style="vertical-align:top;">
<p><span class="font2">RFC2152</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UTF-16BE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">None</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2781</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC2781</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UTF-16LE</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">None</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2781</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC2781</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UTF-16</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">None</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2781</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC2781</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UNICODE-1-1-UTF-7</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csUnicode11UTF7</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1642</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC1642</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">UTF-8</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 2279</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC2279</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">iso-8859-13</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO (see ...assignments/character-set-info/iso-8859-13)[Tumasonis]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">iso-8859-14</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">iso-ir-199, ISO_8859-14:1998, ISO_8859-14, latin8, iso-celtic, l8</span></p></td><td style="vertical-align:top;">
<p><span class="font2">ISO (see ...assignments/character-set-info/iso-8859-14) [Simonsen]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-15</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO_8859-15</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ISO</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">JIS_Encoding</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csJISEncoding</span></p></td><td style="vertical-align:top;">
<p><span class="font2">JIS X 0202-1991; uses ISO 2022 escape sequences to shift code sets, as documented in JIS X 0202-1991</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Shift_JIS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">MS_Kanji, csShiftJIS</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">This charset is an extension of csHalfWidthKatakana—it adds graphic characters in JIS X 0208. The CCSs areJIS X0201:1997 and JIS X0208: 1997. The complete definition is shown in Appendix 1 of JISX0208:1997. This charset can be used for the top-level media type “text”.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">EUC-JP</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Extended_UNIX_Code_ Packed_Format_for_ Japanese, csEUCPkdFmtJapanese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Standardized by OSF, UNIX International, and UNIX Systems Laboratories Pacific. Uses ISO 2022 rules to select code set. code set 0: US-ASCII (a single 7-bit byte set); code set 1: JIS X0208-1990 (a double 8-bit byte set) restricted to A0–FF in both bytes; code set 2: half-width katakana (a single 7-bit byte set) requiring SS2 as the character prefix; code set 3: JIS X0212-1990 (a double 7-bit byte set) restricted to A0–FF in both bytes requiring SS3 as the character prefix.</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">Extended_UNIX_Code_ Fixed_Width_for_ Japanese</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csEUCFixWidJapanese</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Used in Japan. Each character is 2 octets. code set 0: US-ASCII (a single 7-bit byte set), 1st byte = 00, 2nd byte = 20–7E; code set 1: JIS X0208-1990 (a double 7-bit byte set) restricted to A0– FF in both bytes; code set 2: half-width katakana (a single 7-bit byte set), 1st byte = 00, 2nd byte = A0–FF; code set 3: JIS X0212-1990 (a double 7-bit byte set) restricted to A0–FF in the first byte and 21–7E in the second byte.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-10646-UCS-Basic</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeASCII</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">ASCII subset of Unicode. Basic Latin = collection 1. See ISO 10646, Appendix A.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;padding:0pt 0pt 35pt 0pt;"><span class="font2">ISO-10646-Unicode-Latin1</span></p>
<p style="text-indent:7pt;"><span class="font2">ISO-10646-J-1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeLatin1, ISO-10646</span></p></td><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font2">ISO Latin-1 subset of Unicode. Basic Latin and Latin-1. Supplement = collections 1 and 2. See ISO 10646, Appendix A, and RFC 1815.</span></p>
<p><span class="font2">ISO 10646 Japanese. See RFC 1815.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-Unicode-IBM-1261</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeIBM1261</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM Latin-2, -3, -5, Extended Presentation Set, GCSGID: 1261</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-Unicode-IBM-1268</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnidoceIBM1268</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM Latin-4 Extended Presentation Set, GCSGID: 1268</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-Unicode-IBM-1276</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeIBM1276</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM Cyrillic Greek Extended Presentation Set, GCSGID: 1276</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-Unicode-IBM-1264</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeIBM1264</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM Arabic Presentation Set, GCSGID: 1264</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">ISO-Unicode-IBM-1265</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csUnicodeIBM1265</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM Hebrew Presentation Set, GCSGID: 1265</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-1-Windows-3.0-</span></p>
<p style="text-indent:7pt;"><span class="font2">Latin-1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csWindows30Latin1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extended ISO 8859-1 Latin-1 for</span></p>
<p><span class="font2">Windows 3.0. PCL Symbol Set ID: 9U.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">ISO-8859-1-Windows-3.1-</span></p>
<p style="text-indent:7pt;"><span class="font2">Latin-1</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csWindows31Latin1</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extended ISO 8859-1 Latin-1 for</span></p>
<p><span class="font2">Windows 3.1. PCL Symbol Set ID: 19U.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">ISO-8859-2-Windows-Latin-2</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csWindows31Latin2</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extended ISO 8859-2. Latin-2 for</span></p>
<p><span class="font2">Windows 3.1. PCL Symbol Set ID: 9E.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font2">ISO-8859-9-Windows-Latin-5</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csWindows31Latin5</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Extended ISO 8859-9. Latin-5 for</span></p>
<p><span class="font2">Windows 3.1. PCL Symbol Set ID: 5T.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Adobe-Standard-Encoding</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csAdobeStandardEncoding</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PostScript Language Reference Manual. PCL Symbol Set ID: 10J.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Adobe</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ventura-US</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csVenturaUS</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Ventura US-ASCII plus characters typically used in publishing, such as pilcrow, copyright, registered, trademark, section, dagger, and double dagger in the range A0 (hex) to FF (hex). PCL Symbol Set ID: 14J.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ventura-International</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csVenturaInternational</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Ventura International. ASCII plus coded characters similar to Roman8. PCL Symbol Set ID: 13J.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">PC8-Danish-Norwegian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csPC8DanishNorwegian</span></p></td><td style="vertical-align:top;">
<p><span class="font2">PC Danish Norwegian 8-bit PC set for Danish Norwegian. PCL Symbol Set ID: 11U.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">PC8-Turkish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csPC8Turkish</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PC Latin Turkish. PCL Symbol Set ID: 9T.</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2">IBM-Symbols</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">csIBMSymbols</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Presentation Set, CPGID: 259</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">IBM-CIDT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">IBM-Thai</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csIBMThai</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Presentation Set, CPGID: 838</span></p></td><td style="vertical-align:top;">
<p><span class="font2">IBM-CIDT</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HP-Legal</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csHPLegal</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 1U.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HP-Pi-font</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csHPPiFont</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 15U.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HP-Math8</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csHPMath8</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 8M.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Adobe-Symbol-Encoding</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csHPPSMath</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PostScript Language Reference</span></p>
<p><span class="font2">Manual. PCL Symbol Set ID: 5M.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Adobe</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HP-DeskTop</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csHPDesktop</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 7J.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Ventura-Math</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csVenturaMath</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 6M.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Microsoft-Publishing</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csMicrosoftPublishing</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">PCL 5 Comparison Guide, Hewlett-Packard, HP part number 5961-0510, October 1992. PCL Symbol Set ID: 6J.</span></p></td><td style="vertical-align:top;">
<p><span class="font2">HP-PCL5</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Windows-31J</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csWindows31J</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Windows Japanese. A further extension of Shift_JIS to include NEC special characters (Row 13), NEC selection of IBM extensions (Rows 89 to 92), and IBM extensions (Rows 115 to 119). The CCSs are JIS X0201:1997, JIS X0208:1997, and these extensions. This charset can be used for the top-level media type “text”, but it is of limited or specialized use (see RFC 2278). PCL Symbol Set ID: 19K.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">GB2312</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csGB2312</span></p></td><td style="vertical-align:top;">
<p><span class="font2">Chinese for People’s Republic of China (PRC) mixed 1-byte, 2-byte set: 20–7E = 1-byte ASCII; A1–FE = 2-byte PRC Kanji. See GB 2312-80. PCL Symbol Set ID: 18C.</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<table border="1">
<tr><td style="vertical-align:bottom;">
<p style="text-indent:7pt;"><span class="font2" style="font-weight:bold;">Charset tag</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Aliases</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">Description</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2" style="font-weight:bold;">References</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">Big5</span></p></td><td style="vertical-align:top;">
<p><span class="font2">csBig5</span></p></td><td style="vertical-align:bottom;">
<p><span class="font2">Chinese for Taiwan Multibyte set. PCL Symbol Set id: 18T.</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1250</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1250) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1251</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1251) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1252</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1252) [Wendt]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1253</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1253) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1254</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><a name="bookmark3771"></a><span class="font2">Microsoft (see .../character-set-info/ windows-1254) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1255</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1255) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1256</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1256) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1257</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1257) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">windows-1258</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Microsoft (see .../character-set-info/ windows-1258) [Lazhintseva]</span></p></td><td style="vertical-align:top;"></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">TIS-620</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">Thai Industrial Standards Institute (TISI)</span></p></td><td style="vertical-align:top;">
<p><span class="font2">[Tantsetthi]</span></p></td></tr>
<tr><td style="vertical-align:top;">
<p style="text-indent:7pt;"><span class="font2">HZ-GB-2312</span></p></td><td style="vertical-align:top;"></td><td style="vertical-align:bottom;">
<p><span class="font2">RFC 1842, RFC 1843 [RFC1842, RFC1843]</span></p></td><td style="vertical-align:top;"></td></tr>
</table>
<h1 style="text-align:right;"><a name="bookmark208"></a><span class="font11" style="font-weight:bold;"><a name="bookmark3772"></a>Index</span></h1>
<table cellpadding="10pt">
<tr>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 3pt 0pt;"><a name="bookmark3773"></a><span class="font6" style="font-weight:bold;">Symbols</span></p>
<p><a href="#bookmark555"><span class="font23">: (colon), use in headers, 47</span></a></p>
<p><a href="#bookmark3679"><span class="font23">= (equals sign), base-64 encoding, 572</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1051"><span class="font23">/~ (slash-tilde), 122</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">Numbers</span></p>
<p><span class="font23">8-bit identity encoding, 382</span></p>
<p><a href="#bookmark658"><span class="font23">100 Continue status code, 59,</span></a><a href="#bookmark661"><span class="font23"> 60</span></a></p>
<p><a href="#bookmark652"><span class="font23">100-199 status codes, 59–</span></a><a href="#bookmark669"><span class="font23">60, </span></a><a href="#bookmark3365"><span class="font23">505</span></a></p>
<p><a href="#bookmark670"><span class="font23">200-299 status codes, 61, </span></a><a href="#bookmark3365"><span class="font23">505</span></a></p>
<p><a href="#bookmark676"><span class="font23">300-399 status codes, 61–</span></a><a href="#bookmark686"><span class="font23">64, </span></a><a href="#bookmark3774"><span class="font23">506</span></a></p>
<p><a href="#bookmark688"><span class="font23">400-499 status codes, 65–</span></a><a href="#bookmark693"><span class="font23">66, </span></a><a href="#bookmark3375"><span class="font23">506</span></a></p>
<p><a href="#bookmark695"><span class="font23">500-599 status codes, 66, </span></a><a href="#bookmark3376"><span class="font23">507</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark845"><span class="font23">2MSL (maximum segment lifetime), 85</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">A</span></p>
<p><a href="#bookmark442"><span class="font23">absolute URLs, 30</span></a></p>
<p><a href="#bookmark727"><span class="font23">Accept headers, 69, </span></a><a href="#bookmark3379"><span class="font23">508</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1725"><span class="font23">robots and, 225</span></a></p>
<p><a href="#bookmark2571"><span class="font23">Accept-Charset headers, 371, </span></a><a href="#bookmark2602"><span class="font23">375, </span></a><a href="#bookmark3382"><span class="font23">509</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2591"><span class="font23">MIME charset encoding tags and, 374</span></a></p>
<p><a href="#bookmark3386"><span class="font23">Accept-Encoding headers, 509</span></a></p>
<p><a href="#bookmark2550"><span class="font23">Accept-Instance-Manipulation headers, 367</span></a></p>
<p><a href="#bookmark2571"><span class="font23">Accept-Language headers, 371, </span></a><a href="#bookmark2686"><span class="font23">385, </span></a><a href="#bookmark3389"><span class="font23">510</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2793"><span class="font23">content negotiation and, 398</span></a></p>
<p><a href="#bookmark3392"><span class="font23">Accept-Ranges headers, 510</span></a></p>
<p><a href="#bookmark1066"><span class="font23">access controls, 124</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1281"><span class="font23">proxy authentication, 156</span></a></p>
<p><a href="#bookmark1151"><span class="font23">access proxies, 137</span></a></p>
<p><a href="#bookmark1543"><span class="font23">advertising, hit counts and caches, 194</span></a><a href="#bookmark1555"><span class="font23">–196</span></a></p>
<p><a href="#bookmark1514"><span class="font23">age and freshness lifetime, 188</span></a></p>
<p><a href="#bookmark3395"><span class="font23">Age headers, 510</span></a></p>
<p><a href="#bookmark373"><span class="font23">agents, 19</span></a></p></td>
<td valign="top" style="width:50%;">
<p><span class="font23">algorithms</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1510"><span class="font23">aging and freshness, 187</span></a><a href="#bookmark1542"><span class="font23">–194</span></a><span class="font23"> </span><a href="#bookmark1519"><span class="font23">document age calculation, 189</span></a><a href="#bookmark1542"><span class="font23">–194</span></a><span class="font23"> </span><a href="#bookmark2553"><span class="font23">instance-manipulation algorithms, 367</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1488"><span class="font23">LM-Factor, 184</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2118"><span class="font23">message digest algorithms, 291–</span></a><a href="#bookmark2149"><span class="font23">294</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2183"><span class="font23">symmetric authentication, 298</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark838"><span class="font23">Nagle’s algorithm, 84</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark3150"><span class="font23">redirection, enhanced DNS-based, 457</span></a><span class="font23"> </span><a href="#bookmark1194"><span class="font23">resource-discovery algorithm</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark1194"><span class="font23">(WPAD), 143,</span></a><a href="#bookmark3201"><span class="font23"> 465</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2315"><span class="font23">RSA, 317</span></a></p>
<p><a href="#bookmark1695"><span class="font23">aliases (URLs), 219</span></a></p>
<p><a href="#bookmark1300"><span class="font23">Allow headers, 159, </span></a><a href="#bookmark3398"><span class="font23">511</span></a></p>
<p><a href="#bookmark3041"><span class="font23">&lt;allprop&gt; element, 437</span></a></p>
<p><a href="#bookmark1142"><span class="font23">anonymizers, 136</span></a></p>
<p><a href="#bookmark3155"><span class="font23">anycast addressing, 457</span></a></p>
<p><a href="#bookmark975"><span class="font23">Apache web servers, 110</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2798"><span class="font23">content negotiation, 399</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2804"><span class="font23">MultiViews directive, 400</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2801"><span class="font23">type-map files, 399</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1059"><span class="font23">DirectoryIndex configuration</span></a><span class="font23"> directive, 123</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1045"><span class="font23">document root, setting, 121</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1004"><span class="font23">HostnameLookups configuration</span></a><span class="font23"> directive, 115</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1498"><span class="font23">HTTP headers, control of, 186</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1013"><span class="font23">IdentityCheck configuration</span></a><span class="font23"> directive, 116</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1081"><span class="font23">magic typing, 126</span></a></p>
<p><a href="#bookmark1596"><span class="font23">APIs (application programming</span></a><span class="font23"> interfaces), 203 </span><a href="#bookmark1602"><span class="font23">server extensions, 205</span></a><span class="font23"> </span><a href="#bookmark1607"><span class="font23">web services and, 205</span></a></p></td></tr></table><hr>
<p><span class="font20">We’d like to hear your suggestions for improving our indexes. Send email to </span><a href="mailto:index@oreilly.com"><span class="font20" style="font-style:italic;">index@oreilly.com</span></a><span class="font20">.</span></p>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark3633"><span class="font23">application/* MIME types, 540</span></a><a href="#bookmark3636"><span class="font23">–557</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1596"><span class="font23">application programming interfaces (see</span></a><span class="font23"> APIs)</span></p>
<p><a href="#bookmark1061"><span class="font23">application servers, 123,</span></a><a href="#bookmark1594"><span class="font23"> 203</span></a></p>
<p><a href="#bookmark2642"><span class="font23">ASCII character set, 379</span></a></p>
<p><a href="#bookmark2307"><span class="font23">asymmetric cryptography, 315</span></a></p>
<p><a href="#bookmark2216"><span class="font23">attacks, 303–</span></a><a href="#bookmark2243"><span class="font23">306</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2239"><span class="font23">batched brute-force attacks, 305</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2235"><span class="font23">chosen plaintext attacks, 305</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2228"><span class="font23">dictionary attacks, 304</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2296"><span class="font23">enumeration, 313</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2199"><span class="font23">evidence of, 301</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2217"><span class="font23">header tampering, 303</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2231"><span class="font23">hostile proxies, 304</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2232"><span class="font23">man-in-the-middle attacks, 304</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2071"><span class="font23">replay attacks, 284, </span></a><a href="#bookmark2220"><span class="font23">303</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2110"><span class="font23">preventing, 289</span></a></p>
<p><a href="#bookmark3775"><span class="font23">audio/* MIME types, 557</span></a><a href="#bookmark3638"><span class="font23">–559</span></a></p>
<p><a href="#bookmark2029"><span class="font23">authentication, 277–</span></a><a href="#bookmark2046"><span class="font23">280</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark2049"><span class="font23">basic (see basic authentication)</span></a><span class="font23"> </span><a href="#bookmark2032"><span class="font23">challenge/response framework, 278</span></a><span class="font23"> </span><a href="#bookmark2080"><span class="font23">digest (see digest authentication)</span></a><span class="font23"> </span><a href="#bookmark2037"><span class="font23">headers, 278</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3277"><span class="font23">HTCP, 480</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2225"><span class="font23">multiple authentication schemes, risks</span></a><span class="font23"> of, 303</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2037"><span class="font23">protocols, 278</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1281"><span class="font23">proxy servers, 156</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2345"><span class="font23">server, using digital certificates, 321</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2249"><span class="font23">(see also HTTPS)</span></a></p>
<p><a href="#bookmark3702"><span class="font23">Authentication-Info directives, 576</span></a></p>
<p><a href="#bookmark2055"><span class="font23">Authorization headers, 281, </span></a><a href="#bookmark3401"><span class="font23">511</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3698"><span class="font23">directives, 575</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2159"><span class="font23">preemptive generation, 295</span></a></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark440"><span class="font23">automatic expansion of URLs, 30</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">B</span></p>
<p><span class="font23">bandwidth</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1314"><span class="font23">bottlenecks, 161</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1320"><span class="font23">transfer times and, 162</span></a></p>
<p><a href="#bookmark455"><span class="font23">base URLs, 32</span></a></p>
<p><a href="#bookmark3667"><span class="font23">base-64 encoding, 570–</span></a><a href="#bookmark3685"><span class="font23">572</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3676"><span class="font23">alphabet, 571</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3679"><span class="font23">equals sign (=), 572</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3672"><span class="font23">HTTP, compatibility with, 570</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3680"><span class="font23">padding, 572</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3684"><span class="font23">Perl implementation, 572</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3669"><span class="font23">purpose, 570</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2058"><span class="font23">username/password, 282</span></a></p>
<p><a href="#bookmark451"><span class="font23">bases, 31</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-align:justify;"><a href="#bookmark2049"><span class="font23">basic authentication, 281–</span></a><a href="#bookmark2072"><span class="font23">284</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2052"><span class="font23">example, 281</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2056"><span class="font23">headers, 281,</span></a><a href="#bookmark2193"><span class="font23"> 300</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2067"><span class="font23">insecurity of, 283, </span></a><a href="#bookmark2081"><span class="font23">286</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2207"><span class="font23">protection space, 302</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2062"><span class="font23">by proxy servers, 283</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2058"><span class="font23">username/password encoding, 282</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2066"><span class="font23">web server vs. proxy, 283</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2077"><span class="font23">(see also authentication)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2239"><span class="font23">batched brute-force attacks, 305</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1888"><span class="font23">Binary Wire Protocol, 250,</span></a><a href="#bookmark1896"><span class="font23"> 252</span></a></p>
<p style="text-align:justify;"><a href="#bookmark908"><span class="font23">blind relays, 94</span></a></p>
<p style="text-align:justify;"><span class="font23">browsers</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2900"><span class="font23">Host headers and older versions of, 419</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark340"><span class="font23">HTTP, use of, 13</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark880"><span class="font23">parallel connections, maximum, 90</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark465"><span class="font23">URLs, automatic expansion of, 34</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1354"><span class="font23">byte hit rate, 167</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 2pt 0pt;"><span class="font6" style="font-weight:bold;">C</span></p>
<p style="text-align:justify;"><a href="#bookmark3261"><span class="font23">Cache Array Routing Protocol (see CARP)</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1427"><span class="font23">Cache-Control headers, 175–</span></a><a href="#bookmark1439"><span class="font23">177,</span></a><a href="#bookmark1468"><span class="font23"> 182–</span></a><a href="#bookmark1506"><span class="font23">186,</span></a><span class="font23"> </span><a href="#bookmark1517"><span class="font23">189, </span></a><a href="#bookmark3405"><span class="font23">511</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2529"><span class="font23">directives, 361</span></a></p>
<p style="text-align:justify;"><a href="#bookmark362"><span class="font23">caches, 18,</span></a><a href="#bookmark1130"><span class="font23"> 133,</span></a><a href="#bookmark1309"><span class="font23"> 161–</span></a><a href="#bookmark1555"><span class="font23">196</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1543"><span class="font23">advertising and, 194–</span></a><a href="#bookmark1555"><span class="font23">196</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1510"><span class="font23">aging and freshness algorithms, 187</span></a><a href="#bookmark1542"><span class="font23">–194</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1354"><span class="font23">byte hit rate, 167</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3334"><span class="font23">cache busting, 492</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1336"><span class="font23">cache hits and misses, 165,</span></a><a href="#bookmark1357"><span class="font23"> 168</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1382"><span class="font23">cache meshes, 170</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1461"><span class="font23">cache validators, 181</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1427"><span class="font23">Cache-Control headers, 175–</span></a><a href="#bookmark1439"><span class="font23">177,</span></a><span class="font23"> </span><a href="#bookmark1468"><span class="font23">182–</span></a><a href="#bookmark1506"><span class="font23">186,</span></a><a href="#bookmark1517"><span class="font23"> 189, </span></a><a href="#bookmark3405"><span class="font23">511</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2529"><span class="font23">directives, 361</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2014"><span class="font23">cookies and, 273</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2213"><span class="font23">digest authentication and, 302</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1328"><span class="font23">distance delays and, 163</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3147"><span class="font23">DNS caching and load balancing, 456</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1428"><span class="font23">document expiration, 175</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">exclusion of documents from, 182</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1469"><span class="font23">expiration time, setting, 182</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1427"><span class="font23">Expires headers, 175,</span></a><a href="#bookmark1479"><span class="font23"> 183</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1324"><span class="font23">flash crowds and, 163</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1405"><span class="font23">freshness check, 173</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1485"><span class="font23">heuristic expiration, 184</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1550"><span class="font23">hit logs, 195</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1349"><span class="font23">hit rate, 167</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1507"><span class="font23">HTTP-EQUIV tag, 187</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1413"><span class="font23">logging, 174</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1402"><span class="font23">lookup, 173</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1425"><span class="font23">maintaining currency, 175</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2438"><span class="font23">message truncation and, 344</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1315"><span class="font23">network bottlenecks and, 161</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1374"><span class="font23">parent caches, 169</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1396"><span class="font23">parsing, 172</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1388"><span class="font23">peering, 171</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1389"><span class="font23">processing steps, 171–</span></a><a href="#bookmark1430"><span class="font23">175</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1418"><span class="font23">flowchart, 175</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1395"><span class="font23">receiving, 172</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1409"><span class="font23">response creation, 174</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1341"><span class="font23">revalidate hits, 165</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1338"><span class="font23">revalidations, 165</span></a><a href="#bookmark1347"><span class="font23">–166</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1412"><span class="font23">sending, 174</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1428"><span class="font23">server revalidation, 175,</span></a><a href="#bookmark1440"><span class="font23"> 177</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1499"><span class="font23">setting controls, 186</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1388"><span class="font23">sibling caches, 171</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2922"><span class="font23">surrogate caches, 421</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1360"><span class="font23">topologies, 168</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1310"><span class="font23">uses, 161</span></a></p>
<p style="text-align:justify;"><a href="#bookmark714"><span class="font23">caching headers, 68</span></a></p>
<p style="text-align:justify;"><a href="#bookmark362"><span class="font23">caching proxies (see caches)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1368"><span class="font23">caching proxy servers, 169</span></a></p>
<p style="text-align:justify;"><a href="#bookmark491"><span class="font23">canonicalizing of URLs, 37,</span></a><a href="#bookmark1699"><span class="font23"> 220</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3261"><span class="font23">CARP (Cache Array Routing</span></a></p>
<p style="text-indent:36pt;"><a href="#bookmark3261"><span class="font23">Protocol), 475</span></a><a href="#bookmark3267"><span class="font23">–478</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark3266"><span class="font23">disadvantages, 476</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark3263"><span class="font23">ICP vs., 475</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark3266"><span class="font23">redirection method, 476</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2381"><span class="font23">CAs (certificate authorities), 327</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2698"><span class="font23">case sensitivity, language tags, 386</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2921"><span class="font23">CDNs (content distribution networks), 421</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2381"><span class="font23">certificate authorities (CAs), 327</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2334"><span class="font23">certificates (see digital certificates)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1597"><span class="font23">CGI (Common Gateway Interface), 203,</span></a><a href="#bookmark1599"><span class="font23"> 204</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2032"><span class="font23">challenge/response authentication</span></a></p>
<p style="text-indent:36pt;"><span class="font23">model, 278</span></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark758"><span class="font23">challenge headers, 72</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2196"><span class="font23">multiple challenges, 301</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2617"><span class="font23">character encoding schemes, 377, </span></a><a href="#bookmark2653"><span class="font23">381</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2615"><span class="font23">character repertoire, 377</span></a></p>
<p style="text-align:justify;"><a href="#bookmark477"><span class="font23">character sets, 35,</span></a><a href="#bookmark2575"><span class="font23"> 371</span></a><a href="#bookmark2605"><span class="font23">–376</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2567"><span class="font23">encoding, 370</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark482"><span class="font23">mechanisms, 36</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark486"><span class="font23">restricted characters, 36</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2622"><span class="font23">characters, 378</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark474"><span class="font23">URLs, legal in, 35</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2578"><span class="font23">charset tags, 371</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2579"><span class="font23">IANA MIME character set registry</span></a></p>
<p style="text-indent:36pt;"><span class="font23">and, 371</span></p></td>
<td valign="top" style="width:50%;">
<p><a href="#bookmark3776"><span class="font23">chemical/* MIME types, 559</span></a><a href="#bookmark3641"><span class="font23">–561</span></a></p>
<p><a href="#bookmark1120"><span class="font23">child filters, 131</span></a></p>
<p><a href="#bookmark2235"><span class="font23">chosen plaintext attacks, 305</span></a></p>
<p><a href="#bookmark2445"><span class="font23">chunked encodings, 345</span></a></p>
<p><a href="#bookmark2308"><span class="font23">ciphers (see under cryptography)</span></a></p>
<p><a href="#bookmark2270"><span class="font23">ciphertext, 310</span></a></p>
<p><a href="#bookmark2268"><span class="font23">cleartext, 310</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark688"><span class="font23">client error status codes (400-499), 65</span></a><a href="#bookmark693"><span class="font23">–66,</span></a><span class="font23"> </span><a href="#bookmark3368"><span class="font23">505</span></a></p>
<p><a href="#bookmark1002"><span class="font23">client hostname identification, 115</span></a></p>
<p><a href="#bookmark1177"><span class="font23">client proxy configuration, 141–</span></a><a href="#bookmark1197"><span class="font23">144</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1181"><span class="font23">manual, 142</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1186"><span class="font23">PAC (Proxy Auto-configuration)</span></a></p>
<p style="text-indent:36pt;"><a href="#bookmark1186"><span class="font23">protocol, 142,</span></a><a href="#bookmark3189"><span class="font23"> 463</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1193"><span class="font23">WPAD (Web Proxy Autodiscovery</span></a></p>
<p style="text-indent:36pt;"><span class="font23">Protocol), 143</span></p>
<p><a href="#bookmark2779"><span class="font23">client-driven negotiation, 396</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2780"><span class="font23">disadvantages, 396</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1918"><span class="font23">Client-ip headers, 258,</span></a><a href="#bookmark1934"><span class="font23"> 260, </span></a><a href="#bookmark3408"><span class="font23">512</span></a></p>
<p style="text-align:justify;"><span class="font23">clients</span></p>
<p style="text-indent:12pt;"><a href="#bookmark658"><span class="font23">100 Continue status code and, 59</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1491"><span class="font23">freshness constraints, 185</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2898"><span class="font23">Host header requirements, 418</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1913"><span class="font23">identification, 257</span></a><a href="#bookmark2021"><span class="font23">–276</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1945"><span class="font23">fat URLs, using for, 262</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1928"><span class="font23">IP addresses, using for, 259</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1937"><span class="font23">user logins, using for, 260</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1949"><span class="font23">(see also cookies)</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2601"><span class="font23">supported character sets, 375</span></a></p>
<p><a href="#bookmark1570"><span class="font23">client-side gateways, 199</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1586"><span class="font23">security accelerator gateways, 202</span></a></p>
<p><a href="#bookmark1965"><span class="font23">client-side state, 265</span></a></p>
<p><a href="#bookmark2616"><span class="font23">code width, 377</span></a></p>
<p><a href="#bookmark2618"><span class="font23">coded character sets, 377, </span></a><a href="#bookmark2634"><span class="font23">379</span></a></p>
<p><a href="#bookmark2611"><span class="font23">coded characters, 376</span></a></p>
<p><a href="#bookmark2612"><span class="font23">coding space, 376</span></a></p>
<p><a href="#bookmark3058"><span class="font23">collections, 439</span></a></p>
<p><a href="#bookmark2103"><span class="font23">collisions, one-way digests, 288</span></a></p>
<p><a href="#bookmark555"><span class="font23">colon (:), use in headers, 47</span></a></p>
<p><a href="#bookmark3305"><span class="font23">Combined Log Format, 485</span></a></p>
<p><a href="#bookmark1597"><span class="font23">Common Gateway Interface (CGI), 203,</span></a><a href="#bookmark1599"><span class="font23"> 204</span></a></p>
<p><a href="#bookmark3300"><span class="font23">Common Log Format, 484</span></a></p>
<p><a href="#bookmark3593"><span class="font23">composite MIME types, 534</span></a></p>
<p><a href="#bookmark2533"><span class="font23">conditional requests, 362</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark733"><span class="font23">headers, 70,</span></a><a href="#bookmark1447"><span class="font23"> 178</span></a><a href="#bookmark1459"><span class="font23">–181</span></a></p>
<p><a href="#bookmark3197"><span class="font23">configuration URLs (CURLs), 465</span></a></p>
<p><a href="#bookmark1621"><span class="font23">CONNECT method, 206–</span></a><a href="#bookmark1629"><span class="font23">208,</span></a><a href="#bookmark2406"><span class="font23"> 336</span></a></p>
<p><a href="#bookmark827"><span class="font23">connection handshake delays, 82</span></a></p>
<p><a href="#bookmark854"><span class="font23">Connection headers, 86, </span></a><a href="#bookmark3411"><span class="font23">512</span></a><span class="font23"> </span><a href="#bookmark854"><span class="font23">connections (see HTTP connections)</span></a><span class="font23"> </span><a href="#bookmark2921"><span class="font23">content distribution networks (CDNs), 421</span></a><span class="font23"> </span><a href="#bookmark2448"><span class="font23">content encodings, 345, </span></a><a href="#bookmark2483"><span class="font23">351</span></a><a href="#bookmark2496"><span class="font23">–354</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark2836"><span class="font23">content injection, 405</span></a></p>
<p><a href="#bookmark2772"><span class="font23">content negotiation, 395–</span></a><a href="#bookmark2824"><span class="font23">403</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2798"><span class="font23">on Apache web servers, 399</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2779"><span class="font23">client-driven negotiation, 396</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2786"><span class="font23">headers, 397</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2843"><span class="font23">other protocols and, 405</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2843"><span class="font23">performance limitations, 405</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2792"><span class="font23">quality values, 398</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2784"><span class="font23">server-driven negotiation, 397–</span></a><a href="#bookmark2807"><span class="font23">400</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2775"><span class="font23">techniques, 395</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2809"><span class="font23">transparent negotiation, 400–</span></a><a href="#bookmark2824"><span class="font23">403</span></a></p>
<p><a href="#bookmark1136"><span class="font23">content routers, 134,</span></a><a href="#bookmark1383"><span class="font23"> 170</span></a></p>
<p><a href="#bookmark3414"><span class="font23">Content-Base headers, 513</span></a></p>
<p><a href="#bookmark3417"><span class="font23">Content-Encoding headers, 513</span></a></p>
<p><a href="#bookmark2836"><span class="font23">content-injection, 405</span></a></p>
<p><a href="#bookmark2572"><span class="font23">Content-Language headers, 371, </span></a><a href="#bookmark2682"><span class="font23">384,</span></a><a href="#bookmark3420"><span class="font23"> 513</span></a></p>
<p><a href="#bookmark2436"><span class="font23">Content-Length headers, 344–</span></a><span class="font23">347, </span><a href="#bookmark3423"><span class="font23">514</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2448"><span class="font23">content encoding and, 345</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2442"><span class="font23">persistent connections and, 345</span></a></p>
<p><a href="#bookmark3426"><span class="font23">Content-Location headers, 514</span></a></p>
<p><a href="#bookmark2459"><span class="font23">Content-MD5 headers, 347, </span></a><a href="#bookmark3429"><span class="font23">514</span></a></p>
<p><a href="#bookmark3432"><span class="font23">Content-Range headers, 515</span></a></p>
<p><a href="#bookmark2463"><span class="font23">Content-Type headers, 348–</span></a><a href="#bookmark2484"><span class="font23">351, </span></a><a href="#bookmark3435"><span class="font23">515</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2471"><span class="font23">character encodings, 349</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2573"><span class="font23">charset parameter, 371</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2597"><span class="font23">META tags and, 375</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2591"><span class="font23">MIME charset encoding tags and, 374</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2477"><span class="font23">multipart form submissions, 349</span></a></p>
<p style="text-align:justify;"><a href="#bookmark598"><span class="font23">continuation lines, in headers, 51</span></a></p>
<p style="text-align:justify;"><a href="#bookmark656"><span class="font23">Continue status code (100), 59</span></a><a href="#bookmark669"><span class="font23">–60</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3438"><span class="font23">Cookie headers, 516</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3439"><span class="font23">Cookie2 headers, 516</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1949"><span class="font23">cookies, 263–</span></a><a href="#bookmark2024"><span class="font23">276</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1962"><span class="font23">browsers, storage on, 264</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2014"><span class="font23">caching, 273</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1978"><span class="font23">domain attributes, 267</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1956"><span class="font23">functioning, 264</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1956"><span class="font23">information contained in, 264</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1981"><span class="font23">Path attributes, 268</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2018"><span class="font23">privacy and, 275</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2018"><span class="font23">security and, 275</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2010"><span class="font23">session tracking, 272</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1999"><span class="font23">Set-Cookie2 headers, 271</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1984"><span class="font23">specifications, 268</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1977"><span class="font23">third-party vendors, use by, 267</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1953"><span class="font23">types, 264</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1988"><span class="font23">Version 0, 269</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1994"><span class="font23">Version 1, 270</span></a><a href="#bookmark2009"><span class="font23">–272</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2003"><span class="font23">headers, 272</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2006"><span class="font23">version negotiation, 272</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1973"><span class="font23">web site specificity of, 266</span></a></p></td>
<td valign="top" style="width:50%;">
<p><a href="#bookmark3070"><span class="font23">COPY method, 442</span></a></p>
<p><a href="#bookmark2713"><span class="font23">country codes, 388</span></a></p>
<p><a href="#bookmark3777"><span class="font23">country tokens, 388</span></a></p>
<p><a href="#bookmark1665"><span class="font23">crawlers, 215–</span></a><a href="#bookmark1717"><span class="font23">224</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1695"><span class="font23">aliasing, 219</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1699"><span class="font23">canonicalizing of URLs, 220</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1692"><span class="font23">checkpoints, 219</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1674"><span class="font23">cycles, avoiding, 217</span></a><a href="#bookmark1685"><span class="font23">–218, </span></a><a href="#bookmark1710"><span class="font23">222–</span></a><a href="#bookmark1717"><span class="font23">224</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1686"><span class="font23">dups, 218</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1702"><span class="font23">filesystem link cycles, 220</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1690"><span class="font23">hash tables, 218</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1682"><span class="font23">loops, 217</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1691"><span class="font23">lossy presence bit maps, 218</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1693"><span class="font23">partitioning, 219</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1670"><span class="font23">root set, 216</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1690"><span class="font23">search trees, 218</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1687"><span class="font23">tracking of visited sites, 218</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1702"><span class="font23">traps, 220</span></a><a href="#bookmark1717"><span class="font23">–224</span></a></p>
<p style="text-align:justify;"><a href="#bookmark537"><span class="font23">CRLF, 44</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2431"><span class="font23">in entities, 343</span></a></p>
<p><a href="#bookmark2107"><span class="font23">cryptographic checksums, 289</span></a></p>
<p><a href="#bookmark2261"><span class="font23">cryptography, 309</span></a><a href="#bookmark2320"><span class="font23">–317</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2307"><span class="font23">asymmetrically keyed ciphers, 315</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2276"><span class="font23">cipher machines, 311</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2265"><span class="font23">ciphers, 310</span></a><a href="#bookmark2308"><span class="font23">–315</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2285"><span class="font23">digital, 311</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2270"><span class="font23">ciphertext, 310</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2268"><span class="font23">cleartext, 310</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2296"><span class="font23">enumeration attacks, 313</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2318"><span class="font23">hybrid cryptosystems, 317</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2279"><span class="font23">keyed ciphers, 311</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2280"><span class="font23">keys, 311, </span></a><a href="#bookmark2289"><span class="font23">312</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2294"><span class="font23">key length, 313</span></a></p>
<p style="text-align:justify;text-indent:12pt;padding:0pt 0pt 0pt 12pt;"><a href="#bookmark2303"><span class="font23">sharing, logistical aspects of, 315</span></a><span class="font23"> </span><a href="#bookmark2309"><span class="font23">public-key cryptography, 315–</span></a><a href="#bookmark2320"><span class="font23">317</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2319"><span class="font23">computation speed, 317</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2328"><span class="font23">digital signing with, 318</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2315"><span class="font23">RSA algorithm, 317</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2291"><span class="font23">symmetric-key ciphers, 313</span></a></p>
<p><a href="#bookmark3197"><span class="font23">CURLs (configuration URLs), 465</span></a><span class="font23"> </span><a href="#bookmark1674"><span class="font23">cycles, avoiding (web robots), 217</span></a><a href="#bookmark1685"><span class="font23">–218,</span></a><span class="font23"> </span><a href="#bookmark1710"><span class="font23">222–</span></a><a href="#bookmark1717"><span class="font23">224</span></a></p>
<p style="text-indent:12pt;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1703"><span class="font23">filesystem link cycles, 220</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">D</span></p>
<p><a href="#bookmark1138"><span class="font23">data formats, conversion, 135</span></a></p>
<p><a href="#bookmark2754"><span class="font23">date formats, 392</span></a></p>
<p><a href="#bookmark3443"><span class="font23">Date headers, 516</span></a></p>
<p><a href="#bookmark2992"><span class="font23">DAV headers, 431</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3093"><span class="font23">compliance classes, 445</span></a></p>
<p><a href="#bookmark459"><span class="font23">decomposing of URLs, 33</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark2858"><span class="font23">dedicated web hosting, 412</span></a></p>
<p><a href="#bookmark832"><span class="font23">delayed acknowledgements, 83</span></a></p>
<p><a href="#bookmark639"><span class="font23">DELETE method, 58, </span></a><a href="#bookmark3065"><span class="font23">441</span></a></p>
<p><a href="#bookmark2523"><span class="font23">delta encodings, 359, </span></a><a href="#bookmark2545"><span class="font23">365</span></a><a href="#bookmark2551"><span class="font23">–367</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2559"><span class="font23">server disk space and, 368</span></a></p>
<p><a href="#bookmark2558"><span class="font23">delta generators and appliers, 368</span></a></p>
<p><a href="#bookmark3017"><span class="font23">&lt;depth&gt; element, 434</span></a></p>
<p><a href="#bookmark2993"><span class="font23">Depth headers, 431</span></a></p>
<p><a href="#bookmark2998"><span class="font23">Destination headers, 431</span></a></p>
<p><a href="#bookmark2228"><span class="font23">dictionary attacks, 304</span></a></p>
<p><a href="#bookmark3712"><span class="font23">digcalc.c file, 578</span></a></p>
<p><a href="#bookmark3706"><span class="font23">digcalc.h file, 577</span></a></p>
<p><a href="#bookmark2084"><span class="font23">digest authentication, 286</span></a><a href="#bookmark2243"><span class="font23">–306, </span></a><a href="#bookmark3691"><span class="font23">574</span></a><a href="#bookmark3727"><span class="font23">–580</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2126"><span class="font23">algorithms, 291–</span></a><a href="#bookmark2157"><span class="font23">295</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2121"><span class="font23">input data, 291</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2091"><span class="font23">authentication process, 287</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3702"><span class="font23">Authentication-Info directives, 576</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3698"><span class="font23">Authorization directives, 575</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2085"><span class="font23">basic authentication, compared to, 286</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2213"><span class="font23">caching and, 302</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2119"><span class="font23">digest calculations, 291</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2200"><span class="font23">error handling, 301</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3707"><span class="font23">H(A1) and H(A2) reference code, 577</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2114"><span class="font23">handshakes, 290</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2190"><span class="font23">headers, 300</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2129"><span class="font23">MD5 and MD5-sess, 291</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2137"><span class="font23">message-related data (A2), 293, </span></a><a href="#bookmark2180"><span class="font23">298</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2108"><span class="font23">nonces, 289</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2240"><span class="font23">password files, vulnerabilities of, 305</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2163"><span class="font23">preemptive authorization, 296</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2208"><span class="font23">protection space, 302</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3707"><span class="font23">request and response digest reference</span></a></p>
<p style="text-indent:36pt;"><span class="font23">code, 577</span></p>
<p style="text-indent:12pt;"><a href="#bookmark2154"><span class="font23">revalidating a session, 295</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2209"><span class="font23">rewriting URIs, 302</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2085"><span class="font23">security, 286</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2132"><span class="font23">security-related data (A1), 293</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2152"><span class="font23">session, 295</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2178"><span class="font23">symmetric authentication, 298</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3692"><span class="font23">WWW-Authenticate directives, 574</span></a><a href="#bookmark3697"><span class="font23">–575</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2080"><span class="font23">(see also authentication)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2098"><span class="font23">digests, 288</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2122"><span class="font23">algorithm input data, 291</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2103"><span class="font23">collisions, 288</span></a></p>
<p><a href="#bookmark2334"><span class="font23">digital certificates, 319</span></a><a href="#bookmark2350"><span class="font23">–322</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2339"><span class="font23">public-key cryptography and, 320</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2345"><span class="font23">server authentication, use for, 321</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2340"><span class="font23">universal standard, lack of, 320</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2382"><span class="font23">virtual hosting and, 328</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2340"><span class="font23">X.509v3 certificates, 320</span></a></p>
<p><a href="#bookmark2320"><span class="font23">digital cryptography (see cryptography)</span></a><span class="font23"> </span><a href="#bookmark2323"><span class="font23">digital signatures, 317–</span></a><a href="#bookmark2336"><span class="font23">319</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark2329"><span class="font23">example, 318</span></a></p>
<p><a href="#bookmark3724"><span class="font23">digtest.c file, 580</span></a></p>
<p><a href="#bookmark1055"><span class="font23">directory listings, 122</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1060"><span class="font23">disabling, 123</span></a></p>
<p><a href="#bookmark3590"><span class="font23">discrete MIME types, 534</span></a></p>
<p><a href="#bookmark1328"><span class="font23">distance delays, 163</span></a></p>
<p><a href="#bookmark1878"><span class="font23">distributed objects (HTTP:NG), 249</span></a></p>
<p><span class="font23">DNS</span></p>
<p style="text-indent:12pt;"><a href="#bookmark3147"><span class="font23">caching, 456</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3207"><span class="font23">DNS A record lookup, 467</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3128"><span class="font23">redirection, 453</span></a><a href="#bookmark3154"><span class="font23">–457</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3150"><span class="font23">enhanced algorithms for, 457</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3138"><span class="font23">multiple addresses and round-robin</span></a></p>
<p style="text-indent:36pt;"><span class="font23">address rotation, 455</span></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark3130"><span class="font23">resolvers, 453</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark3135"><span class="font23">round robin, 454, </span></a><a href="#bookmark3139"><span class="font23">455</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3143"><span class="font23">load balancing with, 456</span></a></p>
<p><a href="#bookmark1040"><span class="font23">docroots (document roots), 120</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1051"><span class="font23">private, 122</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1051"><span class="font23">user home directory, 122</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1046"><span class="font23">virtually hosted, 121</span></a></p>
<p><a href="#bookmark1124"><span class="font23">document access control, 132</span></a></p>
<p><a href="#bookmark1429"><span class="font23">document expiration, 175</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1469"><span class="font23">setting, 182</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1349"><span class="font23">document hit rate, 167</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1040"><span class="font23">document roots (see docroots)</span></a></p>
<p style="text-align:justify;"><span class="font23">documents</span></p>
<p style="text-indent:12pt;"><a href="#bookmark1514"><span class="font23">age and freshness lifetime, 188</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1519"><span class="font23">age-calculation algorithms, 189–</span></a><a href="#bookmark1542"><span class="font23">194</span></a></p>
<p style="text-indent:12pt;"><span class="font23">caching, preventing, 182</span></p>
<p style="text-indent:12pt;"><a href="#bookmark1510"><span class="font23">freshness and aging algorithms, 187</span></a><a href="#bookmark1542"><span class="font23">–194</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1485"><span class="font23">heuristic expiration, 184</span></a></p>
<p><a href="#bookmark338"><span class="font23">Domain Name Service (see DNS)</span></a></p>
<p><a href="#bookmark2755"><span class="font23">domain names, internationalization of, 392</span></a></p>
<p><a href="#bookmark533"><span class="font23">downstream message flow, 44</span></a></p>
<p><a href="#bookmark1686"><span class="font23">dups (web robots), 218</span></a></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark1061"><span class="font23">dynamic content resource mapping, 123</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">E</span></p>
<p><a href="#bookmark1150"><span class="font23">egress proxies, 137</span></a></p>
<p><a href="#bookmark982"><span class="font23">embedded web servers, 111</span></a></p>
<p><a href="#bookmark2585"><span class="font23">encodings, 372</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2445"><span class="font23">chunked encodings, 345</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2448"><span class="font23">content encodings, 345, </span></a><a href="#bookmark2483"><span class="font23">351</span></a><a href="#bookmark2496"><span class="font23">–354</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2523"><span class="font23">delta encodings, 359, </span></a><a href="#bookmark2545"><span class="font23">365</span></a><a href="#bookmark2551"><span class="font23">–367</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark2559"><span class="font23">impact on server disk space, 368</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2657"><span class="font23">fixed-width, 381</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2497"><span class="font23">transfer encodings, 354</span></a><a href="#bookmark2519"><span class="font23">–359</span></a></p>
<p><a href="#bookmark537"><span class="font23">end-of-line sequence, 44</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark2424"><span class="font23">entities, 342</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2452"><span class="font23">body length, determining, 346</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2436"><span class="font23">Content-Length headers, 344–</span></a><span class="font23">347</span></p>
<p style="text-indent:12pt;"><a href="#bookmark2431"><span class="font23">CRLF line, 343</span></a></p>
<p><a href="#bookmark541"><span class="font23">entity bodies, 44, </span></a><a href="#bookmark556"><span class="font23">47, </span></a><a href="#bookmark602"><span class="font23">52, </span></a><a href="#bookmark2429"><span class="font23">343</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2464"><span class="font23">MIME types, 348</span></a></p>
<p><span class="font23">entity digests, 347</span></p>
<p><a href="#bookmark708"><span class="font23">entity headers (see under headers)</span></a></p>
<p><a href="#bookmark1457"><span class="font23">entity tags (see ETags)</span></a></p>
<p><a href="#bookmark2296"><span class="font23">enumeration attacks, 313</span></a></p>
<p><a href="#bookmark3679"><span class="font23">equals sign (=), base-64 encoding, 572</span></a></p>
<p><a href="#bookmark483"><span class="font23">escape sequences, 36</span></a></p>
<p><a href="#bookmark1457"><span class="font23">ETags (entity tags), 180,</span></a><a href="#bookmark2176"><span class="font23"> 298</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3448"><span class="font23">headers, 517</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1464"><span class="font23">using, 181</span></a></p>
<p><a href="#bookmark2674"><span class="font23">euc-jp encoding, 383</span></a></p>
<p><a href="#bookmark3451"><span class="font23">Expect headers, 517</span></a></p>
<p><a href="#bookmark3661"><span class="font23">experimental MIME types, 569</span></a></p>
<p><a href="#bookmark1469"><span class="font23">expiration of documents, setting, 182</span></a></p>
<p><a href="#bookmark1427"><span class="font23">Expires headers, 175,</span></a><a href="#bookmark1479"><span class="font23"> 183, </span></a><a href="#bookmark3454"><span class="font23">517</span></a></p>
<p><a href="#bookmark1082"><span class="font23">explicit MIME typing, 126</span></a></p>
<p><a href="#bookmark1612"><span class="font23">Extensible Markup Language (see XML)</span></a></p>
<p><a href="#bookmark1602"><span class="font23">extension APIs, 205</span></a></p>
<p><a href="#bookmark595"><span class="font23">extension headers, 51, </span></a><a href="#bookmark709"><span class="font23">68</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark642"><span class="font23">extension methods, 58</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">F</span></p>
<p><a href="#bookmark1603"><span class="font23">Fast CGI, 205</span></a></p>
<p><a href="#bookmark1945"><span class="font23">fat URLs, 262</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1948"><span class="font23">limitations of, 263</span></a></p>
<p><a href="#bookmark505"><span class="font23">file scheme, 39</span></a></p>
<p><a href="#bookmark1702"><span class="font23">filesystem link cycles, 220</span></a></p>
<p><a href="#bookmark1190"><span class="font23">FindProxyForURL( ) method, 143</span></a></p>
<p><a href="#bookmark2105"><span class="font23">fingerprint functions, 289</span></a></p>
<p><a href="#bookmark2707"><span class="font23">first subtag, 387</span></a></p>
<p><a href="#bookmark2657"><span class="font23">fixed-width encodings, 381</span></a></p>
<p><a href="#bookmark1326"><span class="font23">flash crowds, 163</span></a></p>
<p><a href="#bookmark2830"><span class="font23">format conversion, 404</span></a></p>
<p><a href="#bookmark2963"><span class="font23">FPAdminScriptUrl, 426</span></a></p>
<p><a href="#bookmark2962"><span class="font23">FPAuthorScriptUrl, 426</span></a></p>
<p><a href="#bookmark2961"><span class="font23">FPShtmlScriptUrl, 426</span></a></p>
<p><a href="#bookmark2974"><span class="font23">Fpsrvadm, 428</span></a></p>
<p><a href="#bookmark433"><span class="font23">frag or fragment component, URLs, 30</span></a></p>
<p><a href="#bookmark1510"><span class="font23">freshness and aging algorithms, 187</span></a><a href="#bookmark1542"><span class="font23">–194</span></a></p>
<p><a href="#bookmark1514"><span class="font23">freshness lifetime, 188</span></a></p>
<p><a href="#bookmark1925"><span class="font23">From headers, 258, </span></a><a href="#bookmark3457"><span class="font23">517</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1726"><span class="font23">robots and, 225</span></a></p>
<p><a href="#bookmark2941"><span class="font23">FrontPage, 424–</span></a><a href="#bookmark2977"><span class="font23">429</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2957"><span class="font23">client and server extension</span></a></p>
<p style="text-indent:36pt;"><span class="font23">communication, 426</span></p></td>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark2944"><span class="font23">FrontPage Server Extensions (FPSE), 424</span></a><span class="font23"> </span><a href="#bookmark2948"><span class="font23">HTTP POST requests and, 425</span></a><span class="font23"> </span><a href="#bookmark2968"><span class="font23">listExploreDocs element, POST request</span></a><span class="font23"> body, 427</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2966"><span class="font23">listHiddenDocs element, POST request</span></a><span class="font23"> body, 427</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2954"><span class="font23">root web, 425</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2955"><span class="font23">RPC protocol, 426</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2971"><span class="font23">security, 428</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2974"><span class="font23">server administrator utility</span></a></p>
<p style="text-indent:37pt;"><span class="font23">(Fpsrvadm), 428</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2967"><span class="font23">service_name element, POST request</span></a><span class="font23"> body, 427</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2956"><span class="font23">subweb, 426</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2950"><span class="font23">virtual servers, 425</span></a></p>
<p><a href="#bookmark3778"><span class="font23">ftp scheme, 39</span></a></p>
<p><a href="#bookmark3172"><span class="font23">full NAT, 461</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1839"><span class="font23">full-text indexes, 243</span></a></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font6" style="font-weight:bold;">G</span></p>
<p><a href="#bookmark366"><span class="font23">gateways, 19,</span></a><a href="#bookmark1564"><span class="font23"> 197</span></a><a href="#bookmark1606"><span class="font23">–205</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1570"><span class="font23">client- and server-side, 199</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1586"><span class="font23">client-side security accelerator</span></a></p>
<p style="text-indent:37pt;"><span class="font23">gateways, 202</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1568"><span class="font23">examples, 198</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1575"><span class="font23">protocol gateways, 200</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1115"><span class="font23">proxies, contrasted with, 130</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1592"><span class="font23">resource gateways, 203</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1583"><span class="font23">server-side security gateways, 202</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1578"><span class="font23">server-side web gateways, 200</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1256"><span class="font23">Via headers and, 153</span></a></p>
<p><a href="#bookmark710"><span class="font23">general headers (see under headers)</span></a><span class="font23"> </span><a href="#bookmark974"><span class="font23">general-purpose software web servers, 110</span></a><span class="font23"> </span><a href="#bookmark3246"><span class="font23">Generic Router Encapsulation (GRE), 472</span></a><span class="font23"> </span><a href="#bookmark2871"><span class="font23">GET command, virtual hosting issues, 414</span></a><span class="font23"> </span><a href="#bookmark1390"><span class="font23">GET messages, processing steps, 171–</span></a><a href="#bookmark1419"><span class="font23">175</span></a><span class="font23"> </span><a href="#bookmark615"><span class="font23">GET method, 53</span></a></p>
<p><a href="#bookmark1930"><span class="font23">getpeername function, 259</span></a></p>
<p><a href="#bookmark2625"><span class="font23">glyphs, 378</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3246"><span class="font23">GRE (Generic Router Encapsulation), 472</span></a></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font6" style="font-weight:bold;">H</span></p>
<p><a href="#bookmark3707"><span class="font23">H(A1) and H(A2) reference code, 577</span></a></p>
<p><a href="#bookmark3173"><span class="font23">half NAT, 461</span></a></p>
<p><a href="#bookmark827"><span class="font23">handshake delays, 82</span></a></p>
<p><a href="#bookmark2115"><span class="font23">handshakes, digest authentication, 290</span></a></p>
<p><a href="#bookmark1690"><span class="font23">hash tables, 218</span></a></p>
<p><a href="#bookmark2122"><span class="font23">H(d), one-way hash, 291</span></a></p>
<p><a href="#bookmark619"><span class="font23">HEAD method, 54</span></a></p>
<p><a href="#bookmark2453"><span class="font23">HEAD response, 346</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark553"><span class="font23">headers, 47, </span></a><a href="#bookmark584"><span class="font23">51, </span></a><a href="#bookmark700"><span class="font23">67–</span></a><a href="#bookmark770"><span class="font23">73,</span></a><a href="#bookmark3779"><span class="font23"> 508–</span></a><a href="#bookmark3568"><span class="font23">532</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark727"><span class="font23">Accept, 69, </span></a><a href="#bookmark3379"><span class="font23">508</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1725"><span class="font23">robots and, 225</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2571"><span class="font23">Accept-Charset, 371, </span></a><a href="#bookmark2602"><span class="font23">375, </span></a><a href="#bookmark3382"><span class="font23">509</span></a></p>
<p style="text-align:justify;text-indent:25pt;"><a href="#bookmark2591"><span class="font23">MIME charset encoding tags and, 374</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3386"><span class="font23">Accept-Encoding, 509</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2571"><span class="font23">Accept-Language, 371, </span></a><a href="#bookmark2686"><span class="font23">385, </span></a><a href="#bookmark3389"><span class="font23">510</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2793"><span class="font23">content negotiation and, 398</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3392"><span class="font23">Accept-Ranges, 510</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3395"><span class="font23">Age, 510</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1300"><span class="font23">Allow, 159, </span></a><a href="#bookmark3398"><span class="font23">511</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2037"><span class="font23">authentication, 278</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2050"><span class="font23">basic, 281,</span></a><a href="#bookmark2193"><span class="font23"> 300</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2190"><span class="font23">digest, 300</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3702"><span class="font23">Authentication-Info directives, 576</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2055"><span class="font23">Authorization, 281, </span></a><a href="#bookmark3401"><span class="font23">511</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3698"><span class="font23">directives, 575</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2159"><span class="font23">preemptive generation, 295</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1427"><span class="font23">Cache-Control, 175–</span></a><a href="#bookmark1441"><span class="font23">177,</span></a><a href="#bookmark1469"><span class="font23"> 182</span></a><a href="#bookmark1506"><span class="font23">–186,</span></a><a href="#bookmark1517"><span class="font23"> 189,</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark3405"><span class="font23">511</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2529"><span class="font23">directives, 361</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2750"><span class="font23">character set requirements, 392</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark586"><span class="font23">classification, 51</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1919"><span class="font23">client identification using, 258</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1918"><span class="font23">Client-ip, 258, </span></a><a href="#bookmark1934"><span class="font23">260,</span></a><a href="#bookmark3408"><span class="font23"> 512</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark855"><span class="font23">Connection, 86, </span></a><a href="#bookmark3411"><span class="font23">512</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2787"><span class="font23">content negotiation, 397</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3414"><span class="font23">Content-Base, 513</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3417"><span class="font23">Content-Encoding, 513</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2572"><span class="font23">Content-Language, 371, </span></a><a href="#bookmark2682"><span class="font23">384, </span></a><a href="#bookmark3420"><span class="font23">513</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2436"><span class="font23">Content-Length, 344–</span></a><span class="font23">347, </span><a href="#bookmark3423"><span class="font23">514</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3426"><span class="font23">Content-Location, 514</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2459"><span class="font23">Content-MD5, 347, </span></a><a href="#bookmark3429"><span class="font23">514</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3432"><span class="font23">Content-Range, 515</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2463"><span class="font23">Content-Type, 348</span></a><a href="#bookmark2484"><span class="font23">–351, </span></a><a href="#bookmark3435"><span class="font23">515</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2573"><span class="font23">charset parameter, 371</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark598"><span class="font23">continuation lines, 51</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3438"><span class="font23">Cookie, 516</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3439"><span class="font23">Cookie2, 516</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3443"><span class="font23">Date, 516</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2992"><span class="font23">DAV, 431</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3093"><span class="font23">compliance classes, 445</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2993"><span class="font23">Depth, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2998"><span class="font23">Destination, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark592"><span class="font23">entity headers, 51,</span></a><a href="#bookmark708"><span class="font23"> 67,</span></a><a href="#bookmark761"><span class="font23"> 72</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark764"><span class="font23">content headers, 72</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark767"><span class="font23">entity caching headers, 73</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2427"><span class="font23">HTTP/1.1, 342</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3448"><span class="font23">ETag, 517</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark597"><span class="font23">examples, 51</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3451"><span class="font23">Expect, 517</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1427"><span class="font23">Expires, 175,</span></a><a href="#bookmark1479"><span class="font23"> 183, </span></a><a href="#bookmark3454"><span class="font23">517</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark709"><span class="font23">extension headers, 68</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3457"><span class="font23">From, 517</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1726"><span class="font23">robots and, 225</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark589"><span class="font23">general headers, 51, </span></a><a href="#bookmark704"><span class="font23">67, </span></a><a href="#bookmark710"><span class="font23">68</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark714"><span class="font23">caching headers, 68</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1489"><span class="font23">Heuristic Expiration Warning, 184</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2887"><span class="font23">Host, 417, </span></a><a href="#bookmark2892"><span class="font23">418,</span></a><a href="#bookmark2900"><span class="font23"> 419, </span></a><a href="#bookmark3460"><span class="font23">518</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1728"><span class="font23">robots and, 225</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3283"><span class="font23">HTCP cache headers, 480</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3000"><span class="font23">If, 431</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3468"><span class="font23">If-Match, 519</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1344"><span class="font23">If-Modified-Since, 166,</span></a><a href="#bookmark1448"><span class="font23"> 178,</span></a><a href="#bookmark3463"><span class="font23"> 518</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1454"><span class="font23">If-None-Match, 180, </span></a><a href="#bookmark3469"><span class="font23">519</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3472"><span class="font23">If-Range, 519</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3475"><span class="font23">If-Unmodified-Since, 520</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3478"><span class="font23">Last-Modified, 520</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3481"><span class="font23">Location, 520</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3001"><span class="font23">Lock-Token, 431</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1475"><span class="font23">max-age, 183</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1274"><span class="font23">Max-Forwards, 155, </span></a><a href="#bookmark3484"><span class="font23">521</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2466"><span class="font23">for media types, 348</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1554"><span class="font23">Meter, 196, </span></a><a href="#bookmark3341"><span class="font23">493</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3487"><span class="font23">MIME-Version, 521</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">must-revalidate, 183</span></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">no-cache, 182</span></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">no-store, 182</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3003"><span class="font23">Overwrite, 432,</span></a><a href="#bookmark3071"><span class="font23"> 442</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark716"><span class="font23">Pragma, 68, </span></a><span class="font23">182, </span><a href="#bookmark3490"><span class="font23">521</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3493"><span class="font23">Proxy-Authenticate, 522</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3496"><span class="font23">Proxy-Authorization, 522</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark916"><span class="font23">Proxy-Connection, 96,</span></a><a href="#bookmark3499"><span class="font23"> 523</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3503"><span class="font23">Public, 523</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3506"><span class="font23">Range, 524</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1926"><span class="font23">Referer, 259,</span></a><a href="#bookmark3509"><span class="font23"> 524</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1727"><span class="font23">robots and, 225</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark590"><span class="font23">request headers, 51,</span></a><a href="#bookmark706"><span class="font23"> 67,</span></a><a href="#bookmark721"><span class="font23"> 69</span></a><a href="#bookmark745"><span class="font23">–71</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark727"><span class="font23">accept headers, 69</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1920"><span class="font23">client identification using, 258</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark733"><span class="font23">conditional request headers, 70</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark740"><span class="font23">proxy request headers, 70</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark736"><span class="font23">request security headers, 70</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark591"><span class="font23">response headers, 51, </span></a><a href="#bookmark707"><span class="font23">67, </span></a><a href="#bookmark746"><span class="font23">71</span></a><a href="#bookmark759"><span class="font23">–72</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark751"><span class="font23">negotiation headers, 71</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark755"><span class="font23">response security headers, 72</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3514"><span class="font23">Retry-After, 525</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3515"><span class="font23">Server, 525</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1958"><span class="font23">Set-Cookie, 264, </span></a><a href="#bookmark3518"><span class="font23">525</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2017"><span class="font23">caching and, 273</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1978"><span class="font23">domain attributes, 267</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1999"><span class="font23">Set-Cookie2, 271,</span></a><a href="#bookmark3521"><span class="font23"> 526</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><span class="font23">headers (</span><span class="font23" style="font-style:italic;">continued</span><span class="font23">)</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark596"><span class="font23">syntax, 51</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2217"><span class="font23">tampering attack, 303</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3523"><span class="font23">TE, 526</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3004"><span class="font23">Timeout, 432, </span></a><a href="#bookmark3026"><span class="font23">435</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3529"><span class="font23">Title, 527</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3526"><span class="font23">Trailer, 526</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3532"><span class="font23">Transfer-Encoding, 527</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3535"><span class="font23">UA-, 527</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">for uncachable documents, 182</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1289"><span class="font23">unsupported headers, handling, 158</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3538"><span class="font23">Upgrade, 528</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1722"><span class="font23">User-Agent, 225, </span></a><a href="#bookmark1927"><span class="font23">259,</span></a><a href="#bookmark3541"><span class="font23"> 528</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2820"><span class="font23">Vary, 402,</span></a><a href="#bookmark3544"><span class="font23"> 529</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1245"><span class="font23">Via, 151–</span></a><a href="#bookmark1263"><span class="font23">154, </span></a><a href="#bookmark3547"><span class="font23">529</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2465"><span class="font23">Want-Digest, 348</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3550"><span class="font23">Warning, 530</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1489"><span class="font23">Warning 13, 184</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2994"><span class="font23">for WebDAV, 431</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2055"><span class="font23">WWW-Authenticate, 281, </span></a><a href="#bookmark3553"><span class="font23">531,</span></a><a href="#bookmark3692"><span class="font23"> 574–</span></a><a href="#bookmark3697"><span class="font23">575</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3556"><span class="font23">X-Cache, 531</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1935"><span class="font23">X-Forwarded-For, 260, </span></a><a href="#bookmark3557"><span class="font23">531</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3562"><span class="font23">X-Pad, 531</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3565"><span class="font23">X-Serial-Number, 532</span></a></p>
<p><a href="#bookmark3253"><span class="font23">heartbeat messages, 473</span></a></p>
<p><a href="#bookmark1485"><span class="font23">heuristic expiration of documents, 184</span></a></p>
<p><a href="#bookmark1489"><span class="font23">Heuristic Expiration Warning headers, 184</span></a></p>
<p><a href="#bookmark470"><span class="font23">history expansion, 34</span></a></p>
<p><a href="#bookmark1550"><span class="font23">hit logs, 195</span></a></p>
<p><a href="#bookmark3332"><span class="font23">hit metering, 492–</span></a><a href="#bookmark3780"><span class="font23">494</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3341"><span class="font23">Meter headers, 493</span></a></p>
<p><a href="#bookmark1348"><span class="font23">hit rate, 167</span></a></p>
<p><a href="#bookmark414"><span class="font23">host component, URLs, 27</span></a></p>
<p><a href="#bookmark2888"><span class="font23">Host headers, 417, </span></a><a href="#bookmark2892"><span class="font23">418,</span></a><a href="#bookmark3460"><span class="font23"> 518</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2898"><span class="font23">clients, requirements for, 418</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2900"><span class="font23">missing host headers, 419</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2899"><span class="font23">proxies and, 418,</span></a><a href="#bookmark2906"><span class="font23"> 419</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1728"><span class="font23">robots and, 225</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2901"><span class="font23">web servers, interpretation by, 419</span></a></p>
<p><a href="#bookmark2231"><span class="font23">hostile proxies, 304</span></a></p>
<p><a href="#bookmark2855"><span class="font23">hosting services, 411</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2858"><span class="font23">dedicated web hosting, 412</span></a></p>
<p><a href="#bookmark467"><span class="font23">hostname expansion, 34</span></a></p>
<p><a href="#bookmark337"><span class="font23">hostnames, 13</span></a></p>
<p><a href="#bookmark3046"><span class="font23">&lt;href&gt; element, 438</span></a></p>
<p><a href="#bookmark2976"><span class="font23">.htaccess, 428</span></a></p>
<p><a href="#bookmark3268"><span class="font23">HTCP (Hyper Text Caching</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark3268"><span class="font23">Protocol), 478</span></a><a href="#bookmark3286"><span class="font23">–481</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3277"><span class="font23">authentication, 480</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3283"><span class="font23">cache headers, 480</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3282"><span class="font23">caching policies, setting, 480</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3274"><span class="font23">data components, 479</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark3271"><span class="font23">message structure, 478</span></a><span class="font23"> </span><a href="#bookmark3276"><span class="font23">opcodes, 480</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font23">HTML (Hypertext Markup Language) </span><a href="#bookmark341"><span class="font23">displaying resources using HTTP, 13</span></a><span class="font23"> </span><a href="#bookmark452"><span class="font23">documents, relative URLs in, 31</span></a><span class="font23"> </span><a href="#bookmark434"><span class="font23">fragments, referencing, 30</span></a><span class="font23"> </span><a href="#bookmark1811"><span class="font23">robot-control META tags, 237</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark211"><span class="font23">HTTP (Hypertext Transfer Protocol), xiii,</span></a><span class="font23"> </span><a href="#bookmark265"><span class="font23">3</span></a><a href="#bookmark324"><span class="font23">–11,</span></a><a href="#bookmark1864"><span class="font23"> 247</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark2033"><span class="font23">authentication, challenge/response</span></a><span class="font23"> framework, 278</span></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 12pt;"><a href="#bookmark2033"><span class="font23">(see also authentication)</span></a><span class="font23"> </span><a href="#bookmark2218"><span class="font23">authentication schemes, security</span></a><span class="font23"> risks, 303</span></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark3672"><span class="font23">base-64 encoding, compatibility</span></a><span class="font23"> with, 570</span></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark1311"><span class="font23">caching (see caches)</span></a><span class="font23"> </span><a href="#bookmark2575"><span class="font23">character sets (see character sets)</span></a><span class="font23"> </span><a href="#bookmark269"><span class="font23">clients and servers, 4</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3781"><span class="font23">commands, 8</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark1621"><span class="font23">CONNECT method, 206–</span></a><a href="#bookmark1629"><span class="font23">208</span></a><span class="font23"> </span><a href="#bookmark778"><span class="font23">connections (see HTTP connections)</span></a><span class="font23"> </span><a href="#bookmark2423"><span class="font23">entities (see entities)</span></a><span class="font23"> </span><a href="#bookmark1919"><span class="font23">headers (see headers)</span></a><span class="font23"> </span><a href="#bookmark3333"><span class="font23">hit metering extension, 492</span></a><span class="font23"> </span><a href="#bookmark354"><span class="font23">HTTP-NG (see HTTP-NG)</span></a><span class="font23"> </span><a href="#bookmark381"><span class="font23">informational resources, 21</span></a><span class="font23"> </span><a href="#bookmark2521"><span class="font23">instance manipulations, 359</span></a><span class="font23"> </span><a href="#bookmark2568"><span class="font23">international content support, 370</span></a><span class="font23"> </span><a href="#bookmark1867"><span class="font23">limitations, 248</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark312"><span class="font23">messages (see HTTP messages)</span></a><span class="font23"> </span><a href="#bookmark3781"><span class="font23">methods, 8</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark813"><span class="font23">performance considerations (see under</span></a><span class="font23"> TCP)</span></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark1103"><span class="font23">proxy servers (see HTTP proxy servers)</span></a><span class="font23"> </span><a href="#bookmark3123"><span class="font23">redirection, 452</span></a><a href="#bookmark3129"><span class="font23">–453</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark1652"><span class="font23">relays, 212</span></a><span class="font23"> </span><a href="#bookmark266"><span class="font23">reliability of, 3</span></a><span class="font23"> </span><a href="#bookmark1338"><span class="font23">revalidations, 165</span></a><a href="#bookmark1347"><span class="font23">–166</span></a><span class="font23"> </span><a href="#bookmark1719"><span class="font23">robots, standards for, 225</span></a><span class="font23"> </span><a href="#bookmark2249"><span class="font23">secure HTTP (see HTTPS)</span></a><span class="font23"> </span><a href="#bookmark301"><span class="font23">status codes, 9,</span></a><a href="#bookmark3362"><span class="font23"> 505–</span></a><a href="#bookmark3377"><span class="font23">507</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark813"><span class="font23">TCP, dependency on, 80</span></a><span class="font23"> </span><a href="#bookmark311"><span class="font23">textual basis of, 10</span></a><span class="font23"> </span><a href="#bookmark293"><span class="font23">transactions, 8</span></a></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 12pt;"><a href="#bookmark817"><span class="font23">delays, causes of, 80</span></a><span class="font23"> </span><a href="#bookmark2438"><span class="font23">truncation detection, 344</span></a><span class="font23"> </span><a href="#bookmark347"><span class="font23">versions, 16</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark778"><span class="font23">HTTP connections, 74, </span></a><a href="#bookmark785"><span class="font23">75, </span></a><a href="#bookmark852"><span class="font23">86–</span></a><a href="#bookmark954"><span class="font23">104</span></a><span class="font23"> </span><a href="#bookmark933"><span class="font23">closing, 101–</span></a><a href="#bookmark954"><span class="font23">104</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark854"><span class="font23">Connection headers, 86, </span></a><a href="#bookmark3411"><span class="font23">512</span></a><span class="font23"> </span><a href="#bookmark332"><span class="font23">establishing, 13,</span></a><a href="#bookmark343"><span class="font23"> 15–</span></a><a href="#bookmark347"><span class="font23">16</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark893"><span class="font23">keep-alive connections</span></a><span class="font23"> </span><a href="#bookmark893"><span class="font23">(HTTP/1.0+), 91</span></a><a href="#bookmark912"><span class="font23">–96</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark867"><span class="font23">parallel (see parallel connections)</span></a><span class="font23"> </span><a href="#bookmark884"><span class="font23">persistent (see persistent connections)</span></a><span class="font23"> </span><a href="#bookmark928"><span class="font23">pipelined connections, 99</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark917"><span class="font23">Proxy-Connection headers, 96,</span></a><a href="#bookmark3500"><span class="font23"> 523</span></a><span class="font23"> </span><a href="#bookmark861"><span class="font23">serial loading, 87</span></a><span class="font23"> </span><a href="#bookmark779"><span class="font23">(see also TCP)</span></a></p>
<p><a href="#bookmark292"><span class="font23">HTTP messages, 8,</span></a><a href="#bookmark312"><span class="font23"> 10,</span></a><a href="#bookmark520"><span class="font23"> 43</span></a><a href="#bookmark772"><span class="font23">–73</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark556"><span class="font23">entity bodies, 47, </span></a><a href="#bookmark602"><span class="font23">52</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark320"><span class="font23">example, 11</span></a><span class="font23"> </span><a href="#bookmark525"><span class="font23">flow, 43</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1390"><span class="font23">GET messages, processing steps, 171–</span></a><a href="#bookmark1419"><span class="font23">175</span></a><span class="font23"> </span><a href="#bookmark701"><span class="font23">headers (see headers)</span></a><span class="font23"> </span><a href="#bookmark610"><span class="font23">methods (see methods)</span></a><span class="font23"> </span><a href="#bookmark554"><span class="font23">reason phrases, 47, </span></a><a href="#bookmark578"><span class="font23">50</span></a><span class="font23"> </span><a href="#bookmark3117"><span class="font23">redirection of, 450</span></a><span class="font23"> </span><a href="#bookmark563"><span class="font23">request lines, 48</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1737"><span class="font23">robots, setting conditions for, 226</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark551"><span class="font23">request URLs, 46</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark564"><span class="font23">response lines, 48</span></a></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1741"><span class="font23">robots, handling by, 227</span></a><span class="font23"> </span><a href="#bookmark558"><span class="font23">start lines, 47–</span></a><a href="#bookmark585"><span class="font23">51</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark648"><span class="font23">status codes (see status codes)</span></a><span class="font23"> </span><a href="#bookmark534"><span class="font23">structure, 44</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark544"><span class="font23">syntax, 45</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1240"><span class="font23">tracing across proxies, 150</span></a><a href="#bookmark1285"><span class="font23">–157</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1245"><span class="font23">Via headers, 151–</span></a><a href="#bookmark1263"><span class="font23">154</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark603"><span class="font23">Version 0.9 messages, 52</span></a><span class="font23"> </span><a href="#bookmark552"><span class="font23">versions, 46,</span></a><a href="#bookmark580"><span class="font23"> 50</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1104"><span class="font23">HTTP proxy servers, 129–</span></a><a href="#bookmark3782"><span class="font23">160</span></a><span class="font23"> </span><a href="#bookmark1281"><span class="font23">authentication, 156</span></a><span class="font23"> </span><a href="#bookmark1177"><span class="font23">client proxy configuration, 141–</span></a><a href="#bookmark1197"><span class="font23">144</span></a><span class="font23"> </span><a href="#bookmark1170"><span class="font23">client traffic acquisition, 140</span></a><span class="font23"> </span><a href="#bookmark1148"><span class="font23">deploying, 137</span></a><span class="font23"> </span><a href="#bookmark1287"><span class="font23">interoperation, 157</span></a><a href="#bookmark1303"><span class="font23">–160</span></a><span class="font23"> </span><a href="#bookmark1241"><span class="font23">messages, tracing, 150</span></a><a href="#bookmark1285"><span class="font23">–157</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1213"><span class="font23">proxy and server requests, handling, 146</span></a><span class="font23"> </span><a href="#bookmark1158"><span class="font23">proxy hierarchies, 138</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1108"><span class="font23">public and private proxies, 130</span></a><span class="font23"> </span><a href="#bookmark1269"><span class="font23">TRACE method and network</span></a></p>
<p style="text-indent:24pt;padding:0pt 0pt 0pt 13pt;"><span class="font23">diagnosis, 155 </span><a href="#bookmark1289"><span class="font23">unsupported headers and methods,</span></a><span class="font23"> handling, 158</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1218"><span class="font23">URIs, in-flight modification of, 147</span></a><span class="font23"> </span><a href="#bookmark1119"><span class="font23">uses, 131</span></a><a href="#bookmark1146"><span class="font23">–136</span></a></p>
<p><a href="#bookmark500"><span class="font23">http scheme, 38</span></a></p>
<p><a href="#bookmark1966"><span class="font23">HTTP State Management Mechanism, 265</span></a><span class="font23"> </span><a href="#bookmark1868"><span class="font23">HTTP: The Next Generation (see HTTP-NG)</span></a><span class="font23"> </span><a href="#bookmark348"><span class="font23">HTTP/0.9, 16</span></a></p></td>
<td valign="top" style="width:50%;">
<p><a href="#bookmark351"><span class="font23">HTTP/1.0, 16</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2868"><span class="font23">server requests to virtual hosts, problems</span></a><span class="font23"> with, 413</span></p>
<p><a href="#bookmark352"><span class="font23">HTTP/1.0+, 17</span></a></p>
<p><a href="#bookmark353"><span class="font23">HTTP/1.1, 17</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3081"><span class="font23">enhanced methods, 444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2427"><span class="font23">entity header fields, 342</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2893"><span class="font23">Host headers (see Host headers)</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1867"><span class="font23">limitations, 248</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark928"><span class="font23">request pipelining, 99</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1271"><span class="font23">TRACE method, 155</span></a></p>
<p><a href="#bookmark354"><span class="font23">HTTP/2.0, 17</span></a></p>
<p><a href="#bookmark1507"><span class="font23">HTTP-EQUIV tag, 187</span></a></p>
<p><a href="#bookmark354"><span class="font23">HTTP-NG (HTTP: The Next</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark354"><span class="font23">Generation), 17, </span></a><a href="#bookmark1868"><span class="font23">248–</span></a><a href="#bookmark1904"><span class="font23">253</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1901"><span class="font23">current status, 252</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1875"><span class="font23">message transport layer, 249,</span></a><a href="#bookmark1881"><span class="font23"> 250</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1871"><span class="font23">modularization, 248</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1897"><span class="font23">object types, 252</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1876"><span class="font23">remote invocation layer, 249, </span></a><a href="#bookmark1885"><span class="font23">250</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1877"><span class="font23">web application layer, 249,</span></a><a href="#bookmark1890"><span class="font23"> 251</span></a></p>
<p><a href="#bookmark791"><span class="font23">HTTPS, 76, </span></a><a href="#bookmark2252"><span class="font23">308</span></a><a href="#bookmark2260"><span class="font23">–309, </span></a><a href="#bookmark2351"><span class="font23">322–</span></a><a href="#bookmark2407"><span class="font23">336</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2371"><span class="font23">authentication, 326</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2385"><span class="font23">clients, 328–</span></a><a href="#bookmark2398"><span class="font23">335</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2392"><span class="font23">OpenSSL example, 329</span></a><a href="#bookmark2398"><span class="font23">–335</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1622"><span class="font23">CONNECT method, HTTP, 206–</span></a><a href="#bookmark1629"><span class="font23">208,</span></a><span class="font23"> </span><a href="#bookmark2406"><span class="font23">336</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2362"><span class="font23">connecting, 324</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2359"><span class="font23">default port, 323</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2387"><span class="font23">OpenSSL, 328–</span></a><a href="#bookmark2398"><span class="font23">335</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2253"><span class="font23">schemes, 308, </span></a><a href="#bookmark2356"><span class="font23">323</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2377"><span class="font23">site certificate validation, 327</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2365"><span class="font23">SSL handshake, 324–</span></a><a href="#bookmark2370"><span class="font23">326</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2399"><span class="font23">tunnels (see tunnels)</span></a></p>
<p><a href="#bookmark503"><span class="font23">https scheme, 38</span></a></p>
<p><a href="#bookmark3268"><span class="font23">Hyper Text Caching Protocol (see HTCP)</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark341"><span class="font23">Hypertext Markup Language (see HTML)</span></a><span class="font23"> </span><a href="#bookmark211"><span class="font23">Hypertext Transfer Protocol (see HTTP)</span></a></p>
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font6" style="font-weight:bold;">I</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><span class="font23">IANA (Internet Assigned Numbers Authority)</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2554"><span class="font23">instance manipulations, registered</span></a><span class="font23"> types, 367</span></p>
<p style="text-indent:13pt;"><a href="#bookmark3761"><span class="font23">MIME charset registry, 602–</span></a><a href="#bookmark3771"><span class="font23">615</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3608"><span class="font23">MIME type registration, 537</span></a><a href="#bookmark3627"><span class="font23">–539</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2700"><span class="font23">registered language tags, 386,</span></a><a href="#bookmark3745"><span class="font23"> 582</span></a></p>
<p><a href="#bookmark3257"><span class="font23">ICP (Internet Cache Protocol), 473</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3263"><span class="font23">vs. CARP, 475</span></a></p>
<p><a href="#bookmark1007"><span class="font23">ident protocol, 115</span></a></p></td></tr></table><hr>
<table cellpadding="8pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark3000"><span class="font23">If headers, 431</span></a></p>
<p><a href="#bookmark3468"><span class="font23">If-Match headers, 519</span></a></p>
<p><a href="#bookmark1344"><span class="font23">If-Modified-Since headers, 166,</span></a><a href="#bookmark1448"><span class="font23"> 178,</span></a><a href="#bookmark3463"><span class="font23"> 518</span></a></p>
<p><a href="#bookmark1454"><span class="font23">If-None-Match headers, 180, </span></a><a href="#bookmark3469"><span class="font23">519</span></a></p>
<p><a href="#bookmark3472"><span class="font23">If-Range headers, 519</span></a></p>
<p><a href="#bookmark3475"><span class="font23">If-Unmodified-Since headers, 520</span></a></p>
<p><a href="#bookmark3642"><span class="font23">image/* MIME types, 561</span></a><a href="#bookmark3783"><span class="font23">–562</span></a></p>
<p><a href="#bookmark527"><span class="font23">inbound messages, 43</span></a></p>
<p><a href="#bookmark1161"><span class="font23">inbound proxies, 138</span></a></p>
<p><a href="#bookmark1839"><span class="font23">indexes, full-text, 243</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark652"><span class="font23">informational status codes (100-199), 59</span></a><a href="#bookmark669"><span class="font23">–60,</span></a><span class="font23"> </span><a href="#bookmark3368"><span class="font23">505</span></a></p>
<p><a href="#bookmark1151"><span class="font23">ingress proxies, 137</span></a></p>
<p><a href="#bookmark2521"><span class="font23">instance manipulations, 359,</span></a><a href="#bookmark2553"><span class="font23"> 367–</span></a><a href="#bookmark2560"><span class="font23">369</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2547"><span class="font23">delta encodings, 365</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2554"><span class="font23">IANA registered types, 367</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2542"><span class="font23">range requests, 364</span></a></p>
<p><a href="#bookmark2187"><span class="font23">integrity protection, 299</span></a></p>
<p><a href="#bookmark1173"><span class="font23">intercepting proxies, 140,</span></a><a href="#bookmark1212"><span class="font23"> 146</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1235"><span class="font23">URI resolution with, 149</span></a></p>
<p><span class="font23">internationalization</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2754"><span class="font23">date formats, 392</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2755"><span class="font23">domain names, 392</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2750"><span class="font23">headers, character set for, 392</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3753"><span class="font23">ISO 3166 country codes, 594</span></a><a href="#bookmark3755"><span class="font23">–600</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3749"><span class="font23">ISO 639 language codes, 583–</span></a><a href="#bookmark3752"><span class="font23">594</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3756"><span class="font23">languages, administrative</span></a></p>
<p style="text-indent:37pt;"><span class="font23">organizations, 601</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2773"><span class="font23">URL variants, 395</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2554"><span class="font23">Internet Assigned Numbers Authority (see</span></a><span class="font23"> IANA)</span></p>
<p><a href="#bookmark3257"><span class="font23">Internet Cache Protocol (ICP), 473</span></a></p>
<p><a href="#bookmark1830"><span class="font23">Internet search engines (see search engines)</span></a></p>
<p><a href="#bookmark3167"><span class="font23">IP address forwarding, 460</span></a></p>
<p><a href="#bookmark332"><span class="font23">IP (Internet protocol) addresses, 13</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1928"><span class="font23">clients, identification using, 259</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2882"><span class="font23">virtual hosting and, 416</span></a></p>
<p><a href="#bookmark3161"><span class="font23">IP MAC forwarding, 459</span></a></p>
<p><a href="#bookmark792"><span class="font23">IP packets, 76</span></a></p>
<p><a href="#bookmark975"><span class="font23">iPlanet web servers, 110</span></a></p>
<p><a href="#bookmark3753"><span class="font23">ISO 3166 country codes, 594</span></a><a href="#bookmark3755"><span class="font23">–600</span></a></p>
<p><a href="#bookmark3749"><span class="font23">ISO 639 language codes, 583–</span></a><a href="#bookmark3752"><span class="font23">594</span></a></p>
<p><a href="#bookmark2669"><span class="font23">iso-2022-jp encoding, 382</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark2647"><span class="font23">iso-8859 character set, 380</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">J</span></p>
<p><a href="#bookmark2669"><span class="font23">Japanese encodings, 382,</span></a><a href="#bookmark2674"><span class="font23"> 383</span></a></p>
<p><a href="#bookmark2648"><span class="font23">JIS X 0201, 0208, and 0212 character</span></a></p>
<p style="text-indent:37pt;"><span class="font23">sets, 380</span></p>
<p><a href="#bookmark212"><span class="font23">Joe’s Hardware Store web site, xiv</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">K</span></p>
<p style="text-align:justify;"><a href="#bookmark2122"><span class="font23">KD(s,d) digest, 291</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 13pt;"><a href="#bookmark893"><span class="font23">keep-alive connections (HTTP/1.0+), 91–</span></a><a href="#bookmark912"><span class="font23">96</span></a><span class="font23"> </span><a href="#bookmark893"><span class="font23">(see also persistent connections)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2279"><span class="font23">keyed ciphers, 311</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2280"><span class="font23">keys, 311, </span></a><a href="#bookmark2289"><span class="font23">312</span></a></p>
<p style="text-align:justify;text-indent:13pt;padding:0pt 0pt 10pt 0pt;"><a href="#bookmark2294"><span class="font23">key length, 313</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">L</span></p>
<p><a href="#bookmark2718"><span class="font23">language preferences, configuring, 389</span></a></p>
<p><a href="#bookmark2565"><span class="font23">language tags, 370, </span></a><a href="#bookmark2680"><span class="font23">384,</span></a><a href="#bookmark3731"><span class="font23"> 581–</span></a><a href="#bookmark3755"><span class="font23">600</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">case sensitivity, 386</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3732"><span class="font23">first subtag rules, 581</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2700"><span class="font23">IANA-registered tags, 386, </span></a><a href="#bookmark3745"><span class="font23">582</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2724"><span class="font23">reference tables, 389</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3742"><span class="font23">second subtag rules, 582</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2693"><span class="font23">subtags, 386</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2690"><span class="font23">syntax, 385</span></a></p>
<p><a href="#bookmark1465"><span class="font23">Last-Modified dates, using, 181</span></a></p>
<p><a href="#bookmark3478"><span class="font23">Last-Modified headers, 520</span></a></p>
<p><a href="#bookmark330"><span class="font23">layering of protocols, 12</span></a></p>
<p><a href="#bookmark871"><span class="font23">layout delay, preventing, 88</span></a></p>
<p><a href="#bookmark2630"><span class="font23">ligatures, 378</span></a></p>
<p><a href="#bookmark2968"><span class="font23">listExploreDocs element, POST request</span></a></p>
<p style="text-indent:37pt;"><span class="font23">body, 427</span></p>
<p><a href="#bookmark2966"><span class="font23">listHiddenDocs element, POST request</span></a></p>
<p style="text-indent:37pt;"><span class="font23">body, 427</span></p>
<p style="text-align:justify;"><a href="#bookmark1488"><span class="font23">LM-Factor algorithm, 184</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3110"><span class="font23">load balancing, 449</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3136"><span class="font23">DNS round robin, 454</span></a><a href="#bookmark3151"><span class="font23">–457</span></a></p>
<p style="text-align:justify;text-indent:25pt;"><a href="#bookmark3147"><span class="font23">single clients and, 456</span></a></p>
<p style="text-align:justify;"><a href="#bookmark861"><span class="font23">loading, serial, 87</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3481"><span class="font23">Location headers, 520</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3012"><span class="font23">LOCK method, 433</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3032"><span class="font23">status codes, 436</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3022"><span class="font23">lock refreshes, 435</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3023"><span class="font23">&lt;lockdiscovery&gt; element, 435</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3015"><span class="font23">&lt;lockinfo&gt; element, 434</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3010"><span class="font23">locking, 433</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3016"><span class="font23">&lt;locktoken&gt;element, 434</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3001"><span class="font23">Lock-Token headers, 431</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3292"><span class="font23">logging, 483–</span></a><a href="#bookmark3331"><span class="font23">492</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3294"><span class="font23">commonly logged fields, 483</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3296"><span class="font23">interpretation, 484</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3297"><span class="font23">log formats, 484–</span></a><a href="#bookmark3331"><span class="font23">492</span></a></p>
<p style="text-align:justify;text-indent:25pt;"><a href="#bookmark3305"><span class="font23">Combined Log Format, 485</span></a></p>
<p style="text-align:justify;text-indent:25pt;"><a href="#bookmark3300"><span class="font23">Common Log Format, 484</span></a></p>
<p style="text-align:justify;text-indent:25pt;"><a href="#bookmark3315"><span class="font23">Netscape Extended 2 Log</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark3315"><span class="font23">Format, 487–</span></a><a href="#bookmark3323"><span class="font23">489</span></a></p></td></tr></table><hr>
<div style="float:left;writing-mode:horizontal-tb;">
<p style="text-indent:25pt;"><a href="#bookmark3310"><span class="font23">Netscape Extended Log Format, 486</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3324"><span class="font23">Squid Proxy Log Format, 489–</span></a><a href="#bookmark3331"><span class="font23">492</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3347"><span class="font23">privacy concerns, 495</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1682"><span class="font23">loops (web robots), 217</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">M</span></p>
<p><a href="#bookmark3162"><span class="font23">MAC (Media Access Control) addresses, 459</span></a></p>
<p><a href="#bookmark1083"><span class="font23">magic typing, 126</span></a></p>
<p><a href="#bookmark504"><span class="font23">mailto scheme, 38</span></a></p>
<p><a href="#bookmark2232"><span class="font23">man-in-the-middle attacks, 304</span></a></p>
<p><a href="#bookmark1181"><span class="font23">manual client proxy configuration, 142</span></a></p>
<p><a href="#bookmark2917"><span class="font23">master origin server, 420</span></a></p>
<p><a href="#bookmark1476"><span class="font23">max-age response headers, 183</span></a></p>
<p><a href="#bookmark1274"><span class="font23">Max-Forwards headers, 155, </span></a><a href="#bookmark3484"><span class="font23">521</span></a></p>
<p><a href="#bookmark2099"><span class="font23">MD5, 288,</span></a><a href="#bookmark2129"><span class="font23"> 291, </span></a><a href="#bookmark2133"><span class="font23">293,</span></a><a href="#bookmark2459"><span class="font23"> 347</span></a></p>
<p><a href="#bookmark2129"><span class="font23">MD5-sess, 291,</span></a><a href="#bookmark2136"><span class="font23"> 293</span></a></p>
<p><a href="#bookmark3162"><span class="font23">Media Access Control (MAC) addresses, 459</span></a></p>
<p><a href="#bookmark2466"><span class="font23">media types, 348</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2472"><span class="font23">multipart, 349</span></a></p>
<p><a href="#bookmark541"><span class="font23">message body, 44</span></a></p>
<p><a href="#bookmark2118"><span class="font23">message digest algorithms, 291–</span></a><a href="#bookmark2149"><span class="font23">294</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2183"><span class="font23">symmetric authentication, 298</span></a></p>
<p><a href="#bookmark2187"><span class="font23">message integrity protection, 299</span></a></p>
<p><a href="#bookmark3645"><span class="font23">message/* MIME types, 563</span></a></p>
<p><a href="#bookmark1875"><span class="font23">message transport layer (HTTP-NG), 249,</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark1881"><span class="font23">250</span></a></p>
<p><a href="#bookmark2438"><span class="font23">message truncation, 344</span></a></p>
<p><a href="#bookmark3178"><span class="font23">messages (see HTTP messages)</span></a></p>
<p><a href="#bookmark1507"><span class="font23">&lt;META HTTP-EQUIV&gt; tag, 187</span></a></p>
<p><a href="#bookmark1821"><span class="font23">META tag directives, 239</span></a></p>
<p><a href="#bookmark526"><span class="font23">meta-information, 43</span></a></p>
<p><a href="#bookmark1554"><span class="font23">Meter headers, 196, </span></a><a href="#bookmark3341"><span class="font23">493</span></a></p>
<p><a href="#bookmark550"><span class="font23">methods, 46,</span></a><a href="#bookmark565"><span class="font23"> 48,</span></a><a href="#bookmark610"><span class="font23"> 53</span></a><a href="#bookmark649"><span class="font23">–59</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1621"><span class="font23">CONNECT, 206–</span></a><a href="#bookmark1629"><span class="font23">208,</span></a><a href="#bookmark2406"><span class="font23"> 336</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark639"><span class="font23">DELETE, 58,</span></a><a href="#bookmark3065"><span class="font23"> 441</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark642"><span class="font23">extension methods, 58</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark615"><span class="font23">GET, 53</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark619"><span class="font23">HEAD, 54</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark635"><span class="font23">OPTIONS, 57,</span></a><a href="#bookmark1293"><span class="font23"> 159,</span></a><a href="#bookmark3089"><span class="font23"> 445</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark627"><span class="font23">POST, 55</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark622"><span class="font23">PUT, 54,</span></a><a href="#bookmark3083"><span class="font23"> 444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark685"><span class="font23">redirection status codes and, 64</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark628"><span class="font23">TRACE, 55</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1289"><span class="font23">unsupported, handling, 158</span></a></p>
<p><a href="#bookmark2941"><span class="font23">Microsoft FrontPage (see FrontPage)</span></a></p>
<p><span class="font23">Microsoft Internet Explorer</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1970"><span class="font23">cookie storage, 266</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2719"><span class="font23">language preference configuration, 389</span></a></p>
<p><a href="#bookmark975"><span class="font23">Microsoft web servers, 110</span></a></p>
</div>
<p style="text-align:justify;padding:0pt 0pt 0pt 38pt;"><span class="font23">MIME (Multipurpose Internet Mail Extensions)</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 14pt;"><a href="#bookmark2592"><span class="font23">charset encoding tags, 374</span></a><span class="font23"> charset registry, 602–615</span></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 14pt;"><a href="#bookmark3766"><span class="font23">preferred MIME names, 603</span></a><span class="font23"> “multipart” email messages, 349 </span><a href="#bookmark3761"><span class="font23">(see also MIME types)</span></a></p>
<p><a href="#bookmark277"><span class="font23">MIME types, 5, </span></a><a href="#bookmark3572"><span class="font23">533</span></a><a href="#bookmark3662"><span class="font23">–569</span></a><span class="font23"> </span><a href="#bookmark3633"><span class="font23">application/* types, 540</span></a><a href="#bookmark3636"><span class="font23">–557</span></a><span class="font23"> </span><a href="#bookmark3775"><span class="font23">audio/* types, 557–</span></a><a href="#bookmark3638"><span class="font23">559</span></a><span class="font23"> </span><a href="#bookmark3776"><span class="font23">chemical/* types, 559–</span></a><a href="#bookmark3641"><span class="font23">561</span></a><span class="font23"> </span><a href="#bookmark3593"><span class="font23">composite types, 534</span></a><span class="font23"> </span><a href="#bookmark3590"><span class="font23">discrete types, 534</span></a><span class="font23"> </span><a href="#bookmark3586"><span class="font23">documentation, 534</span></a><span class="font23"> </span><a href="#bookmark3661"><span class="font23">experimental types, 569</span></a><span class="font23"> </span><a href="#bookmark3608"><span class="font23">IANA registration, 537</span></a><a href="#bookmark3627"><span class="font23">–539</span></a><span class="font23"> </span><a href="#bookmark3626"><span class="font23">media type registry, 539</span></a><span class="font23"> </span><a href="#bookmark3615"><span class="font23">process, 537</span></a><span class="font23"> </span><a href="#bookmark3609"><span class="font23">registration trees, 537</span></a><span class="font23"> </span><a href="#bookmark3618"><span class="font23">rules, 538</span></a><span class="font23"> </span><a href="#bookmark3622"><span class="font23">template, 538</span></a><span class="font23"> </span><a href="#bookmark3642"><span class="font23">image/* types, 561–</span></a><a href="#bookmark3783"><span class="font23">562</span></a><span class="font23"> </span><a href="#bookmark3645"><span class="font23">message/* types, 563</span></a><span class="font23"> </span><a href="#bookmark3648"><span class="font23">model/* types, 563</span></a><span class="font23"> </span><a href="#bookmark3598"><span class="font23">multipart/* types, 535, </span></a><a href="#bookmark3651"><span class="font23">564</span></a><span class="font23"> </span><a href="#bookmark3601"><span class="font23">primary types, 536</span></a><span class="font23"> </span><a href="#bookmark3589"><span class="font23">structure, 534</span></a><span class="font23"> </span><a href="#bookmark3601"><span class="font23">syntax, 536</span></a><span class="font23"> </span><a href="#bookmark3630"><span class="font23">tables, 539</span></a><a href="#bookmark3662"><span class="font23">–569</span></a><span class="font23"> </span><a href="#bookmark3654"><span class="font23">text/* types, 565–</span></a><a href="#bookmark3657"><span class="font23">568</span></a><span class="font23"> </span><a href="#bookmark3658"><span class="font23">video/* types, 568</span></a></p>
<p><a href="#bookmark1075"><span class="font23">MIME typing, 125</span></a></p>
<p><a href="#bookmark3684"><span class="font23">MIME::Base64 Perl module, 572</span></a></p>
<p><a href="#bookmark3487"><span class="font23">MIME-Version headers, 521</span></a><span class="font23"> </span><a href="#bookmark2913"><span class="font23">mirrored server farms, 420</span></a><span class="font23"> </span><a href="#bookmark3062"><span class="font23">MKCOL method, 440</span></a><span class="font23"> </span><a href="#bookmark1505"><span class="font23">mod_cern_meta module, Apache web</span></a><span class="font23"> server, 186</span></p>
<p><a href="#bookmark3648"><span class="font23">model/* MIME types, 563</span></a><span class="font23"> </span><a href="#bookmark1504"><span class="font23">mod_expires module, Apache web</span></a><span class="font23"> server, 186</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 38pt;"><a href="#bookmark1501"><span class="font23">mod_headers module, Apache web</span></a><span class="font23"> server, 186</span></p>
<p><a href="#bookmark3070"><span class="font23">MOVE method, 442</span></a><span class="font23"> </span><a href="#bookmark2951"><span class="font23">multi-homed servers, 425</span></a><span class="font23"> </span><a href="#bookmark2480"><span class="font23">multipart form-data encodings, 349</span></a><span class="font23"> </span><a href="#bookmark3598"><span class="font23">multipart/* MIME types, 535,</span></a><a href="#bookmark3651"><span class="font23"> 564</span></a><span class="font23"> </span><a href="#bookmark1032"><span class="font23">multiplexed architectures, 119</span></a></p>
<p style="padding:0pt 0pt 0pt 14pt;"><a href="#bookmark1033"><span class="font23">I/O web servers, 119</span></a><span class="font23"> </span><a href="#bookmark1034"><span class="font23">multithreaded web servers, 119</span></a></p>
<table cellpadding="10pt">
<tr>
<td valign="top" style="width:52%;">
<p><a href="#bookmark1028"><span class="font23">multiprocess, multithreaded web</span></a></p>
<p style="text-indent:37pt;"><span class="font23">servers, 118</span></p>
<p><a href="#bookmark277"><span class="font23">Multipurpose Internet Mail Extensions (see</span></a></p>
<p style="text-indent:37pt;"><span class="font23">MIME; MIME types)</span></p>
<p><a href="#bookmark3044"><span class="font23">&lt;multistatus&gt; element, 438</span></a></p>
<p><a href="#bookmark2804"><span class="font23">MultiViews directive, 400</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><span class="font23">must-revalidate response headers, 183</span></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">N</span></p>
<p><a href="#bookmark838"><span class="font23">Nagle’s algorithm, 84</span></a></p>
<p><a href="#bookmark3058"><span class="font23">namespace management, 439–</span></a><a href="#bookmark3080"><span class="font23">444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3061"><span class="font23">methods used for, 440</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3078"><span class="font23">status codes, 443</span></a></p>
<p><a href="#bookmark3784"><span class="font23">namespaces, 388</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2707"><span class="font23">language subtags, 387–</span></a><a href="#bookmark2720"><span class="font23">389</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2991"><span class="font23">XML, 430</span></a></p>
<p><a href="#bookmark3168"><span class="font23">NAT (Network Address Translation), 460</span></a></p>
<p><a href="#bookmark3175"><span class="font23">NECP (Network Element Control</span></a></p>
<p style="text-indent:37pt;"><span class="font23">Protocol), 461</span></p>
<p><a href="#bookmark751"><span class="font23">negotiation headers, 71</span></a></p>
<p><a href="#bookmark3315"><span class="font23">Netscape Extended 2 Log Format, 487–</span></a><a href="#bookmark3323"><span class="font23">489</span></a></p>
<p><a href="#bookmark3310"><span class="font23">Netscape Extended Log Format, 486</span></a></p>
<p><span class="font23">Netscape Navigator</span></p>
<p style="text-align:justify;text-indent:13pt;"><span class="font23">cookies</span></p>
<p style="text-indent:25pt;"><a href="#bookmark1967"><span class="font23">storage, 265</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1988"><span class="font23">Version 0, 269</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2725"><span class="font23">language preference configuration, 389</span></a></p>
<p><a href="#bookmark3168"><span class="font23">Network Address Translation (NAT), 460</span></a></p>
<p><a href="#bookmark1314"><span class="font23">network bottlenecks, 161</span></a></p>
<p><a href="#bookmark3178"><span class="font23">Network Element Control Protocol</span></a></p>
<p style="text-indent:37pt;"><span class="font23">(NECP), 461</span></p>
<p><a href="#bookmark1156"><span class="font23">network exchange proxies, 137</span></a></p>
<p><a href="#bookmark506"><span class="font23">news scheme, 39</span></a></p>
<p><span class="font23">no-cache response headers, 182</span></p>
<p><a href="#bookmark2111"><span class="font23">nonces, 289–</span></a><a href="#bookmark2177"><span class="font23">298</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2164"><span class="font23">next nonce pregeneration, 297</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2167"><span class="font23">reuse, 297</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2173"><span class="font23">selection, 298</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2170"><span class="font23">time-synchronized generation, 297</span></a></p>
<p><span class="font23">no-store response headers, 182</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark2975"><span class="font23">.nsconfig, 428</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">O</span></p>
<p><a href="#bookmark1898"><span class="font23">object types, HTTP-NG, 252</span></a></p>
<p><a href="#bookmark2098"><span class="font23">one-way digests, 288</span></a></p>
<p><a href="#bookmark2122"><span class="font23">one-way hashes, 291</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2106"><span class="font23">functions, 289</span></a></p>
<p><a href="#bookmark3011"><span class="font23">opaquelocktoken scheme, 433,</span></a><a href="#bookmark3019"><span class="font23"> 434</span></a></p>
<p><a href="#bookmark2387"><span class="font23">OpenSSL, 328–</span></a><a href="#bookmark2398"><span class="font23">335</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2392"><span class="font23">example client, 329–</span></a><a href="#bookmark2398"><span class="font23">335</span></a></p></td>
<td valign="top" style="width:47%;">
<p><a href="#bookmark635"><span class="font23">OPTIONS method, 57, </span></a><a href="#bookmark3089"><span class="font23">445</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1294"><span class="font23">requests, 159</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3092"><span class="font23">response headers to, 445</span></a></p>
<p><a href="#bookmark2918"><span class="font23">origin servers, 420</span></a></p>
<p><a href="#bookmark527"><span class="font23">outbound messages, 43</span></a></p>
<p><a href="#bookmark1160"><span class="font23">outbound proxies, 138</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark3003"><span class="font23">Overwrite headers, 432,</span></a><a href="#bookmark3071"><span class="font23"> 442</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">P</span></p>
<p><a href="#bookmark1187"><span class="font23">PAC files, 142</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3196"><span class="font23">autodiscovery, 465</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark3189"><span class="font23">PAC (Proxy Auto-Configuration)</span></a><span class="font23"> protocol, 463</span></p>
<p><a href="#bookmark867"><span class="font23">parallel connections, 88–</span></a><a href="#bookmark882"><span class="font23">90</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark883"><span class="font23">impression of speed, 90</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark869"><span class="font23">loading speed, 88</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark880"><span class="font23">open connection limits, 90</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark890"><span class="font23">persistent connections vs., 91</span></a></p>
<p><a href="#bookmark424"><span class="font23">parameters component, URLs, 28</span></a></p>
<p><a href="#bookmark1159"><span class="font23">parent and child relationships, 138</span></a></p>
<p><a href="#bookmark1374"><span class="font23">parent caches, 169</span></a></p>
<p><a href="#bookmark418"><span class="font23">password component, URLs, 27</span></a><span class="font23"> passwords</span></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2240"><span class="font23">digest authentication password file,</span></a><span class="font23"> risks, 305</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2090"><span class="font23">digest authentication, security, 287</span></a></p>
<p><a href="#bookmark421"><span class="font23">path component, URLs, 28</span></a></p>
<p><a href="#bookmark1805"><span class="font23">Perl code for interaction with robots.txt</span></a></p>
<p style="text-indent:37pt;"><span class="font23">files, 235</span></p>
<p><a href="#bookmark985"><span class="font23">Perl web server, 111</span></a></p>
<p><a href="#bookmark884"><span class="font23">persistent connections, 90</span></a><a href="#bookmark927"><span class="font23">–99</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark2442"><span class="font23">Content-Length headers and, 345</span></a><span class="font23"> </span><a href="#bookmark893"><span class="font23">keep-alive connections</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark893"><span class="font23">(HTTP/1.0+), 91–</span></a><a href="#bookmark912"><span class="font23">96</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark890"><span class="font23">parallel connections vs., 91</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark924"><span class="font23">restrictions and rules, 98</span></a></p>
<p><a href="#bookmark510"><span class="font23">persistent uniform resource locators</span></a></p>
<p style="text-indent:37pt;"><span class="font23">(PURLs), 40</span></p>
<p><a href="#bookmark928"><span class="font23">pipelined connections, 99</span></a></p>
<p><a href="#bookmark2269"><span class="font23">plaintext, security and, 310</span></a></p>
<p><a href="#bookmark415"><span class="font23">port component, URLS, 27</span></a></p>
<p><a href="#bookmark846"><span class="font23">port exhaustion, 85</span></a></p>
<p><a href="#bookmark332"><span class="font23">port numbers, 13, </span></a><a href="#bookmark799"><span class="font23">77</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark339"><span class="font23">default values, 13</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2879"><span class="font23">virtual hosting and, 415</span></a></p>
<p><a href="#bookmark627"><span class="font23">POST method, 55</span></a></p>
<p><a href="#bookmark2948"><span class="font23">POST requests, FrontPage and, 425</span></a></p>
<p><a href="#bookmark716"><span class="font23">Pragma headers, 68, </span></a><span class="font23">182,</span><a href="#bookmark3490"><span class="font23"> 521</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1034"><span class="font23">Pragma: no-cache headers, 182</span></a></p>
<p><a href="#bookmark2236"><span class="font23">precompiled dictionary attacks, 305</span></a><span class="font23"> </span><a href="#bookmark2158"><span class="font23">preemptive authorization, 295</span></a><span class="font23"> </span><a href="#bookmark1691"><span class="font23">presence bit arrays (web robots), 218</span></a><span class="font23"> </span><a href="#bookmark2629"><span class="font23">presentation forms, 378</span></a></p></td></tr></table><hr>
<table cellpadding="10pt">
<tr>
<td valign="top" style="width:52%;">
<p><a href="#bookmark2694"><span class="font23">primary subtags, 386</span></a></p>
<p><a href="#bookmark3347"><span class="font23">privacy, 495</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2018"><span class="font23">cookies and, 275</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1760"><span class="font23">robots and, 229</span></a></p>
<p><a href="#bookmark1365"><span class="font23">private caches, 168</span></a></p>
<p><a href="#bookmark1051"><span class="font23">private docroots, 122</span></a></p>
<p><a href="#bookmark1111"><span class="font23">private proxies, 130</span></a></p>
<p><a href="#bookmark3043"><span class="font23">&lt;prop&gt; element, 437</span></a></p>
<p><a href="#bookmark3051"><span class="font23">&lt;propertyupdate&gt; element, 438</span></a></p>
<p><a href="#bookmark3037"><span class="font23">PROPFIND method, 437</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3045"><span class="font23">server response elements, 438</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3040"><span class="font23">XML elements, used with, 437</span></a></p>
<p><a href="#bookmark3042"><span class="font23">&lt;propname&gt; element, 437</span></a></p>
<p><a href="#bookmark3049"><span class="font23">PROPPATCH method, 438</span></a><a href="#bookmark3057"><span class="font23">–439</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3050"><span class="font23">XML elements, used with, 438</span></a></p>
<p><a href="#bookmark3047"><span class="font23">&lt;propstat&gt; element, 438</span></a><span class="font23"> </span><a href="#bookmark859"><span class="font23">“protecting the header”, 87</span></a><span class="font23"> </span><a href="#bookmark2153"><span class="font23">protection spaces, 295, </span></a><a href="#bookmark2203"><span class="font23">301</span></a><span class="font23"> </span><a href="#bookmark1575"><span class="font23">protocol gateways, 200</span></a><span class="font23"> </span><a href="#bookmark793"><span class="font23">protocol stack, 76</span></a><span class="font23"> </span><a href="#bookmark330"><span class="font23">protocols, layering of, 12</span></a><span class="font23"> proxies</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark665"><span class="font23">100 Continue status code and, 60</span></a><span class="font23"> </span><a href="#bookmark1281"><span class="font23">authentication, 156</span></a><span class="font23"> </span><a href="#bookmark1148"><span class="font23">deploying, 137</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1150"><span class="font23">egress proxies, 137</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1115"><span class="font23">gateways, contrasted with, 130</span></a><span class="font23"> </span><a href="#bookmark2231"><span class="font23">hostile, 304</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1103"><span class="font23">HTTP proxies (see HTTP proxy servers)</span></a><span class="font23"> </span><a href="#bookmark1151"><span class="font23">ingress proxies, 137</span></a><span class="font23"> </span><a href="#bookmark1173"><span class="font23">intercepting proxies, 140,</span></a><a href="#bookmark1212"><span class="font23"> 146</span></a></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1235"><span class="font23">URI resolution with, 149</span></a><span class="font23"> </span><a href="#bookmark1287"><span class="font23">interoperation, 157</span></a><a href="#bookmark1303"><span class="font23">–160</span></a><span class="font23"> </span><a href="#bookmark1241"><span class="font23">messages, tracing, 150</span></a><a href="#bookmark1285"><span class="font23">–157</span></a><span class="font23"> </span><a href="#bookmark1206"><span class="font23">“missing scheme/host/port”</span></a><span class="font23"> problem, 146</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1213"><span class="font23">proxy and server requests, handling, 146</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1158"><span class="font23">proxy hierarchies, 138</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1165"><span class="font23">content routing, 139</span></a></p>
<p style="text-indent:12pt;padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1169"><span class="font23">dynamic parent selection, 140</span></a><span class="font23"> </span><a href="#bookmark1108"><span class="font23">public and private, 130</span></a><span class="font23"> </span><a href="#bookmark3115"><span class="font23">redirection and, 449</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1209"><span class="font23">surrogates, 146</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2810"><span class="font23">transparent negotiation, 400</span></a></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1174"><span class="font23">transparent proxies, 140</span></a><span class="font23"> </span><a href="#bookmark2400"><span class="font23">tunnels and, 335</span></a></p></td>
<td valign="top" style="width:47%;">
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark1218"><span class="font23">URIs, in-flight modification of, 147</span></a><span class="font23"> </span><a href="#bookmark1119"><span class="font23">uses, 131</span></a><a href="#bookmark1146"><span class="font23">–136</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1103"><span class="font23">(see also HTTP proxy servers)</span></a></p>
<p><a href="#bookmark3493"><span class="font23">Proxy-Authenticate headers, 522</span></a></p>
<p><a href="#bookmark2063"><span class="font23">proxy authentication, 283</span></a></p>
<p><a href="#bookmark3496"><span class="font23">Proxy-Authorization headers, 522</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1182"><span class="font23">Proxy Auto-configuration (PAC)</span></a><span class="font23"> </span><a href="#bookmark1182"><span class="font23">protocol, 142,</span></a><a href="#bookmark3189"><span class="font23"> 463</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1186"><span class="font23">(see also PAC files)</span></a></p>
<p><a href="#bookmark1375"><span class="font23">proxy cache hierarchies, 169</span></a></p>
<p><a href="#bookmark1369"><span class="font23">proxy caches, 169</span></a></p>
<p><a href="#bookmark917"><span class="font23">Proxy-Connection headers, 96, </span></a><a href="#bookmark3499"><span class="font23">523</span></a></p>
<p><span class="font23">proxy redirection</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark3261"><span class="font23">CARP (Cache Array Routing</span></a><span class="font23"> </span><a href="#bookmark3261"><span class="font23">Protocol), 475</span></a><a href="#bookmark3267"><span class="font23">–478</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark3268"><span class="font23">HTCP (Hyper Text Caching</span></a><span class="font23"> </span><a href="#bookmark3268"><span class="font23">Protocol), 478</span></a><a href="#bookmark3286"><span class="font23">–481</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3257"><span class="font23">ICP (Internet Cache Protocol), 473</span></a><span class="font23"> </span><a href="#bookmark3182"><span class="font23">proxy redirection methods, 462–</span></a><a href="#bookmark3225"><span class="font23">469</span></a><span class="font23"> </span><a href="#bookmark3185"><span class="font23">explicit browser configuration, 463</span></a><span class="font23"> </span><a href="#bookmark3186"><span class="font23">disadvantages, 463</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark3189"><span class="font23">PAC (Proxy Auto-configuration)</span></a><span class="font23"> protocol, 463</span></p>
<p style="text-indent:13pt;"><a href="#bookmark3193"><span class="font23">WPAD (see WPAD)</span></a></p>
<p><a href="#bookmark740"><span class="font23">proxy request headers, 70</span></a></p>
<p><a href="#bookmark360"><span class="font23">proxy servers, 18</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2400"><span class="font23">networks, use in securing, 335</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark360"><span class="font23">(see also HTTP proxy servers)</span></a></p>
<p><a href="#bookmark1200"><span class="font23">proxy URIs vs. server URIs, 144</span></a></p>
<p><a href="#bookmark1370"><span class="font23">public caches, 169</span></a></p>
<p><a href="#bookmark3503"><span class="font23">Public headers, 523</span></a></p>
<p><a href="#bookmark1110"><span class="font23">public proxies, 130</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2309"><span class="font23">public-key cryptography (see under</span></a><span class="font23"> cryptography)</span></p>
<p><span class="font23">publishing systems</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2941"><span class="font23">FrontPage (see FrontPage)</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2978"><span class="font23">WebDAV (see WebDAV)</span></a></p>
<p style="text-indent:13pt;"><span class="font23">(see also web publishing)</span></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark510"><span class="font23">PURLs (persistent uniform resource</span></a><span class="font23"> locators), 40</span></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark622"><span class="font23">PUT method, 54,</span></a><a href="#bookmark3084"><span class="font23"> 444</span></a></p>
<p><span class="font6" style="font-weight:bold;">Q</span></p>
<p style="padding:0pt 0pt 0pt 13pt;"><a href="#bookmark2138"><span class="font23">qop (quality of protection), 293</span></a><span class="font23"> </span><a href="#bookmark2184"><span class="font23">enhancements, 299</span></a></p>
<p><a href="#bookmark2574"><span class="font23">quality factors, 371</span></a></p>
<p><a href="#bookmark2138"><span class="font23">quality of protection (see qop)</span></a></p>
<p><a href="#bookmark2792"><span class="font23">quality values, 398</span></a></p>
<p><a href="#bookmark429"><span class="font23">query component, URLs, 29</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">R</span></p>
<p><a href="#bookmark3506"><span class="font23">Range headers, 524</span></a></p>
<p><a href="#bookmark2539"><span class="font23">range requests, 363</span></a></p>
<p><a href="#bookmark2042"><span class="font23">realm directive, 280</span></a></p>
<p><a href="#bookmark2204"><span class="font23">realms (protection spaces), 301</span></a></p>
<p><a href="#bookmark304"><span class="font23">reason phrases, 9,</span></a><a href="#bookmark554"><span class="font23"> 47,</span></a><a href="#bookmark578"><span class="font23"> 50, </span></a><a href="#bookmark3362"><span class="font23">505–</span></a><a href="#bookmark3377"><span class="font23">507</span></a></p>
<p><a href="#bookmark1085"><span class="font23">redirection, 126,</span></a><a href="#bookmark3104"><span class="font23"> 448–</span></a><a href="#bookmark3286"><span class="font23">481</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3155"><span class="font23">anycast addressing, 457</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3150"><span class="font23">enhanced DNS-based algorithms, 457</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3167"><span class="font23">IP address forwarding, 460</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3161"><span class="font23">IP MAC forwarding, 459</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1091"><span class="font23">load balancing and, 127,</span></a><a href="#bookmark3111"><span class="font23"> 449</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3117"><span class="font23">methods, 450</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3128"><span class="font23">DNS redirection, 453–</span></a><a href="#bookmark3154"><span class="font23">457</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3123"><span class="font23">HTTP redirection, 452–</span></a><a href="#bookmark3129"><span class="font23">453</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3182"><span class="font23">proxy methods, 462–</span></a><a href="#bookmark3225"><span class="font23">469</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark3785"><span class="font23">proxy techniques, 451</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3175"><span class="font23">NECP (Network Element Control</span></a></p>
<p style="text-indent:36pt;"><span class="font23">Protocol), 461</span></p>
<p style="text-indent:12pt;"><a href="#bookmark3118"><span class="font23">protocols, 450</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3115"><span class="font23">proxies, role in, 449</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3108"><span class="font23">purpose, 449</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3106"><span class="font23">techniques, 448</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1088"><span class="font23">temporary redirect, 126</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3226"><span class="font23">transparent redirection, 469</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1089"><span class="font23">URL augmentation, 126</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3229"><span class="font23">WCCP (Web Cache Coordination</span></a></p>
<p style="text-indent:36pt;"><a href="#bookmark3229"><span class="font23">Protocol), 470</span></a><a href="#bookmark3254"><span class="font23">–473</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark676"><span class="font23">redirection status codes (300-399), 61–</span></a><a href="#bookmark686"><span class="font23">64,</span></a><span class="font23"> </span><a href="#bookmark3368"><span class="font23">505</span></a></p>
<p><a href="#bookmark1926"><span class="font23">Referer headers, 259,</span></a><a href="#bookmark3509"><span class="font23"> 524</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1727"><span class="font23">robots and, 225</span></a></p>
<p><a href="#bookmark443"><span class="font23">relative URLs, 30</span></a><a href="#bookmark463"><span class="font23">–34</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark451"><span class="font23">bases, 31</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark458"><span class="font23">resolving, 33</span></a></p>
<p><a href="#bookmark1652"><span class="font23">relays, 212</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1655"><span class="font23">keep-alive connections and, 212</span></a></p>
<p><a href="#bookmark1852"><span class="font23">relevancy ranking, 245</span></a></p>
<p><a href="#bookmark786"><span class="font23">reliable bit pipe, 75</span></a></p>
<p><a href="#bookmark1876"><span class="font23">remote invocation layer (HTTP-NG), 249,</span></a></p>
<p style="text-indent:36pt;"><a href="#bookmark1885"><span class="font23">250</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark2955"><span class="font23">remote procedure call (RPC) protocol,</span></a><span class="font23"> FrontPage, 426</span></p>
<p><a href="#bookmark3055"><span class="font23">&lt;remove&gt; element, 439</span></a></p>
<p><a href="#bookmark2071"><span class="font23">replay attacks, 284, </span></a><a href="#bookmark2109"><span class="font23">289, </span></a><a href="#bookmark2220"><span class="font23">303</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2110"><span class="font23">preventing, 289</span></a></p>
<p><a href="#bookmark2914"><span class="font23">replica origin servers, 420</span></a></p>
<p><a href="#bookmark3707"><span class="font23">request digest reference code, 577</span></a></p>
<p><a href="#bookmark2143"><span class="font23">request digests, 294</span></a></p>
<p><a href="#bookmark722"><span class="font23">request headers (see under headers)</span></a></p>
<p><a href="#bookmark563"><span class="font23">request lines, 48</span></a></p></td>
<td valign="top" style="width:50%;">
<p><a href="#bookmark315"><span class="font23">request messages, 10, </span></a><a href="#bookmark545"><span class="font23">45, </span></a><a href="#bookmark554"><span class="font23">47</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark550"><span class="font23">methods, 46</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark551"><span class="font23">request URLs, 46</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2144"><span class="font23">request method (HTTP), 294</span></a></p>
<p style="text-align:justify;"><a href="#bookmark928"><span class="font23">request pipelining, 99</span></a></p>
<p style="text-align:justify;"><a href="#bookmark736"><span class="font23">request security headers, 70</span></a></p>
<p style="text-align:justify;"><a href="#bookmark486"><span class="font23">reserved characters (see restricted characters)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1592"><span class="font23">resource gateways, 203</span></a></p>
<p style="text-align:justify;"><a href="#bookmark511"><span class="font23">resource locator servers, 40</span></a></p>
<p style="text-align:justify;"><a href="#bookmark399"><span class="font23">resource paths, 24</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1036"><span class="font23">resources, mapping and accessing of, 120</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3707"><span class="font23">response digest reference code, 577</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1072"><span class="font23">response entities, 125</span></a></p>
<p style="text-align:justify;"><a href="#bookmark746"><span class="font23">response headers (see under headers)</span></a></p>
<p style="text-align:justify;"><a href="#bookmark564"><span class="font23">response lines, 48</span></a></p>
<p style="text-align:justify;"><a href="#bookmark316"><span class="font23">response messages, 10,</span></a><a href="#bookmark546"><span class="font23"> 45,</span></a><a href="#bookmark1073"><span class="font23"> 125</span></a></p>
<p style="text-align:justify;"><a href="#bookmark486"><span class="font23">restricted characters, 36</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3514"><span class="font23">Retry-After headers, 525</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1341"><span class="font23">revalidate hits, 165</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1345"><span class="font23">revalidate misses, 166</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1338"><span class="font23">revalidations, 165</span></a><a href="#bookmark1347"><span class="font23">–166</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1133"><span class="font23">reverse proxies, 134,</span></a><a href="#bookmark1155"><span class="font23"> 137</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1805"><span class="font23">RobotRules object, 235</span></a></p>
<p style="text-align:justify;"><span class="font23">robots</span></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1736"><span class="font23">conditional HTTP requests, 226</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1748"><span class="font23">entities and, 227</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1824"><span class="font23">etiquette, 239</span></a><a href="#bookmark1828"><span class="font23">–241</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1762"><span class="font23">excluding from web sites, 229</span></a><a href="#bookmark1823"><span class="font23">–239</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1811"><span class="font23">HTML robot control META tags, 237</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1719"><span class="font23">HTTP and, 225</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1721"><span class="font23">request headers, identifying, 225</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1814"><span class="font23">META directives, 237</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1748"><span class="font23">Meta HTML tags and, 227</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1760"><span class="font23">privacy and, 229</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1756"><span class="font23">problems caused by, 228</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1742"><span class="font23">response handling, 227</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1830"><span class="font23">search engines, 242</span></a><a href="#bookmark1856"><span class="font23">–246</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1743"><span class="font23">status codes, handling of, 227</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1779"><span class="font23">(see also robots.txt files)</span></a></p>
<p><a href="#bookmark1768"><span class="font23">Robots Exclusion Standard, 230</span></a></p>
<p><a href="#bookmark1764"><span class="font23">robots.txt files, 229</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1801"><span class="font23">caching and expiration, 234</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1798"><span class="font23">comments, 234</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1790"><span class="font23">disallow and allow lines, 233</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1809"><span class="font23">example, 236</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1773"><span class="font23">fetching, 231</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1783"><span class="font23">records, 232</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1797"><span class="font23">specification, changes in, 234</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1779"><span class="font23">status codes for retrievals, 231</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1782"><span class="font23">syntax, 232</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1787"><span class="font23">User-Agent line, 232</span></a></p>
<p style="text-align:justify;text-indent:12pt;"><a href="#bookmark1772"><span class="font23">web sites and, 231</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark1670"><span class="font23">root set, 216</span></a></p>
<p><a href="#bookmark2954"><span class="font23">root web, 425</span></a></p>
<p><a href="#bookmark3131"><span class="font23">round-robin load balancing, 453</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3136"><span class="font23">DNS round robin, 454</span></a><a href="#bookmark3151"><span class="font23">–457</span></a><span class="font23"> </span><a href="#bookmark3156"><span class="font23">routers and anycast addressing, 457</span></a></p>
<p><a href="#bookmark2955"><span class="font23">RPC protocol, FrontPage, 426</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark2315"><span class="font23">RSA algorithm, 317</span></a><span class="font23"> </span><a href="#bookmark3786"><span class="font23">rtsp, rtspu schemes, 39</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">S</span></p>
<p><a href="#bookmark289"><span class="font23">schemes, 7,</span></a><a href="#bookmark400"><span class="font23"> 24,</span></a><a href="#bookmark411"><span class="font23"> 27</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark495"><span class="font23">common formats, 38</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3356"><span class="font23">URIs for, 499</span></a><a href="#bookmark3358"><span class="font23">–504</span></a></p>
<p><a href="#bookmark1830"><span class="font23">search engines, 242</span></a><a href="#bookmark1856"><span class="font23">–246</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1834"><span class="font23">architecture, 242</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1839"><span class="font23">full-text indexes, 243</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1843"><span class="font23">queries, 244</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1852"><span class="font23">relevancy ranking, 245</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1846"><span class="font23">results, sorting and formatting, 244</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1853"><span class="font23">spoofing, 245</span></a></p>
<p style="text-align:justify;"><a href="#bookmark1690"><span class="font23">search trees, 218</span></a></p>
<p style="text-align:justify;"><a href="#bookmark3784"><span class="font23">second subtag, 388</span></a></p>
<p style="text-align:justify;"><a href="#bookmark2258"><span class="font23">Secure Sockets Layer (see SSL)</span></a></p>
<p style="text-align:justify;"><span class="font23">security</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2067"><span class="font23">basic authentication and, 283</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2018"><span class="font23">cookies and, 275</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2085"><span class="font23">digest authentication and, 286</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1127"><span class="font23">firewalls, 132</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2971"><span class="font23">FrontPage, security model, 428</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2218"><span class="font23">HTTP authentication schemes, associated</span></a><span class="font23"> risks, 303</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2300"><span class="font23">key length and, 314</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2225"><span class="font23">multiple authentication schemes,</span></a><span class="font23"> risks, 303</span></p>
<p style="text-indent:13pt;"><a href="#bookmark2043"><span class="font23">security realms, 280</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3216"><span class="font23">WPAD security hole, 468</span></a></p>
<p><a href="#bookmark797"><span class="font23">segments, 76</span></a></p>
<p><a href="#bookmark842"><span class="font23">“sender silly window syndrome”, 84</span></a></p>
<p><a href="#bookmark861"><span class="font23">serial loading, 87</span></a></p>
<p><a href="#bookmark861"><span class="font23">serial transaction delays, 87</span></a></p>
<p><a href="#bookmark695"><span class="font23">server error status codes (500-599), 66, </span></a><a href="#bookmark3368"><span class="font23">505</span></a></p>
<p><a href="#bookmark2865"><span class="font23">server farms, 413</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2913"><span class="font23">mirrored servers, 420</span></a></p>
<p><a href="#bookmark3515"><span class="font23">Server headers, 525</span></a></p>
<p><a href="#bookmark1261"><span class="font23">Server response header field, 154</span></a></p>
<p><a href="#bookmark1200"><span class="font23">server URIs vs. proxy URIs, 144</span></a></p>
<p><a href="#bookmark2784"><span class="font23">server-driven negotiation, 397–</span></a><a href="#bookmark2807"><span class="font23">400</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2808"><span class="font23">server-side extensions, 400</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 3pt 0pt;"><span class="font23">servers</span></p>
<p style="text-indent:13pt;"><a href="#bookmark661"><span class="font23">100 Continue status codes and, 60</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1134"><span class="font23">accelerators, 134</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2371"><span class="font23">certificates, 326</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-indent:13pt;"><a href="#bookmark2559"><span class="font23">delta encodings, impact on, 368</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark695"><span class="font23">error status codes (500-599), 66</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1602"><span class="font23">extension APIs, 205</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2944"><span class="font23">FrontPage Server Extensions (FPSE), 424</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2901"><span class="font23">Host headers, interpreting, 419</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2951"><span class="font23">multi-homed servers, 425</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1440"><span class="font23">revalidation, 177</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2865"><span class="font23">server farms, 413</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2917"><span class="font23">master origin servers, 420</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2914"><span class="font23">replica origin servers, 420</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1295"><span class="font23">supported functionality, identifying, 159</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1428"><span class="font23">validation, 175</span></a></p>
<p><a href="#bookmark2808"><span class="font23">server-side extensions, 400</span></a></p>
<p><a href="#bookmark1570"><span class="font23">server-side gateways, 199</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1583"><span class="font23">security gateways, 202</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1578"><span class="font23">web gateways, 200</span></a></p>
<p><a href="#bookmark1065"><span class="font23">server-side includes (SSIs), 124</span></a></p>
<p><a href="#bookmark3245"><span class="font23">service groups, 472</span></a></p>
<p><a href="#bookmark2967"><span class="font23">service_name element, POST request</span></a></p>
<p style="text-indent:37pt;"><span class="font23">body, 427</span></p>
<p><a href="#bookmark1957"><span class="font23">sessions, cookies and, 264</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2010"><span class="font23">tracking with, 272</span></a></p>
<p><a href="#bookmark3052"><span class="font23">&lt;set&gt; element, 438</span></a></p>
<p><a href="#bookmark1958"><span class="font23">Set-Cookie headers, 264,</span></a><a href="#bookmark3518"><span class="font23"> 525</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2017"><span class="font23">caching and, 273</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1978"><span class="font23">domain attributes, 267</span></a></p>
<p><a href="#bookmark1999"><span class="font23">Set-Cookie2 headers, 271, </span></a><a href="#bookmark3521"><span class="font23">526</span></a></p>
<p><a href="#bookmark2864"><span class="font23">shared hosting, 413</span></a><a href="#bookmark2907"><span class="font23">–419</span></a></p>
<p><a href="#bookmark2303"><span class="font23">shared keys, 315</span></a></p>
<p><a href="#bookmark1112"><span class="font23">shared proxies, 130</span></a></p>
<p><a href="#bookmark1388"><span class="font23">sibling caches, 171</span></a></p>
<p><a href="#bookmark1613"><span class="font23">Simple Object Access Protocol (SOAP), 206</span></a></p>
<p><a href="#bookmark1027"><span class="font23">single-threaded web servers, 118</span></a></p>
<p><a href="#bookmark2377"><span class="font23">site certificate validation, 327</span></a></p>
<p><a href="#bookmark1342"><span class="font23">slow hits, 165</span></a></p>
<p><a href="#bookmark1480"><span class="font23">s-maxage response headers, 183</span></a></p>
<p><a href="#bookmark1613"><span class="font23">SOAP (Simple Object Access Protocol), 206</span></a></p>
<p><a href="#bookmark806"><span class="font23">sockets API, 78</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark807"><span class="font23">calls, 78</span></a></p>
<p><a href="#bookmark974"><span class="font23">software web servers, 110</span></a></p>
<p><a href="#bookmark1666"><span class="font23">spiders, 215</span></a></p>
<p><a href="#bookmark1853"><span class="font23">spoofing, 245</span></a></p>
<p><a href="#bookmark3324"><span class="font23">Squid Proxy Log Format, 489–</span></a><a href="#bookmark3331"><span class="font23">492</span></a></p>
<p><a href="#bookmark1065"><span class="font23">SSIs (server-side includes), 124</span></a></p>
<p><a href="#bookmark2258"><span class="font23">SSL (Secure Sockets Layer), 308</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2371"><span class="font23">authentication, 326</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2365"><span class="font23">handshakes, 324</span></a><a href="#bookmark2370"><span class="font23">–326</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2360"><span class="font23">HTTPS, integration in, 323</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2387"><span class="font23">OpenSSL, 328–</span></a><a href="#bookmark2398"><span class="font23">335</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2377"><span class="font23">site certificate validation, 327</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1636"><span class="font23">tunnels, 209</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1642"><span class="font23">vs. HTTP/HTTPS gateways, 210</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p><a href="#bookmark2393"><span class="font23">SSLeay, 329</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2393"><span class="font23">(see also OpenSSL)</span></a></p>
<p><a href="#bookmark558"><span class="font23">start lines, 47–</span></a><a href="#bookmark585"><span class="font23">51</span></a></p>
<p><a href="#bookmark301"><span class="font23">status codes, 9,</span></a><a href="#bookmark571"><span class="font23"> 49,</span></a><a href="#bookmark650"><span class="font23"> 59</span></a><a href="#bookmark702"><span class="font23">–67</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark574"><span class="font23">classes, 49</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark688"><span class="font23">client error codes (400-499), 65</span></a><a href="#bookmark693"><span class="font23">–66,</span></a><a href="#bookmark3369"><span class="font23"> 505</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3362"><span class="font23">HTTP codes, 505</span></a><a href="#bookmark3377"><span class="font23">–507</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark652"><span class="font23">informational status codes</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark652"><span class="font23">(100-199), 59–</span></a><a href="#bookmark669"><span class="font23">60, </span></a><a href="#bookmark3369"><span class="font23">505</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3032"><span class="font23">LOCK method, 436</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3078"><span class="font23">namespace management methods, 443</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark676"><span class="font23">redirection status codes</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark676"><span class="font23">(300-399), 61–</span></a><a href="#bookmark686"><span class="font23">64, </span></a><a href="#bookmark3371"><span class="font23">505</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1743"><span class="font23">robots, handling by, 227</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark695"><span class="font23">server error codes (500-599), 66, </span></a><a href="#bookmark3366"><span class="font23">505</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark670"><span class="font23">success status codes (200-299), 61,</span></a><a href="#bookmark3370"><span class="font23"> 505</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3032"><span class="font23">UNLOCK method, 436</span></a></p>
<p><a href="#bookmark3048"><span class="font23">&lt;status&gt; element, 438</span></a></p>
<p><a href="#bookmark1460"><span class="font23">strong validators, 181, </span></a><a href="#bookmark2536"><span class="font23">363</span></a></p>
<p><a href="#bookmark2693"><span class="font23">subtags, 386, </span></a><a href="#bookmark2721"><span class="font23">389</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2707"><span class="font23">first subtag, 387</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3784"><span class="font23">second subtag, 388</span></a></p>
<p><a href="#bookmark2956"><span class="font23">subweb, 426</span></a></p>
<p><a href="#bookmark670"><span class="font23">success status codes (200-299), 61,</span></a><a href="#bookmark3368"><span class="font23"> 505</span></a></p>
<p><a href="#bookmark2922"><span class="font23">surrogate caches, 421</span></a></p>
<p><a href="#bookmark1155"><span class="font23">surrogate proxies, 137</span></a></p>
<p><a href="#bookmark1135"><span class="font23">surrogates, 134,</span></a><a href="#bookmark1209"><span class="font23"> 146</span></a></p>
<p><a href="#bookmark1703"><span class="font23">symbolic links and cycles, 220</span></a></p>
<p><a href="#bookmark2178"><span class="font23">symmetric authentication, 298</span></a></p>
<p><a href="#bookmark2291"><span class="font23">symmetric-key ciphers, 313</span></a></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark596"><span class="font23">syntax, headers, 51</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">T</span></p>
<p><a href="#bookmark835"><span class="font23">TCP slow start (see under TCP)</span></a></p>
<p><a href="#bookmark780"><span class="font23">TCP (Transmission Control</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark780"><span class="font23">Protocol), 74–</span></a><a href="#bookmark850"><span class="font23">86</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark785"><span class="font23">connections, 75</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark800"><span class="font23">distinguishing values, 77</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark333"><span class="font23">establishing, 13,</span></a><a href="#bookmark811"><span class="font23"> 79</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark997"><span class="font23">web server handling of, 115</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark851"><span class="font23">(see also HTTP connections)</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark817"><span class="font23">network delays, causes, 80</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark814"><span class="font23">performance considerations, 80–</span></a><a href="#bookmark850"><span class="font23">86</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark827"><span class="font23">connection handshake delays, 82</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark832"><span class="font23">delayed acknowledgements, 83</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark824"><span class="font23">delays, most common causes, 81–</span></a><a href="#bookmark850"><span class="font23">86</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark838"><span class="font23">Nagle’s algorithm, 84</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark846"><span class="font23">port exhaustion, 85</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark835"><span class="font23">TCP slow start, 83</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark838"><span class="font23">TCP_NODELAY, 84</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark846"><span class="font23">TIME_WAIT accumulation, 85</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-indent:13pt;"><a href="#bookmark801"><span class="font23">port numbers and, 77</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark780"><span class="font23">reliability, 74</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark861"><span class="font23">serial loading, 87</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark806"><span class="font23">sockets API, 78</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark835"><span class="font23">TCP slow start, 83</span></a></p>
<p><span class="font23">TCP/IP (Transmission Control</span></p>
<p style="text-indent:37pt;"><a href="#bookmark325"><span class="font23">Protocol/Internet Protocol), 11</span></a></p>
<p><a href="#bookmark838"><span class="font23">TCP_NODELAY parameter, 84</span></a></p>
<p><a href="#bookmark3523"><span class="font23">TE headers, 526</span></a></p>
<p><a href="#bookmark343"><span class="font23">Telnet example, 15–</span></a><a href="#bookmark347"><span class="font23">16</span></a></p>
<p><a href="#bookmark3787"><span class="font23">telnet scheme, 40</span></a></p>
<p><a href="#bookmark3654"><span class="font23">text/* MIME types, 565–</span></a><a href="#bookmark3657"><span class="font23">568</span></a></p>
<p><a href="#bookmark3018"><span class="font23">&lt;timeout&gt; element, 434</span></a></p>
<p><a href="#bookmark3004"><span class="font23">Timeout headers, 432, </span></a><a href="#bookmark3026"><span class="font23">435</span></a></p>
<p><a href="#bookmark846"><span class="font23">TIME_WAIT accumulation, 85</span></a></p>
<p><a href="#bookmark3529"><span class="font23">Title headers, 527</span></a></p>
<p><a href="#bookmark2257"><span class="font23">TLS (Transport Layer Security), 308</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2365"><span class="font23">(see also SSL)</span></a></p>
<p><a href="#bookmark628"><span class="font23">TRACE method, 55,</span></a><a href="#bookmark1270"><span class="font23"> 155–</span></a><a href="#bookmark1285"><span class="font23">157</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1274"><span class="font23">Max-Forwards headers and, 155</span></a></p>
<p><a href="#bookmark3526"><span class="font23">Trailer headers, 526</span></a></p>
<p><a href="#bookmark527"><span class="font23">transactional direction, messages, 43</span></a></p>
<p><a href="#bookmark293"><span class="font23">transactions, 8</span></a></p>
<p><a href="#bookmark1139"><span class="font23">transcoders, 135</span></a></p>
<p><a href="#bookmark2774"><span class="font23">transcodings, 395, </span></a><a href="#bookmark2825"><span class="font23">403–</span></a><a href="#bookmark2846"><span class="font23">406</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2836"><span class="font23">content injection, 405</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2830"><span class="font23">format conversion, 404</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2833"><span class="font23">information synthesis, 404</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2829"><span class="font23">types, 404</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2840"><span class="font23">vs. static pregenerated content, 405</span></a><span class="font23"> </span><a href="#bookmark2497"><span class="font23">transfer encodings, 354</span></a><a href="#bookmark2519"><span class="font23">–359</span></a><span class="font23"> </span><a href="#bookmark3532"><span class="font23">Transfer-Encoding headers, 527</span></a><span class="font23"> </span><a href="#bookmark325"><span class="font23">Transmission Control Protocol/Internet</span></a></p>
<p style="text-indent:37pt;"><span class="font23">Protocol (TCP/IP), 11 </span><a href="#bookmark2809"><span class="font23">transparent negotiation, 400–</span></a><a href="#bookmark2824"><span class="font23">403</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2816"><span class="font23">caching, 401</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2820"><span class="font23">Vary headers, 402</span></a></p>
<p><a href="#bookmark1174"><span class="font23">transparent proxies, 140</span></a></p>
<p><a href="#bookmark3226"><span class="font23">transparent redirection, 469</span></a></p>
<p><a href="#bookmark2257"><span class="font23">Transport Layer Security (see TLS)</span></a></p>
<p><a href="#bookmark1690"><span class="font23">trees, 218</span></a></p>
<p><a href="#bookmark2438"><span class="font23">truncation detection, 344</span></a></p>
<p><a href="#bookmark369"><span class="font23">tunnels, 19,</span></a><a href="#bookmark1616"><span class="font23"> 206–</span></a><a href="#bookmark1653"><span class="font23">212</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1645"><span class="font23">authentication, 211</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2401"><span class="font23">HTTPS SSL, 335–</span></a><a href="#bookmark2407"><span class="font23">336</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1649"><span class="font23">security, 211</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1642"><span class="font23">SSL tunnels vs. HTTP/HTTPS</span></a><span class="font23"> gateways, 210</span></p>
<p><a href="#bookmark1084"><span class="font23">type negotiation, 126</span></a></p>
<p><a href="#bookmark2801"><span class="font23">type-map files, 399</span></a></p>
<p><a href="#bookmark989"><span class="font23">type-o-serve web server, 112</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p style="padding:0pt 0pt 5pt 0pt;"><span class="font6" style="font-weight:bold;">U</span></p>
<p><a href="#bookmark3535"><span class="font23">UA- headers, 527</span></a></p>
<p><a href="#bookmark2654"><span class="font23">UCS (Universal Character Set), 381</span></a></p>
<p><span class="font23">uncachable documents, 182</span></p>
<p><a href="#bookmark281"><span class="font23">uniform resource identifiers (see URIs)</span></a></p>
<p><a href="#bookmark284"><span class="font23">uniform resource locators (see URLs)</span></a></p>
<p><a href="#bookmark3788"><span class="font23">uniform resource names (see URNs)</span></a><span class="font23"> </span><a href="#bookmark2654"><span class="font23">Universal Character Set (UCS), 381</span></a><span class="font23"> </span><a href="#bookmark3029"><span class="font23">UNLOCK method, 435</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3032"><span class="font23">status codes, 436</span></a></p>
<p><a href="#bookmark3538"><span class="font23">Upgrade headers, 528</span></a></p>
<p><a href="#bookmark533"><span class="font23">upstream message flow, 44</span></a></p>
<p><a href="#bookmark2145"><span class="font23">uri-directive-value, 294</span></a></p>
<p><a href="#bookmark281"><span class="font23">URIs (uniform resource identifiers), 6, </span></a><a href="#bookmark397"><span class="font23">24</span></a></p>
<p style="padding:0pt 0pt 0pt 36pt;"><a href="#bookmark1222"><span class="font23">client autoexpansion and hostname</span></a><span class="font23"> resolution, 147</span></p>
<p style="padding:0pt 0pt 0pt 12pt;"><span class="font23">intercepting proxies, resolution with, 149 </span><a href="#bookmark2728"><span class="font23">internationalization, 389–</span></a><a href="#bookmark2748"><span class="font23">391</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1198"><span class="font23">resolution, 144</span></a><a href="#bookmark1239"><span class="font23">–150</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1200"><span class="font23">proxy vs. server, 144</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1233"><span class="font23">with a proxy, explicit, 149</span></a></p>
<p style="text-indent:24pt;"><a href="#bookmark1226"><span class="font23">without a proxy, 148</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2210"><span class="font23">rewriting, 302</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3356"><span class="font23">schemes, 499–</span></a><a href="#bookmark3358"><span class="font23">504</span></a></p>
<p><a href="#bookmark284"><span class="font23">URLs (uniform resource locators), 6,</span></a><a href="#bookmark393"><span class="font23"> 23</span></a><a href="#bookmark519"><span class="font23">–42</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark402"><span class="font23">advantages of, 25</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1695"><span class="font23">aliases, 219</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1089"><span class="font23">augmentation, 126</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark466"><span class="font23">automatic expansion, 34</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark491"><span class="font23">canonical form, 37</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1699"><span class="font23">canonicalizing, 220</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark474"><span class="font23">character sets, 35,</span></a><a href="#bookmark478"><span class="font23"> 35</span></a><a href="#bookmark496"><span class="font23">–38</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark3197"><span class="font23">CURLs, 465</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark336"><span class="font23">examples, 13</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark1945"><span class="font23">fat URLs, client identification using, 262</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark516"><span class="font23">informational resources, 41</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark471"><span class="font23">portability, 35</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark510"><span class="font23">PURLs, 40</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark443"><span class="font23">relative URLs, 30</span></a><a href="#bookmark463"><span class="font23">–34</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark486"><span class="font23">restricted characters, 36</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark289"><span class="font23">schemes, 7</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark497"><span class="font23">schemes (see schemes)</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark439"><span class="font23">shortcuts, 30</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark398"><span class="font23">structure, 24</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark407"><span class="font23">syntax, 26</span></a><a href="#bookmark437"><span class="font23">–30</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark395"><span class="font23">URIs, as a subset of, 24</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2773"><span class="font23">variants, 395</span></a></p>
<p style="text-indent:12pt;"><a href="#bookmark2876"><span class="font23">virtual hosting, paths, 415</span></a></p>
<p style="padding:0pt 0pt 0pt 12pt;"><a href="#bookmark3788"><span class="font23">URNs (uniform resource names), 7, </span></a><a href="#bookmark509"><span class="font23">40</span></a><span class="font23"> </span><a href="#bookmark515"><span class="font23">standardization, 41</span></a></p>
<p><a href="#bookmark2642"><span class="font23">US-ASCII character set, 379</span></a></p></td>
<td valign="top" style="width:50%;">
<p><a href="#bookmark373"><span class="font23">user agents, 19</span></a></p>
<p><a href="#bookmark418"><span class="font23">user component, URLs, 27</span></a></p>
<p><a href="#bookmark1051"><span class="font23">user home directory docroots, 122</span></a></p>
<p><a href="#bookmark1722"><span class="font23">User-Agent headers, 225, </span></a><a href="#bookmark1927"><span class="font23">259,</span></a><a href="#bookmark3541"><span class="font23"> 528</span></a><span class="font23"> </span><a href="#bookmark2837"><span class="font23">user-tracking systems, content injection</span></a><span class="font23"> and, 405</span></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark2663"><span class="font23">UTF-8 encoding, 382</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">V</span></p>
<p><a href="#bookmark2534"><span class="font23">validators, 362</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1465"><span class="font23">Last-Modified dates, using, 181</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1460"><span class="font23">strong and weak, 181, </span></a><a href="#bookmark2537"><span class="font23">363</span></a></p>
<p><a href="#bookmark2582"><span class="font23">variable-length codes, 372</span></a></p>
<p><a href="#bookmark2661"><span class="font23">variable-width modal encodings, 381</span></a></p>
<p><a href="#bookmark2658"><span class="font23">variable-width nonmodal encodings, 381</span></a></p>
<p><a href="#bookmark2820"><span class="font23">Vary headers, 402, </span></a><a href="#bookmark3544"><span class="font23">529</span></a></p>
<p><a href="#bookmark2942"><span class="font23">Vermeer Technologies, Inc., 424</span></a></p>
<p><a href="#bookmark580"><span class="font23">version numbers, HTTP messages, 50</span></a></p>
<p><a href="#bookmark1245"><span class="font23">Via headers, 151–</span></a><a href="#bookmark1263"><span class="font23">154, </span></a><a href="#bookmark3547"><span class="font23">529</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1256"><span class="font23">gateways and, 153</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1264"><span class="font23">privacy and security, 154</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1252"><span class="font23">request and response paths, 153</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1262"><span class="font23">Server response header fields and, 154</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1249"><span class="font23">syntax, 152</span></a></p>
<p><a href="#bookmark3658"><span class="font23">video/* MIME types, 568</span></a></p>
<p><a href="#bookmark1729"><span class="font23">virtual hosting, 225, </span></a><a href="#bookmark2864"><span class="font23">413</span></a><a href="#bookmark2907"><span class="font23">–419</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2382"><span class="font23">digital certificates and, 328</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1046"><span class="font23">docroots, 121</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2871"><span class="font23">GET command, problems with, 414</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2887"><span class="font23">Host headers, by, 417</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2893"><span class="font23">(see also Host headers)</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2882"><span class="font23">IP addresses, by, 416</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2886"><span class="font23">problems for hosters, 417</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2879"><span class="font23">port numbers, by, 415</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2867"><span class="font23">server requests, absence of host</span></a><span class="font23"> information in HTTP/1.0, 413</span></p>
<p style="text-indent:25pt;"><a href="#bookmark2875"><span class="font23">fixes, 415</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2876"><span class="font23">URL paths, by, 415</span></a></p>
<p style="padding:0pt 0pt 10pt 0pt;"><a href="#bookmark2950"><span class="font23">virtual servers, 425</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">W</span></p>
<p><a href="#bookmark2465"><span class="font23">Want-Digest headers, 348</span></a></p>
<p><a href="#bookmark3550"><span class="font23">Warning headers, 530</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1489"><span class="font23">Heuristic Expiration Warning, 184</span></a></p>
<p><a href="#bookmark3229"><span class="font23">WCCP (Web Cache Coordination</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark3229"><span class="font23">Protocol), 470</span></a><a href="#bookmark3254"><span class="font23">–473</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3246"><span class="font23">GRE packet encapsulation, 472</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3253"><span class="font23">heartbeat messages, 473</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3251"><span class="font23">load balancing, 473</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3230"><span class="font23">operation, 470</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p><span class="font23">WCCP (</span><span class="font23" style="font-style:italic;">continued</span><span class="font23">)</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3245"><span class="font23">service groups, 472</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3231"><span class="font23">versions, 470</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3236"><span class="font23">WCCP2 messages, 470</span></a><a href="#bookmark3244"><span class="font23">–472</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3240"><span class="font23">header and components, 471</span></a></p>
<p><a href="#bookmark1460"><span class="font23">weak validators, 181, </span></a><a href="#bookmark2538"><span class="font23">363</span></a></p>
<p><a href="#bookmark1877"><span class="font23">web application layer (HTTP-NG), 249, </span></a><a href="#bookmark1890"><span class="font23">251</span></a></p>
<p><a href="#bookmark355"><span class="font23">web architecture, 17</span></a><a href="#bookmark377"><span class="font23">–20</span></a></p>
<p><a href="#bookmark3229"><span class="font23">Web Cache Coordination Protocol (see</span></a></p>
<p style="text-indent:37pt;"><span class="font23">WCCP)</span></p>
<p><a href="#bookmark362"><span class="font23">web caches, 18,</span></a><a href="#bookmark1312"><span class="font23"> 161</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1312"><span class="font23">(see also caches)</span></a></p>
<p><a href="#bookmark269"><span class="font23">web clients and servers, 4</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark2978"><span class="font23">Web Distributed Authoring and Versioning</span></a><span class="font23"> (see WebDAV)</span></p>
<p><a href="#bookmark2854"><span class="font23">web hosting, 411–</span></a><a href="#bookmark2932"><span class="font23">422</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2855"><span class="font23">hosting services, 411</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2864"><span class="font23">shared or virtual hosting, 413–</span></a><a href="#bookmark2907"><span class="font23">419</span></a></p>
<p><a href="#bookmark306"><span class="font23">web pages, 9</span></a></p>
<p><a href="#bookmark1193"><span class="font23">Web Proxy Autodiscovery Protocol (see</span></a></p>
<p style="text-indent:37pt;"><span class="font23">WPAD)</span></p>
<p><a href="#bookmark1105"><span class="font23">web proxy servers, 129</span></a></p>
<p><span class="font23">web publishing</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2979"><span class="font23">collaborative authoring, 429</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2939"><span class="font23">publishing systems, 424</span></a></p>
<p><a href="#bookmark273"><span class="font23">web resources, 4</span></a></p>
<p><a href="#bookmark1663"><span class="font23">web robots, 215</span></a><a href="#bookmark1857"><span class="font23">–246</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1665"><span class="font23">crawlers (see crawlers)</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1664"><span class="font23">examples, 215</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1666"><span class="font23">spiders, 215</span></a></p>
<p style="text-align:justify;"><a href="#bookmark968"><span class="font23">web servers, 109</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1066"><span class="font23">access controls, 124</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark979"><span class="font23">appliances, 111</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1002"><span class="font23">client hostname identification, 115</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1913"><span class="font23">client identification, 257–</span></a><a href="#bookmark2021"><span class="font23">276</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1950"><span class="font23">cookies, using, 263</span></a><a href="#bookmark2021"><span class="font23">–276</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1944"><span class="font23">fat URLs, using, 262</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1921"><span class="font23">headers, using, 258</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1929"><span class="font23">IP address, using, 259</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1938"><span class="font23">user login, using, 260</span></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1021"><span class="font23">connection input/output processing</span></a><span class="font23"> architectures, 117</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark998"><span class="font23">connections, handling new, 115</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1055"><span class="font23">directory listings, 122</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1040"><span class="font23">docroots, 120</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1061"><span class="font23">dynamic content resource mapping, 123</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark982"><span class="font23">embedded web servers, 111</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1082"><span class="font23">explicit typing, 126</span></a></p>
<p style="padding:0pt 0pt 0pt 37pt;"><a href="#bookmark1103"><span class="font23">HTTP proxy servers (see HTTP proxy</span></a><span class="font23"> servers)</span></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark1007"><span class="font23">ident protocol, 115</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-indent:13pt;"><a href="#bookmark970"><span class="font23">implementations, 109</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1095"><span class="font23">logging, 127</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1075"><span class="font23">MIME typing, 125</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1033"><span class="font23">multiplexed I/O servers, 119</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1034"><span class="font23">multiplexed multithreaded servers, 119</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1028"><span class="font23">multiprocess, multithreaded servers, 118</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark985"><span class="font23">Perl example, 111</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1085"><span class="font23">redirection responses, 126</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3112"><span class="font23">request handling, 449</span></a></p>
<p style="text-indent:13pt;"><span class="font23">request messages</span></p>
<p style="text-indent:25pt;"><a href="#bookmark1014"><span class="font23">receiving, 116</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark1020"><span class="font23">structure of, 117</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1036"><span class="font23">resources, mapping and accessing of, 120</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1072"><span class="font23">response entities, 125</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1073"><span class="font23">response messages, 125</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1092"><span class="font23">responses, sending, 127</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1027"><span class="font23">single-threaded servers, 118</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark974"><span class="font23">software web servers, 110</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1065"><span class="font23">SSIs (server-side includes), 124</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark991"><span class="font23">tasks of, 113–</span></a><a href="#bookmark995"><span class="font23">114</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1084"><span class="font23">type negotiation, 126</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark989"><span class="font23">type-o-serve, 112</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2028"><span class="font23">user authentication (see authentication)</span></a></p>
<p><a href="#bookmark1611"><span class="font23">web services, 206</span></a></p>
<p><span class="font23">web sites</span></p>
<p style="text-indent:13pt;"><a href="#bookmark1915"><span class="font23">personalizing of user experience, 257</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2908"><span class="font23">reliability, improving, 419–</span></a><a href="#bookmark2929"><span class="font23">422</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark2913"><span class="font23">mirrored server farms, 420</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1762"><span class="font23">robots, exclusion, 229–</span></a><a href="#bookmark1823"><span class="font23">239</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1772"><span class="font23">robots.txt files, 231</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2931"><span class="font23">speed, improving, 422</span></a></p>
<p><a href="#bookmark1617"><span class="font23">web tunnels (see tunnels)</span></a></p>
<p><a href="#bookmark2978"><span class="font23">WebDAV (Web Distributed Authoring and</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark2978"><span class="font23">Versioning), 429–</span></a><a href="#bookmark3097"><span class="font23">446</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2979"><span class="font23">collaborative authoring and, 429</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3058"><span class="font23">collections, 439–</span></a><a href="#bookmark3080"><span class="font23">444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2992"><span class="font23">DAV header, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2993"><span class="font23">Depth header, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2998"><span class="font23">Destination header, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3082"><span class="font23">enhanced HTTP/1.1 methods, 444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2994"><span class="font23">headers, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3000"><span class="font23">If header, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3012"><span class="font23">LOCK method, 433</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3005"><span class="font23">locking, 432</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3001"><span class="font23">Lock-Token headers, 431</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3034"><span class="font23">META data, embedding, 436–</span></a><a href="#bookmark3057"><span class="font23">439</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2982"><span class="font23">methods, 429</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3058"><span class="font23">namespace management, 439–</span></a><a href="#bookmark3080"><span class="font23">444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3089"><span class="font23">OPTIONS method, 445</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3003"><span class="font23">Overwrite headers, 432</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3005"><span class="font23">overwrites, preventing, 432</span></a></p></td></tr></table><hr>
<table cellpadding="9pt">
<tr>
<td valign="top" style="width:50%;">
<p style="text-indent:13pt;"><a href="#bookmark3049"><span class="font23">PROPATCH method, 438–</span></a><a href="#bookmark3057"><span class="font23">439</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3034"><span class="font23">properties, 436</span></a><a href="#bookmark3057"><span class="font23">–439</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3037"><span class="font23">PROPFIND method, 437</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3084"><span class="font23">PUT method, 444</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3004"><span class="font23">Timeout headers, 432</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3029"><span class="font23">UNLOCK method, 435</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3094"><span class="font23">version management, 446</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark2985"><span class="font23">XML and, 430</span></a></p>
<p><a href="#bookmark1884"><span class="font23">WebMUX protocol, 250,</span></a><a href="#bookmark1892"><span class="font23"> 251</span></a></p>
<p><a href="#bookmark1193"><span class="font23">WPAD (Web Proxy Autodiscovery</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark1193"><span class="font23">Protocol), 143,</span></a><a href="#bookmark3193"><span class="font23"> 464–</span></a><a href="#bookmark3225"><span class="font23">469</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3222"><span class="font23">administration, 469</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3197"><span class="font23">CURLs, 465</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3204"><span class="font23">DHCP discovery, 467</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3207"><span class="font23">DNS A record lookup, 467</span></a></p>
<p style="text-indent:25pt;"><a href="#bookmark3210"><span class="font23">PAC file retrieval, 467</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3196"><span class="font23">PAC file autodiscovery, 465</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark1194"><span class="font23">resource-discovery algorithm, 143, </span></a><a href="#bookmark3201"><span class="font23">465</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3216"><span class="font23">spoofing, 468</span></a></p></td>
<td valign="top" style="width:50%;">
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3219"><span class="font23">timeouts, 468</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3213"><span class="font23">timing, 468</span></a></p>
<p><a href="#bookmark2055"><span class="font23">WWW-Authenticate headers, 281, </span></a><a href="#bookmark3553"><span class="font23">531</span></a></p>
<p style="text-indent:13pt;"><a href="#bookmark3692"><span class="font23">directives, 574–</span></a><a href="#bookmark3697"><span class="font23">575</span></a></p>
<p style="padding:0pt 0pt 11pt 0pt;"><a href="#bookmark1805"><span class="font23">WWW::RobotRules object, 235</span></a></p>
<p style="padding:0pt 0pt 3pt 0pt;"><span class="font6" style="font-weight:bold;">X</span></p>
<p><a href="#bookmark2340"><span class="font23">X.509v3 certificates, 320</span></a></p>
<p><a href="#bookmark3556"><span class="font23">X-Cache headers, 531</span></a></p>
<p><a href="#bookmark1935"><span class="font23">X-Forwarded-For headers, 260, </span></a><a href="#bookmark3557"><span class="font23">531</span></a></p>
<p><a href="#bookmark1612"><span class="font23">XML (Extensible Markup Language), 206,</span></a></p>
<p style="text-indent:37pt;"><a href="#bookmark2986"><span class="font23">430</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark3015"><span class="font23">elements used in locking, 434</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2990"><span class="font23">namespace, 430</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2989"><span class="font23">schema definition, XML documents, 430</span></a></p>
<p style="text-align:justify;text-indent:13pt;"><a href="#bookmark2985"><span class="font23">WebDAV and, 430</span></a></p>
<p><a href="#bookmark3562"><span class="font23">X-Pad headers, 531</span></a></p>
<p><a href="#bookmark3565"><span class="font23">X-Serial-Number headers, 532</span></a></p></td></tr></table><hr>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font7" style="font-weight:bold;">About the Authors</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24" style="font-weight:bold;">David Gourley </span><span class="font24">is the Chief Technology Officer of Endeca, where he leads the research and development of Endeca’s products. Endeca develops Internet and intranet information-access solutions that provide new ways to navigate and explore enterprise data. Prior to working at Endeca, David was a member of the founding engineering team at Inktomi, where he helped develop Inktomi’s Internet search database and was a key developer of Inktomi’s web caching products.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">David earned a B.A. in Computer Science from the University of California at Berkeley, and he holds several patents in web technologies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24" style="font-weight:bold;">Brian Totty </span><span class="font24">was most recently the Vice President of R&amp;D at Inktomi Corporation (a company he helped found in 1996), where he led research and development of web caching, streaming media, and Internet search technologies. Formerly, he was a scientist at Silicon Graphics, where he designed and optimized software for high-performance networking and supercomputing systems. Before that, he held an engineering position at Apple Computer’s Advanced Technology Group.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Brian holds a Ph.D. in Computer Science from the University of Illinois at Urbana-Champaign and a B.S. degree in Computer Science and Electrical Engineering from MIT, where he received the Organick award for computer systems research. He also has developed and taught award-winning courses on Internet technology for the University of California Extension system.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24" style="font-weight:bold;">Marjorie Sayer </span><span class="font24">writes about network caching software at Inktomi Corporation. After earning M.A. and Ph.C. degrees in Mathematics at the University of California at Berkeley, she worked on mathematics curriculum reform. Since 1990 she has written about energy resource management, parallel systems software, telephony, and networking.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24" style="font-weight:bold;">Sailu Reddy </span><span class="font24">currently leads the development of embedded performance-enhancing HTTP proxies at Inktomi Corporation. Sailu has been developing complex software systems for 12years and has been deeply involved in web infrastructure research and development since 1995. He was a core engineer of Netscape’s first web server and web proxy products and of several following generations. His technical experience includes HTTP applications, data compression techniques, database engines, and collaboration management. Sailu earned an M.S. in Information Systems from the University of Arizona and holds several patents in web technologies.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24" style="font-weight:bold;">Anshu Aggarwal </span><span class="font24">is a Director of Engineering at Inktomi Corporation. He leads the protocol-processing engineering teams for Inktomi’s web caching products, and he has been involved in the design of web technologies at Inktomi since 1997. Anshu holds M.S. and Ph.D. degrees in Computer Science from the University of Colorado at Boulder, specializing in memory-consistent techniques for distributed multiprocessor machines. He also holds M.S. and B.S. degrees in Electrical Engineering. Anshu is the author of several technical papers and holds two patents.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font7" style="font-weight:bold;">Colophon</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Our look is the result of reader comments, our own experimentation, and feedback from distribution channels. Distinctive covers complement our distinctive approach to technical topics, breathing personality and life into potentially dry subjects.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">The animal on the cover of </span><span class="font24" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font24"> is a thirteen-lined ground squirrel (</span><span class="font24" style="font-style:italic;">Spermophilus tridecemlineatus</span><span class="font24">), common to central North America. True to its name, the thirteen-lined ground squirrel has thirteen stripes with rows of light spots that run the length of its back. Its color pattern blends into its surroundings, protecting it from predators. Thirteen-lined ground squirrels are members of the squirrel family, which includes chipmunks, ground squirrels, tree squirrels, prairie dogs, and woodchucks. They are similar in size to the eastern chipmunk but smaller than the common gray squirrel, averaging about 11 inches in length (including a 5–6 inch tail).</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Thirteen-lined ground squirrels go into hibernation in October and emerge in late March or early April. Each female usually produces one litter of 7–10 young each May. The young leave the burrows at four to five weeks of age and are fully grown at six weeks. Ground squirrels prefer open areas with short grass and well-drained sandy or loamy soils for burrows, and they avoid wooded areas—mowed lawns, golf courses, and parks are common habitats.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Ground squirrels can cause problems when they create burrows, dig up newly planted seeds, and damage vegetable gardens. However, they are important prey to several predators, including badgers, coyotes, hawks, weasels, and various snakes, and they benefit humans directly by feeding on many harmful weeds, weed seeds, and insects.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Rachel Wheeler was the production editor and copyeditor for </span><span class="font24" style="font-style:italic;">HTTP: The Definitive Guide</span><span class="font24">. Leanne Soylemez, Sarah Sherman, and Mary Anne Weeks Mayo provided quality control, and Derek Di Matteo and Brian Sawyer provided production assistance. John Bickelhaupt wrote the index.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">Ellie Volckhausen designed the cover of this book, based on a series design by Edie Freedman. The cover image is an original illustration created by Lorrie LeJeune. Emma Colby produced the cover layout with QuarkXPress 4.1 using Adobe’s ITC Garamond font.</span></p>
<p style="text-align:justify;padding:0pt 0pt 6pt 0pt;"><span class="font24">David Futato and Melanie Wang designed the interior layout, based on a series design by David Futato. Joe Wizda prepared the files for production in FrameMaker 5.5.6. The text font is Linotype Birka; the heading font is Adobe Myriad Condensed; and the code font is LucasFont’s TheSans Mono Condensed. The illustrations that appear in the book were produced by Robert Romano and Jessamyn Read using Macromedia FreeHand 9 and Adobe Photoshop 6. This colophon was written by Rachel Wheeler.</span></p>
<p><sup><a href="#footnote1">1</a></sup><a name="bookmark317"></a></p>
<p style="text-align:justify;padding:0pt 0pt 10pt 0pt;"><a name="bookmark319"></a><span class="font23" style="font-style:italic;">Figure 1-7. HTTP messages have a simple, line-oriented text structure</span></p>
<p style="text-align:justify;"><span class="font24">HTTP messages sent from web clients to web servers are called </span><span class="font24" style="font-style:italic;">request messages</span><span class="font24">. Messages from servers to clients are called </span><span class="font24" style="font-style:italic;">response messages</span><span class="font24">. There are no other kinds of HTTP messages. The formats of HTTP request and response messages are very similar.</span></p>
<p><sup><a href="#footnote2">2</a></sup><a name="bookmark318"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Some programmers complain about the difficulty of HTTP parsing, which can be tricky and error-prone, especially when designing high-speed software. A binary format or a more restricted text format might have been simpler to process, but most HTTP programmers appreciate HTTP’s extensibility and debuggability.</span></p>
<p><sup><a href="#footnote3">3</a></sup><a name="bookmark405"></a></p>
<p style="padding:0pt 0pt 0pt 8pt;"><span class="font20"> Browsers often use other applications to handle specific resources. For example, Internet Explorer launches an email application to handle URLs that identify email resources.</span></p>
<p><sup><a href="#footnote4">4</a></sup><a name="bookmark425"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This is a bit of a simplification. In</span><a href="#bookmark1052"><span class="font20"> “Virtual Hosting” in Chapter 18</span></a><span class="font20">, we will see that the path is not always enough information to locate a resource. Sometimes a server needs additional information.</span></p>
<p><sup><a href="#footnote5">5</a></sup><a name="bookmark444"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> In</span><a href="#bookmark677"><span class="font20"> “Range Requests” in Chapter 15</span></a><span class="font20">, we will see that HTTP agents may request byte ranges of objects. However, in the context of URL fragments, the server sends the entire object and the agent applies the fragment identifier to the resource.</span></p>
<p><sup><a href="#footnote6">6</a></sup><a name="bookmark476"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This is caused by the use of a 7-bit encoding for messages; this can strip off information if the source is encoded in 8 bits or more.</span></p>
<p><sup><a href="#footnote7">7</a></sup><a name="bookmark479"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Nonprinting characters include whitespace (note that RFC 2396 recommends that applications ignore whitespace).</span></p>
<p><sup><a href="#footnote8">8</a></sup><a name="bookmark494"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Here we are specifically talking about client applications, not other HTTP intermediaries, like proxies. In </span><a href="#bookmark1217"><span class="font20">“In-Flight URI Modification” in Chapter 6</span></a><span class="font20">, we discuss some of the problems that can arise when proxies or other intermediary HTTP applications attempt to change (e.g., encode) URLs on the behalf of a client.</span></p>
<p><sup><a href="#footnote9">9</a></sup><a name="bookmark498"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> </span><a href="#bookmark490"><span class="font20">Table 2-3 </span></a><span class="font20">lists reserved characters for the various URL components. In general, encoding should be limited to those characters that are unsafe for transport.</span></p>
<p><sup><a href="#footnote10">10</a></sup><a name="bookmark539"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The terms “upstream” and “downstream” relate only to the sender and receiver. We can’t tell whether a message is heading to the origin server or the client, because both are downstream.</span></p>
<p><sup><a href="#footnote11">11</a></sup><a name="bookmark583"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> See </span><a href="http://httpd.apache.org/docs-2.0/misc/known_client_problems.html"><span class="font20" style="font-style:italic;">http://httpd.apache.org/docs-2.0/misc/known_client_problems.html</span></a><span class="font20"> for more on cases in which Apache has run into this problem with clients.</span></p>
<p><sup><a href="#footnote12">12</a></sup><a name="bookmark783"></a></p>
<p style="text-align:right;"><span class="font20"> Though messages won’t be lost or corrupted, communication between client and server can be severed if a computer or network breaks. In this case, the client and server are notified of the communication breakdown.</span></p>
<p><sup><a href="#footnote13">13</a></sup><a name="bookmark789"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> If you are trying to write sophisticated HTTP applications, and especially if you want them to be fast, you’ll want to learn a lot more about the internals and performance of TCP than we discuss in this chapter. We recommend the “TCP/IP Illustrated” books by W. Richard Stevens (Addison Wesley).</span></p>
<p><sup><a href="#footnote14">14</a></sup><a name="bookmark823"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Luckily, most HTTP clients keep a small DNS cache of IP addresses for recently accessed sites. When the IP address is already “cached” (recorded) locally, the lookup is instantaneous. Because most web browsing is to a small number of popular sites, hostnames usually are resolved very quickly.</span></p>
<p><sup><a href="#footnote15">15</a></sup><a name="bookmark831"></a></p>
<p><span class="font20"> IP packets are usually a few hundred bytes for Internet traffic and around 1,500 bytes for local traffic.</span></p>
<p><sup><a href="#footnote16">16</a></sup><a name="bookmark841"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Sending a storm of single-byte packets is called “sender silly window syndrome.” This is inefficient, antisocial, and can be disruptive to other Internet traffic.</span></p>
<p><sup><a href="#footnote17">17</a></sup><a name="bookmark843"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Several variations of this algorithm exist, including timeouts and acknowledgment logic changes, but the basic algorithm causes buffering of data smaller than a TCP segment.</span></p>
<p><sup><a href="#footnote18">18</a></sup><a name="bookmark844"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> These problems can become worse when using pipelined connections (described later in this chapter), because clients may have several messages to send to the same server and do not want delays.</span></p>
<p><sup><a href="#footnote19">19</a></sup><a name="bookmark849"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The 2MSL value of two minutes is historical. Long ago, when routers were much slower, it was estimated that a duplicate copy of a packet might be able to remain queued in the Internet for up to a minute before being destroyed. Today, the maximum segment lifetime is much smaller.</span></p>
<p><sup><a href="#footnote20">20</a></sup><a name="bookmark865"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> This is true even if loading multiple images at the same time is </span><span class="font20" style="font-style:italic;">slower</span><span class="font20"> than loading images one at a time! Users often perceive multiple-image loading as faster.</span></p>
<p><sup><a href="#footnote21">21</a></sup><a name="bookmark866"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> HTML designers can help eliminate this “layout delay” by explicitly adding width and height attributes to HTML tags for embedded objects such as images. Explicitly providing the width and height of the embedded image allows the browser to make graphical layout decisions before it receives the objects from the server.</span></p>
<p><sup><a href="#footnote22">22</a></sup><a name="bookmark873"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The embedded components do not all need to be hosted on the same web server, so the parallel connections can be established to multiple servers.</span></p>
<p><sup><a href="#footnote23">23</a></sup><a name="bookmark877"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> There will generally still be a small delay between each connection request due to software overheads, but the connection requests and transfer times are mostly overlapped.</span></p>
<p><sup><a href="#footnote24">24</a></sup><a name="bookmark881"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> In fact, because of the extra overhead from multiple connections, it’s quite possible that parallel connections could take longer to load the entire page than serial downloads.</span></p>
<p><sup><a href="#footnote25">25</a></sup><a name="bookmark887"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> This effect is amplified by the increasing use of progressive images that produce low-resolution approximations of images first and gradually increase the resolution.</span></p>
<p><sup><a href="#footnote26">26</a></sup><a name="bookmark897"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Additionally, the request and response time might also be reduced because of elimination of the slow-start phase. This performance benefit is not depicted in the figure.</span></p>
<p><sup><a href="#footnote27">27</a></sup><a name="bookmark913"></a></p>
<p><span class="font20"> There are many similar scenarios where failures occur due to blind relays and forwarded handshaking.</span></p>
<p><sup><a href="#footnote28">28</a></sup><a name="bookmark937"></a></p>
<p><span class="font20"> Servers shouldn’t close a connection in the middle ofa response unless client or network failure is suspected.</span></p>
<p><sup><a href="#footnote29">29</a></sup><a name="bookmark942"></a></p>
<p style="text-indent:7pt;"><span class="font20">Administrators who use GET-based dynamic forms should make sure the forms are idempotent.</span></p>
<p><sup><a href="#footnote30">30</a></sup><a name="bookmark1003"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Different operating systems have different interfaces and data structures for manipulating TCP connections. In Unix environments, the TCP connection is represented by a </span><span class="font20" style="font-style:italic;">socket</span><span class="font20">, and the IP address of the client can be found from the socket using the </span><span class="font20" style="font-style:italic;">getpeername</span><span class="font20"> call.</span></p>
<p><sup><a href="#footnote31">31</a></sup><a name="bookmark1011"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> This Common Log Format </span><span class="font20" style="font-style:italic;">ident</span><span class="font20"> field is called “rfc931,” after an outdated version of the RFC defining the </span><span class="font20" style="font-style:italic;">ident</span><span class="font20"> protocol (the updated </span><span class="font20" style="font-style:italic;">ident</span><span class="font20"> specification is documented by RFC 1413).</span></p>
<p><sup><a href="#footnote32">32</a></sup><a name="bookmark1018"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The initial version of HTTP, called HTTP/0.9, does not support version numbers. Some web servers support missing version numbers, interpreting the message as an HTTP/0.9 request.</span></p>
<p><sup><a href="#footnote33">33</a></sup><a name="bookmark1019"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Many web servers support LF or CRLF as end-of-line sequences, because some clients mistakenly send LF as the end-of-line terminator.</span></p>
<p><sup><a href="#footnote34">34</a></sup><a name="bookmark1030"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> A process is an individual program flow of control, with its own set of variables. A thread is a faster, more efficient version ofa process. Both threads and processes let a single program do multiple things at the same time. For simplicity of explanation, we treat processes and threads interchangeably. But, because of the performance differences, many high-performance servers are both multiprocess </span><span class="font20" style="font-style:italic;">and</span><span class="font20"> multithreaded.</span></p>
<p><sup><a href="#footnote35">35</a></sup><a name="bookmark1031"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Systems where threads are created in advance are called “worker pool” systems, because a set of threads waits in a pool for work to do.</span></p>
<p><sup><a href="#footnote36">36</a></sup><a name="bookmark1090"></a></p>
<p><span class="font20"> These extended, state-augmented URLs are sometimes called “fat URLs.”</span></p>
<p><sup><a href="#footnote37">37</a></sup><a name="bookmark1125"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Several companies and nonprofit organizations provide filtering software and maintain “blacklists” in order to identify and restrict access to objectionable content.</span></p>
<p><sup><a href="#footnote38">38</a></sup><a name="bookmark1128"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> To prevent sophisticated users from willfully bypassing the control proxy, the web servers can be statically configured to accept requests only from the proxy servers.</span></p>
<p><sup><a href="#footnote39">39</a></sup><a name="bookmark1141"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Some people distinguish “transcoding” and “translation,” defining transcoding as relatively simple conversions of the encoding of the data (e.g., lossless compression) and translation as more significant reformatting or semantic changes of the data. We use the term transcoding to mean any intermediary-based modification of the content.</span></p>
<p><sup><a href="#footnote40">40</a></sup><a name="bookmark1144"></a></p>
<p><a name="bookmark1143"></a><span class="font23" style="font-style:italic;">Figure 6-10. Proxy application example: anonymizer</span></p>
<p><sup><a href="#footnote41">41</a></sup><a name="bookmark1145"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> However, because identifying information is removed, the quality of the user’s browsing experience may be diminished, and some web sites may not function properly.</span></p>
<p><sup><a href="#footnote42">42</a></sup><a name="bookmark1157"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Core proxies often are deployed where Internet bandwidth is very expensive (especially in Europe). Some countries (such as the UK) also are evaluating controversial proxy deployments to monitor Internet traffic for national security concerns.</span></p>
<p><sup><a href="#footnote43">43</a></sup><a name="bookmark1176"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Intercepting proxies commonly are called “transparent proxies,” because you connect to them without being aware of their presence. Because the term “transparency” already is used in the HTTP specifications to indicate functions that don’t change semantic behavior, the standards community suggests using the term “interception” for traffic capture. We adopt this nomenclature here.</span></p>
<p><sup><a href="#footnote44">44</a></sup><a name="bookmark1183"></a></p>
<p><span class="font20"> Currently supported only by Internet Explorer.</span></p>
<p><sup><a href="#footnote45">45</a></sup><a name="bookmark1204"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><a name="bookmark1205"></a><span class="font20"> HTTP/1.1 now requires servers to handle full URIs for both proxy and server requests, but in practice, many deployed servers still accept only partial URIs.</span></p>
<p><sup><a href="#footnote46">46</a></sup><a name="bookmark1214"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Intercepting proxies also might intercept client-to-proxy traffic in some circumstances, in which case the intercepting proxy might get full URIs and need to handle them. This doesn’t happen often, because explicit proxies normally communicate on a port different from that used by HTTP (usually 8080 instead of 80), and intercepting proxies usually intercept only port 80.</span></p>
<p><sup><a href="#footnote47">47</a></sup><a name="bookmark1219"></a></p>
<p><span class="font20"> This shouldn’t be done casually. Users will receive cryptic error pages they never got before.</span></p>
<p><sup><a href="#footnote48">48</a></sup><a name="bookmark1225"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Most browsers let you type in “yahoo” and auto-expand that into “www.yahoo.com.” Similarly, browsers let you omit the “http://” prefix and insert it if it’s missing.</span></p>
<p><sup><a href="#footnote49">49</a></sup><a name="bookmark1234"></a></p>
<p><span class="font20"> But, for widely shared proxies, it may be impossible to know the proper domain suffix for individual users.</span></p>
<p><sup><a href="#footnote50">50</a></sup><a name="bookmark1253"></a></p>
<p><span class="font20"> For example, caching proxy servers may include hit/miss information.</span></p>
<p><sup><a href="#footnote51">51</a></sup><a name="bookmark1275"></a></p>
<p><span class="font20"> Unfortunately, it isn’t widely implemented yet.</span></p>
<p><sup><a href="#footnote52">52</a></sup><a name="bookmark1276"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The final recipient is either the origin server or the first proxy or gateway to receive a Max-Forwards value of zero (0) in the request.</span></p>
<p><sup><a href="#footnote53">53</a></sup><a name="bookmark1292"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Multiple message header fields with the same field name may be present in a message, but if they are, they must be able to be equivalently combined into a comma-separated list. The order in which header fields with the same field name are received is therefore significant to the interpretation of the combined field value, so a proxy can’t change the relative order of these same-named field values when it forwards a message.</span></p>
<p><sup><a href="#footnote54">54</a></sup><a name="bookmark1299"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Not all resources support every method. For example, a CGI script query may not support a file PUT, and a static HTML file wouldn’t accept a POST method.</span></p>
<p><sup><a href="#footnote55">55</a></sup><a name="bookmark1322"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This table shows just the effect of network bandwidth on transfer time. It assumes 100% network efficiency and no network or application processing latencies. In this way, the delay is a lower bound. Real delays will be larger, and the delays for small objects will be dominated by non-bandwidth overheads.</span></p>
<p><sup><a href="#footnote56">56</a></sup><a name="bookmark1331"></a></p>
<p><span class="font20"> In reality, signals travel at somewhat less than the speed of light, so distance delays are even worse.</span></p>
<p><sup><a href="#footnote57">57</a></sup><a name="bookmark1335"></a></p>
<p style="text-align:right;"><span class="font20"> Few folks can afford to buy a cache big enough to hold all the Web’s documents. And even if you could afford gigantic “whole-Web caches,” some documents change so frequently that they won’t be fresh in many caches.</span></p>
<p><sup><a href="#footnote58">58</a></sup><a name="bookmark1352"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The term “hit ratio” probably is better than “hit rate,” because “hit rate” mistakenly suggests a time factor. However, “hit rate” is in common use, so we use it here.</span></p>
<p><sup><a href="#footnote59">59</a></sup><a name="bookmark1353"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Sometimes people include revalidate hits in the hit rate, but other times hit rate and revalidate hit rate are measured separately. When you are examining hit rates, be sure you know what counts as a “hit.”</span></p>
<p><sup><a href="#footnote60">60</a></sup><a name="bookmark1373"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Because a public cache caches the diverse interests of the user community, it needs to be large enough to hold a set of popular documents, without being swept clean by individual user interests.</span></p>
<p><sup><a href="#footnote61">61</a></sup><a name="bookmark1380"></a></p>
<p><span class="font20"> If the clients are browsers with browser caches, </span><a href="#bookmark1379"><span class="font20">Figure 7-9 </span></a><span class="font20">technically shows a </span><span class="font20" style="font-style:italic;">three</span><span class="font20">-level cache hierarchy.</span></p>
<p><sup><a href="#footnote62">62</a></sup><a name="bookmark1381"></a></p>
<p style="text-align:center;"><span class="font20"> Parent caches may need to be larger, to hold the documents popular across more users, and higher-performance, because they receive the aggregate traffic of many children, whose interests may be diverse.</span></p>
<p><sup><a href="#footnote63">63</a></sup><a name="bookmark1384"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> In practice, network architects try to limit themselves to two or three proxies in a row. However, a new generation of high-performance proxy servers may make proxy-chain length less of an issue.</span></p>
<p><sup><a href="#footnote64">64</a></sup><a name="bookmark1401"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The parser also is responsible for normalizing the parts of the header so that unimportant differences, like capitalization or alternate date formats, all are viewed equivalently. Also, because some request messages contain a full absolute URL and other request messages contain a relative URL and Host header, the parser typically hides these details (see</span><a href="#bookmark441"><span class="font20"> “Relative URLs” in Chapter 2</span></a><span class="font20">).</span></p>
<p><sup><a href="#footnote65">65</a></sup><a name="bookmark1406"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Sophisticated caches also keep a copy of the original client response headers that yielded the server response, for use in HTTP/1.1 content negotiation (see </span><a href="#bookmark241"><span class="font20">Chapter 17</span></a><span class="font20">).</span></p>
<p><sup><a href="#footnote66">66</a></sup><a name="bookmark1438"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Note that all HTTP dates and times are expressed in Greenwich Mean Time (GMT). GMT is the time at the prime meridian (0˚ longitude) that passes through Greenwich, UK. GMT is five hours ahead of U.S. Eastern Standard Time, so midnight EST is 05:00 GMT.</span></p>
<p><sup><a href="#footnote67">67</a></sup><a name="bookmark1444"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> If the origin server is not accessible, but the cache needs to revalidate, the cache must return an error or a warning describing the communication failure. Otherwise, pages from a removed server may live in network caches for an arbitrary time into the future.</span></p>
<p><sup><a href="#footnote68">68</a></sup><a name="bookmark1497"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Document expiration is a form of “time to live” technique used in many Internet protocols, such as DNS. DNS, like HTTP, has trouble if you publish an expiration date far in the future and then find that you need to make a change. However, HTTP provides mechanisms for a client to override and force a reloading, unlike DNS.</span></p>
<p><sup><a href="#footnote69">69</a></sup><a name="bookmark1518"></a></p>
<p><span class="font20"> Remember that the server always has the most up-to-date version of any document.</span></p>
<p><sup><a href="#footnote70">70</a></sup><a name="bookmark1526"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The HTTP specification recommends that clients, servers, and proxies use a time synchronization protocol such as NTP to enforce a consistent time base.</span></p>
<p><sup><a href="#footnote71">71</a></sup><a name="bookmark1531"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Note that if the document came from a parent cache and not from an origin server, the Date header will reflect the date of the origin server, not of the parent cache.</span></p>
<p><sup><a href="#footnote72">72</a></sup><a name="bookmark1532"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> In practice, this shouldn’t be more than a few tens of seconds (or users will abort), but the HTTP designers wanted to try to support accurate expiration of even of short-lifetime objects.</span></p>
<p><sup><a href="#footnote73">73</a></sup><a name="bookmark1551"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Some caches support a variant of this revalidation, where they do a conditional GET or a HEAD request in the background. The user does not perceive the delay, but the request triggers an offline access to the origin server. This is an improvement, but it places more load on the caches and significantly increases traffic across the network.</span></p>
<p><sup><a href="#footnote74">74</a></sup><a name="bookmark1556"></a></p>
<p><span class="font20"> Several businesses have launched trying to develop global solutions for integrated caching and logging.</span></p>
<p><sup><a href="#footnote75">75</a></sup><a name="bookmark1573"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Web proxies that convert between different versions of HTTP are like gateways, because they perform sophisticated logic to negotiate between the parties. But because they speak HTTP on both sides, they are technically proxies.</span></p>
<p><sup><a href="#footnote76">76</a></sup><a name="bookmark1618"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> For more information, see </span><a href="http://www.w3.org/TR/2001/WD-soap12-part0-20011217/"><span class="font20" style="font-style:italic;">http://www.w3.org/TR/2001/WD-soap12-part0-20011217/</span></a><span class="font20">. </span><span class="font20" style="font-style:italic;">Programming Web Services with SOAP</span><span class="font20">, by Doug Tidwell, James Snell, and Pavel Kulchenko (O’Reilly) is also an excellent source of information on the SOAP protocol.</span></p>
<p><sup><a href="#footnote77">77</a></sup><a name="bookmark1625"></a></p>
<p><span class="font20"> The HTTP/1.1 specification reserves the CONNECT method but does not describe its function.</span></p>
<p><sup><a href="#footnote78">78</a></sup><a name="bookmark1632"></a></p>
<p><span class="font20"> Future specifications may define a media type for tunnels (e.g., application/tunnel), for uniformity.</span></p>
<p><sup><a href="#footnote79">79</a></sup><a name="bookmark1635"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The two endpoints of the tunnel (the client and the gateway) must be prepared to accept packets from either of the connections at any time and must forward that data immediately. Because the tunneled protocol may include data dependencies, neither end of the tunnel can ignore input data. Lack of data consumption on one end of the tunnel may hang the producer on the other end of the tunnel, leading to deadlock.</span></p>
<p><sup><a href="#footnote80">80</a></sup><a name="bookmark1637"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Try not to pipeline more data than can fit into the remainder of the request’s TCP packet. Pipelining more data can cause a client TCP reset if the gateway subsequently closes the connection before all pipelined TCP packets are received. ATCP reset can cause the client to lose the received gateway response, so the client won’t be able to tell whether the failure was due to a network error, access control, or authentication challenge.</span></p>
<p><sup><a href="#footnote81">81</a></sup><a name="bookmark1667"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> </span><a href="http://www.netcraft.com"><span class="font20" style="font-style:italic;">http://www.netcraft.com</span></a><span class="font20"> collects great census metrics on what flavors of servers are being used by sites around the Web.</span></p>
<p><sup><a href="#footnote82">82</a></sup><a name="bookmark1677"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> In </span><a href="#bookmark1678"><span class="font20">“Cycle Avoidance</span></a><span class="font20">,” we begin to discuss the need for crawlers to remember where they have been. During a crawl, this list of </span><span class="font20" style="font-style:italic;">discovered</span><span class="font20"> URLs grows until the web space has been explored thoroughly and the crawler reaches a point at which it is no longer discovering new links.</span></p>
<p><sup><a href="#footnote83">83</a></sup><a name="bookmark1694"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Because there are a potentially infinite number of URLs and only a finite number of bits in the presence bit array, there is potential for collision—two URLs can map to the same presence bit. When this happens, the crawler mistakenly concludes that a page has been crawled when it hasn’t. In practice, this situation can be made very unlikely by using a large number of presence bits. The penalty for collision is that a page will be omitted from a crawl.</span></p>
<p><sup><a href="#footnote84">84</a></sup><a name="bookmark1711"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This is a real example mentioned on </span><a href="http://www.searchtools.com/robots/robot-checklist.html"><span class="font20" style="font-style:italic;">http://www.searchtools.com/robots/robot-checklist.html</span></a><span class="font20"> for the calendaring site at </span><a href="http://cgi.umbc.edu/cgi-bin/WebEvent/webevent.cgi"><span class="font20" style="font-style:italic;">http://cgi.umbc.edu/cgi-bin/WebEvent/webevent.cgi</span></a><span class="font20">. As a result of dynamic content like this, many robots refuse to crawl pages that have the substring “cgi” anywhere in the URL.</span></p>
<p><sup><a href="#footnote85">85</a></sup><a name="bookmark1714"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Breadth-first crawling is a good idea in general, so as to more evenly disperse requests and not overwhelm any one server. This can help keep the resources that a robot uses on a server to a minimum.</span></p>
<p><sup><a href="#footnote86">86</a></sup><a name="bookmark1715"></a></p>
<p><span class="font20"> Throttling of request rate is also discussed in</span><a href="#bookmark1825"><span class="font20"> “Robot Etiquette</span></a><span class="font20">.”</span></p>
<p><sup><a href="#footnote87">87</a></sup><a name="bookmark1716"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"></span><a href="#bookmark1765"><span class="font20"> “Excluding Robots</span></a><span class="font20">” discusses how sites can avoid being crawled, but some users refuse to use this simple control mechanism and become quite irate when their sites are crawled.</span></p>
<p><sup><a href="#footnote88">88</a></sup><a name="bookmark1730"></a></p>
<p><span class="font20"> An RFC 822 email address format.</span></p>
<p><sup><a href="#footnote89">89</a></sup><a name="bookmark1731"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"></span><a href="#bookmark726"><span class="font20"> “Accept headers” in Chapter 3</span></a><span class="font20"> lists all of the accept headers; robots may find it useful to send headers such as Accept-Charset if they are interested in particular versions.</span></p>
<p><sup><a href="#footnote90">90</a></sup><a name="bookmark1732"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> This can be very useful to site administrators that are trying to track down how a robot found links to their sites’ content.</span></p>
<p><sup><a href="#footnote91">91</a></sup><a name="bookmark1740"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"></span><a href="#bookmark732"><span class="font20"> “Conditional request headers” in Chapter 3 </span></a><span class="font20">gives a complete listing of the conditional headers that a robot can implement.</span></p>
<p><sup><a href="#footnote92">92</a></sup><a name="bookmark1751"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"></span><a href="#bookmark1815"><span class="font20"> “Robot META directives</span></a><span class="font20">” lists additional meta directives that site administrators and content authors can use to control the behavior of robots and what they do with documents that have been retrieved.</span></p>
<p><sup><a href="#footnote93">93</a></sup><a name="bookmark1752"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The Refresh HTTP header sometimes is used as a means to redirect users (or in this case, a robot) from one page to another.</span></p>
<p><sup><a href="#footnote94">94</a></sup><a name="bookmark1753"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Meta tags must occur in the HEAD section of HTML documents, according to the HTML specification. However, they sometimes occur in other HTML document sections, as not all HTML documents adhere to the specification.</span></p>
<p><sup><a href="#footnote95">95</a></sup><a name="bookmark1757"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"></span><a href="#bookmark1765"><span class="font20"> “Excluding Robots</span></a><span class="font20">” provides information for how site administrators can control the behavior of robots on their sites if there is content that should not be accessed by robots.</span></p>
<p><sup><a href="#footnote96">96</a></sup><a name="bookmark1761"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Generally, ifa resource is available over the public Internet, it is likely referenced somewhere. Few resources are truly private, with the web of links that exists on the Internet.</span></p>
<p><sup><a href="#footnote97">97</a></sup><a name="bookmark1763"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> See search results at </span><a href="http://www.google.com"><span class="font20" style="font-style:italic;">http://www.google.com</span></a><span class="font20">. A cached link, which is a copy of the page that the Google crawler retrieved and indexed, is available on most results.</span></p>
<p><sup><a href="#footnote98">98</a></sup><a name="bookmark1776"></a></p>
<p style="text-align:center;"><span class="font20"> Even though we say “</span><span class="font20" style="font-style:italic;">robots.txt</span><span class="font20"> file,” there is no reason that the </span><span class="font20" style="font-style:italic;">robots.txt</span><span class="font20"> resource must strictly reside in a filesystem. For example, the </span><span class="font20" style="font-style:italic;">robots.txt</span><span class="font20"> resource could be dynamically generated by a gateway application.</span></p>
<p><sup><a href="#footnote99">99</a></sup><a name="bookmark1786"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> For practical reasons, robot software should be robust and flexible with the end-of-line character. CR, LF, and CRLF should all be supported.</span></p>
<p><sup><a href="#footnote100">100</a></sup><a name="bookmark1791"></a></p>
<p><span class="font20"> The </span><span class="font20" style="font-style:italic;">robots.txt</span><span class="font20"> URL always is allowed and must not appear in the Allow/Disallow rules.</span></p>
<p><sup><a href="#footnote101">101</a></sup><a name="bookmark1804"></a></p>
<p><span class="font20"> See</span><a href="#bookmark1423"><span class="font20"> “Keeping Copies Fresh” in Chapter 7</span></a><span class="font20"> for more on handling caching directives.</span></p>
<p><sup><a href="#footnote102">102</a></sup><a name="bookmark1806"></a></p>
<p><span class="font20"> Several large-scale web crawlers use the rule of refetching </span><span class="font20" style="font-style:italic;">robots.txt</span><span class="font20"> daily when actively crawling the Web.</span></p>
<p><sup><a href="#footnote103">103</a></sup><a name="bookmark1818"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This META tag was introduced by the folks who run the Google search engine as a way for webmasters to opt out of allowing Google to serve cached pages of their content. It also can be used with META NAME=&quot;googlebot&quot;.</span></p>
<p><sup><a href="#footnote104">104</a></sup><a name="bookmark1835"></a></p>
<p><span class="font20"> This depends on the resources of the server, the client robot, and the network between the two.</span></p>
<p><sup><a href="#footnote105">105</a></sup><a name="bookmark1847"></a></p>
<p><span class="font20"> The method for passing this query is dependent on the search solution being used.</span></p>
<p><sup><a href="#footnote106">106</a></sup><a name="bookmark1849"></a></p>
<p><span class="font20"></span><a href="#bookmark428"><span class="font20"> “Query Strings” in Chapter 2 </span></a><span class="font20">discusses the common use of the query parameter in URLs.</span></p>
<p><sup><a href="#footnote107">107</a></sup><a name="bookmark1933"></a></p>
<p><span class="font20"> As we’ll see later, some proxies do add a Client-ip header, but this is not part of the HTTP standard.</span></p>
<p><sup><a href="#footnote108">108</a></sup><a name="bookmark1941"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> To save users from having to log in for each request, most browsers will remember login information for a site and pass in the login information for each request to the site.</span></p>
<p><sup><a href="#footnote109">109</a></sup><a name="bookmark1943"></a></p>
<p style="text-align:center;"><span class="font20"> As we will see in</span><a href="#bookmark238"><span class="font20"> Chapter 14</span></a><span class="font20">, the HTTP basic authentication username and password can easily be unscrambled by anyone who wants to go through a minimal effort. More secure techniques will be discussed later.</span></p>
<p><sup><a href="#footnote110">110</a></sup><a name="bookmark2073"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Be careful that the username/password in basic authentication is not the same as the password on your more secure systems, or malicious users can use them to break into your secure accounts!</span></p>
<p><sup><a href="#footnote111">111</a></sup><a name="bookmark2074"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> While not very secure, internal employees of the company usually are unmotivated to maliciously capture passwords. That said, corporate espionage does occur, and vengeful, disgruntled employees do exist, so it is wise to place any data that would be very harmful if maliciously acquired under a stronger security scheme.</span></p>
<p><sup><a href="#footnote112">112</a></sup><a name="bookmark2086"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Usernames and passwords are scrambled using a trivial base-64 encoding, which can be decoded easily. This protects against unintentional accidental viewing but offers no protection against malicious parties.</span></p>
<p><sup><a href="#footnote113">113</a></sup><a name="bookmark2089"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> For example, compared to public key–based mechanisms, digest authentication does not provide a strong authentication mechanism. Also, digest authentication offers no confidentiality protection beyond protecting the actual password—the rest of the request and response are available to eavesdroppers.</span></p>
<p><sup><a href="#footnote114">114</a></sup><a name="bookmark2092"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> There has been significant debate about the relevance of digest authentication, given the popularity and widespread adoption of SSL-encrypted HTTP. Time will tell if digest authentication gains the critical mass required.</span></p>
<p><sup><a href="#footnote115">115</a></sup><a name="bookmark2095"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> There are techniques, such as dictionary attacks, where common passwords are tried first. These cryptanalysis techniques can dramatically ease the process of cracking passwords.</span></p>
<p><sup><a href="#footnote116">116</a></sup><a name="bookmark2097"></a></p>
<p><span class="font20"> In fact, the server really needs to know only the digests of the passwords.</span></p>
<p><sup><a href="#footnote117">117</a></sup><a name="bookmark2125"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> However, they are made a little more complicated for beginners by the optional compatibility modes of RFC 2617 and by the lack of background material in the specifications. We’ll try to help. . .</span></p>
<p><sup><a href="#footnote118">118</a></sup><a name="bookmark2275"></a></p>
<p><span class="font20"> For simplicity of example, we aren’t rotating punctuation or whitespace, but you could.</span></p>
<p><sup><a href="#footnote119">119</a></sup><a name="bookmark2281"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Perhaps the most famous mechanical code machine was the World War II German Enigma code machine. Despite the complexity of the Enigma cipher, Alan Turing and colleagues were able to crack the Enigma codes in the early 1940s, using the earliest digital computers.</span></p>
<p><sup><a href="#footnote120">120</a></sup><a name="bookmark2284"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> In reality, having the logic of the machine in your possession can sometimes help you to crack the code, because the machine logic may point to patterns that you can exploit. Modern cryptographic algorithms usually are designed so that even if the algorithm is publicly known, it’s difficult to come up with any patterns that will help evildoers crack the code. In fact, many of the strongest ciphers in common use have their source code available in the public domain, for all to see and study!</span></p>
<p><sup><a href="#footnote121">121</a></sup><a name="bookmark2299"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> There are ciphers where only some of the key values are valid. For example, in RSA, the best-known asymmetric-key cryptosystem, valid keys must be related to prime numbers in a certain way. Only a small number of the possible key values have this property.</span></p>
<p><sup><a href="#footnote122">122</a></sup><a name="bookmark2301"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Computation speed has increased dramatically since 1995, and cost has been reduced. And the longer it takes you to read this book, the faster they’ll become! However, the table still is relatively useful, even if the times are off by a factor of 5, 10, or more.</span></p>
<p><sup><a href="#footnote123">123</a></sup><a name="bookmark2304"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> A large key does not mean that the cipher is foolproof, though! There may be an unnoticed flaw in the cipher algorithm or implementation that provides a weakness for an attacker to exploit. It’s also possible that the attacker may have some information about how the keys are generated, so that he knows some keys are more likely than others, helping to focus a brute-force attack. Or a user might leave the secret key someplace where an attacker might be able to steal it.</span></p>
<p><sup><a href="#footnote124">124</a></sup><a name="bookmark2313"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> As we’ll see later, most public-key lookup actually is done through digital certificates, but the details of how you find public keys don’t matter much now—just know that they are publicly available somewhere.</span></p>
<p><sup><a href="#footnote125">125</a></sup><a name="bookmark2330"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> This assumes the private key has not been stolen. Most private keys expire after a while. There also are “revocation lists” that keep track of stolen or compromised keys.</span></p>
<p><sup><a href="#footnote126">126</a></sup><a name="bookmark2332"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> With the RSA cryptosystem, the decoder function D is used as the signature function, because D already takes the private key as input. Note that the decoder function is just a function, so it can be used on any input. Also, in the RSA cryptosystem, the D and E functions work when applied in either order and cancel each other out. So, E(D(stuff)) = stuff, just as D(E(stuff)) = stuff.</span></p>
<p><sup><a href="#footnote127">127</a></sup><a name="bookmark2348"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Browsers and other Internet applications try hard to hide the details of most certificate management, to make browsing easier. But, when you are browsing through secure connections, all the major browsers allow you to personally examine the certificates of the sites to which you are talking, to be sure all is on the up-and-up.</span></p>
<p><sup><a href="#footnote128">128</a></sup><a name="bookmark2374"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Client certificates are used for web browsing in some corporate settings, and client certificates are used for secure email. In the future, client certificates may become more common for web browsing, but today they’ve caught on very slowly.</span></p>
<p><sup><a href="#footnote129">129</a></sup><a name="bookmark2375"></a></p>
<p><span class="font20"> Some organizational intranets use client certificates to control employee access to information.</span></p>
<p><sup><a href="#footnote130">130</a></sup><a name="bookmark2430"></a></p>
<p><span class="font20"> Instances are described later in this chapter, in the section</span><a href="#bookmark2520"><span class="font20"> “Time-Varying Instances</span></a><span class="font20">.”</span></p>
<p><sup><a href="#footnote131">131</a></sup><a name="bookmark2434"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> If there is a Content-Encoding header, the content already has been encoded by the content-encoding algorithm, and the first byte of the entity is the first byte of the encoded (e.g., compressed) cargo.</span></p>
<p><sup><a href="#footnote132">132</a></sup><a name="bookmark2454"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Even the Content-MD5 header, which can be used to send the 128-bit MD5 of the document, contains the MD5 of the encoded document. The Content-MD5 header is described later in this chapter.</span></p>
<p><sup><a href="#footnote133">133</a></sup><a name="bookmark2457"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Because a Range header might be forwarded by a more primitive proxy that does not understand multipart/ byteranges, the sender must delimit the message using methods 1, 3, or 5 in this section if it isn’t sure the receiver understands the self- delimiting format.</span></p>
<p><sup><a href="#footnote134">134</a></sup><a name="bookmark2458"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The client could do a half close of just its output connection, but many server applications aren’t designed to handle this situation and will interpret a half close as the client disconnecting from the server. Connection management was never well specified in HTTP. See</span><a href="#bookmark226"><span class="font20"> Chapter 4</span></a><span class="font20"> for more details.</span></p>
<p><sup><a href="#footnote135">135</a></sup><a name="bookmark2462"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> This method, of course, is not immune to a malicious attack that replaces both the message body and digest header. It is intended only to detect unintentional modification. Other facilities, such as digest authentication, are needed to provide safeguards against malicious tampering.</span></p>
<p><sup><a href="#footnote136">136</a></sup><a name="bookmark2469"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> In the case of the HEAD request, Content-Type shows the type that would have been sent if it was a GET request.</span></p>
<p><sup><a href="#footnote137">137</a></sup><a name="bookmark2502"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> You could close the connection as a “poor man’s” end-of-message signal, but this breaks persistent connections.</span></p>
<p><sup><a href="#footnote138">138</a></sup><a name="bookmark2505"></a></p>
<p><span class="font20"> The meaning of the TE header would be more intuitive if it were called the Accept-Transfer-Encoding header.</span></p>
<p><sup><a href="#footnote139">139</a></sup><a name="bookmark2513"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The Trailer header was added after the initial chunked encoding was added to drafts of the HTTP/1.1 specification, so some applications may not understand it (or understand trailers) even if they claim to be HTTP/1.1-compliant.</span></p>
<p><sup><a href="#footnote140">140</a></sup><a name="bookmark2543"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The HTTP/1.1 specification defines only the bytes token, but server and client implementors could come up with their own units to measure or chop up an entity.</span></p>
<p><sup><a href="#footnote141">141</a></sup><a name="bookmark2583"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Unlike Chinese and Japanese, Arabic has only 28 characters. Eight bits provides 256 unique values, which gives plenty of room for Latin characters, Arabic characters, and other useful symbols.</span></p>
<p><sup><a href="#footnote142">142</a></sup><a name="bookmark2595"></a></p>
<p><span class="font20"> See </span><a href="http://www.iana.org/numbers.htm"><span class="font20" style="font-style:italic;">http://www.iana.org/numbers.htm</span></a><span class="font20"> for the list of registered charset values.</span></p>
<p><sup><a href="#footnote143">143</a></sup><a name="bookmark2613"></a></p>
<p style="padding:0pt 0pt 2pt 0pt;"><span class="font20"> Unicode is a commercial consortium based on UCS that drives commercial products.</span></p>
<p><span class="font20">†The names look like “LATIN CAPITAL LETTER S” and “ARABIC LETTER QAF.”</span></p>
<p><sup><a href="#footnote144">144</a></sup><a name="bookmark2621"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Worse, the MIME charset tag often co-opts the name of a particular coded character set or encoding scheme. For example, iso-8859-1 is a coded character set (it assigns numeric codes to aset of 256 European characters), but MIME uses the charset value “iso-8859-1” to mean an 8-bit identity encoding of the coded character set. This imprecise terminology isn’t fatal, but when reading standards documents, be clear on the assumptions.</span></p>
<p><sup><a href="#footnote145">145</a></sup><a name="bookmark2627"></a></p>
<p><span class="font20"> The sound “AIN” is pronounced something like “ayine,” but toward the back of the throat.</span></p>
<p><sup><a href="#footnote146">146</a></sup><a name="bookmark2628"></a></p>
<p><span class="font20"> Note that Arabic words are written from right to left.</span></p>
<p><sup><a href="#footnote147">147</a></sup><a name="bookmark2633"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Many people use the term “glyph” to mean the final rendered bitmap image, but technically a glyph is the inherent shape of a character, independent of font and minor artistic style. This distinction isn’t very easy to apply, or useful for our purposes.</span></p>
<p><sup><a href="#footnote148">148</a></sup><a name="bookmark2636"></a></p>
<p style="text-align:right;"><span class="font20"> The division between semantics and presentation isn’t always clear. For ease of implementation, some presentation variants of the same characters have been assigned distinct characters, but the goal is to avoid this.</span></p>
<p><sup><a href="#footnote149">149</a></sup><a name="bookmark2639"></a></p>
<p><span class="font20"> The arrays can be multidimensional, so different bits of the code number index different axes of the array.</span></p>
<p><sup><a href="#footnote150">150</a></sup><a name="bookmark2641"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> </span><a href="#bookmark2640"><span class="font20">Figure 16-6 </span></a><span class="font20">uses a grid to represent a coded character set. Each element of the grid contains a character image. These images are symbolic. The presence of an image “D” is shorthand for the character “LATIN CAPITAL LETTER D,” not for any particular graphical glyph.</span></p>
<p><sup><a href="#footnote151">151</a></sup><a name="bookmark2672"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The iso-2022-jp encoding is tightly bound to these four character sets, whereas some other encodings are independent of the particular character set.</span></p>
<p><sup><a href="#footnote152">152</a></sup><a name="bookmark2675"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Though the bytes can have only 94 values (between 33 and 126), this is sufficient to cover all the characters in the JIS X 0208 character sets, because the character sets are organized into a 94 </span><span class="font3">× </span><span class="font20">94 grid of code values, enough to cover all JIS X 0208 character codes.</span></p>
<p><sup><a href="#footnote153">153</a></sup><a name="bookmark2689"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Servers also can use the Accept-Language header to generate dynamic content in the language of the user or to select images or target language-appropriate merchandising promotions.</span></p>
<p><sup><a href="#footnote154">154</a></sup><a name="bookmark2695"></a></p>
<p><span class="font20"> Describes the unique dialect spoken by “shredders.”</span></p>
<p><sup><a href="#footnote155">155</a></sup><a name="bookmark2703"></a></p>
<p><span class="font20"> This convention is recommended by ISO standard 3166.</span></p>
<p><sup><a href="#footnote156">156</a></sup><a name="bookmark2706"></a></p>
<p><span class="font20"> See </span><a href="http://www.iana.org"><span class="font20" style="font-style:italic;">http://www.iana.org</span></a><span class="font20"> and RFC 2860.</span></p>
<p><sup><a href="#footnote157">157</a></sup><a name="bookmark2710"></a></p>
<p><span class="font20"> See ISO standard 639, “Codes for the representation of names of languages.”</span></p>
<p><sup><a href="#footnote158">158</a></sup><a name="bookmark2711"></a></p>
<p><span class="font20"> See ISO 639-2, “Codes for the representation of names of languages—Part 2: Alpha-3 code.”</span></p>
<p><sup><a href="#footnote159">159</a></sup><a name="bookmark2716"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The country codes AA, QM–QZ, XA–XZ and ZZ are reserved by ISO 3166 as user-assigned codes. These must not be used to form language tags.</span></p>
<p><sup><a href="#footnote160">160</a></sup><a name="bookmark3330"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> Several of these action codes deal more with the internals of the Squid proxy cache, so not all of them are used by other proxies that implement the Squid Log Format.</span></p>
<p><sup><a href="#footnote161">161</a></sup><a name="bookmark3337"></a></p>
<p><span class="font20"> Recall that virtually every browser has a cache.</span></p>
<p><sup><a href="#footnote162">162</a></sup><a name="bookmark3338"></a></p>
<p><span class="font20"></span><a href="#bookmark231"><span class="font20"> Chapter 7</span></a><span class="font20"> describes how HTTP responses can be marked as uncacheable.</span></p>
<p><sup><a href="#footnote163">163</a></sup><a name="bookmark3383"></a></p>
<p style="text-align:center;"><span class="font20"> The empty Accept-Encoding example is not a typo. It refers to the identity encoding—that is, the unencoded content. If the Accept-Encoding header is present and empty, only the unencoded content is acceptable.</span></p>
<p><sup><a href="#footnote164">164</a></sup><a name="bookmark3402"></a></p>
<p><span class="font20"> See</span><a href="#bookmark307"><span class="font20"> “Status Codes” in Chapter 3 </span></a><span class="font20">for more on the 405 status code.</span></p>
<p><sup><a href="#footnote165">165</a></sup><a name="bookmark3625"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> The lightly structured nature of the form makes the submitted information fine for human consumption but difficult for machine processing. This is one reason why it is difficult to find a readable, well-organized summary of MIME types, and the reason we created the tables that end this appendix.</span></p>
<p><sup><a href="#footnote166">166</a></sup><a name="bookmark3673"></a></p>
<p style="text-align:justify;padding:0pt 0pt 0pt 7pt;"><span class="font20"> Some mail gateways would silently strip many “non-printing” characters with ASCII values between 0 and 31. Other programs would interpret some bytes as flow control characters or other special control characters, or convert carriage returns to line feeds and the like. Some programs would experience fatal errors upon receiving international characters with a value above 127 because the software was not “8-bit clean.”</span></p>
<p><sup><a href="#footnote167">167</a></sup><a name="bookmark3740"></a></p>
<p><span class="font20"> See ISO standard 639, “Codes for the representation of names of languages.”</span></p>
<p><sup><a href="#footnote168">168</a></sup><a name="bookmark3741"></a></p>
<p><span class="font20"> See ISO 639-2, “Codes for the representation of names of languages—Part 2: Alpha-3 code.”</span></p>
<p><sup><a href="#footnote169">169</a></sup><a name="bookmark3746"></a></p>
<p style="padding:0pt 0pt 0pt 7pt;"><span class="font20"> The country codes AA, QM–QZ, XA–XZ and ZZ are reserved by ISO 3166 as user-assigned codes. These must not be used to form language tags.</span></p>
</body>
</html>